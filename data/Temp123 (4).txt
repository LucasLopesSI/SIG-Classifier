This article was downloaded by: [University of Leeds]
On: 17 May 2015, At: 04:20
Publisher: Taylor & Francis
Informa Ltd Registered in England and Wales Registered Number:
1072954 Registered office: Mortimer House, 37-41 Mortimer Street,
London W1T 3JH, UK

International Journal of
Geographical Information
Science
Publication details, including instructions for
authors and subscription information:
http://www.tandfonline.com/loi/tgis20

Regression analysis with
spatially autocorrelated
error: simulation studies
and application to mapping
of soil organic matter
R. M. Lark
Published online: 04 Feb 2010.

To cite this article: R. M. Lark (2000) Regression analysis with spatially
autocorrelated error: simulation studies and application to mapping of soil
organic matter, International Journal of Geographical Information Science, 14:3,
247-264, DOI: 10.1080/136588100240831

To link to this article:  http://dx.doi.org/10.1080/136588100240831

PLEASE SCROLL DOWN FOR ARTICLE

Taylor & Francis makes every effort to ensure the accuracy of all
the information (the “Content”) contained in the publications on our
platform. However, Taylor & Francis, our agents, and our licensors
make no representations or warranties whatsoever as to the accuracy,
completeness, or suitability for any purpose of the Content. Any
opinions and views expressed in this publication are the opinions and
views of the authors, and are not the views of or endorsed by Taylor
& Francis. The accuracy of the Content should not be relied upon and
should be independently verified with primary sources of information.
Taylor and Francis shall not be liable for any losses, actions, claims,
proceedings, demands, costs, expenses, damages, and other liabilities

whatsoever or howsoever caused arising directly or indirectly in
connection with, in relation to or arising out of the use of the Content.

This article may be used for research, teaching, and private study
purposes. Any substantial or systematic reproduction, redistribution,
reselling, loan, sub-licensing, systematic supply, or distribution in any
form to anyone is expressly forbidden. Terms & Conditions of access
and use can be found at http://www.tandfonline.com/page/terms-and-
conditions

Downloaded by [University of Leeds] at 04:20 17 May 2015 int. j. geographical information science, 2000, vol. 14, no. 3, 247± 264

Research Article

Regression analysis with spatially autocorrelated error: simulation
studies and application to mapping of soil organic matter

R. M. LARK
Mathematics and Decision Systems Group, Silsoe Research Institute,
Wrest Park, Silsoe, Bedfordshire, MK45 4HS, England, UK

(Received 12 April 1999; accepted 11 July 1999)

Abstract. Regression is often used in analysis of spatial data to obtain predictive
relationships between variables. The assumption that the errors from the regres-
sion model are statistically independent will often not be plausible, due to spatial
dependence in the sources of error. This is a problem for the regression analysis
in that the resulting estimate of the standard deviation of the errors from the
model is biased (downwards) which invalidates con(cid:142) dence limits on predictions
made with the model, and which could lead to a false conclusion that the
regression is statistically signi(cid:142) cant. While the estimates of the regression coe(cid:129) -
cient(s) are not necessarily biased they are not minimum-variance estimates when
the errors are correlated.

It is shown how the maximum likelihood method of estimating the regression
model (ML) might be used to overcome this problem. It is proposed that standard
variogram functions may be used to model the spatial dependence of the errors
from the regression. In simulation studies it is shown that the method avoids bias
in the estimation of the standard deviation of the regression error from a systematic
sample (unless the spatial interval over which the errors are correlated is of similar
order to the dimensions of the systematic sample grid). The precision of the ML
estimate of the error is poorer than achieved from a random sample, but this can
be improved to some extent by constraining the parameters of the variogram
function.

The ML procedure is demonstrated in the analysis of some remote sensor
data to predict organic matter content of the top soil within an arable (cid:142) eld. The
data on top soil had been collected on a systematic grid. Analysis of the residuals
from an ordinary least-squares regression indicated an appropriate variogram
function to model the spatial dependence of the errors. Con(cid:142) dence limits for
predictions using the regression were calculated from the ML estimate of the error.

1.

Introduction
Regression is an important tool in the analysis of environmental data. Most
properly it is used to estimate an equation for predicting a dependent variable from
values of one or more independent variables (Webster 1997). The most useful applica-
tions of regression analysis are where the independent variable(s) can be rapidly
collected at low unit cost by comparison to the dependent variable. A limited number
of costly observations of the dependent variable may then be used to compute the

Internationa l Journal of Geographica l Information Science
ISSN 1365-881 6 print/ISSN 1362-308 7 online © 2000 Taylor & Francis Ltd
http://www.tandf.co.uk/journals/tf/13658816.html

Downloaded by [University of Leeds] at 04:20 17 May 2015 248

R. M. L ark

regression equation, which is then applied to predict the dependent variable for all
locations where the independent variables are measured.

There are many examples of this application of regression analysis. Variables
computed from digital elevation models have served as independent variables to
predict soil properties (de Bruin and Stein 1998), crop yields (Yang et al. 1998 ) and
air temperatures (Blennow and Persson 1998). Remote sensor data have been used
as the independent variables to predict vegetation variables (Rasmussen 1998;
Dungan 1998), water quality (Walker 1996) and forest resources (Trotter et al. 1997 ).
Lesch et al. (1995) used regression to predict soil salinity (measured directly by auger
sampling and laboratory analysis) from measurements of electromagnetic induction
which are rapidly obtained in the (cid:142) eld.

Recently, the geostatistical technique of co-kriging has been proposed as an
alternative to regression for predicting a sparsely sampled primary variable using a
more densely sampled secondary variable, (e.g. Atkinson et al. 1992, Hughson et al.
1996 ). Co-kriging exploits the fact that the covariance of the variables has a spatial
structure. The predicted value of the primary variable at a site is an optimal (in the
least-squares sense) linear combination of the secondary variables at all nearby sites,
and neighbouring measurements of the primary variable itself. However, co-kriging
two variables makes quite restrictive assumptions about their spatial co-variability,
and it is not always possible to use the technique (Atkinson et al. 1992 ).

Where it is suitable, co-kriging would generally be preferred to regression for
prediction since the latter takes no account of the spatial relationships between data
points. In practice co-kriging is not always preferred. A principal reason for this is
the sampling costs of geostatistical methods. The key to co-kriging is the model of
the spatial dependence of the primary and secondary variables based on variograms
and cross-variograms of both properties (Goovaerts 1997). Estimating variograms
requires a substantial investment in (cid:142) eld work. Webster and Oliver (1992) have
shown that estimating the variogram of a single isotropic, stationary regionalised
variable requires a minimum sample of 100 observations. Even this minimum sample
size may be prohibitive in some applications (e.g. mapping soil properties within
(cid:142) elds for precision agriculture; Lark 1997 ). More complex variables (e.g. those where
the spatial dependence is a function of direction as well as distance) may require
larger samples still. By contrast, it may often be possible to estimate the parameters
of a linear regression model with adequate precision on the basis of a smaller sample.
Lesch et al. (1995) concluded that, where it was applicable, regression analysis could
be more cost-e(cid:128) ective than co-kriging on the basis of the sampling requirement.
Hughson et al., (1996) also concluded that regression was preferable to co-kriging
where sample size is a limiting factor. Dungan (1998 ) concluded from simulations
that regression might give more precise predictions than co-kriging in some
circumstances.

Linear regression may have other advantage s over co-kriging. When kriging it
is assumed that the mean-squared di(cid:128) erence between two values of a property is a
function only of the vector which separates them (the lag) at all locations within the
region of interest. This is the second-order component of the intrinsic hypothesis of
stationarity. The intrinsic hypothesis may often not be plausible, especially in large
regions where the spatial pattern, for example of vegetation cover, may change with
geology or land-use. By contrast, the use of linear regression only assumes that the
relationship between the primary and secondary variables is the same across the
region, an assumption which may sometimes be implausible, but which may often
hold where the intrinsic hypothesis fails.

Downloaded by [University of Leeds] at 04:20 17 May 2015 Regression on spatial data

249

Finally, and perhaps most importantly, co-kriging is a method of estimation by
interpolation, but it may often be necessary (particularly in remote sensing) to predict
the primary variable at locations some distance from any ground observations.
Co-kriging requires that the measurements of the primary variable of interest, are
distributed reasonably regularly across the region to be mapped, albeit on a much
coarser grid than the secondary variables. In the case of linear regression, a relation-
ship derived from a limited number of observations can be extrapolated over a large
area, some of which may be inaccessible, provided that the linear relationship may
be assumed to be uniform over the area.

Linear regression may, therefore, sometimes be preferable to co-kriging, but there
are problems which are not always recognised in its application to spatial data sets.
The ordinary least squares regression assumes that the errors from the (cid:142) tted model
are statistically independent. This is very unlikely with spatial data sets. For example,
if leaf area index (dependent variable) is regressed on remote sensor data (independent
variables), the errors will arise from variation in soil colour, canopy water content
and leaf nutrient status —all of which are likely to be spatially dependent. The errors
in the regression will show spatial dependence imposed by the spatial dependence
of the factors which give rise to them. The result is that the estimate of the error in
the regression is biased (downwards). The con(cid:142) dence limits on predictions from the
regression will be too narrow (implying that the prediction is more precise than
is the case). Even more seriously, the evidence for the statistical signi(cid:142) cance of
the regression model will be over-optimistic (Lazar 1981). In some conditions the
regression coe(cid:129) cients may themselves be biased by correlation in the errors.

Lesch et al. (1995 ) recognised this problem, so applied test of independence to
the residuals from their regression models. They recommended that regression only
be used when the residuals appeared to be independent. This is a very restrictive
condition. It would be better to account for the spatial dependence of the residuals
in the (cid:142) tting of the regression. This can be done, but requires that an appropriate
model of the correlation among the residuals be speci(cid:142) ed.

The present paper proposes that the functions used in geostatistics to model
variograms be used to specify the correlations of errors in a regression model and it
shows how this can be done. The importance of accounting for this lack of independ-
ence is demonstrate d in simulation studies, which are also used to answer some
practical questions about the technique. Finally the use of the method is demon-
strated in a practical problem where soil organic matter content is to be mapped
using remote sensor data.

2. Theory

The basic regression model is

Y = Xb +e,

(1)

where Y is a vector containing the n observations of the dependent variable, X is an
nÖ m matrix containing n observations of m independent variables—each variable
centred to a mean of zero, and b is a vector of m regression coe(cid:129) cients. e is a vector
of n errors. In ordinary least-squares regression (OLS) the elements of e are assumed
to be independent random normal random deviates. Under this assumption the least
squares estimate of b is identical to the maximum likelihood estimate. The assumption
of independence of the errors may be relaxed by treating e as the realisation of an
n-variate normal distribution of mean zero and with a covariance matrix V. To

Downloaded by [University of Leeds] at 04:20 17 May 2015 250

R. M. L ark

simplify further, it is assumed that the error is homogeneous, with variance s2. This
assumption may not always be plausible, but it will hold in many circumstances
where the intrinsic hypothesis does not hold for the dependent and independent
variables. V can therefore be replaced by s2A where A is the correlation matrix of
the errors. On the basis of the above conventions the log-likelihood function for the
regression model may be written as

n
2

n
2

1
2

1
2s2

log 2pÕ

log s2Õ

log |A|Õ

(YÕ Xb)TAÕ 1( YÕ Xb).

(2)

For a given correlation matrix, A, the maximum likelihood estimate of b can be
found by setting to zero the partial derivative of (2) with respect to the elements of
b. It is easy to show that the resulting estimate is given by

b =( XTAÕ 1X)Õ 1( XTAÕ 1Y).

(3)

This estimator is equivalent to the generalised least-squares estimator (Cressie
1993 ), and has been used in other contexts when errors are spatially dependent
(Cook and Pocock 1983). If the errors are independent then the correlation matrix
A is the identity matrix, equation (3) for a regression on a single independent variable
then reduces to the familiar least-squares estimate of the regression coe(cid:129) cient of y
on x

SPxy
SSx
where SPxy and SSx denote the sum of products of x and y and the sum of squares
of x.

b =

(4)

,

The maximum-likelihood estimate of the error variance, conditional on a

particular correlation matrix, is given by

sÃ 2 =

(YÕ Xb)TAÕ 1( YÕ Xb).

1
n

(5)

(6)

From the standard results for the covariance matrices of maximum likelihood
estimators (see, for example, Dobson 1990) it can be seen that the covariance matrix
for the estimated regression coe(cid:129) cients is estimated by

sÃ 2( XTAÕ 1X)Õ 1.

This allows standard errors to be obtained for the regression coe(cid:129) cients.
A problem remains, since all these estimates are conditional on a correlation
matrix for the errors, which we do not know. Cook and Pocock (1983) proposed
that the correlation matrix be de(cid:142) ned by a function of the spatial interval separating
the observations. Conditional estimates of b and of the error variance may then be
obtained by a numerical optimization of (2) with respect to the parameters of the
spatial function. In fact, for a given A the fourth term of (2) depends only on n when
(2) is maximised with respect to b and to the error variance, so the correlation
matrix A is sought which maximizes

log |A|Õ n log sÃ 2.

(7)

How might a correlation matrix A be de(cid:142) ned, which can be speci(cid:142) ed by a small
number of parameters so that a maximum of (7) can be easily found? A must be a
symmetric positive de(cid:142) nite matrix (to meet the condition that the variance of any

Downloaded by [University of Leeds] at 04:20 17 May 2015 Õ
Õ
Regression on spatial data

linear combination of the errors is positive). It must re(cid:143) ect, in a physically realistic
fashion, the possible spatial dependence of the errors. This paper proposes that these
requirements will be met if the elements of A are given by:

ai,j = 1Õ

s(hi,j),

where ai,j is the correlation of errors for observations i and j, hi,j is the lag separating
observations i and j in space and s is an authorised variogram function as used in
geostatistics to model variograms or autocovarianc e functions. If s is an authorised
variogram function then the resulting correlation matrix will be positive de(cid:142) nite
(Webster and Oliver, 1990), and since s(hi,j) = s(hj,i) it will be symmetric.

Examples of authorised variogram functions are the exponential and the spherical.

The exponential variogram function is de(cid:142) ned as

c(h)= 1Õ

eÕ

(h/r)

where r is a distance parameter and h is the lag.

The spherical variogram function is de(cid:142) ned as

251

(8)

(9)

(10)

3h
2r

c(h)=GG

1

rB3
2Ah

H h<

r

1

h > r

where r is a distance parameter, the range, beyond which the phenomenon charac-
terised by the function shows no spatial dependence.

The particular feature of the proposal in this paper is in the combination of
geostatistical models of spatial dependence (variogram functions) with the maximum
likelihood regression procedure. The proposal is made on the basis that variogram
models have been widely successful in describing spatial dependence of environmental
variables (e.g. Cressie 1991), and can describe the outcomes of a variety of di(cid:128) erent
processes.

The exponential variogram describes many phenomena which can be modelled
as random processes in space. If, for example, the variability of a soil property is
strongly controlled by soil boundaries, and the intersection of these boundaries with
a randomly located line on the ground can be regarded as Poisson events, then the
autocorrelation of the process will be described by using (9) as the variogram
function in equation (8). If the underlying process corresponds to rather more
regularly spaced boundaries, then a spherical variogram function may be more
appropriate (Burrough 1983). Power function variograms may describe fractal phen-
omena, and variograms with a sine function can account for periodicity (Webster
and Oliver 1990 ). Variograms may also be linearly combined to describe the outcome
of additive processes at di(cid:128) erent spatial scales. In practice, variogram functions are
usually selected by seeing which gives the best (cid:142) t to observed values (McBratney
and Webster 1986).

One advantage of using the spherical and exponential variograms in the present
context is that they are each de(cid:142) ned by a single spatial parameter, r. This simpli(cid:142) es
the computation. For any set of observations of known spatial arrangement, and for
a given variogram function, a single value of the r will determine the correlation
matrix A. This allows a conditional estimate to be made of b and of the error
variance, from equations (3) and (5). The (cid:142) nal solution is that corresponding to the

Downloaded by [University of Leeds] at 04:20 17 May 2015 Õ
252

R. M. L ark

spatial parameter which yields the correlation matrix and estimate of the error
variance from equation (5) which maximizes equation (7). This will be found numeric-
ally. Thus r and the regression parameters are estimated together. However, there is
no reason why equation (7) should not be maximised with respect to more than one
variogram parameter de(cid:142) ning A in more complex situations.

In principle a number of authorised variogram functions, in addition to the
exponential and spherical, may be suitable to de(cid:142) ne A. Parsimony favours functions
such as the spherical or exponential with a single parameter. However, weighted
linear combinations of variogram functions describing processes at di(cid:128) erent scale,
or periodic functions, may sometimes be more appropriate. In order to select an
appropriate model, exploratory analysis may be carried out on the residuals from
an OLS regression (cid:142) tted to the data. The variogram model which seems best to (cid:142) t
the experimental variogram of these residuals may then be speci(cid:142) ed for A in the
maximum likelihood procedure detailed above. However, since the values of the
experimental variogram will be biased estimates of the true variogram of the errors,
and will be imprecise when based on fewer than 100 samples, it may be a useful rule
of thumb to avoid the more complex variogram models unless the experimental
variogram of the OLS residuals and/or a priori knowledge about the underlying
sources of the error provide strong evidence that they are necessary.

In the remainder of this paper OLS regression is compared with the ML
procedure implemented with variogram-base d estimation of the correlation matrix
(henceforth referred to simply as ML regression) in simulations. The ML method is
then demonstrate d on a real data set.

3. Simulation studies
3.1. Objectives

The previous sections sets out a procedure for obtaining estimates of a regression
model and its error by maximum likelihood when the errors show spatial dependence.
Simulation studies were carried out in order to evaluate the robustness of the
procedure, and to compare its output with OLS. The questions addressed were:

1. Does the ML approach described above have signi(cid:142) cant advantage s overthe
OLS approach by avoiding bias in the estimation of the error? In particular,-
does the conditionality of the estimate of the error variance on A lead to
itsunderestimation? Cook and Pocock (1983) conjectured that any bias should
be small.

2. How far do the e(cid:128) ects above depend on the sampling strategy and on the
scale of spatial dependence of the errors relative to the sampling scheme?

3. Is the ML method sensitive to the choice of variogram model?
4. Is the output of the ML method improved by constraining its solution to
conform with evidence about the variogram of the errors (e.g. from spatial
analysis of the residuals from an OLS regression)?

3.2. T he simulation scheme and experiments

The simulation scheme used was as follows.

1. The simulated annealing algorithm SASIM, of Deutsch and Journel (1992)
was used to simulate a realisation of a random normal variable, E, with a
speci(cid:142) ed variogram, at points on a uniform square grid of 250 rows and
columns. In all cases the a priori variance speci(cid:142) ed for the variable was 1.0,

Downloaded by [University of Leeds] at 04:20 17 May 2015 Regression on spatial data

253

partitioned into a nugget term of 0.05 and a sill of 0.95. The mean of the
random variable was zero. The distance between adjacent grid nodes is called
the ‘grid unit’ in the rest of the paper.

2. A random normal independent variable, X, was simulated at points on the
grid referred to above. Each realisation of this variable was independent of
the others. The algorithm G05DDF from the NAG library (Numerical
Algorithms Group 1988) was used to generate this variable, which had a
variance of 1.0.

3. A dependent random variable, Y , was then generated at each location on the

grid, i, such that

Y(i)= 1.2X(i)+E(i).

(11)

Y therefore had variance 1 +1.22, and was linearly related to X, with an
adjusted R2 value of 0.59. The errors from a regression of Y on X had the
spatial dependence imposed in step (1).

4. A simple random sample of 49 locations was then selected from the grid
without replacement. The values Y(i ) and X(i ), i = 1, 2, ..., 49 were extracted.
The regression of Y on X and the error variance were estimated from these
observations by ordinary least squares (OLS) and by the maximum likelihood
method (ML), having speci(cid:142) ed a variogram model to form the correlation
matrix A. This procedure was repeated a further 99 times, to give a total of
100 estimates of each parameter of the regression model by each method. The
100 samples from the grid were drawn without replacement so that no one
grid node would appear in more than one sample. The parameters of the (cid:142) tted
regression and the estimate of the standard deviation of the error (sÃ
from
equation (5)) were recorded for each sample.

5. A systematic sample of observations on a randomly located grid of unit
spacing corresponding to 7 rows by 7 columns was then drawn from the data
set. The OLS and ML procedures were used as above to estimate the para-
meters of the regression model and the error variance. As before a total of
100 samples, each of 49 observations, were drawn without replacement
(although nodes drawn previously under simple random sampling were eligible
for inclusion in a systematic sample). The parameters of the (cid:142) tted regression
and the estimate of the error standard deviation were recorded for each sample.

This simulation scheme was used in the following experiments.

3.2.1. Experiment 1

The full procedure detailed above was followed six times, simulating the error
variable with a spherical variogram of range 1, 2, 3, 4, 5 and 6 grid units respectively.
The ML procedure was used twice in each instance, specifying a spherical and an
exponential variogram function to de(cid:142) ne the correlation matrix.

3.2.2. Experiment 2

An error variable was simulated with a nested variogram consisting of two
equally weighted spherical components of range 2 and 5 grid units. Step (5) of the
procedure above was then followed. The ML regression method was applied twice,
in the (cid:142) rst instance specifying a spherical variogram function to de(cid:142) ne the correlation
matrix, and in the second instance an exponential.

Downloaded by [University of Leeds] at 04:20 17 May 2015 254

R. M. L ark

3.2.3. Experiment 3

The error variable was simulated three times, with a spherical variogram of
range r = 3, 4 and 5 grid units respectively. Step (5) of the procedure above was then
followed in each case. The ML regression method was applied twice, specifying a
spherical variogram function on both occasions. In the (cid:142) rst instance the range of
the variogram function was unrestricted. In the second instance it was assumed that
some estimate of the actual range was obtained (perhaps by analysis of residuals
from an OLS regression) and that this would lie within Ô 2.5 grid units of the true
range r. The ML method was modi(cid:142) ed to (cid:142) nd the solution which maximised
equation (7) subject to the constraint that the range of the variogram function which
de(cid:142) ned A was within 2.5 grid units of r.

3.3. Results of simulation studies
3.3.1. Experiment 1

The estimates of the standard deviation (sd) of the error term in the regression
model were symmetrically distributed, so it was reasonable to invoke the central
limit theorem, and assume that, for each sampling scheme and regression estimator,
the mean of the estimates from 100 independent samples was a normally distributed
variable. Figure 1 shows the mean values of the estimate of the error sd for each
sampling scheme and regression estimator. Con(cid:142) dence intervals (95%) for these
means are shown, and the (cid:142) rst and third quartiles of the data.

Random sampling. It is apparent that the most precise estimates of the error were
obtained from simple random sampling ((cid:142) gure 1(a) and (b)), regardless of the regres-
sion estimator. There was statistically signi(cid:142) cant evidence of bias ( p < 0.05) when the
range of the simulated error variable was 4 or 5 grid units, but the bias was small.
Bias was more substantial when the range of the simulated error was 6 grid units.
This bias arises when the range of the spatial dependence of the errors becomes
signi(cid:142) cant relative to the size of the region from which the random sample is drawn.
It probably arises in the ML regression because the random sample does not contain
adequate information on the spatial structure of the errors.

Systematic sampling. Here OLS showed pronounced and signi(cid:142) cant bias ( p < 0.05)
in the estimate of the error when the range of the variogram function was 2 grid
units or more ((cid:142) gure 1(c)), and the bias increased with the range of the variogram
of the simulated error. The variation of the estimates was also larger than with
random sampling. Using the ML regression estimator lead to slightly reduced
precision in the estimates of the error sd by comparison to OLS applied to the same
data, but the bias was mitigated, with no signi(cid:142) cant evidence of bias when the
simulated error range was less than 6 grid units ((cid:142) gure 1(d)). (Because of the greater
variability of the estimates this was a less stringent test for bias than in the results
for simple random sampling).

Specifying an exponential model for the correlation matrix A (the simulated data
had a spherical variogram) did not e(cid:128) ect the bias of the ML regression, but did
slightly reduce its precision ((cid:142) gure 1(e)). This implies that the method is not very
sensitive to the form of the variogram function.

The estimated regression coe(cid:129) cients had symmetrical distributions. The central
limit theorem was therefore invoked, and the Student’s t statistic used to test whether
the mean value of the estimated coe(cid:129) cient from the 100 samples di(cid:128) ered signi(cid:142) cantly
from the value speci(cid:142) ed when simulating the data (1.2). This test showed no signi(cid:142) c-
ant bias in any of the estimates of the regression coe(cid:129) cient, regardless of the sampling

Downloaded by [University of Leeds] at 04:20 17 May 2015 Regression on spatial data

255

Figure 1. Results of Experiment 1. Mean values of 100 estimates of the standard deviation
of the regression error ( E
) are shown when the error variable is simulated with a
spherical variogram of range 1 to 6 units. The simulated value of the error standard
deviation was 1.0 in all cases. Solid lines show the 1st and 3rd quartiles of the estimates
and the broken lines show 95% con(cid:142) dence intervals of the mean. OLS signi(cid:142) es ordinary
least squares regression, ML signi(cid:142) es the maximum likelihood regression method
specifying a spherical variogram function (except in (e)). SRS signi(cid:142) es simple random
sampling, and SS systematic sampling.

scheme, the regression estimator used, and the spatial dependence of the simulated
error.

3.3.2. Experiment 2

There was no signi(cid:142) cant evidence of bias in the estimate of the error when a
spherical variogram model was used to de(cid:142) ne the correlation matrix of errors
(table 1), although the errors had been simulated with two nested spherical compon-
ents. There was signi(cid:142) cant evidence of bias when an exponential model was used for

Downloaded by [University of Leeds] at 04:20 17 May 2015 256

R. M. L ark

Table 1. Statistics for 100 estimates of the error standard deviation from data sets in
Experiment 2.

Regression estimator

Standard
Mean deviation

95% con(cid:142) dence
interval for mean Quartile 1 Quartile 3

ML (Spherical model

1.02

ML (Exponential model

0.94

assumed)

assumed)

0.19

0.11

0.98–1.06

0.92–0.96

0.87

0.86

1.16

1.01

analysis of the same data. In neither case was there evidence of bias in the estimation
of the regression coe(cid:129) cient. This result quali(cid:142) es the implications of Experiment 1
for the importance of specifying an appropriate variogram function. If the errors
show spatial variability at more than one scale, then a model should be selected to
accommodate this.

3.3.3. Experiment 3

Constraining the range of the spherical variogram had no e(cid:128) ect on the analysis
when the range of the simulated error was 4 grid units (since the unrestricted analysis
did not (cid:142) nd solutions outside the range). However, with a simulated error term with
a longer range there was improvement in the precision of the estimated error sd,
and the reduction in the variances of the estimates of the error sd were shown to be
signi(cid:142) cant by a two-tailed F test (table 2). The bias in the estimate of the error sd
when the simulated error variable had a range of 6 grid units was less with the
constrained analysis. Prior information on the spatial variability of the errors (e.g.
from a variogram of the residuals from an OLS regression) may therefore be useful.

4. A practical application: mapping organic matter content of the topsoil with
remote sensor data

The study site, Cashmore (cid:142) eld,

is a 6 ha (cid:142) eld at Silsoe Research Institute,
Bedfordshire, England. The soil variation of this (cid:142) eld is discussed elsewhere in detail
(Lark et al. 1998). Research on Cashmore (cid:142) eld is focused on the within-(cid:142) eld variation
of soil conditions and crop yield. If farming practice is to take account of such
variations then methods for mapping soil properties on the basis of minimum
sampling costs, but with reliably estimated precision, are essential. Mapping of soil
organic matter content has attracted interest, in particular because of the importance
of this property in determining the e(cid:129) cacy of soil-acting herbicides (Sudduth et al.
1991 ). If top soil organic matter could be mapped economically, then there may be
scope for more e(cid:129) cient and environmentally acceptable use of such herbicides by
spatially-variabl e application. Since organic content has long been recognised as an
important factor determining the spectral re(cid:143) ectance of soil (e.g. Kristof et al. 1973 )
remote sensing methods seem appropriate for mapping soil organic matter. The
development of a regression equation to predict organic matter from remotely sensed
measurements in Cashmore (cid:142) eld was therefore chosen as a case study for this paper.
Remote sensor measurements were made on 20 March 1996. At this time the
(cid:142) eld was under an autumn-sown barley crop. Cover was partial, with soil visible
from above—particularly between rows. Radiance measurements were obtained from
an array of 6 sensors, mounted 2 m apart on a tractor boom. The sensors were Skye
7.5 nm. Output from the
Instruments type SKR 1800 2, with a waveband of 660 Ô

Downloaded by [University of Leeds] at 04:20 17 May 2015 Regression on spatial data

257

.

3

t
n
e
m

i
r
e
p
x
E

n

i

s
t
e
s

a
t
a
d
m
o
r
f

n
o
i
t
a
i
v
e
d

d
r
a
d
n
a
t
s

r
o
r
r
e

e
h
t

f

o

s
e
t
a
m

i
t
s
e

0
0
1

r
o

f

s
c
i
t
s
i
t
a
t
S

.

2
e
l

b
a
T

3

e
l
i
t
r
a
u
Q

1

e
l
i
t
r
a
u
Q

8
0
1

.

0
1
1

.

8
0
1

.

8
0
1

.

0
1
1

.

9
0
1

.

8
8
0

.

2
8
0

.

9
7
0

.

8
8
0

.

5
8
0

.

3
8
0

.

e
c
n
e
d
(cid:142)
n
o
c
%
5
9

l
a
v
r
e
t
n

i

n
a
e
m

r
o

f

.

2
0
1
–
5
9
0

.

.

0
0
1
–
2
9
0

.

.

8
9
0
–
9
8
0

.

.

2
0
1
–
5
9
0

.

.

0
0
1
–
4
9
0

.

.

9
9
0
–
2
9
0

.

*
o
i
t
a
r
-
F

0
0
1

.

1
5
1

.

2
5
1

.

d
r
a
d
n
a
t
S

f

o

n
o
i
t
a
i
v
e
d

d
s

r
o
r
r
e

n
a
e
M

f

o

e
t
a
m

i
t
s
e

d
s

r
o
r
r
e

f

o

e
g
n
a
R

d
e
t
a
l
u
m

i
s

m
r
e
t

r
o
r
r
e

7
1
0

.

1
2
0

.

2
2
0

.

7
1
0

.

7
1
0

.

7
1
0

.

9
9
0

.

7
9
0

.

4
9
0

.

9
9
0

.

7
9
0

.

6
9
0

.

4

5

6

4

5

6

r
o
t
a
m

i
t
s
e

n
o

i
s
s
e
r
g
e
R

l
e
d
o
m

l
a
c
i
r
e
h
p
S

(

L
M

)

d
e
n

i
a
r
t
s
n
o
c
n
u

,
l
e
d
o
m

l
a
c
i
r
e
h
p
S

(

L
M

)

d
e
n

i
a
r
t
s
n
o
c

f

o

e
u

l
a
v

l
a
c
i
t
i
r
c

e
h
T

.
s
e
t
a
m

i
t
s
e

d
e
n

i
a
r
t
s
n
o
c

e
h
t

f

o

t
a
h
t

o
t

d
s

r
o
r
r
e

e
h
t

f

o

s
e
t
a
m

i
t
s
e

d
e
n

i
a
r
t
s
n
o
c
n
u

e
h
t

f

o

e
c
n
a
i
r
a
v

e
h
t

o
i
t
a
r

e
h
t

s
i

o
i
t
a
r

F

e
h
T

*

f

o

t
a

9
4
1

.

s
i

.

5
0
0
=
p

t
s
e
t

d
e
l
i
a
t
-
o
w

t

a

r
o

f

o
i
t
a
r

s
i

h
t

Downloaded by [University of Leeds] at 04:20 17 May 2015 258

R. M. L ark

sensors was standardised by ratioing to the output from an identical sensor (cid:142) tted
with a cosine-di(cid:128) user and mounted looking vertically upward to measure irradiance.
It was found after data collection that the gain of the reference sensor had been
incorrectly set, so the re(cid:143) ectance measurements which were obtained were relative
rather than absolute measurements. Each measurement was associated with
co-ordinate s obtained from a di(cid:128) erential Global Positioning System mounted on
the tractor.

The sensor system and data preprocessing were designed and operated for studies
on crop development, and the raw data were no longer available. The available data
consisted of averaged (relative) re(cid:143) ectance values for 10 m by 1m pixels, giving more
or less complete coverage of the (cid:142) eld. The 10 m side of the pixel is perpendicular to
the crop rows. Averaging over this distance in this direction avoids artefacts from
aliasing with the crop rows and (cid:142) eld tramlines (wheel tracks for vehicles). Ideally
data from smaller isotropic pixels would have been preferred for the particular
problem of mapping topsoil organic matter content.

The re(cid:143) ectance measurements were interpolated onto a regular 5 m grid. Kriging
was not suitable for this purpose because the data are not on a quasi-point support
relative to the size of the grid. Inverse-squared distance interpolation was therefore
used within a limited search radius of 15 m.

Soil sampling was conducted on the (cid:142) eld four weeks before the radiometric
measurements. Samples were collected at 100 marked and surveyed sites on a square
grid of
interval 25 m. The sampling scheme was determined by requirements of
related work, for which variograms of various properties had to be estimated. For
cost reasons, soil organic matter could only be determined at a subset of the sites,
45 in total. These occurred at 25 m intervals on seven transects oriented North/South
or east/west, so constituted a systematic sample. At each of the sample sites 6 soil
cores to 200 mm depth were collected within a circle about the marker of 1 m
diameter, bulked and sub-sampled in the (cid:142) eld. The organic matter (OM) content
(%) of the resulting material was then determined in the laboratory by the Walkley-
Black digestion method (Hesse 1971). The soil samples were therefore drawn from
a smaller region than the re(cid:143) ectance measurements. However, the di(cid:128) erence in scale
is not very great and the soil data can e(cid:128) ectively be regarded as corresponding to
the re(cid:143) ectance data.

The sites at which OM were determined corresponded to locations on the 5 m
grid of interpolated (relative) re(cid:143) ectance measurements (RR) (subject to the reserva-
tions in the previous paragraph) . OM and RR could therefore be extracted for each
site. The statistical analysis on these data took the following steps.

1. An OLS regression of OM on RR was computed and the residuals from this
regression were obtained for each site. The variogram of the residuals was
estimated and an appropriate model was (cid:142) tted using the MVARIOGRAM
procedure in Genstat (Payne et al. 1995). The estimated variogram and the
best-(cid:142) tting model (a spherical variogram) are shown in (cid:142) gure 2. There is clearly
some spatial autocorrelation of the residuals, which is not unexpected since
the residuals will represent the contributions of spatially dependent factors
such as crop cover, soil moisture content and mineralogy.

2. A ML regression was then computed, using the ML procedure described in
this paper, and specifying a spherical variogram function to de(cid:142) ne the correla-
tion matrix A, since this was the function which best described the variogram

Downloaded by [University of Leeds] at 04:20 17 May 2015 Regression on spatial data

259

Figure 2. Experimental semivariogram for residuals from the OLS regression of top soil
organic matter content on relative re(cid:143) ectance. The solid line shows the (cid:142) tted spherical
variogram model with a range of 77.4 m.

of the OLS residuals. Figure 3 shows the resulting regression model and the
data to which it was (cid:142) tted. The regression equation was

OM (%) = 9.1Õ 16.1 (RR).

(12)

The error variance was estimated as 0.47 and the adjusted R2 was 0.55.

The standard error of the regression coe(cid:129) cient was 2.64. The signi(cid:142) cance of the
regression could thus be tested by the t-statistic for the null hypothesis that the
regression coe(cid:129) cient is zero. The t-statistic for this test was 6.1, the null hypothesis
was rejected ( p < 0.001 ).

The predicted OM values were calculated using (12) for each location of the 5 m

Figure 3. Regression of topsoil organic matter content on relative re(cid:143) ectance.

Downloaded by [University of Leeds] at 04:20 17 May 2015 260

R. M. L ark

grid of interpolated relative re(cid:143) ectance. These were contoured and are shown in
(cid:142) gure 4. Note that OM was not predicted at locations where RR fell outside the
range of values found in the data from which the regression was derived.

The variance of the predicted value, using a regression, of a dependent variable,

Y ¾ , corresponding to a value X¾

is

Var (Y

)+(X ¾

Õ X

)2 Var (b)+Var (e),

(13)

and Y

where Var ( ) denotes variance, b is the regression coe(cid:129) cient, e is the error term and
denote sample averages from the data from which the regression is derived.
X
For OLS regression this reduces to the familiar formula for the variance of a
regression prediction (see, for example equation (10) of Webster 1997 ). Using the
ML regression the variance of a prediction may be estimated as

1

sÃ 2A1 +

nB +Var (b)(X ¾

Õ X

)2,

(14)

where sÃ 2 is obtained from equation (5) and Var (b) is obtained from equation (6).

Equation (14) was used to compute the standard deviations of the predicted
values of OM (see (cid:142) gure 5), and from these the probabilities (if errors are normal)
that the true value of OM at each site is less than 3% (see (cid:142) gure 6). 3% was an
arbitrary threshold selected for illustrative purposes.

The pattern of soil organic matter as mapped by this regression is readily understood
in relation to the soil variation of the (cid:142) eld. The region of low organic matter near the
centre and east of the (cid:142) eld is where relatively shallow sandy soils occur directly over
the underlying Lower Greensand. Crop establishment and growth is generally poor and
returns of organic matter to the soil from stubble are therefore small. In the north-west
corner of the (cid:142) eld, over an extensive patch of boulder clay, yields are generally better
so the organic matter content of the topsoil is larger. Along the southern margin of the
(cid:142) eld organic matter content is large, mainly because of the incorporatio n of underlying
peat deposits into the topsoil by cultivation. Here relative re(cid:143) ectance is commonly below
the range of the data for the regression.

Figure 4. Predicted top soil organic matter content using the maximum likelihood regression.
The hatched areas are where the remote sensor measurements were outside the range
of the calibration data.

Downloaded by [University of Leeds] at 04:20 17 May 2015 ±
±
±
±
±
Regression on spatial data

261

Figure 5. Standard error of predicted top soil organic matter content using the maximum
likelihood regression. The hatched areas are where the remote sensor measurements
were outside the range of the calibration data.

Figure 6. Probability that soil organic matter < 3%, based on standard errors from Maximum
likelihood regression, assuming normal errors. The hatched areas are where the remote
sensor measurements were outside the range of the calibration data.

5. Discussion and conclusions

The simulation study demonstrate d the advantage of the ML regression over
OLS for the analysis of data from a systematic sample. The ML procedure dealt
with the problem of spatial dependence of the errors to achieve unbiased estimates
of the error sd (Experiment 1). This supports Cook’s and Pocock’s (1983) conjecture

Downloaded by [University of Leeds] at 04:20 17 May 2015 262

R. M. L ark

that the conditionality of the estimate on the speci(cid:142) ed correlation matrix will not
introduce signi(cid:142) cant bias.

However, the ML method does not fully mitigate the problems caused by system-
atic sampling and autocorrelate d error, since the precision of the estimates of the
error sd is poorer than is achieved using a simple random sample from the same
data. The precision of the ML estimate of the error sd can be improved to some
extent by constraining the possible values of the spatial parameter of the variogram
function which de(cid:142) nes the error correlation matrix (Experiment 3 ). This requires
that a reasonable indication of the form of the variogram of the errors can be
obtained by analysis of the residuals from the OLS regression.

When data were collected by simple random sampling, the results for OLS and
ML regression were very similar, and estimates of the error variance were biased
once the range of spatial dependence of the errors exceeded 3 grid units. The ML
estimator probably failed to avoid bias because a random sample provides very
limited evidence for the form of the autocorrelation matrix of the errors since there
will be few if any pairs of observations separated by a particular lag.

Increasing the range of the error term increased the bias with which the error
variance was estimated under systematic sampling and simple random sampling,
and there was statistically signi(cid:142) cant evidence for bias ( p < 0.05) in the estimate of
the error sd by the maximum likelihood method when the variogram of the error
term had a range of 6 grid units (Experiment 1). This implies that the overall
dimensions of a systematic sample array should be larger than the anticipated range
of spatial dependence of the errors so that the data contain pairs of observations
separated by lags up to and beyond this range.

When the simulated error had a simple spherical variogram then the choice
between and exponential or spherical variogram function to de(cid:142) ne the correlation
matrix was not critical (Experiment 1), although the precision of the estimate of the
error sd. was slightly poorer when the exponential model was speci(cid:142) ed. However,
when the simulated error had a nested variogram model with two spatial parameters
(double spherical), specifying an exponential variogram function lead to bias in the
estimate of the error variance (Experiment 2). This underlines the value of investiga-
ting the spatial dependence of residuals from an OLS regression to provide evidence
for an appropriate choice of variogram function.

What are the practical implications of these conclusions for scienti(cid:142) c practice?
Firstly, it is clear that the spatial dependence of errors should not be ignored in
regression analysis, especially when the dependence is likely to occur over long
distances. Even random samples from a large region (250 grid units square) showed
some e(cid:128) ects of bias in the estimate of the OLS error when the range of the error
variogram exceeded just 3 grid units. This shows how sensitive regression analysis
can be to correlation of the errors.

Secondly, spatial data will commonly be available on a systematic grid or transect
due to the practical convenience and other advantage s of systematic sampling
(Cochran 1977). Here, as shown in (cid:142) gure 1(c) OLS regression can lead to markedly
biased estimates of the error, even when spatial dependence is limited to short
intervals by comparison to the dimensions of the sampling array.

Five principal practical rules emerge from this study. They should be followed
when using regression analysis on spatial data to generate a predictive equation.
They are important when the analyst is concerned (as he or she almost always should
be) to estimate con(cid:142) dence limits on predictions subsequently made with the regression
model, and to test the regression’s overall signi(cid:142) cance. The rules are as follows

Downloaded by [University of Leeds] at 04:20 17 May 2015 Regression on spatial data

263

1. When data on the dependent variable are collected on a systematic sampling

grid or transect, the ML regression must be used.

2. Given a choice of sampling scheme, random sampling is best if it is reasonable
to assume that the sample region is large relative to the range over which the
errors are spatially dependent. The results from the simulations suggest that
the error estimate from simple random sampling may be biased if the range
of the spatial correlation structures exceeds 1% of the dimension of the sampled
region, but this is only a rough guide.
(General experience, and not the
simulation, suggests that strati(cid:142) ed random sampling may be best to ensure
representative coverage).

3. Where the assumption in rule (2) cannot be made, systematic sampling should
be used in conjunction with ML regression, since the ML method seems to
be most successful in modelling the error from a systematic sample. (Systematic
sampling may also be preferred for practical reasons, especially in terrain
where access to sample sites may be di(cid:129) cult).

4. When following the option in rule (3), it is advisable to conduct an initial
OLS regression on the data, and to examine the variogram of the residuals
to ensure that an appropriate variogram model is speci(cid:142) ed to de(cid:142) ne the
correlation matrix in the ML regression. This study shows that there is no
need to be too concerned as to whether a spherical or exponential model is
speci(cid:142) ed when the errors seem to have a single range of spatial dependence.
When the errors seem to vary at more than one distinct scale, however, then
combinations of variogram models should be used.

5. The precision of the ML estimate of the error sd may be improved if it is
constrained to (cid:142) nd a solution in which the spatial parameter of the function
which de(cid:142) nes the correlation matrix is similar to that of the variogram of the
OLS residuals.

Acknowledgments

This work was funded by the BBSRC (UK) through its Competitive Strategic
Grant to Silsoe Research Institute. The remote sensor data of Cashmore (cid:142) eld were
collected by R. B. Brown as part of a study funded by the Ministry of Agriculture,
Fisheries and Food. Soil sampling was done by Miss H. C. Wheeler and the author,
and the organic matter determinations were done by the Analytical Laboratory of
Silsoe Research.

References
Atkinson, P. M., Webster, R., and Curran, P. J. 1992, Cokriging with ground-based radiome-

try. Remote Sensing of Environment, 41, 45–60.

Blennow, K, and Persson, P., 1998, Modelling local-scale frost variations using mobile
temperature measurements with a GIS. Agricultural and Forest Meteorology, 89, 59–71.
Burrough, P. A. 1983, Multiscale sources of spatial variation in soil. I. The application of
fractal concepts to nested levels of soil variation. Journal of Soil Science, 34, 577–597.

Cochran, W. G., 1977, Sampling T echniques, 3rd Edition (New York: Wiley).
Cook, D. G., and Pocock, S. J., 1983, Multiple regression in geographical mortality studies

with allowance for spatially correlated errors. Biometrics, 39, 361–371.

Cressie, N. A. C., 1993, Statistics for Spatial Data (New York: Wiley).
de Bruin, S., and Stein, A., 1998, Soil-landscape modelling using fuzzy c-means clustering of
attribute data derived from a Digital Elevation Model (DEM). Geoderma, 83, 17–33.
Deutsch, C. V., and Journel, A. G., 1992, GSL IB Geostatistical Software and User’s Guide

(New York: Oxford University Press).

Downloaded by [University of Leeds] at 04:20 17 May 2015 264

Regression on spatial data

Dobson, A. J., 1990, An Introduction to Generalized L inear Models (London: Chapman and

Dungan, J., 1998, Spatial prediction of vegetation quantities using ground and image data.

International Journal of Remote Sensing, 19, 267–285.

Goovaerts, P., 1997, Geostatistics for Natural Resources Evaluation (Oxford: Oxford

Hall).

University Press).

Hesse, P. R., 1971, A T extbook of Soil Chemical Analysis (London: John Murray).
Hughson, L., Huntley, D., and Razack, M., 1996, Cokriging limited transmissivity data
using widely sampled speci(cid:142) c capacity from pump tests in an alluvial aquifer. Ground
Water, 34, 12–18.

Kristof, S. J., Baumgardner, M. F., and Johannsen, C. J. 1973, Spectral mapping of soil
organic matter. L ARS Information Note 030773 (Laboratory for Applications of
Remote Sensing, Purdue University, Indiana).

Lark, R. M., 1997, Variation in soil conditions and crop performance. In Precision Agriculture
’97. Volume I: Spatial Variability in Soil and Crop edited by J.V. Sta(cid:128) ord (Oxford:
BIOS Scienti(cid:142) c Publishers Ltd), pp. 127–135.

Lark, R. M., Catt, J. A., and Stafford, J. V., 1998, Towards the explanation of within-(cid:142) eld
variability of yield of winter barley: soil series di(cid:128) erences. Journal of Agricultural
Science, Cambridge, 131, 409–416.

Lazar, P., 1981, Geographical correlations between disease and environmental factors. In
Perspectives in Medical Statistics: Proceedings of the Rome Symposium on Medical
Statistics, 1980 (London: Academic Press), pp. 21–38.

Lesch, S. M., Strauss, D. J., and Rhoades, J. D., 1995, Spatial prediction of soil-salinity using
electromagnetic induction techniques. I. Statistical prediction models - a comparison
of multiple linear regression and cokriging. Water Resources Research, 31, 373–386.

McBratney, A. B., and Webster, R. 1986, Choosing functions for semi-variograms of soil
properties and (cid:142) tting them to sampling estimates. Journal of Soil Science, 37, 617–639.
Numerical Algorithms Group, 1988, T he NAG Fortran L ibrary Manual—Mark 13 (Oxford:

NAG Ltd).

Payne, R. W., and Arnold, G. M., (editors), 1995, Genstatâ

5 Procedure L ibrary Manual

Release 3[3] (Harpenden: Rothamsted Experimental Station).

Rasmussen, M. S., 1998, Developing simple, operational, consistent NDVI-vegetation models
by applying environmental and climatic information: Part I. Assessment of net primary
production. International Journal of Remote Sensing, 19, 97–117.

Suddath, K. A., Hummel, J. W., and Cahn, M. D., 1991, Soil organic matter sensing: a
developing science. In Automated Agriculture for the 21st Century, Proceedings of the
1991 Symposium (Michigan: American Society of Agricultural Engineers), pp. 307–316.
Trotter, C. M., Dymond, J. R., and Goulding, C. J., 1997, Estimation of timber volume in
a coniferous plantation forest using Landsat TM. International Journal of Remote
Sensing, 18, 2209–2223.

Walker, N. D., 1996, Satellite assessment of Mississippi river plume variability—causes and

predictability. Remote Sensing of Environment, 58, 21–35.

Webster, R., 1997, Regression and functional relations. European Journal of Soil Science,

Webster, R., and Oliver, M. A., 1990, Statistical methods in soil and land resource survey

48, 557–566.

(Oxford: Oxford University Press).

Webster, R., and Oliver, M. A., 1992, Sample adequately to estimate variograms of soil

properties. Journal of Soil Science, 43, 177–192.

Yang, C., Peterson, C. L., Shropshire, G. J., and Otawa, T., 1998, Spatial variability of (cid:142) eld
topography and wheat yield in the Palouse region of the Paci(cid:142) c Northwest.
T ransactions of the ASAE, 41, 17–27.

Downloaded by [University of Leeds] at 04:20 17 May 2015 