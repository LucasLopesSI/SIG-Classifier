REFEREEDPAPERAnAlgorithmforLocalisedContourRemovaloverSteepTerrainWilliamMackanessandMikeStevenInstituteofGeography,SchoolofGeoSciences,DrummondSt,TheUniversityofEdinburgh,Edinburgh,EH98XPEmail:william.mackaness@ed.ac.ukIsolineshaveprovedtobeahighlyeffectivewayofconveyingtheshapeofasurface(mostcommonlyintheformofheightcontourstoconveygeographicallandscape).Selectingtherightcontourintervalisacompromisebetweenshowingsufficientdetailinflatregions,whilstavoidingexcessivecrowdingoflinesinsteepandmorphologicallycomplexareas.Thetraditionalwayofavoidingcoalescenceandconfusionacrosssteepregionshasbeentomanuallyremoveshortsectionsofintermediatecontours,whileretainingindexcontours.Incorporatinghumansinautomatedenvironmentsisnotviable.Thisresearchreportsonthedesign,implementationandevaluationofanautomatedsolutiontothisprobleminvolvingtheautomaticidentificationofcoalescinglines,andremovaloflinesegmentstoensureclarityintheinterpretationofcontourinformation.EvaluationwasmadebysubjectivecomparisonwithOrdnanceSurveyproducts.Theresultswerefoundtobeveryclosetothequalityassociatedwithmanualtechniques.INTRODUCTIONTherepresentationofreliefisfundamentaltotopographicmappingandmanythematicmaptypes.Thechallengeofrepresentingreliefisreﬂectedinthebroadvarietyoftechniquesthathavevariouslybeendeveloped(Imhof,1982)torepresentathree-dimensionallandscapeintwo-dimensions(MonkouseandWilkinson,1971;Collieretal.,2003).Althoughareasofhighreliefmayseemimposingtotheeye,thedistancebetweenlandscapefeaturesissigniﬁcantlylargerthanthelandscapeheight.Reliefrangesfromapproximatelyplusorminus10kmaboveorbelowsealevelwhilethedistancearoundtheequatorisabout40,000km.Thechallengeofrepresentingreliefcartogra-phicallyistomaintaintheemphasisofanimposinglandscapewhilstcreatingamapthatislegibleandgivestheappropriatelevelofdetailforitsintendedpurpose(Lyons,1914).Thepurposeofthemapgovernsdecisionsoneverythingfromthemapscaletotheamountofinformationconveyed–thescaleofthemapverymuchgoverningtheappropriatelevelofdetail.Mappurposeandscalealsogovernthemostappropriatemethodforrepresentingrelief(Imhof,1982).Amixofqualitativeandquantitativetechniqueshasvariouslybeenproposed.Theyincludehillshading,hypsometricshading,hachuring,pictorialrepresentation,andcontouring(Robinsonetal.,1984).Thefocusofthisresearchisontheoptimalportrayalofcontours.Contoursarethemostappropriatemethodfordisplayingreliefatlargeandmediumscales–thescale,complexityofterrain,screenresolutionorpenwidthdeterminingthemostappropriatecontourinterval(Robinsonetal.,1984).Traditionalapproachestomapproductionhavegivenwaytothecreationofmultipledatabasesfromwhicharangeofcartographicproductscanbederived(LiandOpenshaw,1992;LiandSui,2000;McMasterandShea,1992;ZaksˇekandPodobnikar,2005).Ahugeamountofresearchintheﬁeldofmapgeneralisationreﬂectseffortstocapturetheartandscienceofcartographyandembeditwithinhighlyautomatedenvironments(RiegerandCoulson,1993).Thereareconsiderablebeneﬁtsthatcanarisefromthisparadigmshift(KraakandOrmerling,2003;Joa˜o,1998)andtherehasbeenextensiveresearchintomapgeneralisationtechniques(Jonesetal.,1995;Bundyetal.,1995)aswellasdevelopmentofconceptualmodelsandframeworksinwhichtheentireprocesscantakeplace(BrasselandWeibel,1988).SpeciﬁcresearchrelevanttotheworkpresentedhereincludesworkbyLiandSui(2000);Saux,(2003);GoldandThibault(2001)allofwhomhaveworkedonmethodsforlinegeneralisationandrepresentationofheightinformation.Theinherentvaluethatliesinvariousapproachestorepresentingsurfacemorphologyisreﬂectedintheeffortstoprovideautomatedsolutionstowhatweretraditionallyhandbasedtechniques.Automatichachuring(Regnauldetal.,2002)andhillshading(Brassel,1974;Zhou,1992;Yoeli,1967)beingjusttwoexamples.Attemptstoformalisethesetechniqueshavehighlightedthesubtletiesandcomplexitiesoftheirapplication,andthechallengesofevaluatingsolutionsthathavereﬂectedatraditionalaesthetic.TheCartographicJournalVol.43No.2pp.144–156July2006#TheBritishCartographicSociety2006DOI:10.1179/000870406X114630Thispaperisconcernedwiththeautomatedcartographicportrayalofcontourinformation,withaspeciﬁcfocusontherepresentationoflineworkoversteepterrain.Asmapsat1:50,000scaleareprimarilyusedforlocationandorientation(MonkhouseandWilkinson,1971),reliefshouldbeportrayedinsuchawaythattheoveralllandscapeshapeisimmediatelyapparentandassessmentofmorphol-ogyandheightcanbeascertained.ThestandardmethodusedbytheOSwhendisplayingreliefat1:50,000scaleistouseamixofintermediateandindexcontoursat10mintervals–theindexcontour(every50m)representedbyaheavierlineweight.Oversteepterrain,andsmallcontourintervals,contourlinescanbecomesoclosethattheyvisually‘fuse’togetherthusmakinginterpretationofformandshapeconfusing.Traditionallysectionsofthecontourswereremovedinthescribingprocesssothatthecontinuityofotheradjacentcontourscouldbediscerned.Insomeinstancesadditionalpictorialrepresentations(rocksymbol-ogy)aresuperimposedtoreinforcethenotionofsteepground(Figure1).Thecontinuityofadjacentlineshelpstheeyeto‘joinup’suchbrokenlines.Thisideaisbasedontheprincipleofgoodcontinuation:‘thatelementsthatappeartofollowinthesamedirection…tendtobegroupedtogether’(CorenandWard,1989).Thusaseriesofsmoothlyconnectedelementswillnaturallybeperceivedasasinglegraphicalobject.Todate,noneoftheresearchinmapgeneralisationhasaddressedtheproblemoflinesegmentremovaltopreventthisvisual‘fusing’ofisolines.Inessence,thisresearchattemptstoautomateamanualtechnique–namelytheremovalofsmallsegmentsofcontourlinesinordertoimprovethelegibilityofheightinformation.Thestructureofthispaperisasfollows:webeginwithadescriptionofthemethodology,brieﬂydescribetheimplementation,andpresentarangeofoutputswhichareFigure1.Handdrawnsolutions:OS1:50,000Scalecolourraster(greycircledregionsshowpartialremovalofisolinesoversteepground).Notethatindexcontours(heavierweight)remainunbroken,evenoversteepground.Eachgridsquarerepresentsonesquarekilometre.#CrownCopyright/databaseright2006.AnOrdnanceSurvey/EDINAsuppliedserviceAlgorithmforLocalisedContourRemovaloverSteepTerrain145thencomparedwithexistingmapproducts(themselvesderivedfromhanddrawnmaps).Weconcludewithsuggestionsforfurtherwork.METHODOLOGYTheaimwastoderivefromverydetaileddigitalelevationdata,ageneralisedsetofcontourssuitablefordisplayat1:50,000scale.Theprocesswasmadeupofthreedistinctphases(Figure2).Theﬁrstphasewastocreateamoregeneralisedsmoothersurfaceofthedigitalelevationmodel(DEM),andtousethisasabasisforautomaticallycreatingasetofcontours(thisistermedmodelgeneralisation).Thesecondphasewastoimprovetheclarityandlegibilitywithwhichthecontourswereportrayedoversteepground(thisistermedcartographicgeneralisation).Modelgeneral-isationisstraightforwardinthiscase;itisthecartographicgeneralisationprocessthatisthespeciﬁcfocusofthispaper.Thethirdphasewastoassessthequalityoftheoutput.Thiswasdonebyapplyingthealgorithmtotwodifferentmountainousregions.Theﬁrststudyareachosenwasa20kmby25kmareaintheCairngorms,Scotland.TheCairngormsarecharacterisedbysteepslopes,‘u-shaped’valleysandhigh,roundedmountainssoprovidingavarietyofdifferentplaceswherecontoursneedtoberemovedtopreventfusingofthelines.Throughempiricalobservation,thealgorithmwastunedandthenapplied(usingthesameparameters)toadifferentregiontoassesstherobustnessofthesolution.Thesecondstudyareawas20kmby20kmjustnorthofGlenAffricintheWestandEastBenulaForestarea.Thisregionhasadifferentgeologicalandgeomor-phologicalhistorytotheCairngorms,andalandscapemoremodiﬁedbyﬂuvialprocesses(Summerﬁeld1991).ModelGeneralisationoftheSurfaceModelgeneralisationwasperformedusingascriptwritteninESRI’smacrolanguage,AML,developedbyRana(2004).ThemacroutilisedtheTOPOGRIDArcInfofunction[url1],itselfbasedontheANUDEMalgorithm[url2]developedbyHutchinson(1989).TOPOGRIDworksbyﬁttingadiscretisedthinplatesplinesurfacethroughcontourdata.TOPOGRIDisabletopreservemorphologyacrossarangeofgridcellsizesbyincorporat-inglocalterrainfeatures(channelsandridges).Rana(2003)combinedTOPOGRIDwithaniterativesmoothingoperationtoensureoptimalfeatureclassiﬁcation.ThemethodwasintentionallydesignedtohandleOSLand-FormPROFILETMdatasetswiththeintentionofprodu-cingmultiscaleandmorphologicallyconsistentterraingeneralization.BothLand-FormcontourlineshapeﬁlesandLand-FormspotandairheightpointshapeﬁleswereusedasinputstotheprocesswhichreturnedageneralisedDEMconstrainedtoridgesandvalleysusedtoensureconsistencywithlandscapetopography(Steven,2005).FromthisDEM,contourswerederived(seelatersection).Theoriginalcontoursat1:10,000scale(Figure3a)canbeseentoincludemuchmoredetailthanthegeneralisedcontoursintendedforvisualisationat1:50,000scale(Figure3b).CalculatingtheoptimalcontourintervalsTheveryfactthatcontoursapparentlyfuse(Figure3b)arisesbecausethecontourintervalistoosmallgiventhesteepnessoftheregionbeingportrayed.Theselectionofthe‘right’contourintervaliscriticallyimportant.Generally,contoursworkwellatportrayingmountainousareasbutwherethereisagreatercontrastinrelieftheyarelesseffective(MonkhouseandWilkinson,1971).Steepareasrequirecontourintervalstobelargeenoughsothatcontoursdonotbecometoodensesuchthattheyobscureothermapcontent.Conversely,wherereliefismuchﬂatter,lessslopedetailcanbeseenastheintervalscanbelargerthansomelandformfeatures.Consequentlythereisatrade-offbetweentheamountofinformationcontainedinamapanditslegibility.Imhof(1982)devisedanequationtocalculatethesmallestcontourinterval,A:A~M:tana1000:kwhereA5thesmallestpossibledifferencebetweencontoursinmetres;M5thescaledenominator(forexample50,000);a5theangleoftheslope;k5themaximumnumberofcontourslegibleper1millimetreofhorizontalinterval.ForthestudyareaoftheCairngorms,substitutingawithamax(amax546.8u)andusingavalueof2fork(theOS1:50,000contourspeciﬁcationsstatethat10-mcontoursare0.1mminwidth,the50-mcontoursare0.3mminwidthandthatthespacebetweencontoursshouldnotbelessthan0.4mm)givesashortestpossiblecontourintervalof26.6m.Theintervalisawkward(evenifrounded)andfailstoconveydetailinﬂatterareas.Asthemapscaledecreases,thelimitationsofonecontourintervalbecomeincreasinglyapparent.Themostcommonmethodofsolvingtheproblemofchoosingcontourintervalsistouseacombinationofindexandintermediatecontours.Intermediatecontourscanshowmoredetailinﬂatterareasandberemovedinsteeperareas(Figure1isanexampleofFigure2.Overallmethodology:thearrowconveyingtheideaofiterativereﬁnementofthemodelandalgorithmthroughevaluationofmapoutput146TheCartographicJournalthis).Theappropriatenumberofintermediatecontoursdependsontheintervaloftheindexcontoursaswellasthereliefbeingportrayed.Imhof(1982)acknowledgesthattheselectionofcontourintervalismostdifﬁcultat1:50,000scale.Toquicklyselectinformationfromamap,contourintervalsshouldbenumbersthatareeasilydivisibleandcalculable.TheOScombinationof50-mindexcontoursand10-mintermediatecontoursallowsﬂatterlandformstobewellrepresentedbutrequirespartialremovalofcontoursegmentsacrosssteeperregionssufﬁcienttomeetOS’srecommendedminimumseparationbetweenlinesof0.4mm.CARTOGRAPHICGENERALISATIONOFTHECONTOURLINESOncetheoutputhadbeengeneratedfromthemodelgeneralisationprocess,itwasnecessarytodeviseamethodfordetectingareaswherecontourlinesfused.Initiallyresearchfocusedoncalculatingathresholddistancebetweencontourlinesasabasisforweedingoutcontours.Thisprovedproblematicprincipallybecauseitwasveryhardtobuildupapictureofwheregroupsofcontourswereclosetooneanother.Itwasobservedthattherewasadirectcorrelationbetweensteepnessandthenumberofcontourslikelytofuse.Thereforeadifferentapproachwasadopted(basedoncalculatinggradientpolygons)thatgaveusamuchmorecompletepictureofthesameinformation,wassimplertoimplement,andfarlesscomputationallyinten-sive.Slopewascalculated(usingthedigitalelevationmodelasinput)andagradientrasterwasgeneratedbeforebeingconvertedtoapolygonshapeﬁle[url1](Steven2005),whichresultedinaclassiﬁedsetofpolygons(‘Gradientpolygons’Figure4),eachpolygonrepresentingaregionofspeciﬁedsteepness(Figure5).Thenextstagewastoseparateoutthe50-mindexcontoursinthevectorﬁle,sincenocartographicgeneral-isationwouldbeappliedtothesecontoursgiventheirimportanceinthemap(Figure1).Thegradientpolygonswereusedto‘cookiecut’thevectors–thuscreatingfourdifferentsetsofisolines,eachreceivingdifferenttreatments(‘Intersect’Figure4).The‘contoursegmentremoval’(CSR)algorithm(describedinmoredetaillater)wasusedtoﬁlteroutvectorlinesaccordingtoasimplerulesetthatwasbasedon1)thesteepnessoftheregion,and2)thenumberofintermediatecontoursfallingwithintheregion(‘CSRAlgorithm’Figure4).Thenextstagewastocreatemasksforeachoftheregions(‘Erase’Figure4).Thissimplestephastheeffectofcreatingasetof‘bands’,eachbandcontaininganincreasingamountofgeneralisationofthevectorsfallingwithineachofthesteepeninggradientFigure3.OSLand-FormPROFILETMcontoursat(a)1:10,000scale(#CrownCopyright/databaseright2006.AnOrdnanceSurvey/EDINAsuppliedservice),and(b)contoursgeneratedbythemodelgeneralisationprocessAlgorithmforLocalisedContourRemovaloverSteepTerrain147Figure4.Summaryofthecartographicgeneralisationprocess148TheCartographicJournalpolygons.Forthosesectionsofcontoursfallingacrossgradientpolygonsof45uorsteeper,theyweresimplyallremoved.Oncethelinede-selectioniscompleted,thevarioussectionsoflinesarereconstitutedbacktogetheragain,togetherwiththeoriginalindexcontourstogivetheﬁnalmap.ThiswholeprocessispictoriallyrepresentedinFigure4.TheContourSegmentRemovalAlgorithmTherearefour10-mintermediatecontoursbetweenthe50-mindexcontours.Thecontoursegmentremovalalgorithm(CSR)wasdesignedsuchthatasthegroundsteepened,anincreasingnumberofintermediatecontourswouldberemoved.Thus,fourthresholdgradientvalueswererequiredwhereateachvalueanotherintermediatecontourwouldneedtoberemoved.Thechallengewasingeneratingasetofgradientpolygons,(eachpolygoncoveringasmallrangeofgradient)forwhichaparticularoperationshouldbecarriedout.Gradientcanbecalculatedinanumberofways,andresultsvarydependingonthesizeofareaoverwhichgradientiscalculated.Inessence,matchingactiontogradientwasdonethroughempiricalobservation.Fromthegradientraster(derivedfromtheDEM)itwasobservedthatcontourscamewithin0.4mmofeachotherforcalculatedgradientvaluesof30uormore.ThiswasascertainedbyvisualinspectionofvariouspartsoftheOS1:50,000mapoftheCairngorms.Thisvisualinspectionprocessinvolvedoverlayingthegradientpoly-gonsandinspectingthechangesthathadbeenmadetothemapineachofthepolygons(Figure5).Viathesamemethodofinspection,theotherthresholdvalueswereascertained.Wherethegradientwasbetween35uand41uitwasobservedthattwo10-mcontourswereremoved.Forgradientsbetween41uand45u,three10-mintermediatecontourswereremovedandallfour10-mintermediatecontourswereremovedatgradientsover45u.TheCSRalgorithmneedonlybeappliedtotheintervalcontoursectionsthatintersectwiththevariousgradientthresholds(Figure6).The50-mindexcontourswereleftunchangedfortherestoftheprocessastheywerenottoberemovedunderanycircumstances(OS1:50,000contourspeciﬁcation).Itwasoftenthecasethatwithinaparticulargradientpolygontherewasachoiceastowhichcontoursshouldberemoved.Figure7showsapolygonofgradientbetween30uand35u.Inthisexample,theindexcontourpresentsfourcaseswheregeneralisationisrequired.Thesecasescontainone,threeandfourcontoursinconﬂict(Figure7).Accordingtothe‘rules’inFigure6,onecontourshouldberemovedineachcase.Thequestionbecomes,‘forcasesofmorethanonecontour,whichcontourshouldberemoved?’.ThechoicewasbasedonOS’sspeciﬁcationsforcontourson1:50,000scalemapswhichstatedthattheyshouldusuallybeomittedintheorderlowest,highest,secondlowest,secondhighest.Onecouldimaginealternatespeciﬁcations.Forexample,theCanadianCentreforFigure5.Mapofpolygonsatgradientsbetween31–35u,35–41uand41–45u;withOS1:50,000scalecolourrasterofthesameloca-tionsuperimposed,#CrownCopyright/databaseright2006.AnOrdnanceSurvey/EDINAsuppliedserviceFigure6.Theﬁvedifferentgradientlevelsandthecontourremovalateachgradientlevel(wheregisthegradientofthepolygon)Figure7.Thegreypolygonrepresentsaregionofgradientg,30u(g,35u.ThenumberofintermediatecontoursfallingbetweenindexcontoursisacomponentofthealgorithmAlgorithmforLocalisedContourRemovaloverSteepTerrain149TopographicInformationguidelinesondroppingcontoursfrom1:50,000scalemapssuggestdroppingﬁrstlyoneorbothofthecentralintermediatecontours,thenoneormoreoftheremainingintermediatecontours,thentheindexcontouronlyifnecessary[url3].Whicheverwaschosen,wecansummarisethatthealgorithmselectscontoursbasedonthegradientatwhichtheconﬂictoccurs,thenumberofcontoursinvolvedandtheheightofthosecontoursrelativetotheindexcontour.Table1presentsthepseudocodesummarisingtheconditionsgoverningcontourremoval.Notethatthealgorithmworksbysuccessiveremovalofcontoursatincreasinggradient.Forexample,forallthepolygonsgreaterthan30u,(notjustpolygonswithgradientbetween30uand35u)acontourisremoved,forallthepolygonsgreaterthan35uafurthercontourisremoved,andsoon.Inthiscumulativemanner,bythetimethepolygonswiththesteepestgradientareprocessed,allfourcontourshavebeenremoved.ForamoredetailedexplanationoftheimplementationseeSteven(2005).RefinementofmethodologyInitialresultsfromthealgorithmproducedcontoursthatappeareddashed(Figure8).Thisarosewhererelativelysmall,irregularpolygons(representingvariousregionsofsteepness)intersectedthecontourlineatfrequentintervals.Toreducethiseffect,thepolygonsweresimpliﬁedinESRIArcMaptogivethepolygonsamoregeneralisedform(Figure9).ThiswasdonebyapplyingastandardlinesimpliﬁcationalgorithmwithinESRIArcMap[url1].Furthermore,fromempiricalobservation,itwasdeterminedthatalimitshouldbesetonthesmallestlengthofcontoursegmentthatshouldbedeleted.Bystudyingandcomparingoutputwiththepilotarea,theminimumlengthwasdeterminedtobe100m.Thesetworeﬁnementssigniﬁcantlyimprovedthequalityoftheoutput.IMPLEMENTATIONANDEVALUATIONESRI’sArcGISsoftwaresuitewasusedtoprocessthedata.ThealgorithmtoremovesectionsofcontourswaswritteninJavaandwasappliedonlytothosesectionsofintermediatecontours(nottheindexcontours)fallingwithinthegradientpolygons(Steven,2005).Aswithmanycartographicgeneralisationtechniques,evaluationoftenconsistsofcomparisonwithexistingmapproducts–reﬂectingtheideathatthehandprintedmapreﬂectssomeoptimaldesign.Becauseofthesubjectivenatureofassessment,evaluationwasintwoparts:presentationofresultsanddiscussionwithcartographersatTheOS,andvisualcomparisonbetweenhanddrawnandautomaticallyderivedmaps.Inthepaper-basedmethod,evaluationconsistedofidentifyingregionsofdifferentsteepnessacrossthemap(30–35u,35–40u,40–45uand.45u)andcomparingoutputfromthealgorithmwiththepapermap.Oncethealgorithmhadbeencalibratedusingthesampledata,itwasthenappliedtoadifferentstudyarea,theGlenAffricareaoftheNorth-WestHighlandstoprovideatestofhowwellthealgorithmcouldbeappliedtoregionsotherthantheCairngorms.TheoutputwasalsosubmittedtocartographersattheOSforevaluation.Gradientsof30–35uAtgradientsgreaterthan30u,onlyoneofthefour10-mintermediatecontourswasremoved.Theidentiﬁcationofcontourconﬂictatgradientsover30ucoincidedinmanycaseswithwherecartographer’smanualgeneralisationhadTable1.Pseudocodedescribingtherulebasedapproachgovern-ingconditionsforremovalofcontoursForcontourscrossinggradientswhereg>30u:(onecontourtoberemoved)IFthereisonlyonecontourinconflict,removeit.IFtwocontoursareinconflict:IFoneofthemisthelowestcontourbesideanindexcontour(ithasaheightofx10morx60mwherexisapositiveinteger)THENremovethatcontour.ELSEIFoneofthemisthehighestcontourbesideanindexcontour(i.e.x40morx90m)THENremovethatcontour.ELSEremovethelowestcontour.IFthreecontoursareinconflict:IFonecontouristhe10-mor60-mcontourTHENremovethatcontour.ELSEIFonecontouristhe40-mor90-mcontourTHENremovethatcontour.IFfourcontoursareinconflictTHENremovethe10-m(or60-m)contour.Forcontourscrossinggradientswhereg>35u:(afurthercontourisremoved)IFthereisonlyonecontourinconflictTHENremoveit.IFtwocontoursareinconflict:IFoneofthecontoursisthe40-mor90-mcontourTHENremoveit.ELSEremovethehighestcontour.IFtherearethreecontoursinconflict:THENremovethehighestcontour.Forcontourscrossinggradientswhereg>41u(afurthercontourisremoved)IFthereisonlyonecontourinconflictTHENremoveit.IFtwocontoursareinconflict:THENremovethelowest.Forcontourscrossinggradientswhereg>45utheremainingcontourisremoved.Figure8.Theﬁrstimplementationofthealgorithmsometimesproducedshortcontoursectionsandgapsbetweensections150TheCartographicJournalremovedcontoursections.Usuallythelowestofthefourintermediatecontourswasremovedtoremoveclutteraroundthethickerindexcontours.Whilemostcasesappearedtobedealtwithappropriately,therewereafewcaseswherethesolutionwasnotconsideredidealasthelinehappenedtoconveyimportantmorphologicalinformation(Figure10).Thisisanissuethatisdiscussedlaterinthispaper.Gradientsover35uWherethegradientisover35u,thecartographer’sevaluationstatedtherewas‘effectiveremovaloftwocontours’.Simplescenarioswherethemostappropriatecontourtoremovewasthehighestofthefourintermediatecontourswerehandledwell.Insomeareaswherethepolygonwasquitesmall,therewasatendencytocreateadashedeffect–whereshortsectionsofcontoursegmentswereremoved.Thiswaslessofaproblemforgradientsover41usincetheseareastendedtobequitesmallinextent.Figure11showsoutputdemonstratingtheremovalof1-2-3-and4-intermediatecontours.ItmakesveryfavourablecomparisonwiththeOSproduct.Itisworthnotinghowpictorialcliffsymbologyisusedinsomeareastoreinforcethenotionofsteepness(informationthatcouldonlybederivedfromaerialphotography).Figure9.(a)Polygonsofgradientsover30u,over35u,over41uandover45u(eachpolygonislaidontopoftheothers);(b)polygonsaftersimpliﬁcationFigure10.(a)Gradientpolygons,andb)removalofcontoursegmentsthatcarriedimportantinformationonthemorphologyAlgorithmforLocalisedContourRemovaloverSteepTerrain151Wherethegradientwasgreaterthan45u,allofthe10-mintermediatecontourswereremoved.AgaintheseareaswerefoundtomatchwithcorrespondingareasfromtheOS1:50,000map(Figure12).Asthepolygonsforgradientsover45uaregenerallysmall,thisleavessmallgapsincontoursatthesegradients.ComparisonwiththeOS1:50,000scalemapshowsthatwhereallfourintermediatecontoursaredropped,thegapsaresmalltoo.DisplacementofcontoursWhilsttherewassomevariancewithingradientbands,anoverallcountwasmade,andanassessmentwasmadeastowhetherpairsofsolutions(handdrawnorcomputergenerated)werethe‘same’or‘notthesame’.About80%weredeemedtobe‘thesame’–thatthechoiceofcontourandlengthofsegmentremovedwerethesame.However,tosaythataparticularsolution(eitherautomatedorbyFigure11.Thecircledregioncontainsexamplesofwheregroupsof1-,2-,3-and4-intermediatecontourshavebeenremoved,andthesameareaforthe1:50,000ScaleColourRaster,#CrownCopyright/databaseright2006.AnOrdnanceSurvey/EDINAsuppliedserviceFigure12.(a)Thecorrespondingresultsfromtheautomatedsolution;(b)OS1:50,000instancesofallintermediatecontoursdropped.#CrownCopyright/databaseright2006.AnOrdnanceSurvey/EDINAsuppliedservice152TheCartographicJournalhand)wasrightorwrongishighlyproblematic!Insomecases,thealgorithmhighlightedcaseswhererulesgovern-inghanddrawnsolutionwerenotconsistentlyapplied.Insomecasesthecartographerappearedtohaveslightlydisplacedthelinestoavoidhavingtobreakthem(Figure13a).IndiscussionwithcartographersatOS,itwasfeltthatinsomeinstancesdisplacementwaspreferredtolineremoval.Manydisplacementalgorithmshavebeendeveloped(MackanessandPurves2001;BurghardtandMeier1997),andintheoryitwouldbepossibletomodifytherulessuchthatdisplacementcouldbeanalternativesolutiontosegmentremoval(applicabletoFigure10perhaps).Butincaseswherethecontoursaredisplaced,wehaveunwittinglyshownthelandasbeingﬂatterthanitreallyis.Thisisquitedifferentfromtheremovalofinformation.Insuchcases,isitnotbettertoomitthisinformationandlettheadjoiningcontourscarrythemessage–namelythatthegroundissteep?(Figure13b).Thesedifferencescanbeverysubtle.Bythetimeadditionalinformationhasbeensuperimposedonthemap–suchasrockandscreesymbols,text,reliefshading,spotheights–itisdoubtfulthatanydifferenceintheinterpretativeprocesscanbemeasured.Thealgorithmwasiterativelyimproved,usingtheCairngormsstudyarea.Itwasthenappliedtoadifferentregiontoassessitsrobustness.TheNorthofGlenAffricwaschosenbecauseofitsdifferingmorphology.Acomparisonwiththepapermaprevealedaverysimilarsuccessrate(exampleoutputisshowninFigure14)–againhighlightingcaseswhereslightdisplacementmightbepreferred,andwhereshortsegmentsclosetooneanotherproducedadashedlineeffect.DISCUSSIONTherequirementforremovalofsegmentsofcontoursariseswhereverthereissharpvariationinmorphology.AsImhof(1982)argues,thereisnotasingleidealcontourintervalthatwouldworkforeverylandscapetype.TheOS’schoiceofintervalissuchthatsegmentremovalisintegraltothesuccessfulportrayalofcontourinformationinsteepregions.Thechoiceofintervalisinanticipationoftheapplicationofthistechnique.Whilsthandbasedsolutionshaveworkedinthepast,currenttechnologicalparadigmscallforautomatedequivalentstotheartandscienceofcartography.Thealgorithmpresentedherewasiterativelyreﬁnedandappliedtodifferentlandscapes.Thealgorithmwasbasedonmapspeciﬁcationdocumentsthatdetailtheoptimalorderofremovalofintervalcontours.Theideaofusinggradienttodetermineregionsinneedofcartographicgeneralisationwasefﬁcientandeffectiveinpredictingthedegreeofconﬂictandtheconsequentamountofremedialeffortrequired.Acrossarangeofgradients,thealgorithmperformedwell,bothfromlayinspectionoftheoutputandfromcommentsfromexpertcartographers.Onesituationwheretherewasambivalenceinthecartographer’sevaluationwasinthecasewhereallfourintermediatecontourswereremoved.Insomesituations,theremovalseemedappropriatewhileinothersthisgeneratedsomedashedcontours.Thecontrastingopinionsrevolvedaroundthefactthatwhileshortcontoursectionsandshortgapsshouldbeavoided,insomesituationsthiscouldnotbeavoided.Insomeinstances,adashedlineeffectarosewheresmallgradientpolygonsintersectedthesamecontourline.Thiswasremediedbygeneralisingthegradientpolygons,andsettingaminimumlengthforremoval.Inotherinstances,itwasfeltthatacasecouldbemadefordisplacingadjacentcontoursratherthanremovingsegments.Butintheseandallotherinstances,itisimportanttoreﬂectontheoveralleffect–ratherthanfocussingtoomuchonindividualcases.Itshouldbenotedthatthetaskofconveyingmorphologyisverymuch‘shared’amongthecontours.Wherecontoursegmentsarerequiredtoberemoved,therewillalwaysbeanothercontourveryclosebythatisconveyingverysimilarinformation.Inthissensetheshapeandsteepnesscanbesaidtobeconveyedvicariously.Itispreciselythisfactthatenablesustoremovesectionsofcontourswithoutoverlydisturbingtheunderlyinginformation.Figure13.Whichisbetter?(a)ApparentdisplacementofcontoursintheOS1:50,000ScaleColourRaster,OS#CrownCopyright.Allrightsreserved;(b)algorithmicsolution(circled)AlgorithmforLocalisedContourRemovaloverSteepTerrain153Topographicmapscontainanoptimal‘volume’ofinformationandthemapreﬂectsacompromiseatanumberoflevels–thatsuperimposedontheheightinformationisothercontentthatactstoclarifyandreinforceideasaboutthesteepnessandrichmorphologyofthelandscape.Itisthereforearguedthatanalysisofthesolutionneedstobeseenfromaholisticperspective–alongsideassociatedtext,pictorialinformation(rockandscreesymbology),spotheightsandcontourlabelling.Thesynergyandreinforcementbetweentheseothervariablescannotbeignored.Perhapsthereisadangerthatwecritiquetoopreciselytheoutputofthealgorithmandfailtotakeintoaccounttheoverallﬁnalsolutionthatwouldofcourseincludethisotherinformation.Inexaminingvariousoutputitwasnotedthatsomecontoursaremoreimportantthanothersbyvirtueofthefactthattheyreﬂectaparticularshapefeatureinthelandscape.Perhapsthealgorithmcouldbemodiﬁedtoincorporatetheirrelativeimportanceinreachingdecisionsaboutwhichcontourtoremove.Acontourmaydelineatesomesortofmorphologicalanomalyandwemightthereforeattachsomeextraimportancetoit,suchthatitwasnotremoved.Forexample,itcouldbearguedthatindividualcontoursrunningparalleltoeachotheralongthevalleysidehavelessimportancethancontoursthatcrossthevalleyﬂoor,orconveyaridge(Figure10)or‘nickpoint’inthestreambed.Muchworkhasbeendonetotryandsegmentlinesaccordingtotheirvariouscharacteristicforms(Plazanetetal.1995),includingtheuseoffractals(Dutton,1981).Inthecontextofrelief,thishasprovedtobeverycomplex,somethingthatisbothscale(Wood,1996)andtaskdependent.Theideaofrelativeimportanceishighlyproblematic.Withrespecttotheexamplejustgiven,perhapstheparallellinesalongthevalleysiderepresentlateralmorainesorindicateprevioussealevels–thusmakingthemjustasimportantasanyothersectionofcontour.Thus,itisnotatallclearwhether1)itwouldbepossibletoidentifytherelativeimportanceofdifferentsegmentsofthesamecontour,or2)howthesigniﬁcanceofthatimportancewouldbemodelledinthecontextofthisresearch.CONCLUSIONThisresearchhasdemonstratedthatacombinationofmodelandcartographicgeneralizationtechniquescanbeusedtoderiveandvisualizesurfacemorphologyatarangeoflevelsofdetail,appropriateforprintingordigitaldisplay.MorespeciﬁcallythisworkhasdemonstratedthattheremovalofcontoursegmentstoimprovetheclaritywithwhichcontourinformationcanbepresentedcanindeedbeFigure14.AcomparisonintheGlenAffricarea:(a)highlightedcirclesshowregionsthathaveparticularlygoodagreementwiththeOSsolution,(b)#CrownCopyright/databaseright2006.AnOrdnanceSurvey/EDINAsuppliedservice154TheCartographicJournalformalisedandautomated.Thealgorithmcanbereadilyadaptedandtherulesetreﬁned,forexampletohandledifferentmapspeciﬁcations(suchastheCanadianspeciﬁcation),differentcontourintervalsandgradientranges,orwheredisplaydeviceresolutiondoesnotsupporttheﬁdelityinthelineweight(requiringaheavierlineandthereforegreaterremovalofsegmentstoavoid‘fusing’ofcontourlines).Whiletheneedforautomatedgeneralisationsolutionsisclear,thereisstillconsiderabledebateastothelevelofautomationachievableordesirable.Whilewemightcommentonthesubjectivityofamanualapproach,thereisnodoubtingthecriticalroleitplaysinclarifyingcontourinformationoversteepregions.Anequivalentautomatedsolutionprovidesarobust,qualitycontrolledandsystem-aticallyappliedsolution,that‘ﬁts’withincurrenttechno-logicalsolutions.Thecurrentdriveisfordevelopmentofsingledetaileddatabasesfromwhichmultiscaleproductscanbederived.Itisnowpossibletocreateﬁnescalesurfacerepresentationautomaticallyusinganumberofremotesensingtechnologies,mostnotablybyLightDetectionandRanging(LIDAR)whichisanairbornemappingtechniquewhichusesalasertomeasurethedistancebetweentheaircraftandthegroundresultingintheproductionofcost-effectiveterraindata.Thefullpotentialofutilisingthistypeofinformation,presentedatvaryinglevelsofdetail,canonlybeexploitediffunctionsforautomatedgeneralisationsuchastheonepresentedherearemadeavailableasstandardwithinGIS.REFERENCESWeblinksurl1:http://support.esri.com/url2:http://cres.anu.edu.au/outputs/anudem.phpurl3:CanadianCentreforTopographicInformationwebsite:http://maps.nrcan.gc.ca/cartospecs/ChapRelief/ChapReliefEF50/ReliefSpecialNoteContouring010704E50.htmACKNOWLEDGEMENTTheauthorsareverygratefulforcommentsfromtheanonymousreviewers,tothecartographersofTheOrdnanceSurveyfortheirreviewofoutputandforthesupplyofOSdatafromDigimap,anOrdnanceSurvey/EDINAsuppliedservice.BIBLIOGRAPHYBrassel,K.(1974).‘AModelforAutomaticHill-Shading’,TheAmericanCartographer,1,15–27.Brassel,K.E.andWeibel,R.(1988).‘Areviewandconceptualframeworkofautomatedmapgeneralisation’InternationalJournalofGeographicalInformationSystems,2,229–244.Bundy,G.L.,Jones,C.andFurse,E.(1995).‘Holisticgeneralizationoflarge-scalecartographicdata’,inGISandGeneralization:methodologyandpractice,ed.byMuller,J.C.,Lagrange,J.P.andWeibel,R.,pp106–119,TaylorandFrancis,London.Burghardt,D.andMeier,S.(1997)‘CartographicdisplacementusingtheSnakesConcept.’inSemanticModellingfortheAcquistionofTopographicInformationfromImagesandMaps.ed.byFoerstner,W.andPluemer,L.pp59–71.BirkhaeuserVerlag.Collier,P.,Forrest,D.,andPearson,A.,(2003).‘Therepresentationoftopographicinformationonmaps:thedepictionofrelief’,TheCartographicJournal,40,17–26.Coren,S.andWard,L.M.(1989).SensationandPerception,OrlandoFL:HarcourtBraceJovanovich.DuttonG.H.(1981).‘Fractalenhancementofcartographiclinedetail’,AmericanCartographer,8,23–40Gold,C.andThibault,D.(2001).‘Mapgeneralizationbyskeletonretraction’.Proceedingsofthe20thInternationalCartographicConference.InternationalCartographicAssociation,pp2072–2081.Hutchinson,M.F.(1989).‘Anewprocedureforgriddingelevationandstreamlinedatawithautomaticremovalofspuriouspits’,JournalofHydrology106,211–232.Imhof,E.(1982).CartographicReliefPresentation.WalterdeGruyter,NewYorkandBerlin.Joa˜o,E.M.(1998).CausesandConsequencesofMapGeneralisation,TaylorandFrancis,London.Jones,C.B.,Bundy,G.L.andWare,J.M.(1995).‘Mapgeneral-izationwithatriangulateddatastructure’,CartographyandGeographicInformationSystems,22,317–331.Kraak,M.-J.andOrmeling,F.(2003).Cartography:visualizationofspatialdata,Longman,London.Li,Z.andOpenshaw,S.(1992).‘Algorithmsforautomatedlinegeneralizationbasedonanaturalprincipleofobjectivegeneral-ization’,InternationalJournalofGeographicInformationSystems,6,373–389.Li,Z.andSui,H.(2000).‘Anintegratedtechniqueforautomatedgeneralizationofcontourmaps’,TheCartographicJournal,37,29–37.Lyons,H.G.(1914).‘Reliefincartography’,TheGeographicalJournal,63,233–248.MackanessW.A.andPurves,R.(2001)‘Automateddisplacementforlargenumbersofdiscretemapobjects.’Algorithmica30,302–311.McMaster,R.B.andShea,K.S.(1992).GeneralizationinDigitalCartography,AssociationofAmericanGeographers,WashingtonDC.Monkhouse,F.J.andWilkinson,H.R.(1971).MapsandDiagrams:theircompilationandconstruction,MethuenandCo.Ltd,London.PlazanetC,AffholderJ-G,FritschE(1995).‘Theimportanceofgeometricmodelinginlinearfeaturegeneralization’,CartographyandGeographicInformationSystems22,291–305Rana,S.,(2003).‘Multi-scaleandmorphologicallyconsistentterraingeneralisation’,InternalreportOrdnanceSurvey.Rana,S.,(2004).SurfaceNetworks:Newtechniquesfortheirautomatedextraction,generalisationandapplication,UnpublishedPhDThesis,DepartmentofGeomaticEngineering,UniversityCollegeLondon,UK.Regnauld,N.,Mackaness,W.A.,andHart,G.(2002).‘AutomatedReliefRepresentationofArchaeologicalMonumentsandOtherAnthropogenicForms’,Computers,EnvironmentandUrbanSystems26,219–239Rieger,M.andCoulson,M.(1993).‘Consensusorconfusion:cartographers’knowledgeofgeneralization’,Cartographica,30,p69–80.Robinson,A.H.,Sale,R.D.andMorrison,J.L.(1984).ElementsofCartography,JohnWileyandSon,Chichester.Saux,E.(2003).‘B-splinefunctionsandwaveletsforcartographiclinegeneralisation’,CartographyandGeographicInformationSystems,30,33–50.Steven,M.(2005).‘GeneralisingOrdnanceSurveyheightdatatocartographiccontoursat1:50000scale:thedepictionofsteepterrain’.UnpublishedMastersThesis,InstituteofGeography.Edinburgh,UniversityofEdinburgh.Summerfield,M.A.(1991)Globalgeomorphology:anintroductiontothestudyoflandforms.Harlow:LongmanScientificandTechnical.AlgorithmforLocalisedContourRemovaloverSteepTerrain155Wood,J.(1996).‘Scale-basedcharacterisationofdigitalelevationmodels’,In:ParkerD(ed)InnovationsinGIS3.pp163–176,TaylorandFrancis,London.Yoeli,P.(1967).‘Themechanisationofanalyticalhillshading’,CartographicJournal,4,253–259.Zaksˇek,K.andPodobnikar,T.(2005).‘AneffectiveDEMgeneralizationwithbasicGISoperations.8thICAWorkshoponGeneralisationandMultipleRepresentation.ACorun´a,Spain(www.ica.ign.fr).Zhou,Q.(1992).‘Reliefshadingusingdigitalelevationmodels’,ComputersandGeosciences18,1035–1045.156TheCartographicJournal