bs_bs_banner

Research Article

Transactions in GIS, 2016, 00(00): 00–00

A Genetic Algorithm for Tributary Selection with
Consideration of Multiple Factors

Ling Zhang(cid:2),† and Eric Guilbert‡
(cid:2)Key Laboratory of Virtual Geographic Environment, Ministry of Education, Nanjing Normal
University
†Jiangsu Center for Collaborative Innovation in Geographical Information Resource
Development and Application, Nanjing
‡Dept. of Geomatic Sciences, Laval University, Quebec

Abstract
Drainage systems are important components in cartography and Geographic Information Systems (GIS),
and achieve different drainage patterns based on the form and texture of their network of stream channels
and tributaries due to local topography and subsurface geology. The drainage pattern can reﬂect the geo-
graphical characteristics of a river network to a certain extent. To preserve the drainage pattern during the
generalization process, this article proposes a solution to deal with many factors, such as the tributary
length and the order in river tributary selection. This leads to a multi-objective optimization problem
solved with a Genetic Algorithm. In the multi-objective model, different weights are used to aggregate all
objective functions into a ﬁtness function. The method is applied on a case study to evaluate the impor-
tance of each factor for different types of drainage and results are compared with a manually generalized
network. The result can be controlled by assigning different weights to the factors. From this work, differ-
ent weight settings according to drainage patterns are proposed for the river network generalization.

1 Introduction

In both Geographic Information Systems (GIS) and terrain analysis, drainage systems are impor-
tant components. Due to the local topography and subsurface geology, a drainage system achieves
a particular drainage pattern based on the form and texture of its network of stream channels and
tributaries. The drainage pattern is “the arrangement in which a stream erodes the channels of its
network of tributaries” (Chernicoff and Whitney 2006). It can reﬂect the geographical characteris-
tics of a river network to a certain extent because it depends on the topography and geology of the
land. Whether in cartography or GIS, hydrography is one of the most important feature classes to
be generalized to produce representations at various levels of detail. In general, there are two typi-
cal operations in river network generalization: tributary selection and scale-driven generalization
(Li 2007). There are many methods for tributary selection, but few of them consider the drainage
pattern in the ﬁrst place. Tributaries are selected based on the stream order and on local parame-
ters such as their length or catchment area. Drainage pattern and other global factors measured
on the network have not previously been considered in the process.

Recently, many researchers have paid more attention to geospatial patterns in cartographic
generalization (Heinzle et al. 2006, Mackaness and Edwards 2002, Zhang 2012). Drainage

Address for correspondence: Ling Zhang, School of Geography Science, Nanjing Normal Univ., No. 1 Wenyuan Road, Qixia District,
Nanjing 210023, P. R. China. E-mail: lingzhang.sky@gmail.com
Acknowledgements: This research was supported by the National Natural Science Foundation of China (41171350, 41501496), and
Jiangsu Planned Projects for Postdoctoral Research Funds (1402061B).

VC 2016 John Wiley & Sons Ltd

doi: 10.1111/tgis.12205

2

L Zhang and E Guilbert

classiﬁcation based on their patterns was introduced by Zhang and Guilbert (2013). This arti-
cle proposes a river network generalization method with consideration of different factors
according to the drainage pattern. For that purpose, a Genetic Algorithm (GA) is designed and
implemented for tributary selection. The method is applied to networks following different pat-
terns and the importance of each factor is evaluated in each case so as to provide a proper
weight setting for each drainage pattern in river tributary selection.

The remainder of the article is organized as follows. Section 2 reviews related work about
tributary selection. In Section 3, a tributary selection model is presented with consideration of
different factors, and the objective function is provided. Section 4 introduces basic concepts of
GA and explains how they are applied to tributary selection. In Section 5, the selection method
is applied for each type of pattern, and results showing the importance of different factors are
analyzed. Section 6 offers conclusions and describes limitations and future work.

2 Related Work

Tributary selection consists, in river network generalization, in keeping or removing river seg-
ments according to their importance and the scale of the map. Rusak Mazur and Castner (1990)
gave four possible options for the selective elimination of river tributaries based on the number of
tributaries to be kept. Richardson (1993) presents a method to select rivers based on the Horton
order (Horton 1945) and the river length. Thomson and Brooks (2000) apply the Gestalt recogni-
tion principles to river network generalization to emphasize the main channels and omit less
important channels. A main stream is detected based on strokes using their Horton order and their
length; but determining the main stream using the longest path on a clipped river network leads to
errors. Touya (2007) presents a method that relies on the organization of river strokes in a hierar-
chy. His work allows the building of strokes on a clipped area where some sources are not natural,
such as irrigation zones. However, it focuses only on the geometric factors of river networks and
does not simplify the river network with consideration of geomorphologic structures.

As the structure and shape of a river is constrained by the underlying terrain, several
authors developed generalization supported structures integrating terrain information to add
knowledge in the selection process. Wolf (1988) builds a weighted network data structure to
determine the signiﬁcance of a river. Different from Horton’s work, the weight of surface net-
works takes pits, passes and peaks together with the connecting ridges and courses into consid-
eration. Wu (1997) investigates the characteristics of the river tree and develops a method
based on spatial buffer analysis to establish the river tree structure. Ai et al. (2006) present a
selection method where the importance of a channel is not deﬁned by the geometric characteris-
tics of the river stream but by the area of its watershed. Density and upstream drainage area are
also used to prune the river network (Stanislawski 2008, 2009). In the case of man-made
ditches, Sandro et al. (2011) present a typiﬁcation method for generalization of groups of
ditches, which are represented as regular patterns of straight lines. In order to consider different
geographical factors, such as river length, river tributary spacing, catchment area, and river net-
work density, there is a need for a multi-objective optimization (also known as multi-criteria or
multi-attribute optimization) process in river tributary selection. Zhai et al. (2006) built a river
data structure model representing the river system’s spatial knowledge, and selected the river
tributaries automatically based on a genetic multi-objective optimization algorithm. In their
model, indicators such as the river length, the river importance and the distance between prox-
imity rivers1 were taken into account during the selection.

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Genetic Algorithm for Tributary Selection

3

Although these works mentioned above take into account further parameters in river net-
work generalization, they are only applied locally to express knowledge at the river segment
level. The structure of a river network is the result of complex geomorphologic processes that
shaped the terrain and so the pattern exhibited by a network provides knowledge at a more
global level that should be considered and preserved during the generalization process. How-
ever, little research has been done on this aspect. Touya (2007) and Jiang et al. (2009) both
acknowledge the drainage pattern as an important factor in river network generalization, but
no details about how to consider it are given. In order to maintain the main hydrographical
properties, Jiang et al. (2009) presented a simple result of river networks preserving the pat-
terns after a selection operation but they did not go further to explain how these patterns were
preserved. In different drainage patterns, different factors should be considered during the river
network generalization. Sen et al. (2014) proposed a method using self-organizing maps
(SOMs) for the selection of hydrographic model generalization. Geometric attributes, such as
length and sinuosity, and topologic attributes, such as degree, betweenness and closeness, are
used as input variables to the SOM. The method is tested on a dendritic and modiﬁed basic pat-
tern composed mostly of trellis (grid-like structures) and in part rectangular networks, but the
drainage pattern is not taken into account.

We can see that much work has been done on river network generalization relating to trib-
utary selection. However, most of them focus on geometric properties only, and do not con-
sider the pattern in the ﬁrst place. Considering that the drainage pattern is an important piece
of information to preserve in river network generalization, a speciﬁc method adapted to the
drainage may be designed. As the pattern can be characterized by factors such as the tributary
balance and spacing (details are in Section 3.1), this article presents a multi-objective tributary
selection method where the importance of each factor depends on the drainage pattern. The
method is based on a genetic algorithm in order to optimize the selection.

3 Tributary Selection Modeling

This section presents a list of factors considered in the description of each drainage. Each factor
is characterized by a value assigned by an objective function. These functions are later com-
bined into a multi-objective function.

3.1 Geometric Factors and Objective Functions

3.1.1 Drainage pattern membership

Drainage patterns are classiﬁed on the basis of their form and texture according to the terrain
slope and structure. Their shape or pattern develops in response to the local topography and
subsurface geology. There are several drainage patterns, such as dendritic, parallel, and trellis.
Dendritic pattern is the most common form of river system. In a dendritic river system, there
are many contributing streams (analogous to the twigs of a tree), which join together and are
the tributaries of a main river (Lambert 2007). Parallel patterns form where there is a pro-
nounced slope to the surface. Tributary streams tend to stretch out in a parallel-like fashion fol-
lowing the slope of the surface (Ritter 2006). In a trellis pattern, as the river ﬂows along a
strike valley, smaller tributaries feed into it from the steep slopes on the sides of mountains.
These tributaries enter the main river at approximately 908 angles, causing a trellis-like appear-
ance of the river system (Ritter 2006).

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

4

L Zhang and E Guilbert

Table 1 Drainage pattern characteristics. There are three patterns addressed in this research. The
geometric and topologic characteristics are summarized from their deﬁnitions in Ritter’s (2006)
book

Drainage patterns

Schematic Diagrams

Geometric and Topologic Characteristics

Dendritic

-Tributaries joining at acute angles

Parallel

Trellis

- Parallel-like
- Elongated catchments
- Long straight tributaries
- Tributaries joining at small acute angles

- Short straight tributaries
- Tributaries joining at almost right angles

In this research, these three drainage patterns are considered and tested. A list of character-

istics for each of them is proposed and shown in Table 1.

Attributing a pattern to a network is a subjective operation as it is based on a combination of
qualitative characteristics. Zhang and Guilbert (2013) proposed a fuzzy logic approach in which a
membership degree for each pattern is assigned to a network. The higher it is, the more characteris-
tic the pattern is. In order to consider the drainage pattern in tributary selection in the ﬁrst place,
the pattern membership can be regarded as an important factor. Before generalization, the pattern
of a river network or a sub-network can be identiﬁed ﬁrst. Then, as an objective function, the mem-
bership degree can be applied to the generalization according to its pattern.

The objective function of the drainage pattern membership can be given as follows:

FM5

8
>><
>>:

min ðzða; 45(cid:3); 90(cid:3)Þ; zðd; 1; 3ÞÞ
min zða; 30(cid:3); 60(cid:3)Þ; 12sðb; 0; 1Þ; sðc; 0; 1Þ; sðd; 1; 3Þ
Þ
min gða; 10(cid:3); 90(cid:3)Þ; 12sðb; 0; 1Þ; zðc; 0; 1Þ; sðd; 1; 3Þ

ð

ð

Þ

dendritic

parallel

;

trellis

(1)

where a; b; c; and d are the average junction angle, the bended tributaries percentage, the aver-
age length ratio and the catchment elongation, respectively, and FM 2 ½0; 1(cid:4). The details of the
drainage pattern membership value are shown in our previous work (Zhang and Guilbert 2013).

3.1.2 Stream order

The stream order is a way to deﬁne the size of perennial and recurring streams based on a hier-
archy of tributaries. There are several ordering schemes. The Horton-Strahler scheme (Strahler
1957) and the Shreve scheme (Shreve 1966) are the most famous ones. In this article, the
Horton-Strahler order after upstream routine, which is the process to determine the main

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Genetic Algorithm for Tributary Selection

5

stream (Li 2007), will be used for tributary selection as it can provide a generalized river net-
work close to a human-made result (Rusak Mazur and Castner 1990).

In river network generalization, the selection operation, in general, starts from tributaries
at lower orders. Tributaries at larger orders have higher opportunity to be shown on the map
after selective omission. So, the objective function of the stream order is designed to evaluate
the stream order of all network elements:

Fo5

Oi; 0 < n (cid:5) N

n
X

i51

where Fo is the total order of selected tributaries and Oi is the order of the selected tributary i.

3.1.3 Stream length

In a digital map, a stream is stored as a set of points, and the length can be calculated approxi-
mately by the additive value of all distances between these points:

where L is the length of a stream composed of n points (xi, yi) (1(cid:5)i(cid:5)n).

The stream length factor implies to a certain extent that a longer tributary is more impor-
tant. In order to select longer tributaries preferentially, the following objective function FL
aims at maximizing the length value of all selected rivers:

n21
X

q

ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðxi112xiÞ21ðyi112yiÞ2

L5

i51

FL5

Li; 0 < n (cid:5) N

n
X

i51

(2)

(3)

(4)

where FL is the total length of selected tributaries, n is the selected number of tributaries, which
should not be larger than the original number of tributaries N and Li is the length of selected
tributary i.

3.1.4 Balance coefﬁcient

In order to avoid tributaries on only one side of a river being eliminated, the tributary balance
between two sides of a river should be maintained. The balance coefﬁcient is the difference between
the total length of streams on the left side of the mainstream and the total length on the right side. It
shows the uneven degree of a drainage system. The larger the value, the more balanced the water
quantities ﬂowing from two sides of the mainstream. The balance coefﬁcient B is calculated as:

B 5

Li=

Lj;

Li (cid:5)

Lj

(5)

1;

Li50 and

Lj50;

8

>>>>>>>>>>><
>>>>>>>>>>>:

m
X

i51

m
X

i51

n
X

n
X

j51

m
X

j51

i51

n
X

j51

m
X

i51

m
X

i51

n
X

j51

n
X

j51

Lj=

Li;

Li >

Lj

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

6

L Zhang and E Guilbert

where m and n are the numbers of tributaries on the left and right side of the mainstream,
respectively; Li is the length of stream i on the left side (1(cid:5)i(cid:5)m); and Lj is the length of stream j
on the right side (1(cid:5)j(cid:5)n).

The calculation of the balance coefﬁcient shows that B 2 0; 1½

(cid:4). B 5 1 corresponds to a
river that receives the same amount of water from both sides. The objective of the balance coef-
ﬁcient is to maintain the balance after generalization. Therefore, the objective function of the
balance coefﬁcient is deﬁned by the Gaussian function as follows:

FB5

gðB0

i; 0:1; BiÞ

m

(cid:3)

m
X

i51

where m is the number of streams with the order > 1 (a stream should have upper streams); Bi
is the balance coefﬁcient of stream i before generalization, B0
i is the balance coefﬁcient of stream
i after generalization; and FB 2 ½0; 1(cid:4). In the Gaussian function, the center is Bi, and the stand-
ard deviation is set to 0.1. So, the closer B0

i to the center, the greater the value of 1.

3.1.5 Tributary spacing

Tributary spacing is the distance between two adjacent tributaries which are on the same side
of a main stream. As adjacent tributaries are not parallel in general, the calculation of the dis-
tance is complicated. For two polygonal curves, the distance can be given by the Frechet dis-
tance (Alt and Godau 1995). Ai et al. (2006) proposed a weighted distance computation
method. Here, the application of the tributary spacing is more relevant to the trellis and parallel
pattern, where the tributaries are more or less parallel. The shortest distance between two trib-
utaries is used for tributary spacing. The advantage of using the shortest distance is that it pre-
vents tributaries from being too close when the scale becomes smaller and so is preferred to
other distances.

If two polygonal curves A and B are at some distance from each other, for any point a of A
and any point b of B, the distance D, which is similarly regarded as the spacing S, between A
and B is deﬁned by:

S (cid:6) DðA; BÞ5 min
a2A

min
b2B

f

dða; bÞ

g

(cid:4)

(cid:5)

where d(a, b) is the distance between a and b.

As to the objective function of the tributary spacing, it is given as:

Fs5min ðSiÞ;

i51; 2; . . . k

where k is the number of spacing of tributaries after selection, and Si is the tributary spacing of
tributary i. This function should be maximized to avoid tributaries clustering together.

3.2 Multi-objective Modeling with Consideration of the Drainage Pattern

For multi-objective problems, the weighted sum method is the most convenient and simplest
approach. It aggregates a number of objective functions into a single one by multiplying each
function by a weight value (Deb 2001). It can be written as (Hajela and Lin 1992):

(6)

(7)

(8)

(9)

FðXÞ5

wiFiðXÞ

k
X

i51

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Genetic Algorithm for Tributary Selection

7

where k is the number of objective functions; wi is the weight of each objective function Fi, and
the weights satisfy the requirement of Pk
i51 wi51. As the magnitude of each objective function
may be different, they shall be rescaled, and the ﬁnal formula is as follows:

(cid:2)FðXÞ5

wiFi

(cid:2)ðXÞ

k
X

i51

(10)

(11)

i are the scaled objective functions. Usually, the normalization method is used for func-

where F(cid:2)
tion scaling, and F(cid:2)

i is given by:

i ðXÞ5ðFiðXÞ2Fmin
F(cid:2)

i

Þ=ðFmax

i 2Fmin

i

Þ

For all objective functions, the multi-objective functions are aggregated for the ﬁtness in

the GA process. It is given as follows:

FðXÞ5wMFMðXÞ1wOF(cid:2)

OðXÞ1wLFL

(cid:2)ðXÞ1wBFBðXÞ1wSF(cid:2)

SðXÞ

(12)

where wM1wO1wL1wB1wS51, wM, wO, wL, wB and wS are weights for drainage pattern
membership,
stream length, balance coefﬁcient and tributary spacing,
respectively.

stream order,

4 Tributary Selection Using a Genetic Algorithm

Optimizing river selection according to different factors at the same time is a multi-objective
optimization problem. A genetic algorithm (GA) is a class of adaptive stochastic optimization
algorithms that simulates the process of natural evolution, and is used to ﬁnd available solu-
tions to optimization and search problems (Mitchell 1996). Van Dijk et al. (2002) showed that
GAs can solve GIS problems, such as map labeling, generalization and line simpliﬁcation. Ware
et al. (2003) applied GA to solving spatial conﬂict between map objects after scaling.

In GA, the solution (called individual) to the problem is represented by a chromosome (or
genome). Usually, a solution is represented by series of ones and zeros, but there are also other
possible encodings (Whitley 1994). An initial set of solutions called population is ﬁrst gener-
ated, and genetic operators such as selection, crossover and mutation are applied to generate
new solutions in order to ﬁnd the best one(s) by evaluating the ﬁtness of every individual in the
population. The process of a basic GA is shown in Figure 1.

4.1 Encoding a River Network

In the proposed method, a chromosome corresponds to a generalized river network. The chro-
mosome is composed by genes and each gene is associated with a tributary in the network. A
gene is set to 1 if the tributary is selected in this network and to 0 if it is not. Following Thom-
son and Brooks (2000), tributaries are deﬁned by strokes in the network and ordered according
to the Horton-Strahler order scheme after upstream routine.

In Figure 2a, a simulated river network is illustrated, where the number is the ID of a
stroke. In Figure 2b, in chromosome 1, all strokes are selected, while all strokes are omitted in
chromosome 2. In chromosome 3, only strokes with IDs 1, 3, 4 and 6 are selected, and others
are omitted. As strokes must remain connected to the network; a stroke cannot be omitted if
strokes at higher order are selected.

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

8

L Zhang and E Guilbert

Figure 1 Basic GA process

The process requires ﬁrst ﬁxing the number of strokes to be selected and is initialized by
generating a population as possible solutions. At each step, a new population is generated
through reproduction and the best chromosomes are selected so as to get a population contain-
ing better solutions.

4.2 Initialization

In the initialization process, the number of selected strokes (noted Ns) can be calculated by the
“Radical Law” (Topfer and Pillewizer 1966) or other methods. As the number of strokes to
select is ﬁxed beforehand and the consistency of the network must be preserved, we deﬁne the
following rules:

1. The number of genes set to 1 in a chromosome is equal to Ns.
2. A gene cannot be assigned 0 if it breaks the topology of a river network, i.e. a stroke

cannot be omitted if its upper strokes are selected.

3. Strokes with the higher order have priority to be selected; otherwise, strokes with lower

order will be omitted ﬁrst.

These rules translate into the following Algorithm 1 which is applied to generate each

chromosome of the initial population.

Algorithm 1 - Initialization of a chromosome

Input: La the list of all strokes; Ns the number of strokes to be selected
Output: Ls the list of selected strokes
Set Lo empty list of strokes
Set Na 5 card(La)//total number of strokes
Set No 5 Na – Ns//number of strokes to be omitted
Set Nc 5 0//number of strokes currently omitted
Set Lt 5 La

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Genetic Algorithm for Tributary Selection

9

While Nc<No

Randomly choose a stroke Rs from Lt
Set Ns’ the number of upper strokes of Rs (including Rs)
If Nc 1 Ns’ > No then//Rs cannot be omitted

Remove Rs from Lt

Else

Nc 5 Nc 1 Ns’
Add Rs and its upper strokes to Lc
Remove Rs and its upper strokes from Lt

End if
End while
Ls 5 La – Lc

Figure 2 Tributary selection by GA: (a) An example of a river network, the numbers are the
stroke IDs; (b) Some examples of chromosomes with binary encoding of a river network; (c) An
example of crossover process; and (d) An example of mutation process

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

10

L Zhang and E Guilbert

4.3 Selection

In this article, the elitist model (Mitchell 1996) is used for the selection operation in the GA.
Elitism directly copies the best chromosomes to a new population without any other reproduc-
tion operations. This method can rapidly increase the performance of the GA, and it preserves
the best solution all the time.

4.4 Reproduction

The reproduction for tributary selection using GA should be customized following similar rules
to initialization. They are:

1. After reproduction, the number of selected genes must be equal to Ns.
2. The reproduction cannot break the topology of a river network, and cannot omit a

stroke if it has upper strokes.

4.4.1 Crossover

In order to obey the rules of the reproduction for the tributary selection using GA, the crossover oper-
ation cannot be applied normally as one-point-crossover or two-point-crossover. The information
exchange between the two parent chromosomes should be controlled to follow the rules. Here, a
mask, which is represented as a chromosome of the same length, is used to determine which genes are
inherited from which parents. An offspring is generated as indicated in the mask (see also Figure 2): a
gene is from the ﬁrst parent chromosome if the mask gene is 1 and from the second parent if it is 2.

The crossover algorithm is given by Algorithm 2.

Algorithm 2 - Chromosome crossover

Input: Two chromosomes C1 and C2
Output: the offspring chromosome O
Set the mask M as a list of Na values set to 1
Set Lp as an empty list
For i 5 1 to Na

If C1(i)! 5 C2(i)//genes have different values in C1 and C2

If changing the value of C1(i) breaks the network topology

Randomly select i1 and i2 in Lp such that C2(i1)! 5 C2(i2)
If no i1 and i2 can be selected Then

Add i to Lp

For each i of Lp

Remove i from Lp

While Lp is not empty

Exit While
Set M(i1) 5 2
Set M(i2) 5 2
Remove i1 and i2 from Lp

End While
For i 5 1 to Na
If M(i) 5 1

Set O(i) 5 C1(i)

Else

Set O(i) 5 C2(i)

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Genetic Algorithm for Tributary Selection

11

Figure 2c shows an example of the crossover process with two chromosomes. C1 and C2
are parents and O is the chromosome obtained by crossover. Genes 1, 3 and 8 of C1 and C2
are identical and so are copied directly to O. Six other allelic genes are different. However, the
allelic genes in positions 4 and 5 are invalid. If genes exchange in position 4 or 5, stroke 5
would be separated from the river network in C2 or C1, respectively. M is one of the workable
masks determined by random selection. In order to follow rule 1, positions 2 and 7 in the chro-
mosome are marked to exchange information between the parents. A new offspring is gener-
ated by taking genes in positions 2 and 7 from C2 and other genes from C1.

4.4.2 Mutation

The mutation operation changes a gene in a chromosome in order to avoid a too early conver-
gence towards a local instead of a global optimum. Here, if only one gene is changed, rule 1 of
the reproduction cannot be satisﬁed. If a gene is changed from 0 to 1, another gene needs to be
changed from 1 to 0. In the process, only one pair of genes is supposed to be changed.

The modiﬁed mutation for selecting tributaries is given in the following algorithm.

Algorithm 3 - Chromosome mutation

Input: a chromosome C
Output: the mutated chromosome C
Set L1 the list of genes valued to 1 // list of selected tributaries
Set L0 the list of genes valued to 0 // list of omitted tributaries
For each g in L1

If setting g to 0 breaks the topology

Remove g from L1

Randomly choose a gene in L1 and set it to 0
For each g in L0

If setting g to 1 breaks the topology

Remove g from L0.

Randomly choose a gene in L0 and set it to 1

In Figure 2d, an example of mutation is illustrated. C is a chromosome that represents a
solution of selecting six strokes for the river network in Figure 2a. In step 1, lists L1 and L0 are
established. In step 2, stroke 1 is removed from L1. Step 3 chooses stroke 3 to be changed from
1 to 0. Then, in step 4, because its lower river (stroke 4) is omitted, stroke 5 cannot be selected
and, as such, is removed from L0. Finally, stroke 4 is chosen to be changed from 0 to 1. The C’
is the chromosome after the mutation.

4.5 Termination

The GA process does not stop until a termination condition is satisﬁed. For the termination of
this problem, two methods are used. The ﬁrst one sets the number of iterations. The second sets
a number of iterations where the best chromosome does not change. In the experiments, both
termination conditions are set to stop the GA process.

5 Experiments and Results

In the experiment, datasets of the Russian River in California are tested (Figure 3). Data
at 1:24K are provided by the Russian River Interactive Information System (RRIIS)

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

12

L Zhang and E Guilbert

Figure 3 Russian River, California, US. Left: 1:24,000-scale (1:24K) from RRIIS. Right: 1:100,000-scale
(1:100K) from NHD

(http://www.rrwatershed.org) while data at 1:100K were obtained from the National
Hydrography Dataset (NHD) (http://nhd.usgs.gov/data.html).

The river ﬂow dataset at 1:100K scale was not generalized automatically from detailed
data. It can be regarded as a manually generalized dataset. Therefore, the NHD data at 1:100K
scale is used as a standard to check generalized river networks by comparing the similarity,
which is calculated by an overlap ratio.

Similarity is a complicated problem (L€u et al. 2012). In our experiment, as the number of
selected segments is ﬁxed, we look only at segments common to both datasets. In addition, the
segment length that participated was considered in the overlapping ratio to give more impor-
tance to long segments. Supposing a river network from the NHD is composed of N river seg-
ments and an automatic generalized river network has M river segments overlapped with the
NHD data, the overlap ratio is calculated as:

Similarity5

Leni=

Lenj

3100%

 

M
X

i51

N
X

j51

!

(13)

where Lenx is the length of a river segment. An overlap example is shown in Figure 4.

The experiment is conducted as follows:

Figure 4 An example of overlap. Supposing network (a) is a generalized network and network (b)
is a network from the NHD, the overlapped river segments are shown in bold gray shadow in (c).
So, the similarity is the length of segments in shadow divided by the total length of network (b)

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Genetic Algorithm for Tributary Selection

13

1. Get a sub-network from the Russian River at 1:24k, and identify its drainage pattern.
2. Get the same river network from the NHD, and build strokes to obtain the number of

selected strokes.

3. According to the pattern, set weights for the ﬁtness function.
4. Get a generalized river network by applying GA.
5. Calculate the similarity with the river network from the NHD.
6. Repeat above steps for all sub-networks.

In the experiment, parameters are set as follows: the population size is set to 100; for ter-
mination, the total number of generation is 500, and the iteration would stop if the best solu-
tion does not change for 20 generations. These settings are empirical values. The algorithm
runs faster if the population size is small, but this more often leads to a local optimal solution.
However, it is not good to set the population too large because it will slow the algorithm and
the result would not be better than a suitable population size.

There are several objectives to achieve in the experiment: one is to test the importance of each
factor by setting a weight to 0 and others to 0.25, and another is to rank the factors in the order of
importance for the multi-objective function according to different drainage patterns by setting a
weight of a factor to 0.6 and others to 0.1. So, different weights are set in the GA. The importance
of a factor can be validated through these tests. Then, according to tested results, other schemes of
weight setting can be examined to obtain a feasible setting for a drainage pattern.

As the stroke and length method was regarded as the method that “most closely approxi-
mates the generalisation decisions made by a human cartographer” (Thomson and Brooks
2000), it is applied in the experiment for comparison. Taking a stroke as an entity, there are
two steps in the generalization process:

1. Remove the lower order stroke ﬁrst.
2. Remove the shorter strokes if they are in the same order.

Different sets of weights have been set for each drainage pattern. These weights were tested by
performing a selection on each sub-network of the Russian River. Appendix A presents the detailed
results for dendritic networks. Appendix B presents commented results obtained for trellis and par-
allel networks. A summary of best results obtained for each pattern is presented in Table 2.

In Table 2, for all patterns, the length is the most important factor, because the length
weights (wL) are 0.6, 0.6 and 0.5 for the dendritic, trellis and parallels patterns, respectively.
They are much larger than other weights. In the dendritic pattern, the pattern membership and
the order are the second important factors (wM 5 0.15, wO 5 0.15); the factor of balance is not
so important and even cannot be considered. For the trellis pattern, the tributary spacing is the
second important factor (wS 5 0.2), and the balance is also not important. Trellis tributaries
are usually short streams of order 1. As a consequence, giving too much importance to the
order tends to eliminate these tributaries ﬁrst and lose the character of the network. Hence, the
order should not be considered as an important factor for the preservation of the trellis. In
the parallel pattern, the membership factor (wM 5 0.2) is more important than others except
for the length. Compared to the stroke and length method, the GA method provides a better
network both in similarity and drainage pattern preservation.

6 Conclusions

In this article, we introduced a new genetic algorithm for river selection where the objective
function includes different factors weighted according to their importance. Five factors

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

14

L Zhang and E Guilbert

e
h
t

e
r
a

S
w
d
n
a

B
w

,
L

w

,

O
w

,

M
w

.
x
i
d
n
e
p
p
a

e
h
t

n

i

w
o
h
s

e
r
a

s
l
i
a
t
e
d

t
n
e
m

i
r
e
p
x
e

e
h
T

.
s
t
l
u
s
e
r

t
n
e
m

i
r
e
p
x
e

e
h
t

m
o
r
f

s
g
n
i
t
t
e
s

t
h
g
e
w

i

t
s
e
b

e
h
T

2

e
l
b
a
T

y
l
e
v
i
t
c
e
p
s
e
r

,

g
n
i
c
a
p
s

y
r
a
t
u
b
i
r
t

d
n
a

e
c
n
a
l
a
b

,

h
t
g
n
e

l

,
r
e
d
r
o

,

i

p
h
s
r
e
b
m
e
m
n
r
e
t
t
a
p

e
g
a
n
i
a
r
d

f
o

s
t
h
g
e
w

i

i

p
h
s
r
e
b
m
e
M
n
r
e
t
t
a
P

e
g
a
n
a
r

D
e
g
a
r
e
v
A

y
t
i
r
a
l
i

m
S

i

e
g
a
r
e
v
A

l
a
t
o
T

4

r
e
d
r
O

3

r
e
d
r
O

2

r
e
d
r
O

l
a
t
o
T

4

r
e
d
r
O

3

r
e
d
r
O

2

r
e
d
r
O

)
S
w
/
B
w

/
L

/

w
O
w
M
w

/

(

7
3
.
0

9
2
.
0

5
3
.
0

8
2
.
0

0
5
.
0

7
4
.
0

-

-

8
4
.
0

8
2
.
0

7
8
.
0

6
8
.
0

3
5
.
0

8
4
.
0

2
5
.
0

0
4
.
0

3
7
.
0

3
7
.
0

3
3
.
0

5
2
.
0

6
2
.
0

0
2
.
0

7
4
.
0

4
4
.
0

%
4
.
0
8

%
2
.
9
7

%
2
.
2
8

%
4
.
9
7

%
9
.
6
6

%
3
.
5
6

%
0
.
3
8

%
4
.
8
7

%
2
.
2
8

%
0
.
4
8

-

-

%
4
.
8
8

%
4
.
6
8

%
2
.
9
8

%
2
.
2
8

%
6
.
1
9

%
6
.
1
9

%
4
.
8
7

%
5
.
7
7

%
7
.
9
7

%
0
.
8
7

%
7
.
4
6

%
9
.
2
6

)
2
.
0
/
0
.
0
/
6
.
0
/
1
.
0
/
1
.
0
(

h
t
g
n
e
L
1
e
k
o
r
t
S

)
1
.
0
/
1
.
0
/
5
.
0
/
1
.
0
/
2
.
0
(

h
t
g
n
e
L
1
e
k
o
r
t
S

h
t
g
n
e
L
1
e
k
o
r
t
S

)
1
.
0
/
0
/
6
.
0
/
5
1
.
0
/
5
1
.
0
(

c
i
t
i
r
d
n
e
D

s
t
h
g
e
W

i

g
n
i
t
t
e
S

e
g
a
n
i
a
r
D

n
r
e
t
t
a
P

s
l
e

l
l
a
r
a
P

s
i
l
l

e
r
T

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Genetic Algorithm for Tributary Selection

15

Table 3
The approximate weight settings for each drainage pattern. The balance coefﬁcient can-
not be considered in the dendritic and trellis patterns. The length is the most important factor for
all patterns

Dendritic

Parallel

Trellis

Pattern membership (wM)
Stream order (wO)
Stream length (wL)
Balance coefﬁcient (wB)
Tributary spacing (wS)

(cid:7)
(cid:7)
(cid:7)(cid:7)
3
(cid:2)

(cid:7)
(cid:7)
(cid:7)(cid:7)
(cid:2)
(cid:2)

(cid:2)
(cid:2)

(cid:7)(cid:7)
3
(cid:7)

(cid:7)(cid:7) - more important (cid:7) - important (cid:2) - not important 3 - not considered

corresponding to geometric characteristics of the networks were chosen (drainage pattern
membership, order, tributary length, tributary balance and spacing between tributaries). Differ-
ent results can be obtained by adjusting the weights of the multi-objective function. For exam-
ple, the drainage pattern can be preserved by assigning more weight to pattern membership
(wM). If the weight of river order (wO) was set to a higher value, the tributaries of lower order
would be eliminated ﬁrst. The length factor can preserve longer tributaries; the balance coefﬁ-
cient can keep the original balance of a tributary along a river; and the tributary spacing can
avoid tributaries to cluster together.

The proposed GA method is used to assess the inﬂuence of different factors in the general-
ization process for each type of drainage. It was applied to the Russian River data and results
were compared with manually generalized data with the goal to achieve similar results and test
the importance of the drainage pattern. The most important factor is the length. In general,
during manual generalization, the length is indeed the most considerable factor. Although the
drainage pattern does not change much in the manual work, it can be preserved better if
the pattern membership participates in the GA process.

For each pattern, a proper set of weights is given to achieve a greater similarity with the

manual generalized river networks. Table 3 illustrates the approximate settings for weights.

One limitation of the research is that the similarity is not improved obviously comparing

to the stroke and length method. Here are some reasons:

1. The GA is implemented by encoding the network with strokes. Correct strokes will help

to increase the similarity, but sometimes strokes are not built as expected.

2. Some manual networks are not generalized as expected: some tributaries are short and
in lower order, but they are still selected after generalization. It may happen that the
tributary has some signiﬁcant meanings in the geography so it should be preserved
whether it is short or long. Some examples are shown in Figure 5.

Another limitation is that the only involved map scales in this article are the 1:24K and

1:100K scales. Other datasets and other scales should be tested in future work.

Some work still can be done to improve this study. The ﬁrst is that other factors can be
considered. Semantic factors such as the name and geographical meanings of tributaries are not
considered. The name of tributaries can help to establish correct strokes. Some tributaries have
priorities in the selection process according to their geographical meanings. The second is that
rectangular drainages (Figure 6) should also be considered. The third is to provide a method to

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

16

L Zhang and E Guilbert

Figure 5 Unexpected situations, dashed lines are eliminated tributaries. Network (a) and (c) are
from the Russian River at 1:24K scale. Network (b) and (d) are from the NHD at 1:100K scale. The
bold line is the main stream obtained by the stroke. In the dashed box, the stroke is not the same
as the stroke in network (b) because segments at 1:100k do not exist at 1:24k. No matter how the
weights are adjusted, network (a) cannot be generalized as (b). Network (c) is a generalized net-
work, where dashed tributaries are eliminated by considering the length. However, in the dashed
circle, network (d) from the NHD set, a shortest tributary was selected

calculate the weights of objective functions. This work requires more datasets at different
scales. Apart from cartography, drainages are also important in studying the geomorphology of
an area. Characterizing and preserving patterns can be useful in applications where terrain
characteristics are studied at different scales.

Figure 6 An example of rectangular drainage pattern

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Genetic Algorithm for Tributary Selection

17

1 Proximity rivers are adjacent rivers on the same side of a main stream (Ai et al. 2006).

Note

References

Ai T, Liu Y, and Chen J 2006 The hierarchical watershed partitioning and data simpliﬁcation of river
network. In Riedl A, Kainz W, and Elmes G A (eds) Progress in Spatial Data Handling. Berlin,
Springer: 617–32

Alt H and Godau M 1995 Computing the Frechet distance between two polygonal curves. International Journal

of Computational Geometry and Applications 5: 75–91

Chernicoff S and Whitney D 2006 Geology (Fourth Edition). Upper Saddle Creek, NJ, Prentice Hall
Deb K 2001 Multi-objective Optimization Using Evolutionary Algorithms. New York, John Wiley and Sons
Hajela P and Lin C Y 1992 Genetic search strategies in multi-criterion optimal design. Structural and Multidisci-

plinary Optimization 4(2): 99–107

Heinzle F, Anders K, and Sester M 2006 Pattern recognition in road networks on the example of circular road
detection. In Raubal M, Miller H J, Frank A U, and Goodchild M F (eds) Geographic Information Science:
Fourth International Conference, GIScience 2006, M€unster, Germany, September 20-23, 2006, Proceed-
ings. Berlin, Springer Lecture Notes in Computer Science Vol. 4197: 153–67

Horton R E 1945 Erosional development of streams and their drainage basins; hydrophysical approach to quanti-

tative morphology. Geological Society of America Bulletin 56: 275–370

Jiang L, Qi Q, and Zhang A 2009 How to decide the units of drainage pattern of generalization. In
Proceedings of the 2009 International Geoscience and Remote Sensing Symposium, Cape Town, South
Africa: 658–61

Lambert D 2007 The Field Guide to Geology. New York, Checkmark Books
Li Z 2007 Algorithmic Foundation of Multi-scale Spatial Representation. Boca Raton, FL, CRC Books
L€u L, Medo M, Yeung C H, Zhang Y-C, Zhang Z-K, and Zhou T 2012 Recommender systems. Physics Reports

519: 1–49

Mackaness W and Edwards G 2002 The importance of modelling pattern and structure in automated map gener-
alisation. In Proceedings of the Joint ISPRS/ICA Workshop on Multi-Scale Representations of Spatial Data,
Ottawa, Ontario: 7–8

Mitchell M 1996 An Introduction to Genetic Algorithms. Cambridge, MA, MIT Press
Richardson D E 1993 Automated Spatial and Thematic Generalization Using a Context Transformation Model:
Integrating Steering Parameters, Classiﬁcation and Aggregation Hierarchies, Reduction Factors, and
Topological Structures for Multiple Abstractions. Toronto, ON, R&B Publications

Ritter M E 2006 The Physical Environment: An Introduction to Physical Geography. WWW document, http://

www.earthonlinemedia.com/ebooks/tpe_3e/title_page.html

Rusak Mazur E and Castner H W 1990 Horton’s ordering scheme and the generalization of river networks.

Cartographic Journal 27: 104–12

Sandro S, Massimo R, and Matteo Z 2011 Pattern recognition and typiﬁcation of ditches. In Ruas A (ed) Advan-

ces in Cartography and GIScience (Volume 1). Berlin, Springer: 425–37

Sen A, Gokgoz T, and Sester M 2014 Model generalization of two different drainage patterns by self-organizing

maps. Cartography and Geographic Information Science 41: 151–65

Shreve R L 1966 Statistical law of stream numbers. Journal of Geology 74: 17–37
Stanislawski L V 2008 Development of a knowledge-based network pruning strategy for automated generalisa-
tion of the United States National Hydrography Dataset. In Proceedings of the Eleventh ICA Workshop on
Generalization and Multiple Representation, Montpellier, France

Stanislawski L V 2009 Feature pruning by upstream drainage area to support automated generalization of
the United States National Hydrography Dataset. Computers, Environment and Urban Systems 33:
325–33

Strahler A N 1957 Quantitative analysis of watershed geomorphology. Transactions of the American Geophysi-

cal Union 38: 913–20

Thomson R C and Brooks R 2000 Efﬁcient generalization and abstraction of network data using perceptual
grouping. In Proceedings of the Fifth International Conference on Geo-Computation, Greenwich, United
Kingdom: 23–5

Topfer F and Pillewizer W 1966 The principles of selection. Cartographic Journal 3: 10–6
Touya G 2007 River network selection based on structure and pattern recognition. In Proceedings of the Twenty-

third International Cartographic Conference, Moscow, Russia: 4–9

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

18

L Zhang and E Guilbert

Van Dijk S, Thierens D, and De Berg M 2002 Using genetic algorithms for solving hard problems in GIS. GeoIn-

formatica 6: 381–413

Ware J M, Wilson I D, and Ware J A 2003 A knowledge based genetic algorithm approach to automating carto-

graphic generalisation. Knowledge-Based Systems 16: 295–303

Whitley D 1994 A genetic algorithm tutorial. Statistics and Computing 4(2): 65–85
Wolf G W 1988 Weighted surface networks and their application to cartographic generalization. Visualisierung

Techniken und Algorithmen 182: 199–212

Wu H 1997 Structured approach to implementing automatic cartographic generalization. In Proceedings of the

Eighteenth International Cartographic Conference, Stockholm, Sweden

Zhai R J, Wu F, Deng H, and Tan X 2006 Automated elimination of river based on multi-objective optimization

using genetic algorithm. Journal of China University of Mining and Technology 35: 403–08

Zhang L and Guilbert E 2013 Automatic drainage pattern recognition in river networks. International Journal of

Geographical Information Science 27: 2319–42

Zhang X 2012 Automated Evaluation of Generalized Topographic Maps. Unpublished PhD Dissertation, Univer-

sity of Twente

Appendix

A. Dendritic Example

A tested dendritic river network is shown in Figure 7. The results for this example are given
in Table 4. The weights settings are shown in the ﬁrst column. In the table, the column of
the GA process records the value of ﬁtness function and all participating objective functions
at each generation during the process. The value of the stream order function is decreasing,
and others are increasing. This is because a selection solution is initialized based on stream
order. Lower order streams are eliminated ﬁrst, and then, after the GA operations, some
streams with lower order would be selected back due to the inﬂuence of other factors. The
pattern membership value is increasing which can guarantee the pattern is preserved during
the process.

From Table 4, the similarities of generalized networks (A) to (E) are 66.2, 65.6, 81.0,
60.7 and 61.7% respectively. Network (C) is the result of setting the weight of the length
factor with 0.6, and it has the greatest similarity among the group tests, which is also larger
than the similarity of the generalized network by the method of the stroke and length
(81.0 > 73.2%). The similarities with the manual generalized network at 1:100K scale of
other networks are fairly low. Then, we can see, the length is an important factor to a

Figure 7 Tested network for dendritic case study. Network (a) is from Russian river at scale 1:24K.
Network (b) is from the NHD at 1:100K scale. Network (c) is generalized by stroke and length
method. It has the same number of strokes with the network from the NHD, and the similarity
between them is 73.2%

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Genetic Algorithm for Tributary Selection

19

y
t
i
r
a
l
i

m
S

i

%
2
.
6
6

%
6
.
5
6

%
0
.
1
8

e
c
n
a
l
a
b

,

h
t
g
n
e

l

,
r
e
d
r
o

,

i

p
h
s
r
e
b
m
e
m
n
r
e
t
t
a
p

e
g
a
n
i
a
r
d

f
o

i

s
t
h
g
e
w
e
h
t

e
r
a

S
w
d
n
a

B
w

,
L

w

,

O
w

,

M
w

.

e
s
a
c

c
i
t
i
r
d
n
e
d

r
o
f

s
t
l
u
s
e
r

d
e
z
i
l
a
r
e
n
e
G

4

e
l
b
a
T

y
l
e
v
i
t
c
e
p
s
e
r

,

g
n
i
c
a
p
s

y
r
a
t
u
b
i
r
t

d
n
a

*
s
s
e
c
o
r
p

A
G

k
r
o
w
t
e
n

d
e
z
i
l
a
r
e
n
e
G

)
S
w
/
B
w

/
L

/

w
O
w
M
w

/

(

s
t
h
g
e
W

i

)
1
.
0
/
1
.
0
/
1
.
0
/
1
.
0
/
6
.
0
(

)
1
.
0
/
1
.
0
/
1
.
0
/
6
.
0
/
1
.
0
(

)
1
.
0
/
1
.
0
/
6
.
0
/
1
.
0
/
1
.
0
(

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

20

L Zhang and E Guilbert

y
t
i
r
a
l
i

m
S

i

%
7
.
0
6

%
7
.
1
6

%
6
.
5
6

*
s
s
e
c
o
r
p

A
G

k
r
o
w
t
e
n

d
e
z
i
l
a
r
e
n
e
G

)
S
w
/
B
w

/
L

/

w
O
w
M
w

/

(

s
t
h
g
e
W

i

d
e
u
n
i
t
n
o
C

4

e
l
b
a
T

)
1
.
0
/
6
.
0
/
1
.
0
/
1
.
0
/
1
.
0
(

)
6
.
0
/
1
.
0
/
1
.
0
/
1
.
0
/
1
.
0
(

)
5
2
.
0
/
5
2
.
0
/
5
2
.
0
/
5
2
.
0
/
0
(

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Genetic Algorithm for Tributary Selection

21

y
t
i
r
a
l
i

m
S

i

%
6
.
0
6

%
7
.
1
6

%
9
.
3
7

*
s
s
e
c
o
r
p

A
G

k
r
o
w
t
e
n

d
e
z
i
l
a
r
e
n
e
G

)
S
w
/
B
w

/
L

/

w
O
w
M
w

/

(

s
t
h
g
e
W

i

d
e
u
n
i
t
n
o
C

4

e
l
b
a
T

)
5
2
.
0
/
5
2
.
0
/
5
2
.
0
/
0
/
5
2
.
0
(

)
5
2
.
0
/
5
2
.
0
/
0
/
5
2
.
0
/
5
2
.
0
(

)
5
2
.
0
/
0
/
5
2
.
0
/
5
2
.
0
/
5
2
.
0
(

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

22

L Zhang and E Guilbert

y
t
i
r
a
l
i

m
S

i

%
9
.
9
6

%
0
.
1
8

%
0
.
1
8

*
s
s
e
c
o
r
p

A
G

k
r
o
w
t
e
n

d
e
z
i
l
a
r
e
n
e
G

)
S
w
/
B
w

/
L

/

w
O
w
M
w

/

(

s
t
h
g
e
W

i

d
e
u
n
i
t
n
o
C

4

e
l
b
a
T

)
0
/
5
2
.
0
/
5
2
.
0
/
5
2
.
0
/
5
2
.
0
(

)
1
.
0
/
1
.
0
/
5
.
0
/
1
.
0
/
2
.
0
(

)
1
.
0
/
1
.
0
/
5
.
0
/
2
.
0
/
1
.
0
(

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Genetic Algorithm for Tributary Selection

23

y
t
i
r
a
l
i

m
S

i

%
5
.
3
8

%
5
.
3
8

%
5
.
3
8

*
s
s
e
c
o
r
p

A
G

k
r
o
w
t
e
n

d
e
z
i
l
a
r
e
n
e
G

)
S
w
/
B
w

/
L

/

w
O
w
M
w

/

(

s
t
h
g
e
W

i

s
n
o
i
t
a
r
e
t
i

f
o

r
e
b
m
u
n

e
h
t

s
i

s
i
x
a

l
a
t
n
o
z
i
r
o
h

e
h
t

;

n
o
i
t
c
n
u
f

e
v
i
t
c
e
b
o

j

e
h
t

f
o

e
u
l
a
v

e
h
t

s
i

s
i
x
a

l
a
c
i
t
r
e
v

e
h
T
*

s
s
e
n
t
i
F
—
—
—
p
h
s
r
e
b
m
e
M

i

(cid:8)

—
—

r
e
d
r
O

(cid:8)
(cid:8)
(cid:8)
(cid:8)
(cid:8)
(cid:8)

g
n
i
c
a
p
S
—

(cid:8)

—
e
c
n
a
l
a
B

-

-

-

-
-

h
t
g
n
e
L

–
(cid:8)

(cid:8)

—

:

d
n
e
g
e
L

d
e
u
n
i
t
n
o
C

4

e
l
b
a
T

)
1
.
0
/
0
/
6
.
0
/
1
.
0
/
2
.
0
(

)
1
.
0
/
0
/
6
.
0
/
2
.
0
/
1
.
0
(

)
1
.
0
/
0
/
6
.
0
/
5
1
.
0
/
5
1
.
0
(

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

24

L Zhang and E Guilbert

dendritic pattern. After the second group test, without considering the length, network (H)
is generalized by setting wL 5 0, and the similarity decreases to 61.7% from 81.0%. For
other factors, without the membership or the order, similarities of networks (F) and (G)
also decrease from 66.2 to 65.6% and from 65.6 to 60.6% respectively. However, without
the factors of the balance coefﬁcient or the tributary spacing, the increased similarities indi-
cate that these two factors are not so important to the dendritic pattern. From the result,
the preliminary rank of the factors is length (wL) > drainage pattern membership (wM) (cid:6)
order (wO) > tributary spacing (wS) (cid:6) balance (wB), the length is deﬁnitely the most impor-
tant one.

In the following tests, wL is set as a high value to 0.5 or 0.6, and other factors are given
different values to ﬁx the importance between wM and wO, and between wS and wB. For net-
works (K) and (M) in Table 4, although wM and wO are different, the similarities are the
same. It is hard to say which factor has priority between wM and wO. However, with these
two weight settings, similarities are still not greater than for network (C). For this reason,
considering wB has inﬂuenced the similarity a lot, it is set to 0 for networks (N), (O) and
(P). The results show that wS > wB because all similarities of (N),
(O) and (P) have
improved.

B. Generalized Networks in Russian River

B.1 Generalized Dendritic Networks

The setting of weights for the ﬁtness function used in Appendix A is also tested on all den-
dritic river networks in the Russian river. The whole river network can be decomposed in
different sub-networks at different orders. According to the Horton-Strahler order of its
main stream, a sub-network can belong to different orders from 2 to 4. The statistical results
are listed in Table 5.

Table 5, comparing the ﬁrst ﬁve and the second ﬁve tests, shows the same conclusions
with the dendritic case study except for setting the weight of drainage pattern membership
to 0 (Row 6). Without considering the drainage pattern, the average similarity increases
from 72.6 to 75.4%. The similarity is computed by comparing with the manual work, so it
can illustrate that in the manually generalized river networks, the type of pattern is preserved
to some extent but is not emphasised. On the other hand, putting a heavy weight on the pat-
tern membership function tends to increase this membership and to caricature the pattern.
From the results, the similarities can be improved by setting length factor (wL) with high val-
ues. This shows that the length is the most important factor among all ﬁve proposed factors.
Weight settings for the pattern membership (wM), order (wO), length (wL), balance (wB) and
tributary spacing (wS) with 0.15, 0.15, 0.6, 0 and 0.1 get the greatest average similarity
(80.4%) among all settings. The result is same with the case study, so it can conﬁrm that the
settings are more appropriate for dendritic river networks. The average pattern membership
of all dendritic networks before generalization at 1:24K scale is 0.47. After generalization,
although the average membership of networks generalized by the setting (0.15/0.15/0.6/0/
0.1) is only 0.37, which is smaller than 0.47, it is greater than the value of manual general-
ized river networks (0.31). Only the average membership of generalized networks in order 2
is smaller than the original one (0.33 < 0.46) because many generalized networks in order 2
do not have sufﬁcient tributaries for the computation of the drainage pattern membership.
So, with consideration of the drainage pattern, the drainage pattern membership value is
even increased after generalization. In addition, sub-networks in order 3 and 4 have higher

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Genetic Algorithm for Tributary Selection

25

e
c
n
a
l
a
b

,

h
t
g
n
e

l

,
r
e
d
r
o

,

i

p
h
s
r
e
b
m
e
m
n
r
e
t
t
a
p

e
g
a
n
i
a
r
d

f
o

i

s
t
h
g
e
w
e
h
t

e
r
a

S
w
d
n
a

B
w

,
L

w

,

O
w

,

M
w

.
s
t
l
u
s
e
r

s
k
r
o
w
t
e
n

c
i
t
i
r
d
n
e
d

d
e
z
i
l
a
r
e
n
e
G

5

e
l
b
a
T

y
l
e
v
i
t
c
e
p
s
e
r

,

g
n
i
c
a
p
s

y
r
a
t
u
b
i
r
t

d
n
a

l
a
t
o
T

4

r
e
d
r
O

3

r
e
d
r
O

2

r
e
d
r
O

l
a
t
o
T

4

r
e
d
r
O

3

r
e
d
r
O

2

r
e
d
r
O

i

p
h
s
r
e
b
m
e
M
n
r
e
t
t
a
P

e
g
a
n
i
a
r

D
e
g
a
r
e
v
A

y
t
i
r
a
l
i

m
S

i

e
g
a
r
e
v
A

5
5
.
0

8
3
.
0

7
3
.
0

3
3
.
0

1
4
.
0

1
3
.
0

6
4
.
0

3
4
.
0

4
4
.
0

2
4
.
0

0
4
.
0

6
3
.
0

1
4
.
0

6
3
.
0

7
3
.
0

9
2
.
0

7
4
.
0

1
3
.
0

9
5
.
0

2
4
.
0

8
4
.
0

4
4
.
0

3
5
.
0

9
1
.
0

3
6
.
0

0
5
.
0

2
5
.
0

5
5
.
0

3
5
.
0

1
4
.
0

6
5
.
0

7
4
.
0

8
4
.
0

8
2
.
0

8
3
.
0

7
2
.
0

1
7
.
0

6
5
.
0

3
5
.
0

7
4
.
0

4
6
.
0

9
4
.
0

8
6
.
0

6
6
.
0

7
6
.
0

4
6
.
0

1
6
.
0

4
5
.
0

0
6
.
0

2
5
.
0

3
5
.
0

8
4
.
0

3
5
.
0

3
4
.
0

0
5
.
0

3
3
.
0

2
3
.
0

8
2
.
0

4
3
.
0

7
2
.
0

0
4
.
0

7
3
.
0

9
3
.
0

6
3
.
0

5
3
.
0

2
3
.
0

5
3
.
0

2
3
.
0

3
3
.
0

5
2
.
0

6
4
.
0

8
2
.
0

%
6
.
2
7

%
1
.
6
7

%
4
.
9
7

%
4
.
0
7

%
9
.
3
7

%
4
.
5
7

%
3
.
4
7

%
0
.
0
7

%
9
.
5
7

%
3
.
6
7

%
7
.
9
7

%
8
.
9
7

%
9
.
9
7

%
3
.
0
8

%
4
.
0
8

%
2
.
9
7

%
4
.
0
7

%
0
.
4
7

%
1
.
1
8

%
3
.
3
6

%
3
.
0
7

%
8
.
2
7

%
6
.
9
6

%
5
.
4
6

%
3
.
7
7

%
2
.
3
7

%
0
.
0
8

%
6
.
9
7

%
1
.
3
8

%
7
.
2
8

%
0
.
3
8

%
4
.
8
7

%
2
.
6
7

%
5
.
2
8

%
3
.
7
8

%
1
.
0
7

%
5
.
7
7

%
5
.
2
8

%
9
.
8
7

%
0
.
2
7

%
6
.
1
8

%
8
.
0
8

%
2
.
6
8

%
5
.
7
8

%
6
.
6
8

%
8
.
7
8

%
4
.
8
8

%
4
.
6
8

%
8
.
1
7

%
7
.
4
7

%
4
.
7
7

%
9
.
0
7

%
2
.
3
7

%
9
.
3
7

%
4
.
3
7

%
9
.
9
6

%
4
.
4
7

%
4
.
5
7

%
1
.
8
7

%
0
.
8
7

%
2
.
8
7

%
3
.
8
7

%
4
.
8
7

%
5
.
7
7

)
S
w
/
B
w

/
L

/

w
O
w
M
w

/

(

g
n
i
t
t
e
S

s
t
h
g
e
W

i

)
1
.
0
/
1
.
0
/
1
.
0
/
1
.
0
/
6
.
0
(

)
1
.
0
/
1
.
0
/
1
.
0
/
6
.
0
/
1
.
0
(

)
1
.
0
/
1
.
0
/
6
.
0
/
1
.
0
/
1
.
0
(

)
1
.
0
/
6
.
0
/
1
.
0
/
1
.
0
/
1
.
0
(

)
6
.
0
/
1
.
0
/
1
.
0
/
1
.
0
/
1
.
0
(

)
5
2
.
0
/
5
2
.
0
/
5
2
.
0
/
5
2
.
0
/
0
(

)
5
2
.
0
/
5
2
.
0
/
5
2
.
0
/
0
/
5
2
.
0
(

)
5
2
.
0
/
5
2
.
0
/
0
/
5
2
.
0
/
5
2
.
0
(

)
5
2
.
0
/
0
/
5
2
.
0
/
5
2
.
0
/
5
2
.
0
(

)
0
/
5
2
.
0
/
5
2
.
0
/
5
2
.
0
/
5
2
.
0
(

)
1
.
0
/
1
.
0
/
5
.
0
/
1
.
0
/
2
.
0
(

)
1
.
0
/
1
.
0
/
5
.
0
/
2
.
0
/
1
.
0
(

)
1
.
0
/
0
/
6
.
0
/
1
.
0
/
2
.
0
(

)
1
.
0
/
0
/
6
.
0
/
2
.
0
/
1
.
0
(

)
1
.
0
/
0
/
6
.
0
/
5
1
.
0
/
5
1
.
0
(

h
t
g
n
e
L
1
e
k
o
r
t
S

1

2

3

4

5

6

7

8

9

0
1

1
1

2
1

3
1

4
1

5
1

6
1

7
1

8
1

r
e
v
i
r

n
a
i
s
s
u
R

e
h
t

m
o
r
f

e
l
a
c
s

K
4
2
:
1

s
k
r
o
w
t
e
n

r
e
v
i
R

D
H
N
e
h
t

m
o
r
f

e
l
a
c
s

K
0
0
1
:
1

s
k
r
o
w
t
e
n

r
e
v
i
R

t
a

t
a

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

26

L Zhang and E Guilbert

Table 6 Generalized trellis networks results. wM, wO, wL, wB and wS are the weights of drainage
pattern membership, order, length, balance and tributary spacing, respectively

Average Similarity

Average Drainage Pattern
Membership

Weights Setting
(wM/wO/wL/wB/wS)

Order 2 Order 3 Order 4 Total Order 2 Order 3 Order 4 Total

62.9%
(0.6/0.1/0.1/0.1/0.1)
1
74.3%
(0.1/0.6/0.1/0.1/0.1)
2
79.7%
(0.1/0.1/0.6/0.1/0.1)
3
64.3%
(0.1/0.1/0.1/0.6/0.1)
4
(0.1/0.1/0.1/0.1/0.6)
73.7%
5
(0/0.25/0.25/0.25/0.25) 74.9%
6
(0.25/0/0.25/0.25/0.25) 73.3%
7
(0.25/0.25/0/0.25/0.25) 66.6%
8
9
(0.25/0.25/0.25/0/0.25) 75.9%
10 (0.25/0.25/0.25/0.25/0) 75.0%
79.1%
11 (0.2/0.1/0.5/0.1/0.1)
78.5%
12 (0.1/0.2/0.5/0.1/0.1)
80.3%
13 (0.1/0.1/0.5/0.1/0.2)
77.3%
14 (0.2/0.1/0.5/0/0.2)
79.7%
15 (0.1/0.1/0.6/0.0/0.2)
16 Stroke 1 Length
78.0%
17 River networks at 1:24K scale from the Russian river
18 River networks at 1:100K scale from the NHD

73.0%
82.2%
84.8%
64.6%
79.7%
80.3%
79.4%
76.2%
80.7%
78.6%
84.3%
83.1%
83.1%
85.9%
89.2%
82.2%

67.7%
76.5%
81.2%
67.9%
73.2%
76.7%
70.7%
66.9%
77.6%
75.0%
80.6%
80.9%
82.8%
79.0%
82.2%
84.0%

65.7% 0.74
76.4% 0.32
81.0% 0.28
64.5% 0.35
75.1% 0.29
76.3% 0.24
74.7% 0.38
69.0% 0.45
77.2% 0.33
75.9% 0.35
80.5% 0.29
79.8% 0.27
81.1% 0.28
79.5% 0.32
82.2% 0.26
79.4% 0.20
0.21
0.12

0.76
0.42
0.49
0.65
0.66
0.33
0.68
0.72
0.66
0.67
0.66
0.66
0.58
0.65
0.52
0.40
0.18
0.15

0.96
0.93
0.89
0.90
0.91
0.86
0.95
0.92
0.93
0.93
0.92
0.90
0.89
0.92
0.87
0.86
0.03
0.002

0.76
0.37
0.36
0.45
0.41
0.29
0.49
0.54
0.44
0.46
0.41
0.40
0.39
0.43
0.35
0.28
0.19
0.12

average similarities than in order 2, so do average memberships. It illustrates that, to some
extent, networks in the lower order do not have sufﬁcient tributaries to calculate each factor
value in the ﬁtness function, and there is no need to apply a complicated generalization
method to a network with few tributaries.

B.2 Generalized Trellis Networks

For all trellis river networks in Russian river, the statistical results tested by different weight
settings are listed in Table 6.

From Table 6, without considering the length, the average similarity reduces from 81.0
to 69.0% (the decreasing amplitude is 14.8 points). The length factor inﬂuences the similar-
ity a lot. The ﬁrst test shows that pattern membership increased after generalization by
assigning drainage pattern membership (wM) with 0.6 and others with 0.1. Although the
average similarity is low, the pattern has been preserved from the average drainage pattern
membership values in row 1. So, it is useful to take the factor of membership into considera-
tion to preserve or even improve the drainage pattern representation during the generaliza-
tion process. From the last ﬁve tests (rows 11-15), the average similarity is larger than the
method of the stroke and length. The multi-objective method does better than the stroke and

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Genetic Algorithm for Tributary Selection

27

Table 7 Generalized parallel networks results. wM, wO, wL, wB and wS are the weights of drainage
pattern membership, order, length, balance and tributary spacing, respectively

Average Similarity

Average Drainage
Pattern Membership

Weights Setting (wM/wO/wL/wB/wS)

Order 2 Order 3 Total Order 2 Order 3 Total

82.3%
(0.6/0.1/0.1/0.1/0.1)
1
79.4%
(0.1/0.6/0.1/0.1/0.1)
2
91.6%
(0.1/0.1/0.6/0.1/0.1)
3
85.1%
(0.1/0.1/0.1/0.6/0.1)
4
76.3%
(0.1/0.1/0.1/0.1/0.6)
5
73.8%
(0/0.25/0.25/0.25/0.25)
6
73.2%
(0.25/0/0.25/0.25/0.25)
7
60.5%
(0.25/0.25/0/0.25/0.25)
8
79.4%
9
(0.25/0.25/0.25/0/0.25)
91.6%
10 (0.25/0.25/0.25/0.25/0)
91.6%
11 (0.2/0.1/0.5/0.1/0.1)
91.6%
12 (0.1/0.2/0.5/0.1/0.1)
91.6%
13 (0.1/0.1/0.5/0.2/0.1)
91.6%
14 (0.1/0.1/0.5/0.1/0.2)
91.6%
15 (0.3/0.1/0.5/0.1/0)
16 Stroke 1 Length
91.6%
17 River networks at 1:24K scale from the Russian river
18 River networks at 1:100K scale from the NHD

61.5%
62.9%
62.9%
63.6%
61.8%
60.0%
62.9%
60.2%
62.9%
63.8%
64.7%
62.9%
62.9%
62.2%
64.0%
62.9%

63.2% 0.54
64.3% 0.49
65.3% 0.44
65.4% 0.48
63.0% 0.48
61.2% 0.45
63.8% 0.49
60.2% 0.51
64.3% 0.49
66.1% 0.49
66.9% 0.47
65.3% 0.44
65.3% 0.44
64.6% 0.45
66.3% 0.48
65.3% 0.44
0.56
0.64

0.90
0.69
0.73
0.58
0.67
0.26
0.64
0.52
0.69
0.73
0.73
0.73
0.73
0.73
0.73
0.73
0.66
0.46

0.57
0.51
0.47
0.49
0.49
0.43
0.50
0.51
0.51
0.51
0.50
0.47
0.47
0.47
0.50
0.47
0.56
0.63

length method especially in the preservation of the drainage pattern. The weight settings for
wM, wO, wL, wB and wS with 0.1, 0.1, 0.6, 0 and 0.2, respectively are the most proper set-
tings from the statistic results.

B.3 Generalized Parallel Networks

In the dataset, there are no parallel networks in order 4, and most networks are in order 2.
The statistical results are listed in Table 7.

In Table 7, comparing with the result by assigning the weight of balance (wB) with 0.6,
the average similarity is reduced to 64.3 from 65.4% by assigning wB with 0. It shows that
the factor of balance contributes to the similarity to some extent. The length is still the most
important factor during the generalization as the average similarities would decrease (65.3 to
60.2%) if the length is not considered. By assigning the weight of length (wL) with 0.5 and
adjusting weights of other factors, the pattern membership should be set up as the second-
factor. The average similarity is the greatest by assigning wM 5 0.2,
most
wO 5 0.1, wL 5 0.5, wB 5 0.1 and wS 5 0.1. The average similarity is not larger than 70%
due to the inﬂuence of low similarities of networks in order 2. The average similarity of gen-
eralized networks in order 3 is 91.6%. The same situation happens in the average member-
ship in order 3.

important

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

