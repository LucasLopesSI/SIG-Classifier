G   E   O   M   A   T   I   C   A

AN ASSESSMENT OF NONLINEAR
OPTIMIZATION AND SPEEDED UP ROBUST
FEATURES (SURF) ALGORITHM FOR
ESTIMATING OBJECT SPACE TRANSFORMATION
PARAMETERS FOR UAV POSE ESTIMATION

Bassem Sheta, Dr. Mohamed Elhabiby1 and Dr. Naser El-Sheimy
Department of Geomatics Engineering, The University of Calgary, Calgary, Alberta
1 Public Works Department, Faculty of Engineering, Ain Shams University, Cairo, Egypt

Localizing set of features (with known coordinates) on the ground and finding their matches in the image
taken by imaging sensor on the aerial vehicle is the basic concept behind Vision Based Navigation (VBN). The
number of matching points necessary for solving the collinearity equation is a critical factor to be investigated
while using the VBN approach for navigation. Although a robust scale and rotation invariant image matching
algorithm is important for VBN of aerial vehicles, the proper estimation of the collinearity equation object space
transformation parameters improves the efficiency of the navigation process through the real-time estimation of
transformation parameters. These parameters can then be used in aiding the inertial measurements data in the
navigation estimation filter. The main objective of this paper is to investigate the estimation of the object space
transformation  parameters  necessary  for VBN  of  aerial  vehicles  with  the  assumption  that  the  aerial  vehicle
experiences large values of the rotational angles, which will lead to non-linearity of the estimation model. In this
case, traditional least squares approaches will fail or will take longer to estimate the object space transfor-
mation parameters, because of the expected non-linearity of the mathematical model. Five different nonlinear
optimization methods are presented for estimating the transformation parameters – these include four gradient
based nonlinear optimization methods; Trust region, Trust region dogleg algorithm, Levenberg-Marquardt, and
Quasi-Newton  line  search  method  and  one  non-gradient  method;  Nelder-Mead  simplex  direct  search  is
employed for the six transformation parameters estimation process. Assessments of the proposed nonlinear
optimization approaches on the image matching algorithm necessary for the VBN approach are investigated.

La localisation d’une série de caractéristiques (avec des coordonnées connues) sur le terrain et l’observation de
leurs correspondances dans l’image prise par le capteur imageur sur le véhicule aérien constitue le concept de base
derrière la Navigation fondée sur la vision (NFV). Le nombre de points de correspondance nécessaires pour résoudre
l’équation de colinéarité est un facteur essentiel qui doit être examiné lorsqu’on utilise l’approche de NFV pour la navi-
gation. Même si un algorithme rigoureux de correspondance à l’image indépendant de l’échelle et de la rotation est
important pour la NFV des véhicules aériens, l’estimation adéquate des paramètres de transformation de l’équation de
colinéarité entre l’objet et sa position spatiale améliore l’efficience du processus de navigation au moyen de l’estima-
tion en temps réel des paramètres de la transformation. Ces paramètres peuvent ensuite être utilisés en aidant les
données de mesures inertielles dans le filtre d’estimation de navigation. Le principal objectif du présent article est d’exa-
miner l’estimation des paramètres de transformation entre l’objet et sa position spatiale qui sont nécessaires pour la
NFV des véhicules aériens en posant l’hypothèse que le véhicule aérien subit des rotations importantes qui entraînent
une non-linéarité du modèle d’estimation. Dans ce cas, les approches traditionnelles des moindres carrés échoueront
ou prendront plus de temps à estimer les paramètres de transformation entre l’objet et sa position spatiale en raison de
la non-linéarité prévue du modèle mathématique. Cinq méthodes différentes d’optimisation non linéaire sont présentées
pour l’estimation des paramètres de la transformation – elles comprennent quatre méthodes d’optimisation non
linéaire fondées sur les gradients : l’algorithme à régions de confiance, l’algorithme à régions de confiance en ligne
polygonale, la méthode de Levenberg-Marquardt et la méthode de Quasi-Newton par recherche linéaire ainsi qu’une
méthode non fondée sur les gradients; la recherche directe par simplexe de Nelder-Mead est utilisée pour le pro-
cessus d’estimation des six paramètres de la transformation. On examine également les évaluations des approches
proposées d’optimisation non linéaire sur l’algorithme d’appariement d’image requis pour l’approche de la NFV.
1. Introduction

The Unmanned Aerial Vehicles (UAVs) indus-
try  goes  back  to  1916  after  the  first  manned  flight
took  place.  It  started  with  developments  to  the

design and testing of flying bomb or cruise missiles.
However,  UAV  applications  developed  rapidly  and

Bassem Sheta
bimsheta@ucalgary.ca

Mohamed Elhabiby
mmelhabi@ucalgary.ca

Naser El-Sheimy
elsheimy@ucalgary.ca

GEOMATICA  Vol. 66, No. 4, 2012 pp. 307 to 321

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. G   E   O   M   A   T   I   C   A

more research is done into intelligence, surveillance,
and reconnaissance (ISR) missions after the Francis
Gary  Powers  shoot-down  over  Russia  in  1959
[Cook  2007].  In  recent  years,  because  of  the
advancements  in  UAV  technology,  more  UAV
applications have been added to include Unmanned
Ground  (UGVs)  and  Maritime  vehicles  (UMVs).
This large increase in applications for UAVs has led
to an increase in the number of unmanned vehicles
in the military and commercial operation as well.

The reduction of the navigational sensor cost is
considered  a  crucial  factor  in  the  development  of
UAV industry, where the necessary information for
accurate navigation of the aerial platform is provid-
ed by such sensors. Recently, the visual sensors solu-
tion  shows  a  lot  of  promise  in  providing  accurate
navigation  solutions  combined  with  the  traditional
navigation sensors.

Different systems are used for estimating nav-
igation parameters (position and velocity) of aerial
vehicles such as Terrain Contour Matching (TER-
COM), Inertial Navigation System (INS), and GPS.
However, these systems incorporate different limi-
tations  in  the  field  of  aerial  navigation. Typically,
TERCOM  system,  which  is  based  on  calculating
the altitude of the terrain, cannot be used in plain
regions while INS system’s error drift is increased
with time, especially, if it is used alone for naviga-
tion  and  finally,  GPS  systems  can  be  affected  by
other signals and jamming [Dong-Gyu et al. 2002].
Therefore,  many  researchers  have  investigated  a
new method called vision-based navigation, which
can overcome the drawbacks of the other systems
used before [Veth 2011]. This new method depends
mainly  on  image  matching  between  aerial  images
captured during mission and reference images.

The basic idea behind VBN can be defined as
localizing  a  set  of  features  (with  known  coordi-
nates)  on  the  ground  and  finding  their  matches  in
the real time image captured by the visual sensor on
the  UAV.  Then,  through  the  collinearity  equation,
this match is transformed into position information,
which is fused with the INS measurements which
work as a Coordinate Update (CUPT) for the UAV.
Image matching algorithms play a basic role in
many applications such as surveillance, law enforce-
ment, aerial mapping, and navigation of unmanned
land and aerial vehicles. Comparing images pixel by
pixel  (known  as  correlation)  is  one  of  the  classical
image  matching  techniques  [Johnson  and  Kotz
1997]. However, this approach suffers from the high
computation  load  and  may  result  in  innacurate
results  due  to  scale  and  rotation  variations  in  the
matched  images.  To  overcome  the  high  computa-
tional load for the classic correlation, the concept of
Bounded Partial Correlation (BPC) has been intro-

duced [Di Stefano et al. 2005]. In this approach, two
sufficient  conditions  based  on  Cauchy-Schwarz
inequality  at  each  image  position  are  introduced
such  that  the  computational  load  is  reduced.  Using
Cauchy-Schwarz inequality, the upper bound of the
correlation score is computed at each point instead of
computing  the  correlation  process,  which  leads  to
lower  computational  load.  However,  this  did  not
overcome  the  rotation  and  scale  variation  between
the matched images. The block matching approach is
another  method  that  overcomes  the  computational
load problem through parallel processing of blocks
[Alkaabi  and  Deravi 2005;  Mattoccia  et  al. 2007].
However,  the  Block  matching  approach  did  not
cover  the  scale  invariance  problem. To  address  the
texture  features  problem,  Jalil,  et  al.  [2006]  intro-
duced the Principal Component Analysis (PCA) and
wavelet  transform  to  overcome  the  rotation  invari-
ance challenge. This approach estimates the princi-
pal  component  direction  through  PCA  and  rotates
the original image to the angle detected by the PCA.
Then,  the  feature  extraction  is  conducted  by  the
wavelet  transform.  However,  the  use  of  wavelet
transform in feature extraction doesn’t provide scale
and intensity invariance.

Borgefors [1988]  introduced  the  multi-resolu-
tion matching approach. This approach reduced the
computation load through the use of lower resolution
images. However, experimental results indicate that
the  computation  time  achieved  in  the  proposed
approach (8 minutes for an image size of 512 x 512
pixels) is too slow to be employed in real time appli-
cations such as VBN. Fitch et al. [2005] introduced
image  matching  in  the  frequency  domain.  In  this
approach, the number of operations for matching the
surface generation computational load was reduced
by a factor of 820 for image size of 512 × 512 pix-
els.  To  continue  with  image  matching  in  the  fre-
quency domain, Essannouni et al. [2007] introduced
the  L4  norm  as  an  approach  for  a  computationally
efficient approach for image matching. However, the
proposed image matching in the frequency domain
has a disadvantage coming from the overhead result-
ing  from  transforming  back  to  the  spatial  domain,
which affects the real time requirements for VBN.

Berg  et  al.  [2005] and  Makarov [2006]  intro-
duced  the  shape  matching  approach.  In  this
approach, descriptors are based on geometric blur
point which calculates a cost function for the simi-
larity of point descriptors and the geometric distor-
tion. El Oirrak et al. [2002] investigated the same
approach through the use of Fourier descriptors to
describe the shape features.

In  2004,  Lowe [2004] 

introduced  Scale
Invariant  Feature  Transform  (SIFT)  which  outper-
form  other  approaches  for  interest  point  detection

308

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. and  matching.  The  SIFT  approach  is  rotation  and
scale invariant, which is a crucial point to be consid-
ered when dealing with image matching algorithms.
In addition, it is considered a relatively fast approach
for  real-time  application.  However,  when  Lowe
[2004] tried to speed up the algorithm performance
in  the  matching  step  through  the  best-bin-first
approach,  more  mismatches  appeared  which  affect
the matching process.

Employing a robust scale and rotation invariant
image matching algorithm is important for VBN of
aerial  vehicles.  However,  the  proper  estimation  of
the object space transformation parameters improves
the  efficiency  of  the  navigation  process  through
image  matching  by  real-time  estimation  of  trans-
formation  parameters  used  in  aiding  the  inertial
measurements data.

In  this  research  paper,  matches  between  the
geo-referenced database images and those captured
in  real-time  are  examined,  by  employing  the  fast
SURF  algorithm.  SURF,  sometimes  referred  to  as
the Fast-Hessian detector, is essentially based on the
Hessian matrix with Laplacian based detectors such
as Difference of Gaussian (DoG) [Bay et al. 2006].
SURF descriptors describe the gradient information
in the point of interest’s neighborhood through Haar
wavelet responses [Anqi and Dudek 2010].

The number of matches necessary for solving
the  collinearity  equation  is  investigated  through
estimating  object-space  transformation  parameters
using five different nonlinear optimization methods
to  overcome  the  non-linearity  of  the  collinearity
equation, because of expected large rotation angles.
Assessment  of  these  methods  is  done  using  the
SURF  64  and  SURF  128  algorithm  for  image
matching  between  database  images  (stored  on  the
UAV)  and  the  new  real-time  captured  images
(using  the  augmented  visual  sensor)  through  the
investigation  of  the  effect  of  using  different  num-
bers of matching points.

2. A Mathematical Model
for Collinearity Equation

In a VBN system, 3D position and altitude of
the aerial vehicle can be estimated by means of the
conjugate features in the aerial image and geo-ref-
erenced  satellite  image  stored  on  board  (UAV).
Collinearity equations are used for the mathemati-
cal  transformation  between  the  2D  Image  and  3D
object space in stored in the database. This relation
is expressed as shown in figure (1) and equation (1)
[Wolf and Dewitt 2000]:

G   E   O   M   A   T   I   C   A

x p = x pc – f

y p = y pc – f

c11 X p – XPC + c21 Y p – Y PC + c31 Z P – Z PC
c13 XP – XPC + c23 YP – YPC + c33 Z P – Z PC
c12 XP – XPC + c22 YP – YPC + c32 Z P – Z PC
c13 XP – XPC + c23 YP – YPC + c33 Z P – Z PC

1

Figure 1: Collinearity equation model

Where:
(xp, yp)

are the image coordinates.

(Xp, Yp, Zp)
are  the  object  database  ground
coordinates  of  the  conjugate  points  (can  be  deter-
mined after the matching procedure).

(xpc, Ypc, f)
are  the  camera  coordinates  of  the
principal  point  and  principal  distance  which  are
known  as  the  Interior  Orientation  Parameters
(IOP)s  (can  be  determined  by  calibration  of  the
camera before the mission) .

(Xpc, Ypc, Zpc)
are  the  unknown  parameters  which
define the position of projection center of the camera
body in ground coordinate system.

c11, c33
are the elements of the 3D rotation
matrix R containing the rotation angles ω, φ, and κ
between the camera axes and the mapping coordi-
nate system, such that:

Using Taylor’s theorem to linearize equation 1,

these equations are rewritten as:

F = x pc – f m

q = x p

G = y pc – f s

q = y p

2

3

Where:
q = r31 (Xp – Xpc) + r32 (Yp – Ypc) + r33 (Zp – Zpc)
m = r11 (Xp – Xpc) + r12 (Yp – Ypc) + r13 (Zp – Zpc)
s = r21 (Xp – Xpc) + r22 (Yp – Ypc) + r23 (Zp – Zpc)

cos (cid:160) cos (cid:103)

– cos (cid:160) sin (cid:103)

sin (cid:160)

R =

cos (cid:116) sin (cid:103) ! sin (cid:116) sin (cid:160) cos (cid:103) cos (cid:116) cos (cid:103) – sin (cid:116) sin (cid:160) sin (cid:103) – sin (cid:116) cos (cid:160)
sin (cid:116) sin (cid:103) – cos (cid:116) sin (cid:160) cos (cid:103) sin (cid:116) cos (cid:103) ! cos (cid:116) sin (cid:160) sin (cid:103) cos (cid:116) cos (cid:160)

309

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. G   E   O   M   A   T   I   C   A

Applying Taylor’s  theorem  to  equation  2  and
3,  taking  partial  derivatives  with  respect  to  the
unknowns, those equations are expressed as:
(cid:566)F
d(cid:160) " (cid:566)F
(cid:566)(cid:103) !
(cid:566)X PC !
dYP " (cid:566)F
dX P " (cid:566)F

(cid:566)F
(cid:566)Y PC !

dZ P # x p

dX PC "

d(cid:103) "

dYPC "

(cid:566)Y P !

(cid:566)Z P !

F! " (cid:566)F
(cid:566)F
(cid:566)Z PC !

(cid:566)(cid:116) !

d(cid:116) " (cid:566)F
dZ PC " (cid:566)F

(cid:566)(cid:160) !

(cid:566)X P !

(cid:566)(cid:116) !

G! " (cid:566)G
(cid:566)G
(cid:566)Z PC !

"

d(cid:116) " (cid:566)G
(cid:566)(cid:160) !
dZ PC " (cid:566)G

d(cid:160) " (cid:566)G
(cid:566)(cid:103) !
dX P " (cid:566)G

d(cid:103) "

(cid:566)G
(cid:566)X PC !
dYP " (cid:566)G

(cid:566)X P !

(cid:566)Y P !

(cid:566)Z P !

dX PC "

dZ P # y p

(cid:566)G
(cid:566)Y PC !

dYPC

4

5

Where
F0 and G0 are calculated as the initial values for the
unknown parameters in the collinearity equation.
(cid:566)F
(cid:566)(cid:116) !
for  the  unknown  parameters  in  the  collinearity
equation.

$%& ’$(’)($*&+ $, *-& ./.*.$( 0$()&,

!""""! (cid:566)G

(cid:566)(cid:160) !

dw,  dϕ,…,  dZp are  the  corrections  to  be  added  to
the initial values for the unknown parameters.

If the least square approach is used, and notic-
ing that  and  are measured values, residual terms
should  be  added  to  the  equations.  Therefore,  the
linearized  equations  after  adding  these  residuals
can be expressed as:
b11 dω+ b12 dϕ + b13 dκ – b14 dXPC – b15 dYPC – b16
dZPC + b14 dXp + b15 dYP + b16 dZp = j + vxp
6

b21 dω+ b22 dϕ + b23 dκ – b24 dXPC – b25 dYPC – b26
dZPC + b24 dXp + b25 dYP + b26 dZp = K + vyp
7

Where:

b11 ,…, b26, J and K are given as:

b 11 =

f
q 2 m – r33(cid:54)Y + r32(cid:54)Z – q – r13(cid:54)Y + r12(cid:54)Z .
f
q 2 m cos (cid:160)(cid:54)X + sin (cid:116) sin (cid:160)(cid:54)Y – cos (cid:116) sin (cid:160)(cid:54)Z – .
b 12 =
q(–sin ϕ cos κ∆X + sin ω cos ϕ cos κ∆Y – cos ω cos ϕ cos κ∆Ζ)]

b 13 =

– f
q r21(cid:54)X + r22(cid:54)Y + r23(cid:54)Z .
f
q 2 mr31 – qr11 ; b 15=
b 14 =
J = x p – x pc + f m
q .

f
q2

mr32 – qr12 ;b 16 =

mr33 –qr13 .

f
q2

b 21 =

f
q 2 s – r33(cid:54)Y + r32(cid:54)Z – q – r23(cid:54)Y + r22(cid:54)Z .
f
q 2 s cos (cid:160)(cid:54)X + sin (cid:116) sin (cid:160)(cid:54)Y – cos (cid:116) sin (cid:160)(cid:54)Z –
b 22 =
q(sin ϕ cos κ∆X – sin ω cos ϕ sin κ∆Y + cos ω cos ϕ sin κ∆Ζ)]

b 23 =

b 24 =

f
q r11(cid:54)X + r12(cid:54)Y + r13(cid:54)Z .
f
q 2 sr31 – qr21 ; b 25=

310

f
q 2 sr32 – qr22 ; b 26 =

f
q 2 sr33 – qr23 .

K =x p – x pc + f s
q.
∆X = XP – XPC; ∆Y = YP – YPC; ∆Z = ZP – ZPC.

From  the  previous  equations,  the  number  of
necessary  points  (n)  for  the  object  space  transfor-
mation  parameters  in  the  collinearity  equations
should  satisfy  n ≥  3.  If  n ≥  3,  the  number  of  lin-
earized  equations  to  be  solved  is  2n with  6
unknowns to be estimated. These equations in the
matrix form can be expressed as:

A∆x = L + V, where:

∆x = [dω, dϕ, dκ, dXPC, dYPC, dZPC]T can be calcu-
lated using least square approach from (AT A) ∆x =
(AT L).

The determination of parameters through mini-
mization  can  be  considered  as  the  definition  of  a
general  optimization  problem.  Nonlinear  least
squares optimization algorithms can be investigated
through  two  general  approaches.  The  first  one
through  linearization  of  the  collinearity  equation
model, where corrections to the unknown estimated
parameters  are  added  during  the  iteration  steps  on
the  assumption  of  local  linearity,  as  shown  above.
Linearization of the collinearity equation for object
space parameters estimation requires repeated com-
putations iterations that will converge or diverge to a
local or a global minimum based on the initial values
assigned to the unknown transformation parameters
and this approach is clearly investigated in Wolf and
Dewitt [2000].  However,  nonlinear  least  squares
optimization approaches are used in the general case
where  the  aerial  platform  will  lead  to  non-vertical
images.  The  second  one  is  based  on  modifications
made  to  the  steepest  descent  approach,  which  is  a
gradient method. However, for optimal solution, an
optimal interpolation between the two methods can
be used for the representation of the nonlinear model
[Marquardt 1963].

3. Speeded Up Robust
Features (SURF) Algorithm 

Matches between the database images and the
new, real-time captured one are found by employ-
ing  SURF  algorithm.  SURF,  sometimes  called
Fast-Hessian  detector,  is  basically  based  on  the
Hessian matrix with Laplacian based detectors such
as  DoG  [Bay  et  al.  2006].  SURF  descriptors
describes  the  gradient  information  in  the  point  of
interest  neighborhood  through  the  Haar  wavelet
responses [Anqi and Dudek 2010].

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. G   E   O   M   A   T   I   C   A

Figure 3: Discretized and cropped Gaussian and Box filter approximation for
interest point detection [Bay et al. 2006]

3.1 Interest Point Detection

For achieving fast, robust features, SURF algo-
rithm employs the integral images approach which
reduces the computation time.

3.1.1 Integral Images

This  approach  sometimes  is  called  summed
area table [Kruis 2010]. The approach is based on
forming  integral  image    from  summing  of  pixels
intensities of the input image (I) within a rectangu-
lar region formed around location x as the follow-
ing [Bay et al. 2006]:
l (cid:89) x # (cid:89)i # !

l i" j

(cid:89)j # !

j (cid:148) y

i (cid:148) x

8

Figure 2: The summation of the pixels within rectangle 4

The  integral  image  utilizes  three  algebraic
operations to compute the summation of the inten-
sities  in  the  sub-region  of  the  image  as  shown  in
Figure 2. The summation of the pixels within rec-
tangle  4  is  computed  with  four  array  references.
The value of the integral image at location A is the
sum of the pixels in rectangle 1. The value at loca-
tion B is 1+2, at location C is 1+3, and at location
D is 1+2+3+4. The summation within rectangle 4 is
computed as D+A-(B+C).

3.1.2 Hessian Detectors

Hessian  matrix  can  be  employed  as  a  good
detector  due  to  its  good  performance  in  computa-
tion  time  and  accuracy.  Scale  selection  can  be
achieved  through  the  determinant  of  the  Hessian
[Bay  et  al.  2006]  or  through  the  Hessian–Laplace
detector [Mikolajczyk and Schmid 2001].

The hessian matrix H (x, σ) at a given point x =
(x, y) in an image I where x at scale σ is defined as:

x, y =

L xx x, (cid:109) L xy x, (cid:109)
L xy x, (cid:109) L yy x, (cid:109)

9

#!"$%& $’&!’ &!’()*+()!

where Lxx (x, σ) is the convolution of the Gaussian
(cid:44) ,
(cid:566)- , g (cid:109) .(+/ (0*1! I (%
point  x and  similarly  for  Lxy (x, σ)  and  Lyy (x, σ)
[Bay et al. 2006].

10

11

Figure 3 shows, from left to right, the Gaussian
second  order  partial  derivative  in  y  direction  (Lyy),
the xy direction (Lxy) and the box filter approxima-
tion utilized in the SURF algorithm in the y direction
(Dyy) and the xy direction (Dxy).

The box filter approximation was inspired due
to Lowe’s success with the Laplacian of Gaussian
(LOG)  in  the  Scale  Invariant  Feature  Transform
(SIFT).

The  Hessian  matrix  approximation  can  be

expressed as:

det(Happrox) = DxxDyy – (wDxy)2

Where  w  is  the  relative  weight  of  the  filter
response and is given by the following formula for
9×9 box filter and σ = 1.2 [Bay et al. 2006]:

w =

L xy 1.2 F D yy 9 F
L yy 1.2 F Dxy 9 F

Applying  non-maximum  suppression  in  a
3×3×3 neighborhood localizes the interest points in
the image and over scales. Then interpolation of the
determinant of the Hessian matrix in scale and image
space is employed as in Brown and Lowe. (2002).

3.2 SURF Descriptors

The SURF descriptor is based on two steps. The
first one is based on the information coming from a
circular region around the interest point where this
leads to reproducible orientation information. Then,
SURF  descriptor  is  extracted  from  a  square  region
generated  and  aligned  to  the  selected  orientation
[Bay et al. 2006].

The Haar wavelet responses are calculated in x
and y direction in a circular neighborhood with spe-
cific  radius  around  the  detected  interest  point.
These  wavelet  responses  are  weighted  with  a
Gaussian at the center of the detected interest point
and introduced as horizontal vector along x direc-
tion and vertical vector along y direction.

A sliding orientation window at angle of η/3 is
employed,  as  shown  in  figure  4,  to  estimate  the
dominant orientation by calculating the sum of all
responses within this window. Next, a new vector is
generated  by  summing  the  horizontal  and  vertical

311

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. G   E   O   M   A   T   I   C   A

Figure 4: Orientation assignment

responses  within  the  window  where  the  longest
vector  orientation  is  assigned  as  the  interest  point
orientation.

To  establish  descriptor  building,  a  square
region centered on the detected interest point with
orientation along the dominant direction, is used. In
the  case  of  64  descriptor  length  (SURF  64),  the
square  region  is  divided  into  equally  4×4  sub-
regions as shown in Figure 5. As for 128 descriptor
length (SURF 128), several of similar features are
added to the descriptor (dx and |dx| are calculated
for dy<0 and dy>0, the same is applied for dy and
|dy|  which  increases  the  number  of  features)  as
shown in Figure 6.

Figure 5: Descriptor components in SURF 64

312

Figure 6: Descriptor component in SURF 128

4. Nonlinear Optimization
Algorithms

As  mentioned  before,  five  optimization  meth-
ods  will  be  used  with  respect  to  the  object  space
parameters estimation (X, Y, and Z translation vector
and rotation angles ω, φ, and к).

A  general  unconstrained  nonlinear  optimiza-
tion  problem  can  be  described  by  the  following
equation [Teunissen 1990]:

min F(x), x ∈ Rn, F : Rn → R

12

Where:

x

F(x)
Rn

is unknown parameters to be estimated
(object space parameters).
is objective function.
unknowns belong to the Real number.

Iterative  algorithms  are  implemented  to  solve
for minimization of this problem. The main goal is
to  find  a  new  value  to  the  unknown  parameters
(vector  x)  that  leads  to  minimizing  the  objective
function value [Venkataraman 2002].

A  general  solution  to  the  minimization  prob-
lem can be reached through the following scheme:

xk+1 = xk + tkdk, k = 0,1,2,…

13

Where:
xk+1, xk are  the  estimated  unknown  parameters  at
different iteration steps k+1, k respectively.
is positive scalar.
is the search direction vector.

tk
dk

For the purposes of the current research study
for all optimization algorithms tested, the following
steps are followed [Teunissen 1990]:

1. Start the iteration at k=0 with initial values for

the unknown parameters.

2. Determine the search direction vector dk
3. According  to  the  line  search  strategy,  deter-

mine tk such that F(xk+1) ≤ F(xk)

4. Threshold is predefined such that the obtained

solution must satisfy.

5. Stop the iteration when threshold condition is
satisfied and xk+1 will be the solution for equa-
tion 12. Otherwise, k is increased by one and
repeats the procedure steps from 2 to 5.

Depending on this general procedure, the main
difference between the optimization methods used is
the choice of the search direction vector dk and the
scalar tk [El-Habiby et al. 2009] as well as depend-
ing on the objective function itself or its derivative.

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. G   E   O   M   A   T   I   C   A

4.1 Trust Region Algorithm

The  trust  region  approach  for  nonlinear  opti-
mization has been studied for over 50 years [Conn
et al. 2000]. This method is basically considered as
one of the basic descent methods.

At each iteration point xk, define a model mk(x)
to approximate the objective function within a suit-
able neighborhood of xk. This neighborhood is the
trust region. The set of all points defining the trust
region is found in the following equation:

βk = {x∈ Rn ,||x – xk

,||k ≤ ∆k}

14

Where:

∆k
is the trust region radius.
||,,||k is iteration dependent norm.

The  basic  trust  region  algorithm  can  be  sum-

marized as the following [Conn et al. 2000]:

1. Start  with  the  initial  point  x0  and  initial  trust

region radius ∆0. 

2. Define set of constants η1,η2,γ1, and γ2 satisfy-
ing this conditionand 0 < η1 ≤ η2 < 1 and 0 < γ1
≤ γ2 < 1.

3. Calculate f(x0) and put k = 0.
4. Choose  ||.||k and  define  the  approximation

model mk in βk.

5. Calculate  a  step  sk to  minimize  the  model  mk

satisfying xk + sk ∈ βk.

6. Calculate f(xk + sk) and define a parameter (ρ)

f xk ’ f xk ( sk
) If (cid:108) k (cid:149) (cid:100)*+
!"#$" #% (cid:108) k &
mk xk ’ mk xk ( sk
then set xk+1 = xk + sk; otherwise, set xk+1 = xk.

7. Update the trust region radius according to 

(cid:54) k + 1(cid:68)

(cid:54) k,(cid:39)
(cid:97) !(cid:54) k,(cid:54) k
(cid:97) "(cid:54) k,(cid:97) 2(cid:54) k
8.
Increasek k by 1 and repeat the process.

if (cid:108) k > (cid:100)2
if (cid:108) k(cid:68) (cid:100)"#(cid:100)!
if (cid:108) k < (cid:100)1

The trust region method is considered a gradient
based  method  where  the  search  direction  will  be
evaluated  using  the  gradient  of  the  objective  func-
tion.  In  this  method,  the  model  mk(x)  is  quadratic
model  of  the  objective  (based  on  the  second-order
Taylor series of f at xk). This helps to minimize the
number of iterations required for the convergence.

4.2 Trust Region Dogleg Algorithm
At each iteration point xk, the trust region sub-
problem where the quadratic model is used; can be
expressed as:

mk xk + sk = f xk + gk,sk + 1
2

sk, skk

15

Where:

gk is the gradient ∇f(xk).
Hk is the Hessian approximation matrix.

This algorithm is based on computing the step
d,  which  minimizes  the  model  described  above
using the Powell dogleg procedure. For a detailed
description  about  Powell  method,  see  Powell
[Powell 
Research
Establishment 1968]. 

Energy 

Atomic 

and 

The step d is found from a convex combination
of a Cauchy step (a step along the steepest descent
direction)  and  a  Gauss-Newton  step  for  F(x). The
Cauchy step is calculated as:

dc = – α J(xk)T F(xk)

Where  α is  chosen  to  minimize  the  model

described.

The Gauss-Newton step is found by:
J(xk)dGN = – F(xk)

The step d is chosen such that:

d = dc + µ (dGN + dc)

16

17

18

Where  μ  is  the  largest  value  in  the  interval  [0,  1]
such that ||d|| ≤ ∆. 

The  trust  region  dogleg  method  is  a  gradient
based optimization method. The cost of computing
the dogleg paths in addition to the Cauchy and the
Gauss-Newton steps increases the number of itera-
tions more than the trust region approach.

4.3 Quasi-Newton Line
Search Algorithm

In  this  algorithm  the  Hessian  matrix  of  the
collinearity equation is updated using the Broyden,
Fletcher,  Goldfarb,  and  Shanno  (BFGS)  update
where  this  update  is  function  of  the  gradient
[Broyden 1970].

This algorithm can be described as the following:
1. Start with an initial point xi and an approxima-

2. The  search  direction  dk is  calculated  by  solv-

tion Hessian matrix Hk.

ing: Hkdk = – ∇ f(xk)

3. Find  an  acceptable  step  size αk in  the  search
direction found in the previous step through a
line search, then update xk + 1 = xk + αk dk

4. Let sk = αk dk
5. Let υk = ∇ f (xk + 1) – ∇ f (xk)
6.

H k + 1 = H K +

T
(cid:112) k(cid:112) k
Tsk
(cid:112) k

–

H ksk H ksk
TH ksk
sk

T

313

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. G   E   O   M   A   T   I   C   A

In  this  method,  instead  of  computing  the  true
Hessian  as  in  Newton’s  method,  an  approximation
that is based on the change in gradient between iter-
ations  will  be  used.  The  primary  advantage  is  that
there is no need to compute the exact Hessian at each
point, which may be computationally expensive.

4.4 Levenberg-Marquadrt Algorithm
In  this  algorithm  a  scalar  α is  introduced  to
help the choice of the magnitude and the direction
of the descent such that Gauss-Newton algorithm is
modified  using 
trust  region  approach.
Determination  of  using  either  the  Gauss-Newton
method  direction  or  the  steepest  descent  method
direction is done by this scalar. The search direction
is computed by [Luenberger 1984]:

the 

J TC y

– 1J + (cid:95)l d k = – JF xk

19

Where:

Cy is positive definite observation covariance matrix.
If α = 0, the Gauss-Newton approach is real-
ized  and  if  α has  big  values,  the  steepest  descent
method is realized. Calculating the size of (α) such
that the algorithm is efficient in each iteration step
is the challenge in the Levenberg-Marquardt algo-
rithm.  The  relative  nonlinearity  of  the  objective
function F(x) is estimated by a linear predicted sum
of flps (xk) squares  to control the step size:

flps(xk) = J(xk – 1)dk – 1 + F(xk – 1)

20

and an estimate of the minimum fci(x) is cubically
interpolated, where fci(x) is calculated by cubically
interpolating f(xk) and f(xk – 1) [Marquardt 1963]. 
When flps(xk) is greater than fci(x), reduce α or,
to ensure that f(xk + 1) < f(xk) at each iteration step,
it  is  increased  such  that  the  descent  algorithm
towards  the  solution  is  maintained  [Nocedal  and
Wright 1999; Fletcher 2000].

4.5 Nelder-Mead Simplex Direct
Search Algorithm

This algorithm was first published in 1965 and
is  used  in  multidimensional  unconstrained  mini-
mization  problems.  Since  this  algorithm  achieves
minimization  for  the  objective  function  based  on
the function values without any derivative informa-
tion, it is categorized in the direct search methods
[Lagarias et al. 1998].

A  simplex  in  n-dimensional  space  is  created
and represented by n+ 1 distinct vector, where n is
the  length  of  unknown  x  to  be  evaluated  to  mini-
mize the objective function.

From  the  original  paper  of  Nelder-Mead
[Nelder and Mead 1965], the objective function f(x)
is minimized through using four coefficients, where
they  should  satisfy  particular  conditions.  These
parameters  are  reflection (ρ),  expansion (χ),  con-
traction (γ), and shrinkage (σ).

This algorithm can be described as the follow-

ing:

1. Order: based on the vertices values at: f(x1) ≤
f(x2) .....≤ f(xn + 1)
2. Reflection: the  reflection  point  is  evaluated

n

xr = x + (cid:108) x – xn + 1 where x = (cid:89) i = 1

xi
n is the cent-
roid  of  all  vertices  except  xn+1.  Evaluate  f(xr).  if
f(x1) ≤ f(xr) < f(xn), the reflected point xr is accept-
ed and the iteration is terminated.
3. Expansion:

if  f(xr)  <  f(x1)  the  expanded  point  xe is

a.
evaluated. 

xe = x + (cid:114) xr – x = (cid:108)(cid:114) x – xn – 1 . Evaluate f xe

4. Contraction:

If f(xe) < f (xr), replace the worst point xn + 1
with the expanded point xe, and stop the iteration.
If f(xe) ≥ f (xr), change the worst point xn + 1
b.
with the reflected point xr, and stop the iteration.

a.

if f(xn) ≤ f (xr) < fxn + 1, evaluate the contacted

!"#$% xc & x ’ (cid:97) xr ( x ) *+ f xc (cid:148) f xr ,

change the worst point xn + 1 with the contracted
point xc, and stop the iteration. 
Else go to step 5.
b.
point xcc = x – (cid:97) x – xn + 1 .

if f (xr) ≥ f(xn + 1), evaluate the contacted

If f(xcc) ≤ f (xn + 1), change the worst point xn + 1
with the contracted point xcc, and stop the itera-
tion. Else go to step 5.

5. Reduction: evaluate f at n points xi = x1 + σ 

(xi – x1) for all i = 2,…,n+1.
Since  this  method  is  basically  a  non-gradient
optimization method, it is predicted that it will fail
due  to  its  dependency  on  the  objective  function
only, without any derivative information.

5. Performance Analysis
5.1 Nonlinear Optimization
Algorithms Performance

Tests were conducted on the optimization algo-
rithms using simulated data starting with the near-

314

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. G   E   O   M   A   T   I   C   A

Table 1: Initial Values for the Object Space Parameters

vertical  aerial  photo  assumption  captured  with  a
152.916 mm focal length camera. The tests were done
using three ground control points 1 through 3 listed in
Table  2.  Image  coordinates  and  ground  control
coordinates of the three points are listed in Table 2.

Five  nonlinear  optimization  approaches  were
introduces for estimating object space transforma-
tion  parameters,  which  are  necessary  for  the
process of pose estimation of UAV VBN approach.
Convergence  of  these  methods  were  introduced
using  the  near  vertical  assumption  and  with  the
general tilted photograph case. These methods are
basically  categorized  as  gradient  methods  (Trust
Region,  Trust  Region  Dogleg,  Levenberg-
Marquadrt method, and Quasi-Newton Line Search
method)  and  non-gradient  methods  (Nelder-Mead
simplex direct search method).

Results  shown  in  table  3  to  10  show  that  the
Nelder-Mead method has failed due the dependen-
cy  on  the  objective  function  only,  without  any
derivative information.

As  for  gradient  methods,  tests  showed  differ-
ent results in solving for the object space parame-
ters  based  on  the  initial  value  for  φ. As  for  trust
region dogleg method, good results were achieved
till  φ  =  20°  and  then  the  number  of  iterations
increased and the algorithm did not converge since
the degree of the nonlinearity was increased and the
computed  step  d  failed  to  minimize  the  model
described  in  equation  14.  As  for  the  Levenberg-
Marquardt  approach,  it  is  as  a  modified  Gauss-
Newton algorithm using the trust region approach
where a scalar is used to help the choice of the mag-
nitude and the direction of the descent. Depending
on  this  scalar,  either  the  Gauss-Newton  method
direction or the steepest descent method direction is
determined.  Therefore,  the  Levenberg-Marquardt
method converged when φ = 0°. However, it didn’t
converge  once  φ  is  increased  from  0°.  This  was
predicted  since  the  relative  nonlinearity  of  the
objective  function,  shown  in  equation  18  is  esti-
mated by a linear predicted sum of squares to con-
trol the step size which will fail to converge as φ
increases  above  0°.  As  for  the  Quasi-Newton
method, it converged for all values of φ since this
algorithm  is  based  on  the  Hessian  matrix  of  the
collinearity  equation  which  is  updated  using  the
Broyden,  Fletcher,  Goldfarb,  and  Shanno  (BFGS)
update. This update is a function of the gradient. 

As for the number of GCPs needed for conver-
gence,  the  object  space  transformation  parameters
were  successfully  estimated  using  3  GCPs.
Therefore,  the  image  matching  approach  is
assessed such that only three matches are needed,
which  reduces  the  time  needed  for  the  image
matching  process.  These  matches  are  the  input  to

Omega (rad) Phi (rad) Kappa (rad) XL (m) YL (m) ZL (m)

Value

0

0

1.7947 

1009.923 1038.056 649.614

Table 2: Image Points and Ground Control Points (GCP) Coordinates

Image coordinates (mm)

Ground Control Coordinates (m)

Point

x

y

X

Y

Z

1

2

3

86.421

-83.977

1268.102

1455.027

22.606

-100.916

92.582

732.181

545.344

22.299

-98.322

-89.161

1454.553

731.666

22.649

Table 3: Performance of Optimization Methods with initial φ (deg) = 0

Object Space Trust Region  Trust Region Levenberg-
parameters

Dogleg

Marquardt Newton line Mead

Quasi-

Nelder-

δ⍵ (rad)

δφ (rad)

δК (rad)

δXL (m)

0.059

0.021

0.004

21.50

δYL (m)

6.274

δZL (m)

0.361

No. of Iteration

4

0.076

0.003

0.011

17.93

6.058

1.416

2

search

simplex
direct 
search

0.008

0.021

0.051

0.007

0.050

0.021

0.0004

0.048

0.017

17.933

17.933

19.669

6.057

1.417

1

6.058

57.502

1.416

4.502

2

158

Table 4: Performance of Optimization Methods with initial φ (deg) = 5

Object Space Trust Region Trust Region Levenberg-
parameters

Dogleg

Marquardt Newton line Mead

Quasi-

Nelder-

search

0.049

0.050

0.045

simplex
direct
search

0.007

0.072

0.002

δ⍵ (rad)

δφ (rad)

δК (rad)

0.065

0.026

0.004

0.059

0.058

0.026

0.029

0.731

0.647

δXL (m)

21.046

44.462

297.345

17.933

127.438

δYL (m)

6.384

9.413

365.369

6.058

17.553

δZL (m)

0.13

12.096

535.928

1416

63.175

No. of Iteration

2

2

55

2

142

315

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. G   E   O   M   A   T   I   C   A

Table 5: Performance of Optimization Methods with initial φ (deg) = 10

Object Space Trust Region Trust Region Levenberg-
parameters

Dogleg 

Quasi-

Nelder-

Marquardt Newton line Mead
search
simplex
direct
search

0.047

0.109

0.063

0.032

0.728

0.644

0.045

0.050

0.037

0.007

0.148

0.018

14.67

362.236

6.058

11.388

31.887

532.772

1.417

33.672

δ⍵ (rad)

δφ (rad)

δК (rad)

δYL (m)

δZL (m)

0.058

0.030

0.008

6.672

1.262

δXL (m)

23.233

78.689

297.885

17.933

166.201

No. of Iteration

3

3

48

2

153

Table 6: Performance of Optimization Methods with initial φ (deg) = 15

Object Space Trust Region Trust Region Levenberg-
parameters

Dogleg

Marquardt Newton line Mead

Quasi-

Nelder-

simplex
direct
search

0.007

0.235

0.006

δ⍵ (rad)

δφ (rad)

δК (rad)

δXL (m)

δYL (m)

δZL (m)

0.055

0.036

0.021

7.493

5.905

0063

0.097

0.068

0.033

0.725

0.641

0.041

0.050

0.025

31.988

78.031

298.405

17.933

228.742

18.594

359.337

6.058

12.639

31.444

529.787

1.417

37.796

No. of Iteration

4

3

44

3

142  

Table 7: Performance of Optimization Methods with initial φ (deg) = 20

Object Space Trust Region Trust Region Levenberg-
parameters

Dogleg

Marquardt Newton line Mead

Quasi-

Nelder-

search

0.032

0.049

0.005

simplex
direct
search

0.007

0.305

0.020

δ⍵ (rad)

δφ (rad)

δК (rad)

δXL (m)

0.053

0.090

0.053

0.049

0.198

0.137

0.035

0.723

0.638

66.836

142.211

298.797

17.933

280.881

δYL (m)

11.709

36.664

357.216

6.058

18.823

δZL (m)

26.114

74.913

527.565

1.417

62.472

No. of Iteration

6

4

42

3

155

316

the  collinearity  equations  parameters  estimation
problem.

5.2 SURF 64 and SURF 128
Implementation With Different
Number of GCP

To test the SURF methodology, which include
different  numbers  of  descriptor  length  (SURF-64,
and SURF 128), an airborne image data set, captured
over British Columbia was used. Performance of the
proposed  methodology  against  scale  and  rotation
variation is investigated. The data set was collected
during  a  flight  test  with  vertical  camera  axis.  The
camera specification is given in Table 11. 

Tests were conducted using the original image
as a representative of the database and a rotated and
scaled  image  as  a  representation  of  the  real-time
images captured from the aerial vehicle. Tests were
done for the SURF 64 and SURF 128 with a differ-
ent number of GCPs, resulting from the matching
algorithms  and  with  different  rotation  and  scaling
variation after applying transformation matrix 

T = Tscale * Trotation

Where: Tscale =

and Trotation =

s 0 0
0 s 0
0 0 1
0
0
1

cos (cid:101) sin (cid:101)
– sin (cid:101) cos (cid:101)

0

0

After  the  matching  process  is  done,  least
square approach is used to test the confidence in the
matched  points  coming  from  the  matching  algo-
rithm by getting back the scale and rotation varia-
tion. Computing the residuals in this process should
indicate  the  matching  process  quality  analytically
in  addition  to  visual  inspection  as  showed  in  the
following figures. This approach is done after sort-
ing the matching points based on the Euclidean dis-
tance values between each point and its correspon-
ding  point  based  on  the  neighbourhood  of  each
point coming from the matching process.

Three and four GCPs are matched between the
original  image  as  a  representative  of  the  database
images,  and  a  rotated  and  scaled  image  as  repre-
sentation of the real-time images captured from the
aerial vehicle.

As  shown  in  Figures  7  to  10,  the  proposed
algorithm,  with  different  descriptor  length,  has  a
robust performance against scale and rotation vari-
ation. Figure 9 and Figure 10 demonstrate that the
performance  of  the  interest  point  detection  algo-
rithm  is  improved  when  using  3  matches  rather

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. G   E   O   M   A   T   I   C   A

than 4 matches since these points have been sorted
based  on  the  Euclidean  distance  between  descrip-
tors on the neighborhood of each pair.

Results  clearly  show  that,  when  using  SURF
128 where a couple of similar features is added to
the descriptor (dx and |dx| are calculated for dy < 0
and  dy ≥  0  and  similarly  for  dy and  |dy|  which
increases  the  number  of  features),  there  is  no  sig-
nificant  difference  between  SURF  64  and  SURF
128  when  3  matches  is  needed  to  be  used  as  an
input to the camera pose estimation stage where the
nonlinear  optimization  algorithms  will  be  used.
This  result  encourages  the  investigation  to  SURF
36 to test the effect of employing short descriptors
with  3×3  sub-regions  on  the  performance  of  the
matching algorithm.

Conclusion

the
Real-time  nonlinearity  problem  of 
collinearity  equation  for  proper  estimation  of  the
object space transformation parameters (X, Y, and Z
translation vector and rotation angles ⍵, φ, and к)
has been investigated. The proposed methods cov-
ered both gradient and non-gradient based nonlin-
ear  optimization  approaches.  As  for  the  gradient
based  nonlinear  optimization  approaches,  it  cov-
ered  both  first  order  and  second  order  gradient
methods to achieve the fastest method for solving
the collinearity equation nonlinearity problem. 

The  object  space  transformation  parameters
were  successfully  estimated  by  the  Quasi-Newton
approach  with  three  ground  control  points.  This
leads to reducing the number of matches needed for
estimating  the  parameters  mentioned  above.
Therefore,  the  image  matching  approach  used  in
detecting  the  necessary  points  needed  for  object
space  transformation  parameters  estimation  is
assessed  such  that  the  time  needed  for  the  image
matching process is reduced.

References

Alkaabi, S. and F. Deravi. 2005. Block matching in rotat-
ed images. Electronics Letters- IEE 41(4): 181. 
Anqi, X. and G. Dudek. 2010. A vision-based boundary
following framework for aerial vehicles. Intelligent
Robots  and  Systems  (IROS),  2010  IEEE/RSJ
International Conference on.

Bay,  H.,  T.  Tuytelaars,  and  J.  Malik  2006.  SURF:
Speeded  up  Robust  Features.  Computer  Vision  -
Eccv  2006,  Pt  1,  Proceedings.  A.  Leonardis,  H.

Table 8: Performance of Optimization Methods with initial φ (deg) = 25

Object Space Trust Region Trust Region Levenberg-
parameters

Dogleg

Marquardt Newton line Mead

Quasi-

Nelder-

search

0.021

0.049

0.021

simplex
direct
search

0.007

0.367

0.081

0.057

0.417

0.297

0.036

0.722

0.636

110.221

355.848

6.058

12.676

207.172

526.124

1.417

96.331

δ⍵ (rad)

δφ (rad)

δК (rad)

δYL (m)

δZL (m)

0.054

0.039

0.028

8.382

6.332

δXL (m)

32.591

269.341

299.053

17.933

317.632

No. of Iteration

5

6

41

1

145  

Table 9: Performance of Optimization Methods with initial φ (deg) = 30

Object Space Trust Region Trust Region Levenberg-
parameters

Dogleg

Marquardt Newton line Mead

Quasi-

Nelder-

search

0.005

0.049

0.061

simplex
direct
search

0.007

0.372

0.032

0.081

0.605

0.496

0.051

0.701

0.611

252.292

335.329

6.058

72.918 

396.564

502.321

1.417

9.056

δ⍵ (rad)

δφ (rad)

δК (rad)

δYL (m)

δZL (m)

0.061

0.049

0.031

8.963

9.808

δXL (m)

38.772

327.116

303.414

17.933

303.152

No. of Iteration

7

7

35

2

152

Table 10: Performance of Optimization Methods with initial φ (deg) = 45

Object Space Trust Region Trust Region Levenberg-
parameters

Dogleg

Marquardt Newton line Mead

Quasi-

Nelder-

search

0.033

0.047

0.167

simplex
direct
search

0.007

0.418

0.268

δ⍵ (rad)

δφ (rad)

δК (rad)

δXL (m)

0.062

0.054

0.047

0.093

0.589

0.487

0.102

0.591

0.471

42.567

323.951

316.447

17.932

310.099

δYL (m)

12.072

281.309

263.707

6.058

160.33

δZL (m)

11.593

410.709

381.079

1.417

17.023

No. of Iteration

8

8

23

3

170

317

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. G   E   O   M   A   T   I   C   A

Figure 7: Number of matches = 4, s = 0.6 and θ = 30 with SURF 64 to the left and SURF 128 to the right

Figure 8: Number of matches = 3, s = 0.6 and θ = 30 with SURF 64 to the left and SURF 128 to the right

Table 11: Camera and flight specification

Focal length

Pixel size

60.735 mm

6.8 μm

CMOS format

53.9×40.4 mm (8984×6732 pixels)

Flying height

1000 m  

Bischof  and  A.  Pinz.  Berlin,  Springer-Verlag
Berlin. 3951: 404-417.

Berg, A.C., T.L. Berg, and J. Malik. 2005. Shape match-
ing and object recognition using low distortion cor-
respondences.  Computer  Vision  and  Pattern
Recognition,  2005.  CVPR  2005.  IEEE  Computer
Society Conference on.

Borgefors,  G.  1988.  Hierarchical  chamfer  matching:  a
parametric  edge  matching  algorithm.  Pattern
Analysis  and  Machine 
IEEE
Transactions on 10(6): 849-865.

Intelligence, 

Brown, M., and D. Lowe. 2002. Invariant Features from
Interest Point Groups In: BMVC 2002: 13th British
Machine Vision Conference, 2002-09-02 - 2002-09-
05, Cardiff.

318

Broyden,  C.G.  1970.  The  Convergence  of  a  Class  of
Double-rank  Minimization  Algorithms  1.  General
Journal  of  Applied
IMA 
Considerations.” 
Mathematics 6(1): 76-90.

Conn, A.R.,  N.I.M.  Gould,  and  P.L. Toint. 2000. Trust-
region  methods.  Philadelphia,  PA,  Society  for
Industrial and Applied Mathematics.

Cook,  K.L.B.  2007.  The  Silent  Force  Multiplier:  The
History  and  Role  of  UAVs  in  Warfare. Aerospace
Conference, 2007 IEEE.

Di  Stefano,  L.,  S.  Mattoccia,  and  F.  Tombari.  2005.
ZNCC-based template matching using bounded par-
tial correlation. Pattern Recognition Letters 26(14):
2129-2134.

Dong-Gyu,  S.,  P.  Rae-Hong, K.  Rin-Chul,  and  L.  Sang
Uk. 2002. Integrated position estimation using aeri-
al image sequences. Pattern Analysis and Machine
Intelligence, IEEE Transactions on 24(1): 1-18.
El-Habiby,  M.M.,  Y.  Gao,  and  M.G.  Sideris.  2009.
Comparison  and  Analysis  of  Non-Linear  Least
Squares  Methods 
3-D  Coordinates
for 
Transformation. Survey Review 41(311): 26.
El  Oirrak,  A.,  M.  Daoudi,  and  D.  Aboutajdine.  2002.
Estimation  of  general  2D  affine  motion  using
Fourier  descriptors.  Pattern  recognition. 35:  223-
228.

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. G   E   O   M   A   T   I   C   A

Figure 9: Number of matches = 3, s = 0.6 and θ = 15 with SURF 64 to the left and SURF 128 to the right

Figure 10: Number of matches = 4, s = 0.6 and θ = 15 with SURF 64 to the left and SURF 128 to the right

Essannouni,  F.,  R.O.H.  Thami,  D.  Aboutajdine  and  A.
Salam. 2007. Fast L4 template matching using fre-
quency domain. Electronics Letters- IEE 43(9): 507.
Fitch,  A.J.,  A.  Kadyrov,  W.J.  Christmas  and  J  Kittler.
2005.  Fast  robust  correlation.  Image  Processing,
IEEE Transactions on 14(8): 1063-1073.

Fletcher,  R.  2000.  Practical  Methods  of  Optimization.

Chichester, Wiley.

Jalil,  A.,  I.M.  Qureshi,  A.  Manzar,  and  R.A.  Zahoor.
2006. Rotation-Invariant Features for Texture Image
Classification.  Engineering  of  Intelligent  Systems,
2006 IEEE International Conference on.

Johnson, N.L. and S. Kotz. 1997. Leading personalities
in statistical sciences-: from the seventeenth century
to the present. New York, Wiley.

Kruis,  M.  2010.  Human  pose  recognition  using  neural
networks,  synthetic  models,  and  modern  features.
Electrical  Engineering.  Stillwater,  OK,  Oklahoma
State University. Master Of Science 64.

Lagarias, J.C., J.A. Reeds, M.H. Wright and P.E. Wright.
1998.  Convergence  properties  of  the  Nelder-Mead
simplex  method  in  low  dimensions.  Siam  Journal
on Optimization 9(1): 112-147.

Lowe,  D.G.  2004.  Distinctive  Image  Features  from
Scale-Invariant Keypoints. International Journal of
Computer Vision 60(2): 91-110.

Luenberger, D.G. 1984. Linear and nonlinear program-

ming. Reading, Mass., Addison-Wesley.

Makarov, A.M.M. 2006. Binary shape coding using finite
automata. IEE proceedings. Vision, image, and sig-
nal processing 153(5): 695.

Marquardt, D.W. 1963. An Algorithm for Least-Squares
Estimation of Nonlinear Parameters. Journal of the
Society  for  Industrial  and  Applied  Mathematics
11(2): 431-441.

Mattoccia,  S.,  F.  Tombari,  L.D.  Stefano  and  M.
Pignoloni. 2007. Efficient and optimal block match-
ing for motion estimation. Proceedings of the 14th
International  Conference  on  Image  Analysis  and
Processing, IEEE Computer Society: 705-710.
Mikolajczyk, K. and C. Schmid. 2001. Indexing based on
scale  invariant  interest  points.  Computer  Vision,
2001.  ICCV  2001.  Proceedings.  Eighth  IEEE
International Conference on.

Nelder, J.A. and R. Mead. 1965. A Siples-Method for Function
Minimization. Computer Journal 7(4): 308-313.

319

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. G   E   O   M   A   T   I   C   A

Figure 9: Performance of SURF 64 with 3 matches and 4 matches with different rotation angles

Figure 10: Performance of SURF 128 with 3 matches and 4 matches with different rotation angles

Nocedal, J. and S.J. Wright. 1999. Numerical optimiza-

tion. New York, Springer.

Powell,  M.J.D.  and  H.  Atomic  Energy  Research
Establishment.  1968.  A  Fortran  Subroutine  for
Solving Systems of Nonlinear Algebraic Equations.
United Kingdom.

Teunissen,  P.J.G.  1990.  Nonlinear 

least  squares.
Manuscripta Geodaetica 15 (Copyright 1990, IEE):
137-150.

Venkataraman, P. 2002. Applied optimization with MAT-

LAB programming. New York, Wiley.

Veth, M.J. 2011. Navigation Using Images, A Survey of
Techniques. Navigation 58(2): pp. 127-139.
Wolf,  P.R.  and  B.A.  Dewitt.  2000.  Elements  of  pho-
togrammetry  :  with  applications  in  GIS.  Boston,
McGraw-Hill.

MS Rec’d 12/02/27
Revised MS Rec’d 12/11/30

320

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. G   E   O   M   A   T   I   C   A

Authors

Bassem Sheta is currently a PhD-candidate in
the  Department  of  Geomatics,  Schulich  of
Engineering, University of Calgary. He is a mem-
ber of Mobile Multi-sensor Research Group, where
he conducts research in the area of the integration
of  Mobile  Mapping  data  from  different  platforms
such  as  Inertial  Navigation  System  (INS),  Global
Positioning  System  (GPS),  and  medium  format
cameras  which  used  for  navigation  of  airborne
vehicles. Mr. Sheta’s research aims to develop and
implement a comprehensive fast and real-time low
cost VBN  system  for  UAVs. This  implementation
will  be  done  by  simulated  visual  measurements
combined  with  a  simulated  GPS/INS  path  at  low
altitude.  In  1998,  he  received  his  Bachelor  of
Science in Electrical engineering. In 2005, he grad-
uated  with  a  Master’s  of  Science  degree  from  the
electrical engineering department.

Dr.  Mohamed  Elhabiby is  a  senior  research
engineer  at  the  Mobile  Mapping  Multi-Sensors
Systems  Research  group  at  the  University  of
Calgary,  Calgary,  Alberta.  Currently,  he  is  the
Treasure  of  the  Geodesy  Section  at  the  Canadian
Geophysical  Union  and  he  is  a  leader  of  an
Archaeological  Mission  at  the  Area  of  Great
Pyramids, Cairo, Egypt. Dr. Elhabiby is the Chair
of  WG  4.1.4: 
Imaging  Techniques,  Sub-
Commission  4.1:( Alternatives  and  Backups  to
GNSS. Dr. Elhabiby is and was the co-investigator
in  several  industrial  research  projects  in  Canada
and internationally in the field of mobile mapping,
Structure  health  monitoring,  and  Archeological
exploration. His research expertise includes Multi-
dimensional  Multi-resolution  signal  processing,
Remote sensing, Geomatics system integrations for
high  precision  applications,  Gravity,  LIDAR  and
GNSS/DGPS/LORAN systems. Dr. Elhabiby pub-
lished more than 80 academic journals, conference,
Patents, book Chapters and workshop proceedings.

He received more than 8 academic awards.  He won
Bibliotheca Alexandria  Center  for  Special  Studies
and  Programs  (CSSP)  Grant  for  the  year  2008  in
engineering sciences and technologies – One of ten
winners selected from over 100 international appli-
cants.  Dr. Elhabiby is a regular reviewer and ses-
sion chairman for several well known journals and
conferences and is a member of supervising com-
mitted  and  graduated  four  Masters  and  five  PhD
students at University of Calgary, Canada and Ain
Shames University, Egypt.

Dr. Naser El-Sheimy is Professor at Department
of  Geomatics  Engineering,  at  The  University  of
Calgary. He holds a Canada Research Chair (CRC) in
Mobile  Multi-sensor  Systems  and  the  scientific
director  of  Tecterra  Research  Centre.  His  research
expertise  includes  GPS/INS  integration,  multi-sensor
systems, and mobile mapping systems. Prior to joining
The  University  of  Calgary,  Dr.  El-Sheimy  held  the
position  of  VP  R&D  with  VISAT  Technologies
Inc.,  a  high-tech  company  in  Montreal.  Dr.  El-
Sheimy published two books and over 350 papers
in  academic  journals,  conference  and  workshop
proceedings,  in  which  he  has  received  over  30
national and international paper awards. He organ-
ized  and  participated  in  organizing  many  national
and international conferences.  Dr. El-Sheimy is the
president  of  Commission  I  on  “Sensors  and
for
Platforms”  of 
Photogrammetry  and  Remote  Sensing  (ISPRS)  and
the  general  chair  of  the  USA  Institute  of  Navigation
Global Navigation Satellite Systems (GNSS). Dr. El-
Sheimy is currently a member of the Editorial Board of
the  Journal  of  Survey  Review,  Journal  of  Applied
Geodesy, and Coordinates. He served as a member of
the  Alberta  Geomatics  Group  Board  of  Directors,
Geoide NCE Board of Directors, Technical Committee
Member  of  the  ASPRS  Direct  Georeferencing
Committee,  regular  reviewer  for  the  Journal  of
Geodesy,  Journal  of  Photogrammetric  Record,  the
Photogrammetric  Engineering  and  Remote  Sensing
Journal and other scientific journals. !

International  Society 

the 

321

Geomatica Downloaded from www.nrcresearchpress.com by YORK UNIV on 12/10/18For personal use only. 