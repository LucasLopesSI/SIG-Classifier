The Cartographic Journal
The World of Mapping

ISSN: 0008-7041 (Print) 1743-2774 (Online) Journal homepage: http://www.tandfonline.com/loi/ycaj20

Improving the Quality of Cartographic Colour
Reproduction Using the Self-Organizing Map
Method

Mingguang Wu, A-Xing Zhu & Li He

To cite this article: Mingguang Wu, A-Xing Zhu & Li He (2018) Improving the Quality of
Cartographic Colour Reproduction Using the Self-Organizing Map Method, The Cartographic
Journal, 55:3, 273-284, DOI: 10.1080/00087041.2017.1414106

To link to this article:  https://doi.org/10.1080/00087041.2017.1414106

Published online: 18 Oct 2018.

Submit your article to this journal 

Article views: 25

View Crossmark data

Full Terms & Conditions of access and use can be found at
http://www.tandfonline.com/action/journalInformation?journalCode=ycaj20

THE CARTOGRAPHIC JOURNAL
2018, VOL. 55, NO. 3, pp. 273–284
https://doi.org/10.1080/00087041.2017.1414106

REFEREED PAPER

Improving the Quality of Cartographic Colour Reproduction Using the
Self-Organizing Map Method

Mingguang Wu, A-Xing Zhu and Li He

Mingguang Wu and A-Xing Zhu, Key Laboratory of Virtual Geographic Environment of Ministry of Education, Nanjing Normal University,
Nanjing, People’s Republic of China; State Key Laboratory Cultivation Base of Geographic Environment Evolution (Jiangsu Province),
Nanjing, Jiangsu, People’s Republic of China; Jiangsu Center for Collaborative Innovation in Geographical Information Resource
Development and Application, Nanjing, People’s Republic of China
Li He, School of Humanities and Social Science, Xi’an Jiaotong University, Xi’an, People’s Republic of China

ABSTRACT
Colour distortion, which is caused by the unavoidable mismatch between a map’s gamut and a
device’s gamut, negatively aﬀects the semiotic quality of maps. Cartographic communication
often suﬀers from undesirable colour inconsistency. This method models cartographic colour
reproduction as a constrained transform problem, namely, adapting a map’s gamut to ﬁt a
device’s gamut while preserving the semiotic quality. First, the characteristics of the map’s
gamut are investigated by considering cartographic principles, and the fundamental
concerns of preserving semiotic quality are proposed. Then, the self-organizing map method
is introduced to iteratively optimize the cartographic colour reproduction. We implement this
method and evaluate it based on a series of thematic maps. The results indicate that the
proposed algorithm oﬀers better
facilitating
cartographic colour reproduction.

results than two alternatives in terms of

KEYWORDS
Map colour; colour
reproduction; cartographic
principles; self-organizing
map

Introduction

The consistency of colour is a fundamental concern for eﬀective cartographic communication (White and Sifneos,
2002). Colour is functionally manipulated to encode qualitative and quantitative geographic information (Brewer,
2016; MacEachren, 1995). Then, purposely coloured maps are reproduced on display devices for further
information decoding through colour reading. Maps may be reproduced on various display media, including
printed media and digital screens such as desktop or mobile screens, projectors and printers. Ideally, map
colours should be reproduced consistently to ensure that the map designer’s intentions, in terms of the use of
colour (such as ordinal value and spatial distribution), are faithfully conveyed to map readers (Weninger, 2015).
While many suggestions have been made in terms of cartographic colour design (Brewer et al., 2003; Harrower
and Brewer, 2003; Christophe, 2011; Steinrücken and Plümer, 2013; Bláha and Štěrba, 2014) and cartographic
colour reading (Brychtová and Çöltekin, 2014), eﬀorts on how to achieve colour consistency are relatively
limited. Thus, the semiotic quality often suﬀers from colour distortions (Hoarau, 2011). Accurate cartographic
colour reproduction on various display media is widely required in many scenarios, such as cooperative map-
based decision-making and common operational pictures.

Colour distortions result from the mismatching of the gamut of maps and display devices. A map’s gamut
refers to all colours that are present in the map; the entire range of colours that can be reproduced by a display
device is called the device’s gamut (Morovic and Luo, 2001). Inevitably, a map’s gamut does not exactly match
the device’s gamut even if the devices are well calibrated. If a map’s colour is within the device’s gamut, it will
it will be replaced by an in-gamut colour, resulting in inconsistent
be accurately reproduced; otherwise,
cartographic colour reproduction. Since a map’s gamut as intended by the cartographer may be quite
diﬀerent from the gamuts of potential devices, colour distortions widely exist in map reproduction. Notably,
colour distortions are not unacceptable in all cases, but map readers may be confused when performing
map-reading tasks, e.g. identiﬁcation and distribution, especially when comparing one or more reproduced
maps with the original. Furthermore, colour distortions negatively aﬀect semiotic quality. For example,
similar colours are used to present associative relationships and colour shades are used to imply order
relationships (Hoarau, 2011). Compression and clipping are two major strategies to adapt map colours to ﬁt
devices (Sharma, 2006). Certainly, compressed colours may make associative relationships indistinguishable,

CONTACT M. WU

wmg@njnu.edu.cn

© 2018 British Cartographic Society

274

M. WU ET AL

and clipped colours may partially lose their order relationship (Morovic and Luo, 2001). Colour distortions are
unavoidable but should be reduced to preserve semiotic quality.

(http://colorbrewer2.org/) provides well-crafted colour

Many eﬀorts have been conducted to improve the quality of cartographic colour reproduction. In the ﬁeld of
cartography, a straightforward solution is to deﬁne a lookup table for diﬀerent output media. For example,
Colorbrewer
light-emitting diode,
photocopy and printer (Brewer et al., 2003). However, deﬁning colour-lookup tables for all potential
presentation devices is time-consuming and extremely challenging. Hoarau (2011) proposed a method to
preserve semiotic quality for mobile mapping. In this method, conventional and semantic rules of colour
are considered. The semiotic quality is carefully preserved by determining association and diﬀerentiation.
However, this method focuses on the constraint of energy consumption rather than the constraint of a
device’s gamut. A ﬂexible solution that is adaptive to various devices is required.

schemes

for

A variety of methods have been proposed in the ﬁeld of colour science, especially gamut-mapping technologies,
which transform the source gamut to the target gamut (Morovic and Luo, 2001). These algorithms can be classiﬁed
into two groups: device-to-device and image-to-device techniques. The International Colour Consortium (ICC)
developed a general device-to-device gamut-mapping algorithm by applying colour compression and clipping
(Sharma, 2006). The ICC proposed a colour-management solution based on this algorithm, which has been
introduced in map reproduction to reduce colour distortion (NPS, 2005). However, device-to-device methods,
focus on transforming a source device’s gamut to a target device; speciﬁc
including the ICC solution,
characteristics of images are not considered. Generally, the quality of colour reproduction is relatively lower
than that for image-to-device methods (Giesen et al., 2006).

In contrast to the device-to-device approach, the basic idea behind image-to-device methods is to design speciﬁc
algorithms according to the characteristics of the source image (Morovic and Luo, 2001). Many eﬀorts have been
made to design gamut-mapping algorithms that are adaptive to the content of images (Chen and Chen, 2011), such
as frequency-based, retinex-based (e.g. Kimmel et al., 2005; McCann, 1998) and image-diﬀerence minimization
methods (e.g. Kimmel et al., 2005; Nakauchi, et al, 1999). In these studies, several factors, e.g. spatial ratios, spatial
image-to-device
gradients and luminance variations, have been proposed to characterize images. Therefore,
methods achieved higher quality gamut mapping than device-to-device methods in many cases, such as saturated
graphics and pictorial images (Dugay et al., 2008). However, two crucial factors that shape a map’s gamut have not
yet been considered for cartographic colour reproduction: (1) cartographic principles of colour and (2) the
characteristics of mapping data. Correspondingly, the characteristics of a map’s gamut have not been addressed by
existing methods. Optimizing cartographic colour reproduction to preserve semiotic quality is still challenging.

With the goal of improving the quality of cartographic colour reproduction, we model cartographic colour
reproduction as a constrained transform problem, namely, adapting a map’s gamut to ﬁt a device’s gamut while
preserving the semiotic quality. This paper is organized as follows. In the next section, we outline the inherent
characteristics of a map’s gamut and the major concerns when adapting a map’s gamut to ﬁt a device’s gamut.
Section 3 introduces an iterative optimization method to achieve high-quality cartographic colour reproduction.
Section 4 details how this method is tested, and the results are comparatively analysed with two alternatives.
The conclusions and future directions are provided in Section 5.

Problem formulation

Many cartographic principles have been proposed to guide colour usage. Originally, Bertin (1984) and MacEachren
(1995) deﬁned basic guidelines on how to manipulate three colour dimensions to symbolize geographic
information related to various levels of measurements. Then, sequential, diverging and qualitative colour
schemes were deﬁned to encode qualitative and quantitative information (Brewer et al., 2003; Harrower and
Brewer, 2003). Fundamentally, three types of relationships for cartographic colour were distinguished: (1)
association, which uses similar colours to present associated mapping themes; (2) diﬀerentiation, which uses
distant colours to emphasize diﬀerences between mapping themes and (3) order, which uses colour shades to
imply ordinal or numerical data. In addition, many other cartographic principles, such as colour harmony
(Christophe et al., 2011), colour contrast (Bláha and Štěrba, 2014) and colour discrimination, have been
proposed to choose colours to make maps legible. Correspondingly, two characteristics are highlighted in this
paper when describing a map’s gamut as a discrete point set.

Cartographic colour points tend to be limited in number, scattered and even regularly distributed. Similar
colours are used to encode associative relationships (e.g. sea and lake). When considering map legibility, both
the number of selected colours and the number of cartographic objects that are depicted by colour are limited.
Thus, the number of colour points in a map’s gamut is low. To present diﬀerentiation, colours in the map are
chosen to contrast each other. Therefore, the distance between any two colour points tends to be large.

THE CARTOGRAPHIC JOURNAL

275

Figure 1. Map of the mean annual cooling degree days in the USA (courtesy of the USGS) and its map gamut in 2D/3D view in CIELab.

Furthermore, colour is often logically designed to imply order, so the spatial distribution of colour points in a map’s
gamut is generally regular rather than random. Many eﬀorts have been made to characterize the spatial distribution
pattern of colour points, such as polynomial (Kimerling, 1985), linear (Brychtová and Doležalová, 2015) and arc
models (Brewer, 2016). For example, Figure 1.1 is a thematic map that was provided by the United States
Geological Survey (USGS). It uses a diverging colour scheme to symbolize annual cooling degree days in the
mainland US. As shown in the map’s legend, the scheme encoded the mean annual cooling degree days on a
numerical scale. We investigated the spatial distribution of the map’s gamut by plotting a 2D and 3D view of
the gamut in the CIELab colour space. Figure 1.2 and 1.3 shows that the colour points are roughly arranged
along a hypothesized smooth trajectory.

Additionally, colour points are spatially weighted. Although a colour scheme in a map legend appears as
regular blocks, colour patches in the map stand for spatially varying geographic phenomena. For example,
Figure 2.2 is a rainfall map of Australia; its gamut is shown in Figure 2.1. In this map, each colour point
in the map’s gamut is associated with a range of rainfall values, and regions within these ranges spatially
vary. When adapting map colours, the diversity of mapping objects that the colours represent should be
considered, even though map colours are plotted with the same marker and size in the legend.

Semiotic quality should be preserved for cartographic colour reproduction. Generally, diﬀerent types of images
have diﬀerent concerns for colour reproduction. In studies of device-to-device methods, several concerns have been
suggested, such as hue preservation, grey-axis preservation and continuity. (Morovic and Luo, 2001). For image-to-
device methods, McCann (1998) suggested preserving the spatial gradients. Alsam and Farup (2011) suggested
preserving the spatial ratio. From the perspective of cartographic communication, associative, diﬀerentiation
and order relationships are intended by cartographers and interpreted by map readers. When reproducing
maps, these relationships should be kept consistent so that the ﬁnal map conveys the same relationships. In this
sense, this paper understands the cartographic colour reproduction problem as a consternated transform
problem, namely, adapting a map’s gamut to ﬁt a device’s gamut while preserving the semiotic colour quality.

Problem solving

Choosing a self-organizing map (SOM) for cartographic colour reproduction
Colour distance is a widely used metric to quantify semiotic quality. Christophe et al. (2011) used the colour
distance to characterize colour harmony; Bláha and Štěrba (2014) used the colour distance to describe colour
contrast; Brychtová and Çöltekin (2014) used the colour distance to evaluate map discriminability and Hoarau
(2011) used colour distance to determine associative and diﬀerentiation relationships. Inspired by these studies,

276

M. WU ET AL

Figure 2. Rainfall map of Australia (courtesy of the Australia Bureau of Meteorology) and its map gamut in CIELab.

we select colour distance as a metric to describe the fundamental concern of cartographic colour reproduction.
Describing a map’s gamut as a discrete colour point set, inter-point distances in a map’s gamut should be
preserved to retain the semiotic quality of the original map. The shape of the map’s gamut may be far diﬀerent
from that of the device’s gamut, so colour-distance preservation for every point is impossible in most cases. As
a compromise, we suggest a complementary constraint: the adjacency of colour with its neighbours. Hence,
distance and topology preservation when adapting a map’s gamut to a device’s gamut are the major concerns in
cartographic colour reproduction.

Visualization-induced self-organizing map
As a distance-and-topology-preserving transform method, the visualization-induced self-organizing map (ViSOM)
method was selected in this paper to implement cartographic colour reproduction. ViSOM is an extension of the
self-organizing map (SOM). The SOM, which is a type of artiﬁcial neural network, provides a transformation of
input data (training sample) of arbitrary dimension into a discrete low-dimensional network with topological
preservation (Kohonen, 2000). The major components of the SOM network are nodes, which are associated
with weight vectors and arranged in a low-dimensional lattice. In an SOM, nodes are also called neurons, and
the associated weight vector has the same dimension as the input data. For a two-dimensional output space,
neurons are usually placed regularly in a hexagonal or rectangular grid (Kohonen, 2013). These neurons are
trained using unsupervised learning to reﬂect the inherent characteristics of the input data. The process of
transforming the input data into neurons in an SOM consists of four major phases: initialization, competition,
cooperation and adaptation. A detailed explanation of these phases is beyond the scope of this paper, so brief
introductions are provided as follows:

(1) Initialization. The weights of the neurons are initialized to small random values.
(2) Competition. Let x be a training sample in D-dimensional space, where wj is the weight of the neurons j in the
output units. Input x into the network, and the neuron whose weight is closest to the training sample x is called
the winning neuron.

(3) Cooperation. The winning neuron excites surrounding neurons through the neighbourhood function. A

commonly used neighbourhood function is shown below:
(cid:1)

h( j,i(x)) = exp −

(cid:3)

d2
(j,i)
2s2(t)

(1)

where i(x) is the index of the winning neuron; dj,i is the distance between the nodes j and i in the network and
s(t) is the neighbourhood radius, which is fairly large at the start of the process, e.g. on the order of half the
diameter of the output space, σ(0) = v/2, where v is the diameter of the output space.

(4) Adaptation. The winning neuron and the excited neurons adjust the weights towards the training sample using

the weight updating rule:

wj(t + 1) = wj(t) + h(t)h( j,i(x))(x(t) − wj(t))
where h(t) is the learning rate. As usual, h(t) should be decreasing. Usually, exponential functions are used.

(2)

THE CARTOGRAPHIC JOURNAL

277

Circularly repeat the competition, cooperation and adaptation for the next input sample. After inputting all the
training samples, increase the step index (t, which is speciﬁed as 1 at the start) and repeat the weight updating until
the computational bounds are exceeded, e.g. t reaches the predetermined number of iterations (called the limit).
One of the greatest properties of SOMs is that close training samples in the input space will be mapped to nearby
neurons, namely, topology-preserving. However, the inter-point distances are not kept in an SOM, and the shapes
of the output units are often distorted (Yin, 2002). An extended SOM called ViSOM has been proposed to preserve
the inter-point distance. In ViSOM, the updating force x(t) − wj(t) in Equation (2) is decomposed into two forces,
as shown below:

x(t) − wj(t) = (x(t) − wi(x)(t)) + (wi(x)(t)

− wj(t)) ; Fvx + Fkv

(3)

The ﬁrst force, Fvx, represents the updating force, which leads the neurons towards the orthogonal direction of the
winner. The second force, Fkv, refers to the contraction force, which brings the neurons to the winner. ViSOM
preserves the distances and topology by regularizing the distance between the neurons and the winner
(Baruque, Corchado and Yin, 2007; Yin, 2002).

Major properties of choosing ViSOM for cartographic colour reproduction
ViSOM provides two major properties for accurate cartographic colour reproduction. First, the colour distance and
adjacency in a map’s gamut is carefully preserved because of the properties of the topology and distance
preservation. The training samples and neurons are fully connected, so every neuron learns from all the
training samples, which is helpful in preventing suboptimal colour preservation that has occurred in some
existing methods (e.g. gamut-clipping technologies).

Second, sample training and neuron updating are not supervised, which means that no prerequisite knowledge
on cartographic colour principles is needed. Cartographers may manipulate colours in various ways to encode
information. When employing ViSOM, cartographic colour reproduction is ﬂexible for diﬀerent colour schemes
and even their desired combinations and can be automatically executed without any human–machine interactions.

ViSOM-based gamut mapping

Now, we present a ViSOM-based cartographic colour reproduction method that consists of two key components:
spatialization and iterative optimization.

Spatialization in the CIElab colour space
First, a map’s and device’s gamuts are spatialized in an independent colour space. CIELab is approximately
equidistant (Mahy et al., 1994), so we selected CIELab as the working colour space. A map’s gamut is described
as a point set in CIELab, which can be denoted as follows:

M = {(C1, W1), (W2, C2), . . ., ( Wh, Ch)}

where h represents the point count in the colour set, Ci represents a point in the set where i is the point index and
Wi represents the spatial weight of Ci. We used the area-based approach by Hoarau (2011) to measure the spatial
weight. Speciﬁcally, Ai represents the sum of the area of the mapping theme, which is symbolized by Ci, and Wi is
the normalized Ai:

(4)

(5)

Wi =

Ai(cid:4)

h
i=0 Ai

According to Morovic and Luo (2001) and Giesen et al. (2006), four spatial operations are available, which are
shown in Figure 3: (1) we can compute a continuous shape D that approximates the device’s gamut, and we
can compute the boundary of D; (2) we can determine whether a colour is inside the device’s gamut shape D
(e.g. in Figure 3, Cn is inside D, whereas Cp and Cq are outside D); (3) we can scale an out-of-gamut colour
′ and (4) we can snap an out-of-gamut colour to
along a line (e.g. lightness axis), such as by moving Cq to Cq
the boundary along a line by moving Cp to Cp

We distinguished three types of topological relationships between a device’s gamut D and a map’s gamut M. As
shown in Figure 4, some of the map colour points in Case A exceeded the device’s gamut; for instance, D overlaid
with M. In Case B, all the points were outside the device’s gamut: D was disjoined with M. In Case C, all the points
were inside the device’s gamut: D contained M. The map’s gamut was contained by the device’s gamut in Case C, so
the colour could be accurately reproduced without any distortions. We focused on Cases A and B. In Case B, we

′.

278

M. WU ET AL

Figure 3. Schematic diagram that shows the four spatial operations on the gamuts in CIELab.

Figure 4. Three spatial relationships between a map’s gamut (plotted with blue dots) and a device’s gamut (ﬁlled with grey and outlined with black): (1) D
overlays M, (2) D is disjoint from M and (3) D contains M.

could scale all the points in the map’s gamut, and the results were further derived into two situations: BA (D was
disjoined with the scaled M) and BC (D contained the scaled M). Case BC was identical to Case C and did not need
further transformation. Clearly, Case BA was identical to Case A. Thus, we concentrated our research on Case A,
which is also the most common case in practice.

Iterative optimization
We iteratively optimized cartographic colour reproduction. The four major components of iterative optimization
are explained as follows.

Initialization. Commonly, if the number of neurons is less than the number of training samples, the SOM
clusters the training samples. In the proposed algorithm, the number of neurons is set to the number of
training samples. In the original SOM, all the weights of the neurons are initialized with small random values.
In this paper, the neurons are initialized according to the out-of-gamut colours. As shown in Figure 5, we

Figure 5. Identiﬁcation and initialization of static neurons.

THE CARTOGRAPHIC JOURNAL

279

Figure 6. Illustration of the process of ViSOM-based cartographic colour reproduction: a neural network (plotted with red squares and red lines) is trained to
approximate the map’s gamut (plotted with blue circles) under the constraint of the device’s gamut (ﬁlled with grey and bounded with a solid black line).

assumed that Cp, Cq and Cj are out-of-gamut colours. Certainly, minimized colour distortions can be achieved by
snapping these colours to the boundary of the device’s gamut. In this sense, we modiﬁed the initialization by
distinguishing ﬂoating and static neurons. As shown in Figure 5, the entire CIELab colour space was divided
into several sectors according to the hue angle u. Here, u> 0 is a parameter of the proposed algorithms (e.g.
u= 45° in Figure 5). In each sector, the colours that were farthest from the device’s gamut, such as Cp and Cq in
Figure 5, were identiﬁed. Assuming m identiﬁed points, these colours were snapped to the boundary of shape
′ for Cq. Neurons that were associated with these points were classiﬁed as
D, such as point Cp
static neurons. The remaining neurons (e.g. neurons that were associated with Cm, Cn, Ci and Cj) were classiﬁed
as ﬂoating neurons. While the ﬂoating neurons were initialized as small random values and updated their
weight during the iterative process, static neurons, which served as anchor points, were initialized with speciﬁc
weights (colour values of the associated point, such as Cp

′) and kept the weight ﬁxed.

′ for Cp and Cq

′ and Cq

Competition. The colours in a map’s gamut, which serve as training samples, are selected randomly and provided
for the network. While the static neurons always act as winners, the other neurons compete to become a winner
according to their weights.

Cooperation. Intuitively, a map’s gamut is adequately transformed if the points that have larger spatial weights
are displaced less than the points with smaller spatial weights. For example, if we assume that Cn in Figure 5 has
larger spatial weights (such as the region with rainfall from 10 to 25 mm in Figure 2.2), then Ci has a smaller spatial
weight (such as the region with rainfall from 400 to 600 mm in Figure 2.2). To reduce colour distortions, Cn should
change less then Ci. Here, we modiﬁed the learning rate to consider the spatial weight of colours:

h(t, T, wi) = wi × h(t, T)

(6)

In this manner, Cn has a higher learning rate for weight updating (see Equation (2)) (marked with a large red circle
for illustration), whereas Ci has a lower learning rate (marked with a small red circle for illustration). With this
modiﬁcation, the colours that are associated with more covered areas inﬂuence the excited neurons much more
than the colours that are associated with less covered areas.

Adaptation. In SOMs, the excited neurons update their individual weight values towards the training sample.
This type of adaptation does not consider the boundary of D. Thus, the weight of the updated neurons may
exceed the device’s gamut (e.g. Cj in Figure 5). We modiﬁed this adaptation to ensure that the adapted colour
was still within the device’s gamut: after adaptation, we determined whether the newly updated point was
within the device’s gamut. If so, then we continued to the next training sample; if the colour was outside the
device’s gamut, then the colour was snapped to the boundary of D (e.g. snap Cj to Cj

′).

An optimal result could be achieved through spatialization and iterative optimization. As illustrated in a 2D view
in Figure 6, the map and device’s gamuts were spatialized in CIELab, and the neurons were initialized. Then, the
neurons were iteratively trained to respond to the colours in the map’s gamut under the constraints of a device’s
gamut. After T rounds of iterations, the neurons fell within the device’s gamut and approximated the map’s gamut.
Then, the map colours could be optimally reproduced in the device by translating the weights of the output neurons
(colour value in CIELab) into the device’s colour space (i.e. RGB).

Evaluation and discussion

Evaluation

Test device, test maps and compared methods
As shown in Figure 7, six thematic maps selected from the Atlas of Population, Environment and Sustainable
Development of China and two datasets on US land cover and African populations (download from https://
www.mrlc.gov/ﬁnddata.php and https://en.actualitix.com/country/afri/africa-population-rural.php) colourized

280

M. WU ET AL

Figure 7. Test maps.

using the colour schemas from Colorbrewer, were used in this experiment, called test maps 1 to 8. These test maps
covered all three types of aforementioned relationships. These test maps were in raster format. We scanned all the
pixels to determine the spatial weights of the maps’ colours. The test display was a desktop screen with a viewable
size of 21.3 in. The monitor was calibrated and proﬁled with the GretagMacBeth’s Eye One package, version 1.0.
We implemented the proposed method in a prototype system in which the segment maxima gamut boundary
descriptor (SMGBD) algorithm that was proposed by Morovic and Luo (2001) was used to calculate the shape and
boundary of the device’s gamut. We used LittleCMS (an open-source colour-management engine, which is
available at https://sourceforge.net/projects/lcms/ﬁles/) to translate colours from RGB to CIELab. In the
initialization phase, CIELab was divided into six sections to identify out-of-gamut colours; the number of
iterations was speciﬁed as 1000. The number of colours was deliberately limited by the maps’ creators to ensure
map legibility. Hence, the maps’ gamuts tended to be small, and colour points, which served as training
samples, may not have been suﬃcient to train the neural network, especially in test map 4. In this case,
Kohonen (2013) suggested a strategy to reuse a limited number of training samples, namely, cyclically feeding
samples to the network, which is called bootstrap learning. Two solutions are available: ﬁrst, reuse the samples

THE CARTOGRAPHIC JOURNAL

281

in their internal order; and second, pick a sample at random. We applied bootstrap learning in the proposed
method when the number of samples was much smaller by randomly picking training samples.

We compared the proposed algorithm with the ICC’s solution. Many methods have been proposed for colour
reproduction in various applications. An extensive comparison of existing methods is beyond the scope of this
paper. To the best of our knowledge, only the ICC’s solution has been introduced in cartography to improve
the quality of cartographic colour reproduction. The ICC deﬁned four purposes for colour reproduction:
relative colorimetric, absolute colorimetric, perceptual and saturation intent. Among these methods, relative
colorimetric intent was suggested as an appropriate method to implement cartographic colour reproduction
(NPS, 2005). Saturation intent was determined to be suitable for business graphics, charts, etc. (Sharma, 2006).
Therefore, we compared our algorithm with the ICC’s relative colorimetric and saturation intents. We
employed Adobe Photoshop to apply these two methods to reproduce map colours in this test.

Results
We measured the colour distortions between the original and reproduced maps with an image quality indicator
suggested by Hoarau (2011), which is an area-weighted colour distance. Figure 8 shows the results of colour
distortions over the test maps.

The colour-distance measurements suggest that this method can achieve the lowest colour distortions in all eight
maps. By applying gamut clipping, the ICC’s relative colorimetric intent snapped out-of-gamut colours to the
boundary of the device’s gamut. The map’s gamut was compressed to ﬁt the device’s gamut of the ICC’s
saturation intent. Therefore, in-gamut colours were correspondingly scaled, resulting in global colour shifting.
Distortions of out-of-gamut colours were minimized in the proposed method by distinguishing ﬂoating and static
neurons. Furthermore, colours that were associated with the mapping theme with relatively larger covered areas
were moved less by considering their spatial weights. Thus, colour distortions in the proposed method were
signiﬁcantly less than those in the two ICC methods.

We also recruited 20 participants to take a survey to evaluate the quality of cartographic colour reproduction
through map reading. The participants included undergraduate students in the ﬁelds of cartography and
Geographic Information System (GIS), as well as experienced cartographers. Participants were invited to answer
three questions regarding the semiotic quality of the reproduced maps; (1) Is the diﬀerentiation relationship
well preserved? (2) Is the association relationship well preserved? (3) Is the order relationship well preserved?
We explained what these terms meant to the participants in the survey. We used 5-point scales to record the
participants’ agreement levels, varying from 1 representing strongly disagree, to 3 representing neither disagree
nor agree, to 5 representing strongly agree.

The results showed that the proposed method can better preserve semiotic quality. Saturation was preserved in the
ICC’s saturation intent method. However, hue and lightness are distorted in saturation intent. The ICC’s relative
colorimetric intent was implemented by gamut clipping. Two out-of-gamut colours were used in a sequential
scheme. By applying gamut clipping, these two colours were snapped to the boundary of the device’s gamut, and
these two points were transformed into the same colour. In this case, the order relationship was partially lost.
Unlike these two methods, the proposed method aimed to preserve the distance and adjacency of map colours to

Figure 8. Colour distortions of the test maps.

282

M. WU ET AL

Table 1. Average ratings of the semiotic quality of associative, diﬀerentiation and order relationships.

Methods

The proposed method
ICC relative colorimetric intent
ICC saturation intent
Note: M: mean; SD: standard deviation.

M

4.532
4.058
4.082

Association

Diﬀerentiation

Order

SD

0.091
0.030
0.045

M

4.528
4.088
4.081

SD

0.073
0.047
0.042

M

4.587
4.101
4.071

SD

0.078
0.039
0.028

retain semiotic quality. The average ratings of the three questions are shown in Table 1, which indicates that
participants generally agreed that the proposed method could achieve relatively better quality in terms of
preserving semiotic quality, with varying agreement levels for the three relationships. In this test, the proposed
method achieved signiﬁcantly better (p < 0.01) quality of cartographic colour reproduction compared to the ICC’s
relative colorimetric intent and the ICC’s saturation intent.

Discussion

Quality and sensibility
A map’s gamut is shaped by cartographic principles and the characteristics of geographic data. This paper treats
cartographic colour reproduction as a constrained transform problem, namely, adapting a map’s gamut to ﬁt a
device’s gamut while preserving the semiotic quality. Speciﬁcally, we introduced the ViSOM method to implement
cartographic colour reproduction by modelling a map’s gamut as training samples and a device’s gamut as the
boundary condition for neuron training. Distortions of out-of-gamut colours could be minimized by distinguishing
ﬂoating and static neurons. With this modiﬁed learning rate (see Equation (7)), colours with higher spatial weights
would be less distorted then colours with lower weights.

Importantly, SOMs are sensitive to the number of available training samples. An SOM requires a considerable
number of training samples to achieve satisfactory results. The bootstrap learning strategy was employed to train
neurons; thus, the semiotic quality could be carefully preserved.

Usability and limitations
In this method, device limitations are modelled as boundary constraints for cartographic colour reproduction. Map
colours can be reproduced on other devices by replacing the boundary constraint with that device’s gamut.
Compared to the colour-lookup table method, the proposed method is more ﬂexible. Furthermore, the
proposed method can be automatically executed;
it is not dependent on knowledge of the cartographic
principles used by the mapmaker, and it is not dependent on the nature of the mapped data because of the
non-supervised nature of SOMs.

One limitation of this method is that only discrete map gamuts are supported. Three types of relationships are
preserved in this method by considering the inter-point distance and adjacency. Map gamuts that involve these
relationships are discrete: colour points have low density and distinguishable inter-point distances. This
scenario is not the case for all thematic maps, such as rainbow maps, in which continuous colour shades are
used to symbolize geographic phenomena. These types of map gamuts are (partially) continuous: colour points
have high density and non-distinguishable inter-point distances. Continuous map gamuts were not studied here
but will be considered in future research.

As discussed in Section 3.1, spatial weights are considered in this method. The spatial weight is measured
using the area-based method. As shown in Figure 7, all the mapping features in the test maps of this paper
were polygons. No points or polylines were involved in the test. According to Hoarau (2011), point and
polyline features can also support the area-based approach to measure their spatial weight. Therefore, the
proposed method has potential applicability on point and polyline feature maps but requires further
evaluation. In addition, only the geometric aspect of the spatial weight was addressed. The semantic aspect
of the spatial weight also requires further investigation.

Conclusions

From the perspective of cartographic communication, colour should be reproduced as consistently as possible to
ensure that information is faithfully delivered to map readers, with as little distortion as possible. Colour
distortions, which are caused by the unavoidable mismatching of a map and device’s gamut, have an
undesirable eﬀect on the semiotic quality during cartographic communication. The consistency of colour is a
fundamental concern when reproducing maps on various display media, including printed media and digital
screens. In this paper, we investigated the characteristics of a map’s gamut and outlined the concerns of

THE CARTOGRAPHIC JOURNAL

283

adapting a map’s gamut to ﬁt a device’s gamut. Then, we introduced ViSOM technology to iteratively optimize
cartographic colour reproduction. The test results suggested that the proposed algorithm could improve the
quality of cartographic colour reproduction when reproducing maps on various display devices. This method
is also adaptable to various devices and compatible with diﬀerent colour schemes.

Although the proposed algorithm oﬀers some advantages, it still has several issues that require further
investigation. One issue is the concerns of cartographic colour reproduction. We suggested preserving the inter-
point distance and topology of the map’s gamut to maintain the semiotic quality. We believe that more
concerns, such as the colour appearance (Fairchild, 2005), should also be further considered. Another issue is
the spatial weight. We employed an area-based method to measure the spatial weight from a geometric
perspective. Future improvements might involve the semantic aspects of the spatial weight.

Furthermore, device limitations are modelled as boundary constraints in CIELab, which is device independent.
Coupled with device calibration and colour conversion techniques, which are able to bidirectionally translate
colour values between CIELab and the device-related colour space (e.g. RGB and CMYK), this method is
theoretically adaptive to various output devices, including desktop or mobile screens, projectors and printers.
However, the gamuts of these devices greatly vary and may be nonconvex in shape. Since colour adaption in
this method may be misled by imprecise gamut boundaries, gamut boundary descriptors have signiﬁcant
inﬂuences on quality. To calculate the shape and the boundary of a device’s gamut, we employed the SMGBD
algorithm, which use segments to approximate the gamut of a device. Further research will include improving
the gamut boundary descriptor to support various output devices.

The proposed method provides a guideline to achieve high-quality cartographic colour reproduction. Colour
should be delivered to map readers as faithfully as possible, so cartographic communication should beneﬁt from
colour consistency, especially in the age of digital mapping, in which various display devices are used for map
presentation. For example, a large number of web mapping services are available over the Internet. Some of
these services even provide interfaces for map readers to specify the map style, including map symbols and
colour schemes, such as the Symbology Encoding speciﬁcation from Open Geospatial Consortium (OGC).
Certainly, creativity and personalization in colour design are encouraged in these services. In practice, these
services are accessed by various clients, and maps retrieved from these web mapping services are produced on
various display devices. To the best of our knowledge, the constraint of colour reproduction from devices has
not been considered in existing services. Colour distortions will occur in this context. By implementing the
proposed method into web mapping services, cartographic communication might often be better facilitated by
reducing colour distortion inherent in reproduction of maps on diﬀerent viewing media.

We appreciate the anonymous reviewers for their valuable suggestions and questions. This work was supported by the National
Natural Science Foundation of China [grant 41271446; 41571433].

Funding

Notes on the contributor

Mingguang Wu is currently an Associate Professor at
the Department of Geographic
Information Science, Nanjing Normal University, China. He has a PhD in Geography and
Geographic Information Science from the Information Engineering University, China. His
professional skills and interests in cartography are symbol design and spatio-temporal mapping.

References
Alsam, A. and Farup, I. (2011) “Spatial Colour Gamut Mapping by Means of Anisotropic Diﬀusion” In Schettini, R., Tominaga,

S. and Trmeau, A. (Eds) Computational Color Imaging Berlin: Springer, pp.113–124.

Baruque, B., Corchado, E. and Yin, H. (2007) “ViSOM Ensembles for Visualization and Classiﬁcation” In Sandoval, F., Prieto,

A., Cabestany, J. and Gra, A.M (Eds) Computational and Ambient Intelligence Berlin: Springer, pp.235–243.

Bertin, J. (1984) Semiology of Graphics: Diagrams, Networks, Maps Madison: University of Wisconsin Press.
Bláha, J.D. and Štěrba, Z. (2014) “Colour Contrast in Cartographic Works using the Principles of JohannesItten” The

Cartographic Journal 51 (3) pp.203–213. doi:10.1179/1743277414Y.0000000084.

Brewer, C.A. (2016) Designing Better Maps: A Guide for GIS Users (2nd ed.) Redlands, CA: Esri Press.
Brewer, C.A., Hatchard, G.W. and Harrower, M.A. (2003) “Colorbrewer in Print: A Catalog of Color Schemes for Maps”

Cartography and Geographic Information Science 30 (1) pp.5–32.

284

M. WU ET AL

Brychtová, A. and Çöltekin, A. (2014) “An Empirical user Study for Measuring the Inﬂuence of Colour Distance and Font Size
in Map Reading using Eye Tracking” The Cartographic Journal 53 (3) pp.202–212. doi:10.1179/1743277414Y.0000000103.
Brychtova, A, Doležalová, J. (2015) “Designing Usable Sequential Color Schemes for Geovisualizations” In Gartner, G. and
Huang, H. (Eds) Proceedings of the 1st ICA European Symposium Symposium on Cartography Berlin: Springer, pp.31–32.
Chen, H. and Chen, S. (2011) “Spatial Gamut Mapping Algorithms for Cross-Display Color Reproduction” Journal of the

Society for Information Display 19 (2) pp.178–188.

Christophe, S. (2011) “Creative Colours Speciﬁcation based on Knowledge (COLorLEGend System)” The Cartographic Journal

Christophe, S., Zanin, C. and Roussaﬀa, H. (2011) “Colours Harmony in Catrography” Proceedings of the 25th International

Dugay, F., Farup, I. and Hardeberg, J.Y. (2008) “Perceptual Evaluation of Color Gamut Mapping Algorithms” Color Research &

48 (2) pp.138–145.

Cartographic Conference Paris: 3rd–8th July.

Application 33 (6) pp.470–476.

Fairchild, M.D. (2005) Color Appearance Models (2nd ed.) Chichester: Wiley-IS & T Series in Imaging Science and Technology.
Giesen, J., Schuberth, E., Simon, K., Zeiter, D. and Zolliker, P. (2006) “A Framework for Image-Dependent Gamut Mapping”
Proceedings of SPIE 6058, Color Imaging XI: Processing, Hardcopy, and Applications San Jose, CA: Electronic Imaging, 15th
January.

Harrower, M. and Brewer, C.A. (2003) “Colorbrewer.org: An Online Tool for Selecting Colour Schemes for Maps”

Cartographic Journal 40 (1) pp.27–37.

Hoarau, C. (2011) “Reaching a Compromise Between Contextual Constraints and Cartographic Rules: Application to

Sustainable Maps” Cartography and Geographic Information Science 38 (2) pp.79–88.

Kimerling, J.A. (1985) “The Comparison of Equal-Value Gray Scales” Cartography and Geographic Information Science 12 (2)

pp.132–142.

Kimmel, R., Shaked, D., Elad, M. and Sobel, I. (2005) “Space-Dependent Color Gamut Mapping: A Variational Approach”

IEEE Transactions on Image Processing 14 (6) pp.796–803.

Kohonen, T. (2000) The Self-Organizing Map (3rd ed.) Springer, Berlin.
Kohonen, T. (2013) “Essentials of the Self-Organizing Map” Neural Networks 37 pp.52–65.
MacEachren, A. (1995) How Maps Work New York: Guilford Press.
Mahy, M., Eycken, L. and Oosterlinck, A. (1994) “Evaluation of Uniform Color Spaces Developed after the Adoption of

CIELAB and CIELUV” Color Research & Application 19 pp.105–121. doi:10.1111/j.1520-6378.1994.tb00070.x.

McCann, J.J. (1998) “Color Gamut Measurements and Mapping: The Role of Color Spaces” Proceedings of SPIE 3648, Color

Imaging: Device-Independent Color, Color Hardcopy, and Graphic Arts IV San Jose, CA: 22nd December.

Morovic, J. and Luo, M.R. (2001) “The Fundamentals of Gamut Mapping: A Survey” Journal of Imaging Science and

Nakauchi, S., Hatanaka, S. and Usui, S. (1999) “Color Gamut Mapping based on a Perceptual Image Diﬀerence Measure” Color

Technology 45 (3) pp.283–290.

Research and Application 24 (4) pp.280–290.

NPS (2005) National Park Service U.S. Department of the Interior, Color Management for Harpers Ferry Center Designers and

Cartographers Available at: https://www.nps.gov/hfc/pdf/colorcolour-management.pdf (Accessed: 2nd May 2017).

Sharma, A. (2006)) “ICC Color Management” In Lukac, R. and Plataniotis, K.N. (Eds) Color Image Processing: Methods and

Steinrücken, J. and Plümer, L. (2013) “Identiﬁcation of Optimal Colours for Maps from the Web” The Cartographic Journal 50

Applications Boca Raton: CRC Press, pp.1–27.

(1) pp.19–32. doi:10.1179/1743277412Y.0000000017.

Weninger, B. (2015) “A Framework for Color Design of Digital Maps: An Example of Noise Maps” In Brus, J., Vondrakova, A.

and Vozenilek, V. (Eds.) Modern Trends in Cartography Cham: Springer International Publishing, pp.103–116.

White, D. and Sifneos, J.C. (2002) “Regression Tree Cartography” Journal of Computational and Graphical Statistics 11 (3)

pp.600–614.

Yin, H. (2002) “Data Visualization and Manifold Mapping using the ViSOM” Neural Networks 15 (8–9) pp.1005–1016.

