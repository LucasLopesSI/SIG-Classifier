Transactions in GIS, 2010, 14(5): 569–580

Research Article

Similarity Weighted Instance-based
Learning for the Generation of Transition
Potentials in Land Use Change Modeling

Florencia Sangermano
Clark Labs, Clark University

J Ronald Eastman
Clark Labs, Clark University

Honglei Zhu
Clark Labs, Clark University

Abstract
Land use change models are increasingly being used to evaluate the effect of land
change on climate and biodiversity and to generate scenarios of deforestation.
Although many methods are available to model land transition potentials, they are
usually not user-friendly and require the speciﬁcation of many parameters, making
the task difﬁcult for decision makers not familiar with the tools, as well as making
the process difﬁcult to interpret. In this article we propose a simple method for
modeling transition potentials. SimWeight is an instance-based learning algorithm
based on the logic of the K-Nearest Neighbor algorithm. The method identiﬁes the
relevance of each driver variable and predicts the transition potential of locations
given known instances of change. A case study was used to demonstrate and validate
the method. Comparison of results with the Multi-Layer Perceptron neural network
(MLP) suggests that SimWeight performs similarly in its capacity to predict tran-
sition potentials, without the need for complex parameters. Another advantage
of SimWeight is that it is amenable to parallelization for deployment on a cloud
computing platform.tgis_1226 569..580

1 Introduction

With increasing concern for the implications of deforestation on climate change and
ecosystem functioning, land change modeling is being widely used to generate scenarios
of deforestation. The process of empirical land change modeling involves the evaluation
of past land cover changes (land change analysis), the empirical determination of the

Address for correspondence: Florencia Sangermano, Clark Labs, Clark University, Worcester, MA
01610, USA. E-mail: fsangermano@clarku.edu

© 2010 Blackwell Publishing Ltd
doi: 10.1111/j.1467-9671.2010.01226.x

570

F Sangermano, J R Eastman and H Zhu

relationship between land change and driver/suitability variables to evaluate the rea-
diness of the land for transition from one land cover to another (generation of transition
potentials), the determination of the amount of land that will transition (demand of land)
and ﬁnally, the allocation of land to the new land cover types (land allocation). The
evaluation of transition potentials is a critical step in the process of land change modeling
and prediction, as the ﬁnal allocation of land is based upon them. Therefore the
production of transition potentials with high accuracy is essential in the process of
land change prediction. Although many methods exist for the generation of transition
potentials, to our knowledge, only Eastman et al. (2005) have evaluated an extensive list
of them. In their work they evaluated (among others) the Weights of Evidence, which is
used in DINAMICA (Soares-Filho et al. 2002); empirical probabilities, which is used in
GEOMOD (Pontius et al. 2001); logistic regression, which is used, for example, in
CLUE-S (Verburg et al. 1999) and the Multi-Layer Perceptron neural network, which is
used in LTM (Pijanowski et al. 2002) and LCM (Eastman 2009). The main conclusion of
that work is that there are large differences in the patterns of transition potentials
generated by the different methods, and therefore they are not interchangeable. More-
over, in their tests, they found that the Multi-Layer Perceptron (MLP) performed best.
Non-parametric methods such as the Multi-Layer Perceptron are appealing for the
generation of transition potentials since they can ﬁt complex relationships, and they are
capable of producing accurate results. However, in order to train the neural networks for
the determination of transition potentials, many parameters need to be adjusted, which
makes the model difﬁcult to run and complex to understand.

In this work we introduce a simple non-parametric technique for the calculation
of
land change transition potentials: similarity weighted instance-based learning
(SimWeight). The rationale for the methodology is presented, together with a case study
of its application, as well as a comparison of the transition potentials generated by this
methodology with those generated by the Multi-Layer Perceptron.

2 The SimWeight Algorithm

SimWeight is an instance-based machine learning procedure that is derived from the
underlying logic of the K-Nearest Neighbor procedure (Fix and Hodges 1951). It is based
on calculation of weighted distances in variable space to known instances for the classes.
In the context of the generation of transition potentials for land change modeling, for
each transition to be evaluated the model should have two classes: change and persis-
tence. For each pixel to be evaluated, SimWeight extracts the k nearest neighbors (either
change or persistence) and then calculates the distance in the variable space from each
unknown location to the instances of change that falls in the range of k (Figure 1).

This distance is used in an exponential weighting function in order to calculate a
continuous surface of class membership. Then, for each pixel the class membership is
calculated as:

Membership

change

=

=

1

i

≤(
c k

)

(1)

c

(
∑ 1 0
.

−

)

1
e d
1

i

+

1
k

where k is the number of closest pixels (change + persistence) of a pixel, c is the number
of change pixels within the k nearest neighbors and d is the distance to a change instance

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(5)

Novel Method for Modeling Transition Potentials

571

Figure 1 Representation of the variable space produced by two variables. Triangles
represent change and diamonds represent persistence. The solid square represents the
pixel to be evaluated (with unknown transition potential). The circle represents k = 9.
Inside the circle there are six samples for change and three for persistence. Each arrow
represents the vector distance in the variable space

i. A large class membership for the change class would mean that a pixel has environ-
mental conditions similar to those that have already changed, and therefore it can be
considered to have a high transition potential.

The SimWeight procedure differs from the K-Nearest Neighbor (KNN) algorithm in
two respects. First, it produces a continuous statement of class membership rather than
a crisp assignment. Second, it derives its value only from the instances of change. The
rationale for this is that instances of persistence are not deﬁnitively examples of locations
that will not change. All we truly know is that they have not changed yet. However,
the instances of change are unambiguous. Thus this procedure falls into the family of
one-class classiﬁers (e.g. Boyd et al. 2006, Foody et al. 2007, Sanchez-Hernandez et al.
2007) or presence only empirical modeling techniques (e.g. Clark et al. 1993, Dettmers
and Bart 1999, Hirzel et al. 2002).

The most desirable feature of this algorithm is that it only requires one parameter –
k. In addition, the optimum k can be tested using a subset of the training data for
validation over a range of values for k. The algorithm is also appropriate for parallel
processing since separate nodes can process different sub-groups as long as they each
have a copy of the training data. Finally, an important quality is that it is distribution free
and is amenable to relationships that are non-linear and multi-modal.

3 Pre-processing Data for SimWeight

3.1 Preparing the Training Samples

At least two land cover maps at different time periods (T0 and T1) are needed to develop the
model of deforestation vulnerability. A third land cover map (T2) is optionally used to
evaluate the performance of the model. For each transition to be modeled, two training

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(5)

572

F Sangermano, J R Eastman and H Zhu

classes are needed: change and persistence. Sampling change can be accomplished by an
overlay between the land cover images at T0 and T1, in which all (or a sample of) locations
that transitioned from class A to B are considered as training samples from the category
change. Since the method is sensitive to the prevalence of training samples, persistence
samples are extracted by a random sample to match the number of change samples.

3.2 Preparing the Independent Variables

Since distances are calculated in variable space, variables should have comparable units;
this can be achieved by standardization. As with KNN classiﬁers, SimWeight is affected
by the presence of irrelevant variables (Tahir et al. 2007). Different driver variables may
have different importance as determinants of the transition. The differential importance
of the variables can be included by weighting, in which each variable is multiplied by a
weight proportional to its ability to distinguish between classes (Gómez et al. 2007).

In this model, the variable importance weight is determined by comparing the
standard deviation of the variable inside areas that have changed, to the standard
deviation of the variable for the study region as in equation (2):

Relevance Weight

= − (
1

SD in Change SD in Study Area

)

(2)

If the variable is relevant for discriminating change, then the standard deviation of
the variable inside the pixels that changed would be smaller than for the study region as
a whole, therefore having a large weight. Using the method explained above, weights are
determined for each variable. Then the standardized variables are multiplied by the
weight, affecting the scaling in a way proportional to the importance of the variable to
discriminate change. Optionally, a threshold can be speciﬁed to remove variables that
have a very low weight.

Although more sophisticated and complex weighting procedures for instance-based
learning methods have been developed (e.g. Blansché et al. 2006, De la Torre et al. 2002),
the simplicity of the weighting method used here makes it easy to interpret and calculate.

4 Testing SimWeight

In order to test the performance of SimWeight for the generation of transition potentials,
the methodology was applied to predict land use change in lowland Bolivia. The high
rates of change in this region as well as the availability of good quality land cover maps
for three different time periods (Killeen et al. 2007), makes this region a good case study
to test the SimWeight procedure.

Three land cover maps of Bolivia for the years 1992, 2001 and 2004 (Killeen et al.
2007), were obtained from the Museo Noel Kempff Mercado (MNKM), Bolivia. In order
to decrease computing time, the land cover maps were coarsened from their original 30m
resolution to a 1 km resolution. Dates 1992 and 2000 (T0 and T1 respectively) were used
for model training and 2004 (T2) was used to test the transition potential results.

Only the transition “humid forest to agriculture” was considered, which included
training pixels for areas that experienced the transition (change), as well as areas that were
humid forest and did not transition to agriculture (persistence). All pixels that experienced
change between T0 (1992) and T1 (2001) were used as training for change (n = 9,784).
Persistence was randomly sampled to extract 9,784 training pixels for that class.

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(5)

Novel Method for Modeling Transition Potentials

573

Table 1 Variables used to model the transition potentials for Bolivia and their sources

Variable

Elevation

Slope

Cost distance to Santa Cruz

Distance to agriculture 1992

Distance to roads

Source

USGS – GTOPO30: http://edc.usgs.gov/products/

elevation/gtopo30/gtopo30.html

Derived from a layer of the location of the city of Santa
Cruz, using the module COST in Idrisi 16.04 (Eastman
2009) and GTOPO30 elevation as a friction variable.
Derived from GTOPO30 elevation, using the SURFACE

module in Idrisi 16.04 (Eastman 2009)

Derived from Killeen et al. (2007) 1992 land cover layer,
using the module DISTANCE in Idrisi 16.04 (Eastman
2009)

Derived from roads layer provided by the Noel Kempff
Mercado Museum, using the module DISTANCE in
Idrisi 16.04 (Eastman 2009)

Kempff Mercado Museum, using the module
DISTANCE in Idrisi 16.04 (Eastman 2009)

Distance to populated places Derived from populated places provided by the Noel

and their
Table 2 Independent
weights determined for the Bolivia case study

variables

relevance

Variable

Cost distance to Santa Cruz
Elevation
Distance to agriculture 1992
Slope
Distance to roads
Distance to populated places

Relevance
Weight

0.15
0.65
0.67
0.58
0.13
0.28

Six variables were used to model the vulnerability of forest conversion in Bolivia:
cost distance to Santa Cruz city (cost based on distance and elevation), elevation, slopes,
distance to roads, distance to populated places and distance to agriculture in 1992
(Table 1). Variables were standardized and rescaled by multiplying them with the vari-
able relevance weight (Table 2). SimWeight was run for different values of k (k = 50, 100,
150, 300, 500, 1,000 and 1,500) in order to test the sensitivity of the method to this
parameter.

Performance of the method was evaluated by Yule’s Q statistic (Yule 1900), and area
under the Receiver Operating Characteristic curve (AUC; Swets 1986). Yule’s Q, also
known as the odds ratio skill score, has been proposed as a measure of performance of
binary forecasts (Stephenson 2000). Q ranges between -1 and 1 where Q = 1 represents

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(5)

574

F Sangermano, J R Eastman and H Zhu

Table 3 List of parameters used to run MLP

Parameter

Input layer nodes (number of variables)
Output layer nodes (# of output classes)
Number of hidden layers
Hidden layer nodes
Learning rate
Momentum factor
Sigmoid constant
Iterations

Value

6
2
1
3
0.001
0.5
1
10,000

perfect discrimination skill, Q = 0 represents no skill and Q = -1 represents perfect
discrimination but wrong calibration of the model. The Receiver Operating Character-
istic curves (ROC) and corresponding AUC statistics were calculated using the ROC
module in Idrisi 16.04 (Eastman 2009). The AUC statistic values range from 0 to 1,
where a value of 0.5 represents no skill, a value of 1 indicates perfect skill, and values
between 0 and 0.5 represent wrong calibration of the model. AUC is a threshold and
prevalence independent method (Fielding and Bell 1997) and it has been used to assess
land change models (Pontius and Schneider 2001). On the other hand the contingency
table needed to produce Yule’s Q is calculated for a particular threshold. For the purpose
of this work we were interested in evaluating the quality of the transition potentials,
without consideration of our capability to predict the amount of change, therefore the
real amount of change between T1 (2001) and T2 (2004) (20,453 pixels) was used as the
predicted amount of change. In order to generate the contingency table we rank-ordered
the transition potentials in a descending fashion, and reclassiﬁed as “predicted change”
all pixels from rank 1 to rank 20,453, which produced a predicted change map with the
exact amount of change between T1 and T2. Results from SimWeight were compared to
the more complex Multi-layer Perceptron back propagation neural network (MLP),
using the parameters listed in Table 3. The number of hidden layers and momentum
factor parameters were chosen following Tso and Mather (2001). The number of hidden
layer nodes was speciﬁed as the integer of the square root of the product between the
input and output nodes (Eastman 2009). The value obtained (hidden layer nodes = 3) is
consistent with that recommended by Boger and Guterman (1997). The default sigmoi-
dal activation function was used with a sigmoid constant of 1.0). After iterative adjust-
ment, the learning rate was set to 0.001, as it was the rate at which the highest accuracy
was achieved. MLP was run in Idrisi 16.04 (Eastman 2009).

5 Results and Discussion

SimWeight performed well for the deﬁnition of transition potentials, with accuracies
similar to MLP (Table 4). The spatial patterns of transition potentials (Figure 2, A and
C), and allocation of changes (Figure 2, B and D) are very similar between SimWeight
and MLP. The average correlation coefﬁcient between the transition potentials resulting

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(5)

Novel Method for Modeling Transition Potentials

575

Table 4 Accuracy of SimWeight as a function of k for
Bolivia

k

AUC

Yule’s Q

Correlation
with MLP

50
100
150
300
500
1000
1500
Average k
MLP

0.901
0.905
0.905
0.906
0.907
0.902
0.901
0.904
0.906

0.943
0.945
0.946
0.950
0.953
0.953
0.952
0.949
0.947

0.908
0.932
0.939
0.941
0.934
0.908
0.879
0.920
–

Figure 2 (A) SimWeight transition potentials; (B) a close-up of errors for SimWeight
hard prediction; (C) MLP transition potentials; and (D) a close-up of errors for MLP hard
prediction

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(5)

576

F Sangermano, J R Eastman and H Zhu

Figure 3 Comparison between ROC curves based on the testing data (using informa-
tion from T2) for SimWeight (k = 300) and MLP

from SimWeight and MLP (Table 4) was 0.92 and AUC statistic was greater than 0.9 (a
strong value) for both models. Moreover, ROC curves (Figure 3) show that the number
of true positives and false positives are also similar between the two methods. Inspection
of the weights ﬁle produced by MLP (Table 5) revealed that the variable distance to
agriculture 1992 was weighted strongly for hidden layer node 3, which was in turn the
one that contributed the most to the output node associated with change. On the other
hand SimWeight not only has a high weight for agriculture, but also considers slopes and
elevation as important variables (Table 2). This apparent difference in variable weight-
ing, although not tested in this work, may be responsible of the differences between the
SimWeight and MLP results.

When looking at the goodness of ﬁt of the models (Figure 4) we can see that
SimWeight and MLP have essentially the same goodness of ﬁt. Comparing how the
methods ﬁt the data to how that ﬁt extrapolates to the predicted data (Figure 5), the
training accuracy is higher than the testing accuracy (as expected).

As expected, the model is sensitive to changes in k in our case study. Increasing k
increased accuracy until it reaches a point (k = 500) where accuracy started to decrease.
Results produced with k = 300 correlated better with the MLP. Although some differ-
ences exist, the ROC curves for different k values are virtually identical and therefore not

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(5)

Novel Method for Modeling Transition Potentials

577

Table 5 Multi-layer perceptron ﬁnal weights

Weight of input node to hidden layer node:

Input layer nodes (variables)

1

1- Distance to agriculture 1992
2- Distance to roads
3- Distance to populated places
4- Slope
5- Elevation
6- Cost distance to Santa Cruz
Weight of hidden layer node to
transition potential output

-0.655
-0.313
-0.892
-0.242
0.107
-0.637
2.245

2

5.534
-5.904
1.849
5.376
5.747
6.218
-7.981

3

20.452
-1.419
0.052
0.937
-1.160
-1.408
17.877

Weights are given from input nodes (variables) to hidden nodes and from hidden nodes to output
nodes (transition potential for change and no-change). Here only weights for output node 1 are
included as this is the output used to generate the transition potential for change.

shown. Although increasing k increases computing time we recommend selecting the best
k for a particular case study through cross-validation. From our case study we can say
that k = 100 is a good compromise between computing time and model performance.
It can be seen in Figure 2 (B and D) that locations falsely predicted as change (false
alarms) are near areas where change occurred but were predicted as persistence (misses).
The location that changes at a particular time is one scenario from many plausible
patterns of change. For example, in the context of deforestation for agriculture, many
areas may be suitable but external factors, such as commodity prices, tenure regime or
technological changes (Cattaneo 2001), could affect whether the land will be deforested
at that point in time. In this work validation was performed using actual changes and
therefore the accuracy is affected by those external factors that were not included in the
model.

6 Conclusions

SimWeight is an effective method for the calculation of transition potentials for land
change modeling. The method does not require the speciﬁcation of complex parameters
and has the beneﬁt that it is easily understood and suitable for application by non-expert
modelers. It is also a distribution-free non-parametric procedure. The only parameter
required (k – the number of instances considered in deriving the transition potential) can
also be determined automatically. As it is shown here, SimWeight is capable of producing
results that rival or even exceed those of the Multi-Layer Perceptron. Further, unlike
MLP which is a black box, SimWeight can give feedback on the relative importance of
the independent variables, and the algorithm is simple to interpret.

Although SimWeight is a computationally intensive method, the algorithm is simple
and amenable to parallelization for deployment on the cloud. All that would be required
is that each node on the network has a copy of the training samples and a spatial subset
of the independent variables.

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(5)

578

F Sangermano, J R Eastman and H Zhu

Figure 4 Comparison between ROC curves based on the testing data (goodness of ﬁt)
for SimWeight (k = 300) and MLP

Figure 5 Comparison of ROC curves based on the training dataset (model ﬁt) and using
information from T2 (model prediction) for SimWeight (left) and MLP (right)

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(5)

Novel Method for Modeling Transition Potentials

579

Acknowledgements

The authors would like to thank T. Killeen and the Noel Kempff Mercado Museum for
providing the Bolivia datasets used in this study, and the two anonymous reviewers for
their comments on the manuscript. This research was supported by the Gordon and Betty
Moore Foundation and Google.org.

References

Blansché A, Gancarski P, and Korczak J J 2006 MACLAW: A modular approach for clustering with

local attribute weighting. Pattern Recognition Letters 27: 1299–306

Boger Z and Guterman H 1997 Knowledge extraction from artiﬁcial neural network
models. In Proceedings of the IEEE Systems, Man, and Cybernetics Conference, Orlando,
Florida

Boyd D S, Sanchez-Hernandez C, and Foody G M 2006 Mapping a speciﬁc class for priority
habitats monitoring from satellite sensor data. International Journal of Remote Sensing 27:
2631–44

Cattaneo A 2001 Deforestation in the Brazilian Amazon: Comparing the impacts of macro-
economic shocks, land tenure, and technological change. Land Economics 77: 219–40
Clark J D, Dunn J E, and Smith K G 1993 A multivariate model of female black bear habitat use

for geographic information systems. Journal of Wildlife Management 57: 519–26

De la Torre A, Peinado A M, Rubio J A, Segura J C, and Benítez C 2002 Discriminative feature
weighting for HMM-based continuous speech recognizers. Speech Communication 38:
267–86

Dettmers R and Bart J 1999 A GIS modeling method applied to predicting forest songbird habitat.

Ecological Applications 9: 152–63

Eastman J R 2009 IDRISI 16.04. The Taiga Edition. Worcester, MA, Clark University
Eastman J R, Van Fossen M E, and Solorzano L A 2005 Transition potential modeling for land
cover change. In Maguire D J, Batty, and Goodchild M F (eds), GIS, Spatial Analysis and
Modeling. Redlands CA, ESRI Press: 357–86

Fielding A H and Bell J F 1997 A review of methods for the assessment of prediction errors in

conservation presence / absence models. Environmental Conservation 24: 38–49

Fix E and Hodges J L 1951 Discriminatory analysis, nonparametric discrimination: Consistency
properties. Project No. 21-49-004, Report No. 4 USAF School of Aviation Medicine, Ran-
dolph Field, Texas, USA.

Foody G M, Boyd D S, and Sanchez-Hernandez C 2007 Mapping a speciﬁc class with an ensemble

of classiﬁers. International Journal of Remote Sensing 28: 1733–46

Gómez O, Morales E F, and González J A 2007 Weighted Instance-based learning using represen-
tative intervals. In Gelbukh A, Morales K, and Fernando A (eds) Advances in Artiﬁcial
Intelligence: Proceedings of the Sixth Mexican International Conference on Artiﬁcial Intelli-
gence, Aguascalientes, Mexico, Berlin, Spinger-Verlag Lecture Notes in Computer Science
Vol. 4827: 420–30

Hirzel A H, Hausser J, and Chessel D 2002 Ecological niche factor analysis: How to compute

habitat-suitability maps without absence data? Ecology 83: 2027–36

Killeen T J, Calderon V, Soria L, Quezada B, Steininger M K, Harper G, Solórzano L A, and Tucker

C J 2007 Thirty years of land-cover change in Bolivia. Ambio 36: 600–6

Pijanowski B C, Brown D G, Shellito B A, and Manik G A 2002 Using neural networks and GIS
to forecast land use changes: A land transformation model. Computers, Environment and
Urban Systems 26: 553–75

Pontius R G Jr and Schneider L C 2001 Land-cover change model validation by a ROC method.

Agriculture Ecosystems and Environment 85: 239–48

Pontius R G Jr, Cornell J, and Hall C A S 2001 Modeling the spatial pattern of land-use change
with GEOMOD2: Application and validation for Costa Rica. Agriculture, Ecosystems and
Environment 85: 191–203

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(5)

580

F Sangermano, J R Eastman and H Zhu

Sanchez-Hernandez C, Boyd D S, and Foody G M 2007 One-class classiﬁcation for mapping a
speciﬁc land-cover class: SVDD classiﬁcation of fenland. IEEE Transactions on Geoscience
and Remote Sensing 45: 1061–73

Soares-Filho B S, Pennachin C L, and Cerqueira G 2002 DINAMICA: A stochastic cellular
automata model designed to simulate the landscape dynamics in an Amazonian colonization
frontier. Ecological Modelling 154: 217–35

Stephenson D B 2000 Use of the “odds ratio” for diagnosing forecast skill. Weather Forecasting 15:

Swets J A 1986 Indices of discrimination of diagnostic accuracy: Their ROCs and implied models.

221–32

Psychological Bulletin 99: 100–17

Tahir T A, Bouridane A, and Kurugollu F 2007 Simultaneous feature selection and feature
weighting using hybrid Tabu Search / k-neareast neighbor classiﬁer. Pattern Recognition
Letters 218: 438–46

Tso B and Mather P M 2001 Classiﬁcation Methods for Remotely Sensed Data. New York, Taylor

and Francis

Verburg P H, de Koning G G J, Kok K, Veldkamp A, and Bouma J 1999 A spatial explicit allocation
procedure for modeling the pattern of land use change based on actual land use. Ecological
Modelling 116: 45–61

Yule G U 1900 On the association of attributes in statistics. Philosophical Transactions of the Royal

Society London 194A: 257–319

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(5)

