Geoinformatica (2011) 15:399–416
DOI 10.1007/s10707-010-0107-2

Controlling patterns of geospatial phenomena

Tomasz F. Stepinski · Wei Ding · Christoph F. Eick

Received: 9 February 2009 / Revised: 17 August 2009 /
Accepted: 13 January 2010 / Published online: 29 January 2010
© Springer Science+Business Media, LLC 2010

Abstract Modeling spatially distributed phenomena in terms of its controlling fac-
tors is a recurring problem in geoscience. Most efforts concentrate on predicting
the value of response variable in terms of controlling variables either through a
physical model or a regression model. However, many geospatial systems comprises
complex, nonlinear, and spatially non-uniform relationships, making it difficult to
even formulate a viable model. This paper focuses on spatial partitioning of control-
ling variables that are attributed to a particular range of a response variable. Thus,
the presented method surveys spatially distributed relationships between predictors
and response. The method is based on association analysis technique of identifying
emerging patterns, which are extended in order to be applied more effectively to
geospatial data sets. The outcome of the method is a list of spatial footprints,
each characterized by a unique “controlling pattern”—a list of specific values of
predictors that locally correlate with a specified value of response variable. Mapping
the controlling footprints reveals geographic regionalization of relationship between
predictors and response. The data mining underpinnings of the method are given and
its application to a real world problem is demonstrated using an expository example
focusing on determining variety of environmental associations of high vegetation
density across the continental United States.

T. F. Stepinski
Lunar and Planetary Institute, Houston, TX 77058, USA
e-mail: tom@lpi.usra.edu

W. Ding (B)
Department of Computer Science, University of Massachusetts Boston,
Boston, MA 02125-3393, USA
e-mail: ding@cs.umb.edu

C. F. Eick
Department of Computer Science, University of Houston, Houston, TX 77204-3010, USA
e-mail: ceick@uh.edu

400

Geoinformatica (2011) 15:399–416

Keywords Predictors–response relationship · Association analysis ·
Mapping predicting relationship · Vegetation density · Data mining

1 Introduction

A common problem in geoscience is to model an observed phenomenon in terms of
its likely predictors. Because physical models are usually difficult to formulate, the
data-centric regression modeling approach is prevalent. The most popular regression
models are global—a single predictive formula is holding over the entire data space.
However, in the geospatial context, where variables are often mutually interdepen-
dent in a spatially distributed fashion, assembling a viable global model can be very
difficult. One solution is to construct a model in the form of a regression tree [30],
which models different subsets of the data set by different linear regressions. This
approach is frequently used in geoscience. For example, in studying contamination
of soil by heavy metals, environmental engineers attempt to model occurrence of
contaminant on factors such as soil parameters, and catchment properties [15, 18, 28].
Similarly, hydrologists are modeling [24, 26] concentration of nitrate and/or phospho-
rus in stream water in terms of factors, such as antecedent precipitation index, air and
water temperatures, amount of discharge etc. Biologist model [10, 11] occurrence
of different species of plants based on co-occurrence of environmental factors such
as climate, landform, soil type, geomorphology and level of urbanization, and, in
agriculture, the crop yields are modeled [16] in terms of climate and soil properties.
In general, these (and similar) studies have two different but related goals: (1) to
obtain a classifier to be applied for objects for which the values of predictors are
know but the values of response are not, (2) to accept or reject a regression model as
a good description of the relationship between predictors and response. However,
it has been pointed out [29] that the regression tree model can also be used for
mapping spatial distribution of objects on the basis of the leaves of the tree to which
they belong. The resulting map reveals a geographic partition of the data set on the
basis of differences in relationships between predictors and response. For example,
in [29] it was demonstrated that the same level of richness of native species of birds in
Oregon is associated with different set of predictors (different leaves in the regression
tree) mapped to different geographical parts of Oregon. Thus, such methodology can
reveal a diversity of predictors leading to the same response.

In this paper we propose a new, fundamentally different approach to the discovery
of geographic regionalization of relationships between predictors and response. The
presented method follows our earlier efforts [7, 27] to develop means for studying
relationships between various spatial variables using a branch of data mining tech-
niques called association analysis. The goal of association analysis is to discover rules
(or patterns) that capture affinity of objects in a data set. Association analysis was
originally developed [1] to analyze so-called market basked transactions but was
since applied to other domains, such as bioinformatics, medical diagnosis, and Web
mining. Because of its origins, the association analysis works natively on categorical,
non-spatial variables and needs to be modified for applications in geoscience. On
the other hand, the analysis is completely data-centric, it requires no modeling
assumptions, and is capable of yielding results based on simple, clearly understood
principles.

Geoinformatica (2011) 15:399–416

401

Our core idea is as follows. First, we assemble a geospatial data set where objects
are the pixels carrying local values of predictor and response variables. Throughout
this paper we will also refer to predictors as “explanatory variables,” and to response
as “class variable.” Second, we mine this data set for frequent emerging patterns.
Note that in the context of this paper a pattern refers to a composition of non-spatial
attributes (explanatory variables) and not to a spatial object which we refer to as a
footprint. Initially introduced by [9], emerging patterns are the patterns that contrast
two different data classes; they are frequent in one data class but rare in another
data class. In our context, we divide the range of response variable into “interesting”
(referred to as phenomenon) and “other” and mine for emerging patterns with
respect to the phenomenon. Such emerging patterns are controlling patterns of the
phenomenon because they are associated predominantly with its presence. Different
patterns represent different combinations of predictors leading to a phenomenon.
Mapping the footprints of controlling patterns reveals regionalization and diversity
of predictors leading to the same phenomenon.

The rest of the paper is organized as follows. Section 2 gives a brief introduc-
tion into emerging patterns. In Section 3 we give a detailed description of our
methodology. This includes spatially-specific extensions to a standard technique of
association analysis and methods for pre-processing original data to categorical form
required by the association analysis. In Section 3 we present an application of our
methodology to an expository example pertaining to environmental correlates of
high vegetation density across the continental United States. Conclusions and future
research directions are given in Section 5.

2 Emerging patterns

Emerging patterns are patterns whose supports increase significantly from one data
set to another [9], hence they are a useful tool to capture a contrast between two
different data sets or between two classes within a single data set. Emerging patterns
have been successfully applied in many domains including medical science [2, 12–14],
monitoring network traffic [5], data credibility analysis [20], etc. For example, in
medical studies, a single data set of subjects (R) can be divided into two mutually
exclusive and exhaustive classes: subjects showing symptoms of a disease (D) and
those in a control group (C) free from the symptoms. The patterns to be considered
consist of various factors that can potentially lead to the development of the disease.
The task is to mine for emerging patterns that are frequent in D but absent or
significantly less frequent in C. Taken collectively, the emerging patterns identify
all combinations of risk factors leading to disease development and thus contribute
to the understanding of the root causes of the disease.

Our method is based on an analogous application of emerging patterns but to
the spatial data sets. The previous application of emerging pattern to spatial data
sets [4] concentrated on a small number of objects making possible to store their
spatial interactions in a relational table. In this paper we apply emerging patterns to
raster data sets which call for a different approach. First, because most geospatial
rasters contain continuous variables, these variables need to be categorized in order
to be subjected to association analysis. We propose a categorization procedure
that can accommodate non-Gaussian distributions and assures that all variables are

402

Geoinformatica (2011) 15:399–416

categorized in a correspondent manner. Second, we propose a modification to the
standard definition of pattern support in order to alleviate arbitrariness in dividing
the class variable on the basis of discretization.

3 Methodology

Modern geospatial data sets originate from remote sensing and are given in the
form of rasters. In such context, an object in a database is a raster cell or a pixel.
Hereafter, we will use the terms objects and pixels interchangeably. Older data sets
originate from manual measurements and are given in the form of tables. In such
data sets, an object is a table entry. Our method works equally well with raster
or table data sets; if necessary we perform a table to raster conversion. In most
cases the measurements are real numbers from a continuous domain. Because the
emerging-pattern technique requires categorical data, the first step in our method is
to categorize the data.

3.1 Data preprocessing

The numerical values of explanatory variables come from their respective distribu-
tions that could have quite different functional forms. Therefore, it is necessary to
normalize the values of different variables to the common meaning. The two most
important properties of any distribution is its center (μ) that indicates location of the
bulk of the data, and the scale (σ ) that indicates dispersion around the center. For
variables having bell-shaped distributions, μ and σ can be easily estimated using the
mean and the standard deviation, respectively. However, the mean and the standard
deviation are biased estimates of μ and σ for variables with skewed distribution of
their values. For μ, a robust estimator is the trimmed mean calculated by discarding
a certain percentage of the lowest and the highest values. Note that the median, ˜x, is
a particular example of the trimmed mean. For σ , a robust estimator is a function Sn
introduced by [23]:

Sn = c medi{med j|xi − x j|}

(1)

where c is a constant having the value of 1.1926, and med is the median operator. Sn,
whose numerical complexity is O(n log n) [23], is a measure of dispersion around the
center that works equally well for symmetric as well as asymmetric distributions.

In order to normalize the values of explanatory variables to a common meaning,
we transform them to their modified z-scores (x − ˜x)/Sn. We refer to this expression
as the “modified” z-score because it has the same form as an ordinary z-score, but
with the values of the mean and the standard deviation replaced by the values of ˜x
and Sn. Thus, the modified z-score is the number of Sn that a given value of a variable
is above or below the median calculated from the global distribution of this variable.
The positive values of z-score indicate upward deviations from the median, whereas
the negative values of z-score indicate downward deviations from the median. Two
different variables with the same z-score are “equal” in the sense that both are
deviated by the same relative amount from the centers of their distributions. The
data sets are categorized by first transforming them to their modified z-scores and
then assigning the z-scores into n bins using n − 1 split points. The z-score of a given

Geoinformatica (2011) 15:399–416

403

variable is converted to an integer number corresponding to the bin to which it
belongs. This transforms all real-valued data sets into categorical data sets with a
common range.

3.2 Problem definition

The fusion of all data sets relevant to a given task results in a geospatial data set
R—a raster where each pixel is an object having a form of a tuple

r = {x, y; a1, a2, ..., am; cl}

(2)

where the first two entries (x, y) are spatial coordinates, the next m entries
a1, a2, ..., am are categorical values of m explanatory variables that can potentially
exert control over the class variable, and the last entry cl is a binary variable that
indicates whether the class variable has a value of interest (cl = 1) or not (cl = 0).
Disregarding the location information (x, y), each object in R can be viewed (from
the point of view of association analysis) as a transaction {a1, a2, ..., am; cl}. All
transactions are classified into two mutually exclusive and exhaustive sets: data
set D grouping transactions with cl = 1 (phenomenon) and data set C grouping
transactions with cl = 0. A pattern (itemset) is a set of items contained in a trans-
action. For example, assuming m = 10, P = {2, _, _, _, 3, _, _, _, _, _; 1} is a pattern
indicating that a1 = 2, a5 = 3 , and cl = 1 while the values of all other variables
are not specified. A transaction supports the pattern P if it has specified values of
indicated attributes. The footprint of the pattern P is the set of pixels corresponding
to transactions that support the pattern. For example, Fig. 1b illustrates the footprint
of a pattern {_, _, _, _, _, _, _, _, _, _; 1} where cl = 1 indicates the class of “high”
values of vegetation density.

(a)

(b)

Fig. 1 a Map of vegetation density in the United States. The value of Normalized Difference
Vegetative Index (NDVI) serves as proxy for vegetation density. b Footprint of high vegetation
density region D defined by the two highest categorical bins of class variable is shown in green. A
zoomed-in window centered on the states Virginia and Maryland shows sharp boundaries of high
vegetation density footprint in details

404

Geoinformatica (2011) 15:399–416

We defined a controlling pattern as:

Deﬁnition 1 A controlling pattern (CP) P in D is an itemset such that its growth
ratio C PD

P fulfills the criterion

C P

D
P

= sup(P, D)
sup(P, C)

≥ ρ

where ρ is a user-defined minimum growth-ratio threshold, and sup(P, D) and
sup(P, C) are the support of a pattern P in D and C, respectively. Pattern support
is basically a measure of the size of its footprint; we give a formal definition of sup()
in the following subsection. We refer to such itemsets as controlling patterns, because
they correspond to particular values of certain explanatory variables that happen to
be associated in disproportionally large numbers with cl = 1 objects. It is therefore
expected that they constitute controlling factors for the distribution of cl = 1 objects.

3.3 Calculating pattern support

Let’s F be a set of transactions (corresponding to a set of pixels) which support a
given pattern P, and G be a set of transactions (corresponding to the remaining set
of pixels) which do not support P. We define the following sets:
– D+ = D ∩ F , pixels of interest that support P
– D− = D ∩ G, pixels of interest that do not support P
C+ = C ∩ F pixels of no interest that support P
–
C− = C ∩ G pixels of no interest that do not support P
–
The support of P in data sets D and C is defined as:

Thus,

sup(P, D) =

, sup(P, C) =

|D+|
|D|

|C+|
|C|

C P

D
P

= sup(P, D)
sup(P, C)

=

|D+|/|D|
|C+|/|C|

(3)

(4)

where | | denotes the number of elements in a set. Notice that |D+| + |D−| + |C+| +
|C−| = |R|. Discovering controlling patterns is a matter of evaluating C PD
P given by
Eq. 4 for a set of viable patterns and selecting those patterns that have C PD
≥ ρ.
P

Without loss of generality our method models one aspect of the class variable at
the time. Thus, the set D is defined by an arbitrary threshold (or thresholds) that
identifies this aspect. For example, in the case study of the vegetation density, D
may correspond to pixels having “high” density of vegetation. In our application
“high” density of vegetation is defined by belonging to the two highest z-score
categories (see Section 4). Figure 1a depicts the distribution of vegetation density
in the United States. Figure 1b depicts a footprint of D corresponding to a high
density of vegetation. Note that a smooth transition from high to low vegetation
density is observed in Fig. 1a, but the footprint of D in Fig. 1b has artificially sharp
and complicated boundary—an artifact of data discretization.

In order to offset the effects of data discretization, we redesign a definition of
pattern support without changing the footprints of the patterns themselves. We

Geoinformatica (2011) 15:399–416

observe that due to the spatial continuity of class variable data, many pixels nearby
the footprint of D are expected to have values of class variable, that although lower
than a required threshold, are nevertheless quite close to this threshold. We propose
to incorporate this observation into a new definition of sup(P, D). Specifically, we
propose a following modification of |D+| that we denote by |D+|∗

:

(cid:2)

|D+|∗ =

w(o, D)

o∈F
where o is a pixel belonging to F and w(o, D) is a weight determined on the basis
of spatial proximity of this pixel to D. The weight is calculated using the following
formula:

w(o, D) =

(cid:3)

o ∈ D
1
(cid:4)(h(o, D)) o ∈ C

The influence function (cid:4) determines the weights for objects outside the footprint
of D. In the traditional definition of pattern support, (cid:4)() = 0 and |D+|∗ = |D+|.
However, when working with spatially extended data, an influence function (cid:4)() (cid:6)= 0
better captures the character of the data; in this paper, we use a half normal
distribution as the influence function:

(cid:4)(ξ ) = exp

(cid:4)

(cid:5)

−θ 2ξ 2
π

where θ, θ ∈ [0, ∞), is a free parameter. The function (cid:4) determines the weights for
the objects that are within the footprint of the pattern but outside the footprint of
D; the farther a pixel o is from D, the less it counts toward the pattern support.
The function h(o, D) used by the influence function (cid:4) is a special case of Hausdorff
distance [17] in the spatial domain. It measures the distance between a pixel o and
the data set D as the distance between o and the nearest pixel in D.

Figure 2 illustrates the concept of weights as applied not to a particular pattern P
but rather to the entire data set (F in Eq. 5 is replaced by R). The vegetation density
data is used. The high vegetation density regions (D) are surrounded by nearby pixels
that have weights decreasing with increasing distance from the region. The smaller
the value of θ, the more surrounding pixels will be taken into account. Thus, using
our measure of support, the support of the pattern P “in” D is increased (|D+|∗ >
|D+|) if a significant number of pixels close to the footprint of D conform to this
pattern. Simultaneously, in such a situation, the support of P in C must be decreased
by the same amount. This is captured by a modification of |C+| by a measure denoted
by |C+|∗

|C+|∗ =

[1 − w(o, D)]

(cid:2)

o∈F

C P

D
P

∗ =

|D+|∗/|D|
|C+|∗/|C|

Finally, the controlling patterns are mined using the new definition of pattern

support,

Note that in Eq. 9, we do not modify the values of |D| and |C|, and the total number
of pixels is preserved: |D+|∗ + |D−| + |C+|∗ + |C−| = |R|.

405

(5)

(6)

(7)

(8)

(9)

406

Geoinformatica (2011) 15:399–416

Fig. 2 Illustrating a new method of calculating pattern support by including fractional support from
nearby pixels. Original footprint of high vegetation density region is shown in green (weight = 1),
pixels contributing weights in the range (1, 0.5) are shown in red, those contributing weights in the
range (0.5, 0.25) are shown in yellow, in the range (0.25, 0.1) are shown in blue, and those contributing
less than 0.1 are shown in gray. The result depends on the value of θ: 0.25 (left), 0.5 (middle), and
0.75 (right)

3.4 Measuring spatial aggregation of footprints

Spatial character of controlling-pattern footprints differs from one pattern to an-
other; patterns with more aggregated footprints are arguably more likely to reveal
important controlling factors than the patterns with more disperse footprints because
a pattern extending over a well-defined region is more likely to correspond to coordi-
nation of factors due to specific regional conditions whereas a pattern extending over
dispersed pixels is more likely to correspond to coordination due to coincidence.
We use Ripley’s K function [6], a statistical method frequently applied to point
pattern analysis, to quantify degree of footprint aggregation. Without considering
edge effects, Ripley’s K function is estimated as [6]:

ˆK(d) = F
N2

N(cid:2)

N(cid:2)

i=1

j=1, j(cid:6)=i

Id(dij)

(10)

where N is the number of pixels in the footprint of the pattern P, dij is the distance
between the ith and jth pixel, Id(dij) is the indicator function which is 1 if dij ≤ d and
0 otherwise, F is the area of a footprint, and d is a free parameter corresponding to a
distance scale. In order to infer clustering properties of a footprint, the value of ˆK(d)
is compared to the value calculated for a completely random (homogeneous Poisson
process) ensemble of points that is Ko(d) = π d2,
(cid:7)

ˆK(d)
Ko(d)
where kP > 1 indicates spatial aggregation, and kP < 1 indicates spatial segregation.
The larger value of kP indicates a more aggregated pattern P.

kP =

(11)

=

ˆK(d)
π
d

(cid:6)

Geoinformatica (2011) 15:399–416

407

3.5 Algorithm for discovering controlling patterns

We have designed and implemented an algorithm called mineCP to identify the
controlling patterns. We mine for controlling patterns from amongst all the patterns
that are frequentin D. In the first step, the mineCP algorithm (see Algorithm 1) finds
these frequent patterns using a user-defined support threshold. We use an efficient
depth-first search method introduced by Burdick et al. in [3] to find the frequent
patterns. In the second step, the algorithm calculates the modified pattern support.

The most computationally intensive part of our method is to calculate distance
h(o, D) for each pattern Pi. To circumvent this problem, we introduce a distance
matrix M that is spatially co-registered with the raster R. The distance matrix M
is pre-calculated to record the distance values of nearby pixels to the footprint of
D. Specifically, the cells in M that support at least one pattern (o ∈ ∪Fi) and are
also located in D are set to the value of 1. For the remaining cells we calculate
Hausdorff distance h(o, D), using steps 4–7 of the algorithm mineCP. A gain in
performance is achieved because pattern footprints often overlaps, and the distance
is only calculated at most once for each pixel in C. In steps 9–10, we calculate
|D+|∗
(see Eqs. 5 and 8) for each frequent pattern Pi, using the pre-
calculated values in the distance matrix M. In step 11, we calculate kPi to evaluate
an aggregation a frequent pattern Pi. Finally, frequent patterns whose growth ratios
are greater than the minimum growth-ratio threshold ρ are reported as controlling
patterns.

and |C+|∗

Algorithm 1 mineCP: Mining Controlling Patterns
1: Mine frequent patterns in a transaction set D using a support threshold δ; output

spatial footprint Fi of each frequent pattern Pi.

Calculate the distance h(o, D).

2: Initialize a distance matrix M.
3: Assign every pixel in R to a correspondent cell in M.
4: for each pixel o ∈ (∪Fi) ∩ C do
5:
6: Record the distance in corresponding cell of the distance matrix M.
7: end for
8: for each frequent pattern Pi do
9:

with respect to Pi using the distance matrix M.

10:

and |C+|∗

Calculate |D+|∗
Calculate growth ratio C PD
P
Calculate kPi .

11:
12: end for
13: return frequent patterns whose growth ratios ≥ ρ.

∗ = |D+|∗/|D|
|C+|∗/|C| .

4 Controlling patterns of high vegetation density in the United States

In order to illustrate the working of our method and to demonstrate its utility,
we applied it to a data set pertaining to a density of vegetation cover across the
continental United States. The goal is to survey all combinations of controlling
factors that are associated with high density of vegetation and to map their footprints.
We address this goal by finding controlling patterns of high vegetation density.
The class variable is the Normalized Difference Vegetation Index (NDVI). The

408

Geoinformatica (2011) 15:399–416

NDVI is an index calculated from visible and near-infrared channels of satellite
observations, and it serves as a standard proxy of vegetation density. The eleven
plausible explanatory variables are summarized in Table 1; they can be divided
into climate-related (average annual precipitation rate, average minimum annual
temperature, average maximum annual temperature, and average dew point tem-
perature), soil-related (available water capacity, bulk density, permeability, porosity,
and soil pH), and topography-related (elevation). The available water capacity is
the volume of water that soil can store for plants. The pH measures the degree
to which water in soil is acid or alkaline. Bulk density, porosity, and permeability
relate to the physical form of the soil. The dew temperature is an indicator of relative
humidity. We made an attempt to use data pertaining to measurements performed at
approximately the same time. These data sets are from different sources [19, 21, 25]
and are available in different spatial resolutions. We have fused all the data sets
to 11 co-registered latitude–longitude grids with a resolution of 0.5o × 0.5o. Each
grid has 700 × 1,253 pixels, of which 361,882 pixels (41.3%) have values for all the
11 variables. Note that this is an expository example intended only to illustrate

Table 1 Data sets of
explanatory variables used in
the case study

Variable abbreviation

Short description

3. dew

Average dew point temperature

1. awc

2. bd

4. elev

5. perm

6. ph

7. poros

9. tmax

10. tmin

11. aveveg

Available water capacity (2000)
ORNL for biogeochemical and

ecological data

Soil bulk density (2000)
ORNL for biogeochemical and

ecological data

(annual 2005)

PRISM climate mapping system
Elevation
USGS National Map Seamless Server
Soil permeability (2000)
ORNL for biogeochemical and

ecological data

Soil pH (2000)
ORNL for biogeochemical and

ecological data
Soil porosity (2000)
ORNL for biogeochemical and

ecological data

PRISM climate mapping system
Average annual maximum temperature

(1971–2001)

(1971–2001)

PRISM climate mapping system
Average annual minimum temperature

(1971–2001)

PRISM climate mapping system
Vegetation growth average

(annual 2005)

USGS National Map Seamless Server

8. ppt

Average annual precipitation

Geoinformatica (2011) 15:399–416

409

the working of our method, because a more careful selection of a larger set of
explanatory variables should be performed in ecological domain for an “industrial-
strength” application.

All data sets are subjected to the categorization procedure described in Section 3.1
(−2, −1.5],
with six split points resulting in seven z-score bins (−∞, −2],
(−1.5, −0.5], (−0.5, 0.5], (0.5, 1.5], (1.5, 2], and (2, ∞), which are assigned categorical
labels from 1 to 7, respectively. The NDVI data set is divided into two subsets, D
with cl = 1, combining categories 6 and 7 of (0.5, 1.5] and (1.5, 2], and C with cl = 0,
combining categories 1 to 5 of (−∞, −2], . . ., (0.5, 1.5]. Thus, the vegetation density
is arbitrarily defined as high when it is at least 1.5 ×Sn higher than the median value.
Figure 1b shows the spatial distribution of D. Each pixel carries a specific transaction
consisting of the local values of explanatory variables and the class designation of
vegetation density.

4.1 Results

We have conducted two numerical experiments. In the first primary experiment,
we have employed the algorithm mineCP to identify controlling patterns of high
vegetation density. In the second control experiment we have calculated controlling
patterns using an algorithm that does not take advantage of a new definition of
sup(P, D). In both experiments we used frequent pattern threshold δ = 0.2 and the
minimum growth-ratio threshold ρ = 10.0. Thus, we set up experiments to identify
patterns whose footprints extend over at least 20% of the vegetation cover across the
continental United States and which are at least 10 times more concentrated in the
high vegetation density region. We also use d = 1 as a value of scale parameter in
the footprint aggregation measure kP (Eq. 11). In the primary experiment, we use
the influence function (cid:4) (Eq. 7) with θ = 0.25,

The primary experiment has identified 893 patterns frequent in D, 780 of which
have been determined to be controlling patterns. Figure 3 shows the values of the
growth ratio C PD
for all the 780 controlling patterns plotted against the values of
P
kP. The patterns are color-coded for the number of items present. The blue dots
indicate patterns consisting of up to 3 items; the green dots indicate patterns with
four to six items; the red dots indicate patterns with seven or more items. In general,
the most interesting patterns are those indicated by the red dots and also located

∗

Fig. 3 Properties of 780
controlling patterns of high
vegetation density in the
United States. Colors:
blue—patterns with 1–3 items,
green—patterns with 4–6
items, and red—patterns with
≥ 7 items

3.0

2.8

2.6

2.4

2.2

2.0

1.8

1.6

P
k

0

20

40

100

120

140

80

60
growth ratio

410

Geoinformatica (2011) 15:399–416

near the upper right corner of the graph. Such patterns are the most descriptive,
highly specific to high vegetation density region, and they have highly aggregated
footprints. Several immediate observations can be drawn from Fig. 3:

– All the controlling patterns have kP ≥ 1. This means that the complexes of

controlling factors that are common in D are spatially aggregated.

∗

– There appear to be some positive correlations between the values of the growth
and kP. This indicates that patterns that are more indicative of high

ratio C PD
P
vegetation density are also more aggregated.
Patterns with more attributes are more aggregated. More specific sets of control-
ling factors are restricted to more specific locations.

–

Tables 2 and 3 show the lists of the top 20 controlling patterns identified in
the control and primary experiments, respectively. The 1st column gives a pattern
ID number; the 2nd column shows the actual pattern; and the 3rd column gives
the number of features that match the pattern. The patterns are to be interpreted
as described in Section 3.2. For example, pattern #56 (top emergent pattern on
both lists) describes environment characterized by below average values (bin 3)
of pH and above average values (bin 6, (1.5, 2]) of precipitation. Values of the
remaining nine explanatory variables vary from pixel to pixel within the footprint
of this pattern. Thus, pattern #56 is not very specific as it involves only two out
of 11 potential explanatory variables, but the conditions it describes exist in above
20% of the vegetation cover in the continental United States (frequent pattern)
and almost nowhere outside the high vegetation density region (highly emergent
pattern). Other emergent patterns are more descriptive; the most descriptive pattern
in the top 20 controlling patterns (#832) involves seven out of 11 explanatory
variables.

Table 2 Top 20 controlling patterns found in the control experiment

Pattern ID

# of variables

56
12
312
586
555
780
135
337
314
588
114
34
318
568
530
695
765
549
441
776

Patterns
ph = 3, ppt = 6
ppt = 6
awc = 4, perm = 4, ph = 3, tmax = 5
awc = 4, perm = 4, ph = 3, tmax = 5, tmin = 5
awc = 4, elev = 3, perm = 4, ph = 3, tmax = 5
awc = 4, elev = 3, perm = 4, ph = 3, tmax = 5, tmin = 5
perm = 4, ph = 3, tmax = 5
perm = 4, ph = 3, tmax = 5, tmin = 5
elev = 3, perm = 4, ph = 3, tmax = 5
elev = 3, perm = 4, ph = 3, tmax = 5, tmin = 5
dew = 6, elev = 3, ph = 3
dew = 6, ph = 3
awc = 4, perm = 4, ph = 3, tmin = 5
awc = 4, elev = 3, perm = 4, ph = 3, tmin = 5
awc = 4, bd = 4, perm = 4, ph = 3, tmax = 5
awc = 4, dew = 5, perm = 4, ph = 3, tmax = 5, tmin = 5
awc = 4, bd = 4, perm = 4, ph = 3, tmax = 5, tmin = 5
awc = 4, perm = 4, ph = 3, poros = 5, tmax = 5
awc = 4, dew = 5, perm = 4, ph = 3, tmax = 5
awc = 4, perm = 4, ph = 3, poros = 4, tmax = 5, tmin = 5

2
1
4
5
5
6
3
4
4
5
3
2
4
5
5
6
6
5
5
6

Geoinformatica (2011) 15:399–416

Table 3 Top 20 controlling patterns found in the primary experiment

Pattern ID

411

# of variables

56
114
34
312
555
586
780
162
314
135
360
337
588
393
695
639
441
318
832
671

Patterns
ph = 3, ppt = 6
dew = 6, elev = 3, ph = 3
dew = 6, ph = 3
awc = 4, perm = 4, ph = 3, tmax = 5
awc = 4, elev = 3, perm = 4, ph = 3, tmax = 5
awc = 4, perm = 4, ph = 3, tmax = 5, tmin = 5
awc = 4, elev = 3, perm = 4, ph = 3, tmax = 5, tmin = 5
awc = 4, ph = 3, tmax = 5
elev = 3, perm = 4, ph = 3, tmax = 5
perm = 4, ph = 3, tmax = 5
awc = 4, elev = 3, ph = 3, tmax = 5
perm = 4, ph = 3, tmax = 5, tmin = 5
elev = 3, perm = 4, ph = 3, tmax = 5, tmin = 5
awc = 4, ph = 3, tmax = 5, tmin = 5
awc = 4, dew = 5, perm = 4, ph = 3, tmax = 5, tmin = 5
awc = 4, elev = 3, ph = 3, tmax = 5, tmin = 5
awc = 4, dew = 5, perm = 4, ph = 3, tmax = 5
awc = 4, perm = 4, ph = 3, tmin = 5
awc = 4, dew = 5, elev = 3, perm = 4, ph = 3, tmax = 5, tmin = 5
awc = 4, dew = 5, elev = 3, perm = 4, ph = 3, tmax = 5

2
3
2
4
5
5
6
3
4
3
4
4
5
4
6
5
5
4
7
6

The lists of controlling patterns stemming from primary and control experiments
overlap, but they don’t contain the same patterns; the patterns that don’t occur
in both lists are highlighted in Tables 2 and 3. Moreover, the order of patterns in
the two lists is different. Thus, the modification of sup(P, D) leads to identification
of different controlling patterns, or, at least, to different ordering of controlling
patterns. We observe that pattern #12 is absent in the top 20 patterns identified in
the primary experiment, though it is ranked as the 2nd best in the control experiment.
On the other hand, in the primary experiment, pattern #114 has improved its rank
significantly ranking 2nd, and new patterns, such as pattern #162, emerge in the top
20 list.

Does our new definition of sup(P, D) lead to “better” controlling patterns? In
Section 3.3, we presented a heuristic argument for our modification, based on the
notion that it offsets negative effects of data discretization. Do the results in Tables 2
and 3 support our argument? In order to address this problem quantitatively, we
calculate “similarity” or degree of overlap between the footprint of D (region of
high vegetation density) and the footprints of the following patterns respectively,

–
–

–

#12, 2nd on the top 20 list resulting from the control experiment,
#114, 2nd on the top 20 list resulting from the primary experiment and 12th on the
top 20 list resulting from the control experiment,
and #162, 8th on the top 20 list resulting from the primary experiment.

The similarity is calculated using a measure based on mutual information between
the two footprints [22]. The more the two footprints overlap the more one footprint
determines the other footprint resulting in the larger value of mutual information.
The mutual information-based similarity between the footprint of D and footprints
of patterns #12, #114, #162 are 0.0188, 0.0214, and 0.0489, respectively. This shows

412

Geoinformatica (2011) 15:399–416

(a) Pattern # 12

(b) Pattern # 114

(c) Pattern # 162 

Fig. 4 a–c Footprints of patterns #12, #114, #162. Colors: green—high vegetation density region,
pink—footprints of patterns, dark brown—overlays between pattern footprint and high vegetation
density region

that the footprints of patterns #114 and #162, whose ranks are increased while using
the new definition of sup(P, D), match better with the region of high vegetation
density than the footprint of pattern #12 whose rank decreases while using the new
definition of sup(P, D). Thus, the new definition seems to promote patterns which
offer a better spatial fit to the region of interest. Figure 4a–c reiterate the same
point in a graphical fashion; compared with the footprint of pattern #12, footprints
of patterns #114 and #162 align better with the footprint of high vegetation density
region.

To further demonstrate the advantage of using a modified definition of sup(P, D),
we compare the unions of footprints of all 20 patterns stemming from the primary
and control experiments, respectively. Figure 5a–b show such comparison; careful
examination reveals that the union of footprints shown in Fig. 5a is more “land
filling,” exactly the effect we intended to achieve by our modification. The mutual
information-based similarity between the footprint of D and the unions of footprints
of the 20 top pattern calculated in the primary and control experiments is 0.0649 and
0.0563, respectively.

It is instructive to examine the values of explanatory variables as they appear
as items in the top 20 patterns in Table 3. Interestingly, top controlling patterns
contain only a limited range of values for each variable. For example, in the patterns
that contain average annual maximum temperature (tmax) only values of tmax =
5 (0.5 to 1.5 × Sn above the median value of tmax) are present. Similarly, top
controlling patterns contain only the values pH = 3 (0.5 to 1.5 × Sn below the median
value of pH). In general the range is at most two consecutive bins. This indicate
that environmental conditions that support high vegetation density are restricted

Fig. 5 Union of footprints for
the top 20 patterns stemming
from the primary experiment
(a) and control experiment (b).
Colors: green—high vegetation
density region, pink—union of
footprints, dark brown—
overlays between the union of
footprints and high vegetation
density region

(a) primary experiment

(b) control experiment

Geoinformatica (2011) 15:399–416

413

to rather narrow values of explanatory variables, although, within these limits, the
specific conditions may vary between different geographical locations.

5 Conclusions

In this paper, we have presented a methodology for surveying and mapping re-
lationships between predictors and response in geospatial data sets. In particular,
our method reveals diversity of predictors associated with the same response. In
departure from a previous attempt to address this problem [29], we base our method
on the association analysis technique of mining for emerging patterns which offers
a principled approach to the problem and also has several potential advantages.
First, the model (at its core) is conceptually strong and transparent—the only
numerical operation is pixel counting. This intrinsic simplicity of association analysis
assures that all nonlinearities in the system are taken fully into account. Second, the
method yields itself into modification that accommodates the spatial character of
the data. We show how to modify the standard association analysis methodology
to accommodate spatial data sets. Evaluation of the vegetation data set confirmed
that those modifications lead to somewhat improved result over an application of
unmodified method.

Our approach, in its present form, has some shortcomings that need to be
addressed by further research. One issue is the need for data categorization. This
issue enters only in the context of dividing a response variable into the two
classes. In the present paper we addressed this issue by modifying the definition
of pattern support so it takes into consideration spatial proximity. Future research
would concentrate on further improvement of the definition of pattern support,
so it takes into consideration not only spatial proximity but also feature similarity.
Another issue is the difficulty in interpreting the outcome of our method. This is
a common problem with the association analysis; it produces thorough but large
output that frequently requires a summarization technique in order to presented
the results in a comprehensive fashion. In our application to the vegetation data
set, we have identified 780 controlling patterns. Each controlling pattern represents
a nugget of knowledge about the local combination of predictors associated with
the phenomenon. However, this association is not exclusive, other patterns may also
cover the same location. In general, footprints associated with controlling patterns
are not mutually exclusive and exhaustive, instead they overlap and their union
does not necessarily cover the entire extent of the phenomena. In Section 4, we
have showed top 20 controlling patterns as well as footprints for few patterns, more
extensive visualization would take significantly more space. In order for the results
of our method to be more effectively presented a companion method of pattern
summarization needs to be developed. We have already taken the first step into
this direction by investigating a possibility to define a similarity measure between
the patterns [8]. Such similarity could be used to cluster the patterns into a smaller
number of “super-patterns”—a sets of patterns having similar meaning and sharing
common spatial extent [8]. Super-patterns would provide a more concise means to
visualize our output and they would make possible a direct comparison of our results
with the results of the method based on the regression tree [29].

414

Geoinformatica (2011) 15:399–416

Acknowledgements The work is supported in part by the National Science Foundation under
Grant IIS-0812271. A portion of this research was conducted at the Lunar and Planetary Institute,
which is operated by the USRA under contract CAN-NCC5-679 with NASA. This is LPI Contribu-
tion No. 1532.

References

1. Agrawal R, Imielinski T, Swami AN (1993) Mining association rules between sets of items
in large databases. In: Buneman P, Jajodia S (eds) Proceedings of the 1993 ACM SIGMOD
international conference on management of data. Washington, D.C., pp 26–28, 207–216

2. Boulesteix AL, Tutz G, Strimmer K (2003) A cart-based approach to discover emerging patterns

in microarray data. Bioinformatics 19(18):2465–2472

3. Burdick D, Calimlim M, Gehrke J (2001) Mafia: a maximal frequent itemset algorithm for trans-
actional databases. In: Proceedings of the 17th international conference on data engineering.
Heidelberg, Germany

4. Ceci M, Appice A, Malerba D (2007) Discovering emerging patterns in spatial databases: a multi-
relational approach. In: Knowledge discovery in databases: PKDD 2007, series: lecture notes in
artificial intelligence, vol 4702. Springer, Berlin, pp 390–397

5. Cormode G, Muthukrishnan S (2004) What’s new: finding significant differences in network data

streams. In: IEEE INFOCOM

6. Cressie, NA (1993) Statistics for spatial data. Wiley, New York
7. Ding W, Stepinski TF, Parmar R, Jiang D, Eick CF (2009) Discovery of feature-based hot spots

using supervised clustering. Comput Geosci 35:1508–1516

8. Ding W, Stepinski TF, Salazar, J (2009) Discovery of geospatial discriminating patterns from
remote sensing datasets. In: SIAM international conference on data mining (SDM), Nevada,
April 2009

9. Dong G, Li J (1999) Efficient mining of emerging patterns: discovering trends and differences.
In: KDD ’99: proceedings of the fifth ACM SIGKDD international conference on knowledge
discovery and data mining. San Diego, California, United States

10. Korkalainen T, Lauren A (2006) Using phytogeomorphology, cartography and GIS to explain
forest site productivity expressed as tree height in southern and central Finland. Geomorphology
74:271–284

11. Larsen DR, Speckman, PL (2004) Multivariate regression trees for analysis of abundance data.

12. Li J, Wong L (2005) Structural geography of the space of emerging patterns. Intelligent Data

Biometrics, 60(2):543–549

Analysis 9(6):567–588

13. Li J, Yang Q (2007) Strong compound-risk factors: efficient discovery through emerging patterns

and contrast sets. IEEE Trans Inf Technol Biomed 11:544–552

14. Li J, Liu H, S-K Ng, Wong L (2003) Discovery of significant rules for classifying cancer diagnosis

data. Bioinformatics 19:ii93–ii102

15. Liaghati T, Preda M, Cox M (2003) Heavy metal distribution and controlling factors within
coastal plain sediments, Bells Creek catchment, southeast Queensland, Australia. Environ Int
29:935–948

16. Lobell, J. I. Ortiz-Monasterio, Asner GP, Naylor RL, Falcon WP (2005) Combining field sur-
veys, remote sensing, and regression trees to understand yield variations in an irrigated wheat
landscape. Agron J 97:241–249

17. Munkres J (1999) Topology, 2nd edn. Prentice Hall, Upper Saddle River
18. Navas A, Machín J (2002) Spatial distribution of heavy metals and arsenic in soils of Aragón
(northeast Spain): controlling factors and environmental implications. Appl Geochem 17:961–
973

19. ORNL (2009) Oak Ridge National Laboratory distributed active archive center data holdings.
20. Podraza R, Tomaszewski K (2005) KTDA: emerging patterns based data analysis system. In:

XXI fall meeting of polish information processing society, pp 213–221

21. PRISM (2009) PRISM (parameter-elevation regressions on independent slopes model) climate

mapping system products matrix. PRISM, Corvallis

22. Remmel TK, Csillag, F (2006) Mutual information spectra for comparing categorical maps. Int J

Remote Sens 27:1425–1452

Geoinformatica (2011) 15:399–416

415

23. Rousseeuw J, Croux C (1993) Alternatives to the median absolute deviation. J Am Stat Assoc

88:1273–1283

24. Rusjan S, Mikos, M (2008) Assessment of hydrological and seasonal controls over the nitrate
flushing from a forested watershed using a data mining technique. Hydrol Earth Syst Sci 12:645–
656

25. Seamless (2009) National map seamless server. USGS, Denver
26. Steegen A, Govers G, Takkena I, Nachtergaelea J, Poesena J, Merckxb R (2001) Factors con-
trolling sediment and phosphorus export from two Belgian agricultural catchments. J Environ
Qual 30:1249–1258

27. Stepinski T, Ding W, Eick C (2008) Discovering controlling factors of geospatial variables. In:
The 16th ACM SIGSPATIAL international conference on advances in geographic information
systems (ACM GIS 2008). Irvine, CA, USA, pp 1–4

28. Wang X, Qin Y (2005) Spatial distribution of metals in urban topsoils of Xuzhou (China):

controlling factors and environmental implications. Environ Geol 49(6):905–914

29. White D, Sifneos JC (2002) Regression tree cartography. J Comput Graph Stat 11(3):600–614
30. Witten IH, Frank E (2005) Data mining: practical machine learning tools and techniques, 2nd
edn (Morgan Kaufmann series in data management systems). Morgan Kaufmann, San Francisco

Tomasz F. Stepinski
is a staff scientist at the Lunar and Planetary Institute in Houston, Texas. His
research interest is computational geomorphology with application to Mars and Earth. He received
his PhD in applied mathematics from the University of Arizona.

Wei Ding is an Assistant Professor of Computer Science at the University of Massachusetts Boston.
She received her M.Sc. degree in Software Engineering from the George Mason University in 2000

416

Geoinformatica (2011) 15:399–416

and her Ph.D. degree in Computer Science from the University of Houston in 2008. She has 7-year
teaching experience in Computer Science and 8-year industrial working experience in banking, soft-
ware development, and web technology. Her main research interests include Data Mining, Machine
Learning, Artificial Intelligence, Computational Semantics, and with applications to astronomy,
geosciences, and environmental sciences. Her research projects are currently sponsored by NASA.

Christoph F. Eick received a Ph.D. in Computer Science from the University of Karlsruhe in
Germany. He is an Associate Professor in the Department of Computer Science at the University
of Houston. His areas of expertise include spatial data mining, clustering, machine learning, evo-
lutionary computing, databases, and artificial intelligence. He published more than 100 papers in
these areas. His current research centers on region discovery in spatial datasets, on the design of
clustering algorithms that provide plug-in fitness functions, collocation mining, distance function
learning, regional regression, and on the application of data mining to challenging problems in
medicine, astronomy, geology, and environmental sciences. He also serves in program committees of
major data mining conferences.

