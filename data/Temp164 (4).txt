This article was downloaded by: [University of Iowa Libraries]
On: 14 March 2015, At: 16:59
Publisher: Taylor & Francis
Informa Ltd Registered in England and Wales Registered Number: 1072954 Registered
office: Mortimer House, 37-41 Mortimer Street, London W1T 3JH, UK

International Journal of Geographical
Information Science
Publication details, including instructions for authors and
subscription information:
http://www.tandfonline.com/loi/tgis20

An efficient measure of compactness
for two-dimensional shapes and its
application in regionalization problems
Wenwen Li a , Michael F. Goodchild b & Richard Church b
a School of Geographical Sciences and Urban Planning, GeoDa
Center for Geospatial Analysis and Computation , Arizona State
University , Tempe , AZ , USA
b Department of Geography , University of California , Santa
Barbara , CA , USA
Published online: 22 Jan 2013.

To cite this article: Wenwen Li , Michael F. Goodchild & Richard Church (2013) An efficient
measure of compactness for two-dimensional shapes and its application in regionalization
problems, International Journal of Geographical Information Science, 27:6, 1227-1250, DOI:
10.1080/13658816.2012.752093

To link to this article:  http://dx.doi.org/10.1080/13658816.2012.752093

PLEASE SCROLL DOWN FOR ARTICLE

Taylor & Francis makes every effort to ensure the accuracy of all the information (the
“Content”) contained in the publications on our platform. However, Taylor & Francis,
our agents, and our licensors make no representations or warranties whatsoever as to
the accuracy, completeness, or suitability for any purpose of the Content. Any opinions
and views expressed in this publication are the opinions and views of the authors,
and are not the views of or endorsed by Taylor & Francis. The accuracy of the Content
should not be relied upon and should be independently verified with primary sources
of information. Taylor and Francis shall not be liable for any losses, actions, claims,
proceedings, demands, costs, expenses, damages, and other liabilities whatsoever or
howsoever caused arising directly or indirectly in connection with, in relation to or arising
out of the use of the Content.

This article may be used for research, teaching, and private study purposes. Any
substantial or systematic reproduction, redistribution, reselling, loan, sub-licensing,
systematic supply, or distribution in any form to anyone is expressly forbidden. Terms &

Conditions of access and use can be found at http://www.tandfonline.com/page/terms-
and-conditions

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 International Journal of Geographical Information Science, 2013
Vol. 27, No. 6, 1227–1250, http://dx.doi.org/10.1080/13658816.2012.752093

An efﬁcient measure of compactness for two-dimensional shapes and
its application in regionalization problems

Wenwen Lia*, Michael F. Goodchildb and Richard Churchb

aSchool of Geographical Sciences and Urban Planning, GeoDa Center for Geospatial Analysis and
Computation, Arizona State University, Tempe, AZ, USA; bDepartment of Geography, University of
California, Santa Barbara, CA, USA

(Received 4 July 2012; ﬁnal version received 9 November 2012)

A measure of shape compactness is a numerical quantity representing the degree to
which a shape is compact. Ways to provide an accurate measure have been given great
attention due to its application in a broad range of GIS problems, such as detecting clus-
tering patterns from remote-sensing images, understanding urban sprawl, and redrawing
electoral districts to avoid gerrymandering. In this article, we propose an effective and
efﬁcient approach to computing shape compactness based on the moment of inertia
(MI), a well-known concept in physics. The mathematical framework and the computer
implementation for both raster and vector models are discussed in detail. In addition to
computing compactness for a single shape, we propose a computational method that is
capable of calculating the variations in compactness as a shape grows or shrinks, which
is a typical application found in regionalization problems. We conducted a number of
experiments that demonstrate the superiority of the MI over the popular isoperimetric
quotient approach in terms of (1) computational efﬁciency; (2) tolerance of positional
uncertainty and irregular boundaries; (3) ability to handle shapes with holes and mul-
tiple parts; and (4) applicability and efﬁcacy in districting/zonation/regionalization
problems.

Keywords: moment of
regionalization;
districting; shape index; automated zoning procedure; pattern recognition; geographic
Information Science; vector data modelling; raster data modelling

inertia; compactness;

shape analysis;

1.

Introduction

The compactness measure of a shape, also known as its shape index, is a numerical quan-
tity representing the degree to which a shape is compact (Gillman 2002). Here, shape
refers to geometric objects that have a two-dimensional extent, such as objects used to
describe a park or a parcel of land, as opposed to one-dimensional features such as net-
work links or three-dimensional features such as a globe. Compactness is acknowledged
as one of the most intriguing and important properties of a shape (Angel et al. 2010) and
is widely used as a descriptor in a variety of domain tasks. For instance, compactness is
a critical factor in deﬁning and analyzing homogeneous habitat regions in ecology (Eason
1992). Within computer vision, there have been many applications of shape compactness
for object matching and pattern recognition (Edwards et al. 2003). In content-based image

*Corresponding author. Email: wenwen@asu.edu

© 2013 Taylor & Francis

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 1228

W. Li et al.

retrieval, this factor is used to identify shape signatures for non-rigid shape search and
retrieval in large databases (Ovsjanikov et al. 2009). In psychological studies, compact-
ness has been introduced to quantify perceptual stability and to understand the causes of
perceived shape aesthetics (Friedenberg 2012).

In GIScience, the quantiﬁcation and computation of shape compactness has been a
long-standing and fundamental research question for a number of reasons. First, a com-
pact region has appealing properties because compactness implies maximum accessibility
to all parts of the shape, and a compact shape is likely to be homogeneous, therefore
sharing common attributes and properties (Tobler 1970). Second, identiﬁcation of shape
has a great impact on the search for, and extraction of, spatial patterns, which is essen-
tial to analyzing and understanding geographical phenomena, as well as predicting future
patterns (Wentz 1997). Third, the geographical world is populated with spatial objects
described through areal representations, making compactness an important part of under-
standing these objects. Therefore, shape comparison has been given great attention due to
its application in a broad range of geographical problems (MacEachren 1985). For exam-
ple, there has been a long history of using compactness within political geography to assess
the constitutionality of political districts based on their shape (Gibbs 1961, Rinder et al.
1988, Fryer and Holden 2007). In urban morphology studies, Christaller (1968) deduced
the emergence of compact hexagonal arrangements of towns in his ‘central place the-
ory’ (CPT). More recently, compactness has become a well-established principle used to
guide city planning, evaluate urban settings, and study urban sprawl (Chandra et al. 2009).
In addition, compactness is a well-known index to describe the hydrological properties of
drainage basins (Bardossy and Schmidt 2002).

The geospatial applications mentioned above concern the role of compactness as a
shape index to measure a single shape. In practice though, there are also a signiﬁcant
number of applications requiring the computation of compactness for two or more adja-
cent shapes that are grouped together. This type of application, called regionalization,
often involves large spatial datasets, such as census data, and requires the aggregation of
a large number of shapes into a smaller number of larger regions. Using compactness as a
measure in regionalization was discussed as early as the 1960s; Weaver and Hess (1963)
emphasized the importance of generating compact regions in designing political districts.
Kaiser (1966) and Young (1988) discussed the use of moment of inertia conceptually in
measuring the compactness of electoral districts and concluded that moment of inertia is
not only good at measuring compactness, but also provides a measure of size. In 1977,
Openshaw discussed the importance of achieving a degree of compactness in solving the
Modiﬁable Areal Unit Problem (MAUP) (Openshaw 1977, 1978). In 1995, Openshaw and
Raw discussed Automatic Zoning Procedure (AZP) for census redesign, which became the
basis for the design of the 2001 UK census geography (Martin et al. 2001). In this pro-
cedure, compactness was considered to be an important requirement to meet. Since then,
many compactness measures have been proposed by the geography community (Horn et al.
1993), such as those based upon isoperimetric quotients, reference shape comparison, and
moment of inertia. There are also a number of indirect compactness measurements, such
as methods based on the distance to a reference point (Haunert and Wolf 2010), ratio of
the actual area of a region to its minimum external peripheral area (Datta et al. 2012), and
those reviewed by Duque et al. (2007).

To evaluate the efﬁciency and effectiveness of compactness measures, we propose the
following criteria: (1) robust, (2) computationally efﬁcient, and (3) additive. Robust here
meaning the algorithm should be able to measure the compactness of any shape. As any

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 International Journal of Geographical Information Science

1229

digitization process produces some degrees of uncertainty (Goodchild 1996), a robust mea-
sure should also be relatively insensitive to such uncertainty. Moreover, a robust measure
should be stable for a given ﬁxed shape regardless of changes in size and spatial resolution.
In addition to robustness, computational efﬁciency is an important factor when problem
sizes are very large. A good algorithm for computing compactness should be computa-
tionally efﬁcient to the extent that it is not a bottleneck in GIS processing. In addition,
for some practical applications such as a regionalization problem, one may need to mea-
sure the changing compactness of a region as it is combined with other areas on the ﬂy,
instead of recomputing compactness from scratch at each iteration. In fact, an algorithm
should be able to obtain a compactness value when merging two or more regions using
a simple summation approach; in other words, the algorithm should be ‘additive’, which
is the third criterion. A compactness measurement approach that is additive and easy to
compute will reduce computational complexity and improve the computational efﬁciency
and effectiveness when used in real-world applications.

In this article, we propose a new and efﬁcient way to compute compactness based on
the concept of the moment of inertia (MI), a well-known quantity in physics. Although
earlier research has considered the use of MI (Kaiser 1966, Massam and Goodchild
1971, Zhang et al. 2006), considerable barriers existed in its widespread adoption. First,
there was no clear, deﬁnable way in which it could be applied. Second, few tests have
demonstrated its superiority. We therefore attempt to address both of these barriers.
Section 2 reviews the existing methods for computing compactness and their pros and
cons. Section 3 discusses in detail the mathematical equations of our proposed trapezium-
based method for computing moment of inertia for both vector and raster data. Section 4
provides details of how this approach can be implemented. Section 5 compares statistically
the performance of our proposed method against the commonly used Iso-Perimetric
Quotient (IPQ) measure. Section 6 introduces a large practical application of this method
in generating a set of 100 compact zones spanning Southern California that are used as
the basic spatial units for a large scale economic simulation model. Section 7 concludes
the work and proposes directions for future research.

2. Literature review

There is a long history of interest in the science community in developing an effective
compactness measure; in 1822, Ritter proposed to measure a shape’s compactness using
a simple ratio of the perimeter (P) to the area (A) of the shape (Frolov 1975). Since
then, a variety of compactness measures have been proposed (Miller 1953; Richardson
1961, Cole 1964, Massam and Goodchild 1971, Frolov 1975, Osserman 1978, Kim and
Anderson 1984, Bribiesca 1997, Bachi 1999, Bottema 2000, Wentz 2000, Zhao and Stough
2005, Santiago and Bribiesca 2009). These measures can be grouped into four categories:
area–perimeter measurement, reference shape, geometric pixel properties, and dispersion
of elements of area.

The method (P/A) proposed by Ritter can be categorized as an area–perimeter
approach. Although straightforward, Ritter’s simplistic ratio suffers from the fact that the
measure varies when shape size changes. To account for this limitation, the measure can
be made dimensionless by dividing the shape’s area by the square of its perimeter. Among
many alternative names and precise mathematical forms that have been given to this class
of metrics, including the circularity ratio 4A/P2 by Miller (1953) and the compactness
π A/P by Richardson (1961), the IPQ (Osserman 1978) has become one of the
ratio 2
most widely accepted compactness measures of this class. It is deﬁned as:

√

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 1230

W. Li et al.

CIPQ = 4π A
P2

where the perimeter P is squared to remove the scaling effect, A is the area of the shape,
and CIPQ is the compactness value. By adding π in the numerator of Miller’s circularity
ratio, CIPQ’s range is changed to (0, 1] (instead of 0 to 1/π in Miller’s measure). A shape
with a high value of CIPQ is considered to be more compact than a shape with a lower CIPQ.
A circle is the most compact shape, and by deﬁnition above, it will have a compactness
value of 1. This measure is also the square of Richardson’s compactness ratio. Although
the IPQ approach is not very stable for irregular contours (Santiago and Bribiesca 2009), it
is applicable in computing the compactness index for both vector and raster data, it is easy
to compute, and it is not sensitive to size changes (keeping shape constant). Therefore, it
remains the most popular shape index to date (Santiago and Bribiesca 2009).

Another approach to the measurement of compactness uses reference shapes. For
instance, Cole (1964) proposed a compactness measure to compare the area of a shape,
A, with the area of the smallest circle that circumscribes the shape, Asc. This is an alter-
native form of Gibbs’s (1961) compactness measure 4A/L2, where L is the longest line
between two points on a shape’s perimeter. Kim and Anderson (1984) later termed this the
digital compactness measure (DCM). DCM is deﬁned as:

Like the IPQ, its maximum value, 1, will occur when the shape is a circle. The major
drawbacks of this method are that it cannot be applied to shapes with holes, it is not additive
and scale-invariant. A second approach that falls in this category was proposed by Bottema
(2000). It works by overlaying the shape S with a circle C of the same area and computing
the overlap. Suppose the area of S is A, and the area of C is A0, then Bottema’s compactness
measure can be expressed as:

Another alternative index falling in this category is the elongation index (Wentz 2000),
which is a type of overlap index (Zhao and Stough 2005) that sets a condition of equal-
area matching. It is calculated from the ratio of maximum overlap of the intersection to the
union of the object with a circle of equal area. Mathematically,

CDCM = A
Asc

CBottema = 1 −

|A ∩ A0|
A0

El =

|A ∩ A0|
|A ∪ A0|

A and A0 hold the same meanings as in Equation (3). The overlap could also be determined
by coinciding the centroids of the shape and the reference shape (Zhao and Stough 2005).
Both the Bottema measure and the elongation index are capable of measuring compactness
of a shape with holes; however, like the DCM method, they are sensitive to size changes in
computation. Moreover, the circle can be overlaid on the shape in many different positions,
so a search must be invoked to determine the position of maximum overlap, making this
type of method less competitive from a computational perspective.

(1)

(2)

(3)

(4)

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 International Journal of Geographical Information Science

1231

Other shape-reference approaches include the comparison of the area or diameter of the
maximum inscribed circle to that of the minimum circumscribed circle. The approaches in
this category have common drawbacks. First, the parameter is difﬁcult to measure; for
example, for Bottema’s approach, there must be a procedure to compute the intersection
of two areas. Second, the compactness of a shape is not computable from its parts; when
this measure is used in a regionalization process, the compactness of a given region must
be recalculated every time it grows or shrinks. These drawbacks make the shape reference
approach less appealing in practical applications.

The third category is designed to work on raster datasets. A representative method
of this class of methods is called the normalized discrete compactness (NDC) measure,
suggested by Bribiesca (1997). The idea is to count the number of cell sides (LD) shared
between pixels that represent a shape S, and then calculate the measure CNDC. This is
given as:

where LDmin and LDmax are the lower and upper limits of the number of cell sides that can be
shared with the same number of pixels within S. Deﬁning p as the number of edges on the
border and n as the total number of pixels in S, LD, LDmin , and LDmax can be obtained from
Equations (6)–(8):

CNDC = LD − LDmin
− LDmin
LDmax

LD = 4n − p

2

LDmin

= n − 1
√

LDmax

= 2(n −

n)

The NDC approach has the advantage of being scale invariant, and can be applied when

computing the compactness of shapes with holes.

The last category of measures is based on analyzing the dispersion of elements/
components in a shape. This approach involves the calculation of the second moment of
an area about a point, also known as the moment of inertia (MI). According to Massam
and Goodchild (1971), each shape can be considered as composed of inﬁnitesimally small
units of area da, and the MI of a shape is deﬁned as the second moment of an area about a
point s on the shape as follows:

(cid:2)

Is =

z2da

Ig =

z2
gda

where z is the distance from da to s. Similarly, the MI about its centroid can be deﬁned as:
(cid:2)

where zg is the distance from da to the centroid of a shape. ‘The moment about a point s(cid:5)’
means the moment about an axis perpendicular to the shape through the point s; we use
the former phrase throughout the article for simplicity. The ‘centroid’ in GIS has come
to mean any point representative of a shape, but it is used here in its strict mathematical

(5)

(6)

(7)

(8)

(9)

(10)

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 1232

W. Li et al.

sense as the balance point and the point about which the MI is minimum for any shape.
The shape index base upon MI, CMI, is calculated as the ratio of the MI of a circle of the
same area about its center, to the MI of the shape about its centroid. The value range of
CMI is (0,1]; larger values means more compact shape. A circle receives the maximal value
of 1. Mathematically, it can be expressed as:

CMI = A2
2π Ig

(11)

where A is the area of a shape. Bachi (1999) reviewed this measure and some equivalent
measures. This measure is readily additive, since the index for an aggregate of shapes
is easily computed from the relevant properties of each component shape, as we will
show below. The measure is also insensitive to shape size and rough boundaries. This
approach is also appealing due to its ability in distinguishing between the shape of the
region being measured and the shape of a speciﬁc distribution of sub-regions within the
region. Therefore, it has extensive applicability in a regionalization problem.

In Massam and Goodchild’s (1971) implementation, the primitive elements used to
represent the shape, da, were triangles. However, there is no simple, obvious, and robust
way to divide a polygon into triangles uniquely. To our best knowledge, there are no speciﬁc
discussions in the literature on how to compute the MI of a shape efﬁciently. To overcome
this limitation, in Section 3 we propose a trapezium-based approach which provides an
efﬁcient and unique alternative to measuring MI-based compactness. We also discuss how
to handle shapes with multiple parts and shapes with holes, as well as how this approach
can be further simpliﬁed when applied to a raster.

3. Methods for computing the centroid and moment of inertia

3.1. Moment of inertia of a single shape
To compute the compactness CMI of a shape we must ﬁrst compute the coordinates (xi
of the centroid g:

g, yi
g)

(cid:3)

ai

xdai

ai

=

xi
g

, yi
g

=

(cid:3)

ai

ydai

ai

(12)

(cid:2)

(cid:2)

(cid:3)
,

xn, yn

(cid:2)
xi, yi

(cid:2)
x1, y1
(cid:3)

(cid:3)
, . . . ,
(cid:3)

(cid:2)
x2, y2
(cid:2)
xi+1, yi+1

where x and y are the coordinates of dai and ai is the area’s measure. To compute these
properties, we represent the area as a polygon and partition the polygon into primi-
tive elements using trapezia. Figure 1 shows a polygon deﬁned as a clockwise sequence
(cid:3)
(cid:3)
. For any
, and deﬁne
of n vertices
adjacent pair of vertices, drop perpendiculars to the x-axis. Taking the segment with
as an example, when dropping perpendiculars to the
endpoints
x-axis, a trapezium is formed with two vertical sides, one horizontal side, and one diago-
nal side. The calculation of moment of inertia of the trapezium Ti formed from segment
with endpoints (xi, yi) and
, about its centroid, can be reduced to calculating
the composition of the moments for the triangle piece (T) and the rectangle piece (R)
about their respective centroids, and then combining them appropriately. For the triangle
piece,

(cid:2)
xi+1, yi+1

(cid:2)
x1, y1

xn+1, yn+1

and

=

(cid:3)

(cid:3)

ai_T = (xi+1 − xi)(yi+1 − yi)/2

(13)

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 International Journal of Geographical Information Science

1233

Figure 1. A polygon with points deﬁned clockwise, showing the trapezia generated from two of its
segments.

y

(xi + 1, yi + 1)
n t

e

m

g

e

S

T

(xi, yi)

(xi, yi)

Segment

(xi + 1, yi + 1)

R

Ti = T + R

xi
g_T

= (xi + 2xi+1) /3

= (2yi + yi+1)/3

yi
g_T
(cid:4)
(xi+1 − xi)2 + (yi+1 − yi)2

(cid:5)

/18

Ii_T = ai_T

ai_R = (xi+1 − xi)yi

xi

g_R

= (xi + xi+1)/2

g_R

= yi/2

yi
(cid:4)
(xi+1 − xi)2 + y2
i

(cid:5)

/12

Ii_R = ai_R

For the rectangle piece,

g, yi

where ai denotes area, (xi
g) is the centroid, and Ii denotes the MI of each piece. Note that
for any piece falling below or completely outside of the polygon, the values for ai_T and
ai_R will be negative. For example, when computing the area of the rectangle piece of the
trapezium associated with the segment on the lower right portion of the polygon, xi exceeds
the value of xi+1, the difference xi+1 − xi will be negative, and thus the area calculated in
Equation (17) will be negative in value.

The calculation of MI for the whole polygonal area requires combining all triangle and
rectangle pieces. The total polygon area, A, can be obtained by adding the areas of triangle
and rectangle pieces with respect to sign. Equation (21) presents the mathematical equa-
tion. The centroid of the polygon is obtained by averaging the coordinates of all vertices,
as Equation (22) shows.

A =

(ai_T + ai_R)

n(cid:6)

i=1

(14)

(15)

(16)

(17)

(18)

(19)

(20)

(21)

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 1234

W. Li et al.

n(cid:6)

(xi

g_R

=

xg

i=1

ai_T )

g_T

ai_R + xi
A

,

=

yg

n(cid:6)

(yi

g_R

i=1

ai_T )

g_T

ai_R + yi
A

For computing the entire Ig of A, according to the parallel axis theorem (Landau and

Lifschitz 1984), the MI about any point s is related to the MI about the centroid g by:

Is = Ig + d2da

where d is the distance from the centroid to s. Adjusting the moments of inertia of all pieces
to the polygon centroid yields Ig, illustrated in Equation (23):

Ig =

(Ii_T + d2

i_T, gAi_T + Ii_R + d2

i_R, gAi_R)

n(cid:6)

i=1

where di_T, g and di_R, g are the distances between the centroids of the triangle and rectangle
pieces of trapezium i and the centroid of the polygon, respectively. Note that as the pieces
falling below or completely outside of the polygon have a computed negative area, their
moments are automatically subtracted from the total. Substituting Ig in Equation (11), the
shape index (normalized MI) can be easily obtained. In summary, Equations (13)–(16)
compute the area, centroid, and MI of the triangle piece of trapezium Ti formed from
(cid:3)
segment (xi, yi) to
. Equations (17)–(20) compute the area, centroid, and MI of
the rectangle piece of the trapezium Ti. Equations (21)–(24) compute the area, centroid,
and MI of the whole polygon by grouping all the triangle and rectangle pieces of the n
trapezia formed by the n segments of the polygon.

(cid:2)
xi+1, yi+1

3.2. Moment of inertia of a region

Section 3.1 introduced the computation of MI of a single shape. In the context of a region-
alization problem, we also require the on-the-ﬂy computation of MI as a region grows or
shrinks based upon the addition or subtraction of polygonal spatial units. For instance,
given a partial region P aggregated from a set of atomic units u1, u2, . . . ,um and supposing
that the area of P at current state j is Ap (j), its MI is Ip (j) and the centroid is (x p (j)
, y p (j)
).
g
When a region P grows, this must involve the addition of another atomic unit uk, which
has the properties of area Auk , centroid (xg_uk , yg_uk ), and MI Iuk . The compactness of P at
new state j + 1 can be easily obtained by combining the properties of P in state j and that
of the atomic unit as follows:

g

Ip (j+1) = Ip (j) + Iuk

+ Ap (j)d2

p (j+1),p (j)

+ Auk d2

p (j+1),uk

Ap (j+1) = Ap (j) + Auk

xp (j+1)
g

= (Ap (j)xp (j)

g

+ Auk xg_uk )/Ap (j+1)

yp (j+1)
g

= (Ap (j)yp (j)

g

+ Auk yg_uk )/Ap (j+1)

(22)

(23)

(24)

(25)

(26)

(27)

(28)

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 International Journal of Geographical Information Science

1235

where dp ( j+1), p(j) refers to the distance between the centroid of region P at state j and the
new centroid after attaching atomic unit uk. We can also call the new centroid the centroid
of P at state j + 1, and obtain it from Equations (27) and Equations (28). Equation (25) is
the calculation of the moment of inertia for P at state j + 1. We can tell from this equation
that the moment of inertia of a new region when combining two sub-regions equals the
sum of the MI of both sub-regions and the increase caused by the merging. This calcula-
tion avoids the recomputation of compactness for all constitutional units, and therefore, is
computationally efﬁcient and additive. Equation (25) can also be used as the theoretical
foundation for calculating the compactness of a shape with multiple parts (connected or
otherwise).

Similarly, when a basic unit uk is switched out of or removed from region P at state j,

the properties of P at state j + 1 can be obtained from:

Ip (j+1) = Ip (j) − Iuk

− Ap (j+1)d2

p (j+1),p (j)

− Auk d2

uk ,p (j)

Ap (j+1) = Ap (j) − Auk

xp (j+1)
g

= (Ap (j)xp (j)

g

− Auk xg_uk )/Ap (j+1)

yp (j+1)
g

= (Ap (j)yp (j)

g

− Auk yg_uk )/Ap (j+1)

(29)

(30)

(31)

(32)

Equation (29) shows that when removing a sub-region, the MI not only decreases by
that of the sub-region, but also by the loss in splitting, reﬂected in the centroid changes.
This equation can also be used to calculate the compactness of a shape with holes.

Whenever the shape of a region is changed, the MI is recalculated. Then by substituting

this value in Equation (11), the shape index (normalized MI) can be obtained.

In summary, Equations (25)–(28) compute the new MI, area, and centroid of a region
after merging an atomic unit. Equations (29)–(32) compute the new MI, area, and centroid
of a region after removing an atomic unit from it. The attributes (MI, area, and centroid) of
an atomic unit used in Equations (25)–(32) are obtained from Equations (12)–(20). Rather
than recomputing the MI of a region every time it changes, these equations provide a means
of additively computing the MI and the shape index. This constitutes the building block for
an efﬁcient algorithm to be integrated into a compactness-driven regionalization problem.

3.3. Computation of shape index on raster data models
The proposed method has the advantage of being easily calculated from boundary coor-
dinates. There is, however, a further simpliﬁcation that can be made when using raster
datasets. For a geo-referenced raster dataset, instead of using the coordinates of vertices
to depict a shape (red region in Figure 2), the geographic extent (the top, bottom, left and
right coordinates of a rectangle covering all of the raster dataset’s data) and the cell size (r)
are employed. Each pixel can be identiﬁed by its row and column indices (s,t) in a rectan-
gular matrix (M). In order to integrate the MI measure of a raster dataset into our current
methodological framework, the following steps are taken:

First, the building blocks of a raster dataset – the pixels – are of equal size. In the
example of Figure 2, each pixel is r × r in size. Therefore, the initial MI for each pixel in
a raster dataset is the same and could be obtained by adapting Equation (20):

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 1236

W. Li et al.

Column t = 3

y

(x0, y0)

r

(xg (s,t), yg (s,t))

Row s = 4

x

O

Figure 2. Raster data represented in a projected coordinate reference system (CRS).

Second, the MI of a shape can be obtained by replacing the integral in Equation (9)

with the sum over the pixels that constitute the shape, shown in Equation (34),

To obtain zg, the centroid of each pixel and the centroid of the entire shape need to
be computed. Take the shape (shaded in red) in Figure 2, for example, where the centroid
coordinates (x s,t
g ) at row s and column t are a function of cell size r, its indices s and t,
and the actual coordinates (x0, y0) in the upper left corner:

g , y s,t

da = r2

Ida = r2da/6 = r4/6

(cid:6)

Ig =

gr2
z2

s,t where M(s,t) (cid:6)=null

x s,t
g

= x0 + c/2 + c(t − 1)

y s,t
g

= y0 − c/2 − c(s − 1)

(33)

(34)

(35)

(36)

(37)

The centroid for the entire shape can be calculated by averaging the x and y coordinates

of all the pixels composing the shape (where M(s,t)(cid:6)=null):

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 International Journal of Geographical Information Science

1237

(cid:7)

xg =

∀s, t where M (s,t)(cid:6)=null
(cid:7)

∀s, t where M (s,t)(cid:6)=null
(cid:7)

yg =

∀s, t where M(s,t)(cid:6)=null
(cid:7)

∀s, t where M(s,t)(cid:6)=null

x s,t
g

1

y s,t
g

1

(38)

(39)

Given the centroid coordinates of each pixel from Equations (36) and Equations (37),
and the centroid coordinates of the entire shape from Equations (38) and Equations (39),
zg, which denotes the Euclidean distance between any pixel centroid and the centroid of the
shape, can be easily calculated. Consequently, the MI of the entire shape can be computed
from Equation (35). Similarly, when a raster representation is used in a regionalization
process, Equations (25)–(28) can be adopted to compute the updated MI when combining
two contiguous regions together and Equations (29)–(32) can be adopted for MI compu-
tation when a sub-region is removed from a region. Then by applying Equation (11), the
compactness index of a changing shape involving a raster representation can be generated.

4. Computer implementation
The proposed method was implemented using the open-source cross-platform pro-
gramming language Python with the support of Esri’s ArcPy package (Esri 2012).
Figure 3 shows the object-oriented design of the program, in which ﬁve classes (DataSet,
MultiPartPolygon, Polygon, LineSegment, and Point) and their associations are deﬁned.
When reading shapes from a dataset, each shape record is cached as an instance of
MultiPartPolygon class. A MultiPartPolygon record may be a single-part polygon, a multi-
part polygon, or a polygon with holes. Therefore, the list ‘parts’ is deﬁned. It contains the
variable ‘ﬂag’ indicating the type of a shape (0 represents the main or a single-part poly-
gon, 1 for the remaining parts in a multi-part polygon, and 2 for a hole) and a variable
of the type Polygon, which records the actual geographic data that represent each part of
a shape. In a Polygon class, each polygon (must be single-part) can be represented by a
list of its vertices. Each vertex has type Point, deﬁned by its x and y coordinates in the
CRS (Coordinate Reference System) and documented in the metadata of the dataset. The
class LineSegment is used when computing the MI of each trapezium formed by the line
segments of a polygon.

Figure 4 shows the workﬂow for computing the MI of shapes with a vector represen-
tation. The applications of the above ﬁve classes are highlighted at their ﬁrst occurrences
within the whole procedure. The components on the left side are for pre-processing, in
which all shapes are read and organized in the data structure deﬁned in Figure 3. The com-
ponents on the right side of the ﬁgure deal with the MI computation for each multi-part
polygon in the dataset. The function combine() implements Equation (24), when the MIs
of all trapezia are adjusted to the polygon’s centroid to obtain the MI of the entire poly-
gon about its centroid. A rule needs to be instituted for determining which trapezia fall
inside the polygon area and which fall outside. For vertices that are ordered clockwise
around a polygon, such as the one shown in Figure 1, the trapezium should be added when
xi+1 ≥ xi and should be subtracted when xi+1 < xi. For ‘counterclockwise’ ordering of ver-
tices along the boundary of a polygon, the opposite applies. The isClockwise() operation in

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 1238

W. Li et al.

Figure 3. UML design of classes and associations in computer implementation.

the Polygon class is used to accomplish this task. In this way, the MI of any regular polygon
can be computed.

When it comes to computing the MI of a polygon with more than one part, the split()
and merge() processes are adopted. If the part is a hole, the split() function is called
to remove the MI of the hole from the shape and the MI introduced by the splitting
(Equations (29)–(32)); otherwise, the merge() function, which implements Equations (25)–
(28), will be called. These two functions could be easily adapted to handle the case of
computing the MI of a growing or shrinking region in a regionalization problem.

In handling a raster dataset, a similar procedure can be adopted. In this case, a pixel
corresponds to a Polygon class, each individual shape corresponds to a MultiPartPolygon,
and the raster dataset corresponds to the class of Dataset. The difference is that only the
workﬂow on the right-hand side of Figure 4 is executed since the MI for each pixel can be
easily calculated from Equation (35).

5. Comparing the moment of inertia shape index with the isoperimetric quotient
5.1. Testing the robustness of MI and IPQ shape indices for vector data under
positioning uncertainty
Our ﬁrst test involves calculating the robustness of the proposed MI compactness measure
and the popular IPQ approach in handling data with uncertainties. As we know, there will
always be some amount of positional error in geospatial data, because exact measurement
of location is impossible. Consider a hypothetical study area given in Figure 5a repre-
sented by a polygon. We randomly repositioned its vertices to introduce small positioning

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 International Journal of Geographical Information Science

1239

Figure 4. Workﬂow for computing the MI of shapes.

errors. Table 1 shows the parameters of the experimental settings. For each generated poly-
gon instance, we calculated the MI shape index and the IPQ shape index. This process was
repeated n times, and the mean and standard deviation of the MI and IPQ indices were com-
pared. Figure 5a shows the original test shape and all its vertices, and Figure 5b shows the
shape before and after distortion. From a visual perspective, we can observe from Figure 5b
that this repositioning had little impact on the overall compactness of the shape or area.

Table 2 presents the statistical results associated with 3000 randomly determined
instances for each level of positional error buffer size. For each level, the table lists the
minimal, maximal, mean, and standard deviation of shape indices for both MI and IPQ.
The mean shape indices calculated from the MI approach are almost invariant over the
entire range of error buffer sizes. In contrast, the IPQ values vary considerably over the
range of levels of error buffer values, from a high of 0.8464 to a low of 0.3474. Given
that the shape remains relatively the same over the range of values, the compactness index
should have remained relatively constant as well. In this case, the IPQ appears to be too
sensitive to issues of positional error, whereas the MI inspired compactness index tolerates
positioning errors much better for a digitalized object.

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 1240

a

W. Li et al.

b

Legend

Vertices

Polygon with random positioning errors

0 2.5 5

10

Test polygon

miles

0 2.5 5

10

miles

(a) Test polygon and (b) the 10 realizations of polygons with positioning errors (d = 1) out

Legend

Vertices

Test polygon

Figure 5.
of 3000 samples.

Table 1. Parameter settings.

Parameter

Value

Number of vertices of the test polygon
Perimeter
Area
Runs of randomized repositioning n
Error buffer d

70
58
228
3000
[2, 1, 3/4, 1/2, 1/4, 3/16, 1/8, 1/16]

Table 2. Statistical results of shape indices computed from MI and IPQ.

MI-moment of inertia

IPQ-isoperimetric quotient

Error buffer, d Min

Max Mean

Std dev. (%) Min

Max Mean

Std dev. (%)

1/16
1/8
1/4
3/8
1/2
3/4
1
2

0.8754 0.8776 0.8764
0.8739 0.8792 0.8764
0.8701 0.8821 0.8761
0.8676 0.8859 0.8759
0.8666 0.8849 0.8759
0.8608 0.8879 0.8753
0.8571 0.8915 0.8743
0.8288 0.9018 0.8679

0.03
0.06
0.19
0.26
0.26
0.40
0.54
1.12

0.8408 0.8506 0.8464
0.8319 0.8531 0.843
0.7809 0.8436 0.8133
0.7452 0.8339 0.7901
0.7355 0.8297 0.79
0.7833 0.7268
0.661
0.5545 0.734
0.6472
0.2655 0.4512 0.3474

0.14
0.28
0.92
1.29
1.30
2.02
2.64
2.94

5.2. Robustness test of the MI and IPQ shape indices for vector data under shape
generalization
Our next experiment involved testing the effects of cartographic generalization on the per-
formance of the MI and IPQ shape indices. Figure 6 shows an initial boundary of Maine

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 International Journal of Geographical Information Science

1241

Figure 6. Overlay of original and generalized boundaries of State of Maine.

(excluding islands) and its comparison with a generalized boundary. These shapes have the
same general outline, but the outline of the generalized shape is smoother than the original
one. The Douglas–Peucker algorithm (Douglas and Peucker 1973) was used to simplify
the shape boundary, within tolerance windows from 500 m to 4 km, by 500 m increments.
As the tolerance distance increases, the boundary is represented by fewer points, and there-
fore fewer cartographic details are retained, and the perimeter decreases in length as well.
Figure 7 shows the variation in both the MI and IPQ shape indices when the perimeter
of Maine is smoothed through line generalization. The perimeter values given along the
x-axis were normalized using the initial perimeter length (1979 km). Points closer to the
origin represent generalized shapes with larger tolerance distances. We can observe from
the ﬁgure that IPQ drops monotonically as the perimeter of the Maine boundary increases
(as the impact of line generalization decreases), even though the resulting shape remains
nearly the same. In contrast, the MI index remains relatively the same across all levels of
generalization. We conclude here that the MI index is insensitive to boundary roughness
and thus is more robust, in general, for shapes with rugged boundaries.

5.3. Computational efﬁciency in generating MI index for vector and raster data
In this next experiment, we compared the computational efﬁciency of a vector computa-
tion of MI using integrals and a raster representation using summation for a test area of
biological habitat. The tests were conducted on a workstation with Intel Core(TM) i5 2
3.2GHz CPU and 8GB of RAM. Figure 8a shows the hypothetical habitat patch extracted
from the habitat of the endangered San Joaquin Kit Fox (SJKF). The habitat area in the

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 1242

W. Li et al.

f2(x) = 0.8039
R2 = 0.6508

0.9

0.8

0.7

0.6

0.5

0.4

0.3

x
e
d
n
i
 
e
p
a
h
S

Shape index from IPQ

Fitting curve f1

Shape index from MI

Fitting curve f2

f1(x) = –0.6916x+0.9582
R2 = 0.9958

0.2

0.86

0.88

1
Normalized perimeter of  generalized boundaries of  State of  Maine

0.92

0.96

0.98

0.94

0.9

Figure 7. Variation of shape indices from IPQ and MI for generalized boundaries.

Figure 8. Hypothetical habitat patch (a) and its raster representation with spatial resolution at
1800 m (b).

ﬁgure represents areas that lie in three counties (Kings County, Tulare County, and Kern
County) of Southern California (CalEPA 2002). The two holes within the patch are agri-
cultural and residential areas considered outside of desired habitat. Figure 8a presents a
vector representation of the habitat. In order for making a comparative study, the data in the
vector representation were resampled at 10, 30, 90, 180, 270, 360, and 450 m, respectively.
Figure 8b shows a raster representation of the same area with a cell size of 1800 m.

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 International Journal of Geographical Information Science

1243

time(read data)
time(compute MI)
total time

number of  pixels

109

107

105

103

101

100

10–1

1010

108

106

104

102

100

l

s
e
x
p

i

 
f

o

 
r
e
b
m
u
n

 
/
 
)
d
n
o
c
e
s
(
 
e
m
T

i

i

c
m
h
t
i
r
a
g
o
l
 
t
a
 
d
n
o
c
e
s
(
 
e
m
T

i

l

)
e
a
c
s
 
)
0
1
 
e
s
a
b
(

10

30

90

360

450

Vector

270
180
Cell size (m)

Fitting curve 1
Number of  pixels
Fitting curve 2
Total time
Fitting curve 3
Raster reading time
Fitting curve 4
MI computation time

10–2

10 30

90

180

270
Cell size (m)

360

450

Figure 9.
Regression analysis between comptation time and cell sizes.

(a) Time efﬁciency comparison of MI computation for raster and vector data. (b)

Figure 9 shows the completion times for the calculation of the MI shape index for
the habitat patch depicted in Figure 8 for seven different raster resolutions as well as in
vector format. The time required to calculate the MI shape values for raster data can be
divided into the time needed to read in the data and the time needed for computing the
MI index by merging the MI value of each pixel within the entire shape. Because the
MI of each pixel in a raster dataset is the same, there is no need to repeatedly compute
it as the pixels are read and processed. Figure 9a shows (1) the time used by each task
for computing the MI index from a raster dataset at different cell sizes, (2) the time used
for computing the MI of the same shape from the vector dataset, and (3) the number of

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 1244

W. Li et al.

pixels involved for each cell size value. From this analysis, one can see that for completing
this task, the fastest time for computing the MI compactness index is when using a vector
representation. The time needed to read in the dataset dominates the total processing time
for both raster and vector models. The actual time used for computing the MI index, for
raster data through summation and for vector data through the integral process, after the
data are read only takes 5% of the total processing time, suggesting that the proposed
method is very computationally efﬁcient. When the raster model is used, the computation
time increases dramatically as spatial resolution increases (cell size decreases). This is due
to the fact that as the cell size decreases, the total number of pixels used for representing
the shape increases by x times (where x equals the square of the ratio between old and new
cell sizes). As each pixel acts as a building block for computing the entire MI of a shape,
the time consumed will be linearly correlated to the total number of pixels. Therefore,
when the size of a cell decreases, the computation time increases signiﬁcantly. Figure 9b
presents a regression analysis between the relationships of total computational time, total
number of pixels, total read time, and MI computation time versus the pixel size. The
y-axis (representing time) is displayed on a logarithmic scale (using base 10). In each case,
R2 value equaled 0.99. On an average, it takes 1/10,000 of a second to incorporate a single
pixel into the MI computation for a raster-based approach. For the vector data model, the
time complexity is O(n), where n denotes the number of vertices of a shape.

Therefore, in terms of time efﬁciency, computing an MI compactness index using
a vector model will outperform a raster model. Although the computation of a raster-
based MI approach takes much longer than using vector data, it is still decently efﬁ-
cient. For instance, for a shape with 1 million pixels, the total processing time is less
than 3 minutes in the current testing environment. Through our experiments, we vali-
dated the computational efﬁciency of the proposed method, due to its quality of being
additive.

5.4. Robustness of MI, IPQ, and NDC in handling shapes with holes
In addition to the experiments detailed in Section 5.3, the three popular methods MI (capa-
ble of handing both raster and vector data), IPQ (capable of handling vector data), and
NDC (capable of handling raster data only) were compared in terms of their performances
in measuring the compactness of shapes with holes. The shape in Figure 8 was also used
in this experiment. A cursory examination of Figure 8 reveals that the areas of the holes
appear to be small enough that the effect they have on shape whether included or not should
be quite small. The IPQ compactness index for the region with the two holes is 26% smaller
than the IPQ index for the region without holes. This is due to the fact that the IPQ index
is based upon both perimeter and area, so the perimeter increases and area decreases when
holes are introduced. In comparison, the compactness index drops only 0.3% when the
NDC approach is applied to the patch with the two holes as compared to the patch with
no holes. This happens because for a large area represented by small cells as shown in
Figure 8b, the perimeter is much smaller than the number of cells used to represent the
same area. Therefore, the variation in perimeter is insigniﬁcant when computing the NDC
index. When using the proposed MI approach, the compactness index drops 2% when the
two holes are taken into account, suggesting a relatively small but detectable change in the
compactness of the general region. This result agrees with our observations. It is important
to note that when holes of a shape are considered in computing the compactness index,
different shapes may result in identical values. Altogether, one can conclude that the MI

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 International Journal of Geographical Information Science

1245

shape index outperforms the IPQ method and is equal to or better that the NDC method in
reﬂecting the actual compactness of shapes with holes.

In summary, our tests have shown that the MI shape index (1) efﬁciently handles both
vector and raster data; (2) is insensitive to positioning errors; (3) tends to be consistent
across data represented at varying resolutions; (4) easily handles shapes with holes; and
(5) is robust in handling irregular boundaries. Our tests of the conventionally accepted
standard, IPQ, demonstrated weaknesses among virtually all of our tests (roughness, posi-
tioning uncertainty, holes, and resolution). Adopting an MI shape measure as a standard of
shape measurement has been hampered by the lack of an efﬁcient, computationally simple
method of computing the moment of inertia. The methods (both the vector and raster) pre-
sented in Sections 3 and 4 have eliminated this major hurdle. Consequently, the MI shape
approach should be adopted in practice.

6. Case study: a regionalization problem
In this section, we apply the MI approach to a compactness-driven, multi-constraint region-
alization problem that requires the generation of a set of compact regions that form the
basic spatial units of a microeconomic model. Our goal was to aggregate the 4109 trans-
portation analysis zones (TAZs) in six counties of Southern California (Los Angeles,
Riverside, San Bernardino, Orange, Imperial, and Ventura, as shown in Figure 10) into
approximately 100 regions, the maximum number considered computationally feasible for
subsequent work in the microeconomic simulation of the study area. Our objective is to
maximize the overall compactness of the generated regions while at the same time sat-
isfying the following constraints: (1) each region must be spatially contiguous, (2) the
boundaries of regions must not cross major physiographic features and county boundaries,

Figure 10. TAZ boundaries in the study area.

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 1246

W. Li et al.

and (3) the intra-zonal trafﬁc within a generated region must be smaller than a certain per-
centage of all trafﬁc generated by that region. Although we do not give a mathematical
formulation here, this problem can be deﬁned as a nonlinear integer-programming prob-
lem. It is considered to be of a size and model type that is difﬁcult to solve optimally for
even very small problems. Because our problem involved over 4000 ‘atomic’ units, we
were forced to consider a heuristic approach.

We developed a greedy-based heuristic algorithm for the zoning process. Brieﬂy,
it includes four phases, outlined as follows. (1) Initialization: each region is originally
assigned a ‘seed’ TAZ as a starting point. (2) Dealing phase: each region is allowed to grow
initially to a viable size. Similar to dealing cards in a card game, each region is assigned
a TAZ that touches its border and helps keep it compact and maintain constraints. Dealing
is continued until all regions achieve a minimal size. (3) Randomized Greedy growth: for
each region, identify the candidate TAZ not yet assigned to any region that would improve
the objective the most (while maintaining constraints) if added to that region. Considering
all regions, identify the top three regions that will improve the most if allowed to add their
candidate TAZs. Select at random one of these three regions and add its best candidate TAZ
to that region. Repeat this step until each TAZ has been assigned to one of the 100 regions.
(4) Adaptive Search Procedure: if moving a TAZ on a region boundary to another region
will improve the objective function and not violate the constraints, then this TAZ is moved.
This process is repeated until no further improvement can be found.

To demonstrate how easily the proposed MI computation can be applied to such a
regionalization problem, two simpliﬁed scenarios are given. Figure 11 shows a partial
region P1 at state j, its three adjacent TAZs – the atomic units (A1, A2, and A3), and their
centroids (in black). To decide which TAZ to aggregate with region P1, its MI is computed
after combining the three TAZs according to Equations (25)–(28). Then by substituting

Figure 11. An example of region growth.

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 International Journal of Geographical Information Science

1247

Figure 12. The best zoning solution out of 333 heuristic trails, using the MI shape index as the
compactness measure.

the MI values in Equation (11), the new shape index of P1 in each case can be obtained.
Given that the improvement of compactness for P1 made by adding A1 is larger than when
adding A3 or A3, A1 will be chosen as the candidate TAZ to grow region P1 (the TAZ
that introduces the maximal compactness improvement will be chosen as the candidate to
grow a region). The second scenario takes place in the adaptive search phase. Suppose that
(1) region P1 has now included A1; (2) A2 and A3 have been assigned to other regions; and
(3) there is another region P2 which is adjacent to P1 along a common edge on A1. At this
point, the variation of overall compactness introduced by moving A1 from P1 to P2 should
be tested. This involves calculating the change of compactness for P1 due to disaggrega-
tion of A1 through the application of Equations (29)–(32), as well as that of P1 with the
aggregation of A1 through the application of Equations (25)–(28). If the sum of the vari-
ation is positive, it indicates that this move will increase the overall compactness, so A1
should be moved. Because the centroid, area, and MI of each TAZ (A1, A2, and A3) were
pre-calculated using Equations (12)–(24) and the computation of the new MI of a region
after (dis)aggregation only requires a few ‘add’ operations rather than being dependent on
the number of atomic units of a region, the time complexity is only O(1) for computing a
region’s compactness index as its shape changes. This demonstrates that the integration of
the proposed compactness measure into a regionalization problem can be very easily and
efﬁciently accomplished.

Figure 12 shows the best zoning plan obtained by applying the MI-based compact-
ness measure as the objective. Visually, the regions in Figure 12 are mostly round and
close to round, except for those restricted by the political and physiographical boundaries.
Statistically, of the 100 regions generated, 91% achieve compactness over 0.8, 66 of the
100 achieve compactness over 0.9, and only 9 of them have compactness below 0.8. This
demonstrates the good performance of the proposed MI approach in generating compact
zones in a regionalization problem.

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 1248

W. Li et al.

7. Discussion and conclusion

Adopting an MI index as a standard for shape measurement has been hampered by the
lack of an efﬁcient, computationally simple method of computing the moment of iner-
tia. Previous discussions remained at the conceptual level (Kaiser 1966, Young 1988) or
focused on the implementation of only a single shape’s compactness measure (Zhang
et al. 2006). In this article, we proposed a clear mathematical deﬁnition and computer
implementation of a trapezium-based approach for computing moment of inertia and the
corresponding compactness index based upon it. This approach has the advantage of
uniquely determining the compactness value, in comparison with the triangular approach
proposed by Massam and Goodchild (1971). Through successive experiments in Section 5,
we demonstrated that measuring compactness with the proposed MI shape index has clear
advantages over the commonly used IPQ. Moreover, we not only discussed the MI compu-
tation for vector data, we also presented a specialized form in which it can be applied to a
raster data model. We successfully integrated this measure into a large and practical region-
alization problem to demonstrate its easy extendibility and integrity. This article makes a
major contribution to geographic analysis through the development of a robust, additive,
computationally efﬁcient, and easy-to-integrate compactness measure. It also proposes that
an MI shape index should be considered as a standard method for measuring compactness.
Though the discussion in this article has been focused on measurements based on
pure geometry, the MI approach is easily extended to applications measuring compactness
weighted by the distribution of a property such as population, which is a feature that is
not supported by any of the other methods discussed. In a vector model, we could assume
that each basic spatial unit (a single shape) had a uniform density ρ, and by weighting
each element of area dA in Equation (7) by ρ, a density-weighted shape index can be
obtained. When it is desirable to investigate the property at a ﬁner level of detail, the
shift can be made to a raster representation and the shape index can be measured by a
weighted summation of pixels for that property. This will be the direction taken in our
future research in order to extend the methodological framework. We will also promote
and broaden the application of the proposed compactness measure to enhance the ability
to precisely identify compact spatial clusters, as needed in multiple scientiﬁc ﬁelds such as
spatial epidemiology and criminology.

Acknowledgements
The application to Southern California is funded by the University of California’s Ofﬁce of the
President and is being carried out as a collaboration between researchers at the University of
California’s Riverside, Berkeley, and Santa Barbara campuses and at the University at Buffalo.
The cooperation of collaborators at Harvard University and the staff of the Southern California
Association of Governments in providing access to data is also acknowledged.

References
Angel, S., Parent, J., and Civco, D. L., 2010. Ten compactness properties of circles: measuring shape

in geography. Canadian Geographer-Geographe Canadien, 54 (4), 441–461.

Bachi, R., 1999. New methods of geostatistical analysis and graphical presentation: distributions of

populations over territories, 1 ed. New York, NY: Springer.

Bardossy, A. and Schmidt, F., 2002. GIS approach to scale issues of perimeter-based shape indices
for drainage basins. Hydrological Sciences Journal (Journal Des Sciences Hydrologiques), 47
(6), 931–942.

Bottema, M.J., 2000. Circularity of objects in images. International Conference on Acoustic, Speech

Bribiesca, E., 1997. Measuring 2-D shape compactness using the contact perimeter. Computers &

and Signal Processing, Istanbul, 2247–2250.

Mathematics with Applications, 33 (11), 1–9.

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 International Journal of Geographical Information Science

1249

CalEPA, 2002. San Joaquin Kit Fox (Vulpes macrotis mutica) [online]. Available from: http://www.

cdpr.ca.gov/docs/endspec/espdfs/sjkfall.pdf [Accessed 01 Jun 2012].

Chandra, S., Chhetri, P., and Corcoran, J., 2009. Spatial patterns of urban compactness in Melbourne:
an urban myth or a reality. In: B. Ostendorf, P. Baldock, D. Bruce, M. Burdett and P.
Corcoran, eds. Proceedings of the Surveying and Spatial Sciences Institute Biennial International
Conference, Adelaide, Australia, 231–242.

Christaller, W., 1968. Wie ich zu der Theorie der zentralen Orte gekommen bin. Geographische

Zeitschrift, 56 (2), 88–101.

Cole, J.P., 1964. Study of major and minor civil divisions in political geography. The 20th

International Geographical Congress, London.

Datta, D., Malczewski, J., and Figueira, J.R., 2012. Spatial aggregation and compactness of census
areas with a multiobjective genetic algorithm: a case study in Canada. Environment and Planning
B-Planning & Design, 39 (2), 376–392

Douglas, D. H. and Peucker, T. K., 1973. Algorithms for the reduction of the number of points
required to represent a digitized line or its caricature. The Canadian Cartographer, 10 (2),
112–122.

Duque, J.C., Ramos, R., and Surinach, J., 2007. Supervised regionalization methods: a survey.

International Regional Science Review, 30 (3), 195–220.

Eason, P., 1992. Optimization of territory shape in heterogeneous habitats – a ﬁeld-study of the

red-capped cardinal (Paroaria-Gularis). Journal of Animal Ecology, 61 (2), 411–424.

Edwards, J. D., Riley, K. J., and Eakins, J. P., 2003. A visual comparison of shape descriptors
using multi-dimensional scaling. Computer Analysis of Images and Patterns, Proceedings, 2756,
393–401.

Esri, 2012. Geoprocessing with Python [online]. Available from: http://help.arcgis.com/
en/arcgisdesktop/10.0/help/in dex.html#/Importing_ArcPy/002z00000008000000/ [Accessed
01 Jun 2012].

Friedenberg, J., 2012. Aesthetic judgment of triangular shape: compactness and not the golden ratio

determines perceived attractiveness. i-Perception, 3, 163–175.

Frolov, Y.S., 1975. Measuring shape of geographical phenomena - history of issues. Soviet

Geography Review and Translation, 16 (10), 676–687.

Fryer, R.G. Jr and Holdeen, R.T., 2007. Measuring the compactness of political districting plans

[online]. Available from: http://www.nber.org/papers/w13456 [Accessed June-01 2012].

Gibbs, J.P., 1961. A method for comparing the spatial shapes of urban units. In: J.P. Gibbs, ed. Urban

research methods. Princeton, NJ: Van Nostrand, 99–106.

Gillman, R., 2002. Geometry and gerrymandering. Math Horizons, 10 (1), 10–13.
Goodchild, M.F., 1996. Generalization, uncertainty, and error modeling. In: Proceedings of GIS/LIS
96. Bethesda, MD: American Society for Photogrammetry and Remote Sensing, 765–774.
Haunert, J.H. and Wolff, A., 2010. Area aggregation in map generalisation by mixed-integer
programming. International Journal of Geographical Information Science, 24 (12), 1871–1897.
Horn, D.L., Hampton, C.R., and Vandenberg, A.J., 1993. Practical application of district compact-

Kaiser, H.F., 1966. An objective method for establishing legislative districts. Midwest Journal of

ness. Political Geography, 12 (2), 103–120.

Political Science, 10 (2), 200–213.

Kim, C.E. and Anderson, T.A., 1984. Digital disks and a digital compactness measured. In:
Proceedings of the sixteenth annual ACM symposium on theory of computing. New York, NY:
ACM Press, 117–124.

Landau, L.D. and Lifschitz, E.M., 1984. Electrodynamics of continuous media. 2nd ed. Oxford,

England: Pergamon Press, 460 pp.

Maceachren, A.M., 1985. Compactness of geographic shape – comparison and evaluation of

measures. Geograﬁska Annaler Series B-Human Geography, 67 (1), 53–67.

Martin, D., Nolan, A., and Tranmer, M. 2001. The application of zone-design methodology in the

2001 UK census. Environment and Planning A, 33 (11), 1949–1962.

Massam, B.H. and Goodchild, M.F., 1971. Temporal trends in the spatial organization of a service

agency. Canadian Geographer, 15, 193–206.

Miller, V.C., 1953. A quantitative geomorphic study of the drainage basin characteristics in the
Clinch Mountain area, Virginia and Tennessee. New York: Columbia University Department
of Geology Technical Report, No. 3.

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 1250

W. Li et al.

Openshaw, S., 1977. Geographical solution to scale and aggregation problems in region-building,
partitioning and spatial modeling. Transactions of the Institute of British Geographers, 2 (4),
459–472.

Openshaw, S., 1978. Empirical-study of some zone-design criteria. Environment and Planning A, 10

Openshaw, S. and Rao, L. 1995. Algorithms for reengineering 1991 census geography. Environment

Osserman, R., 1978. Isoperimetric inequality. Bulletin of the American Mathematical Society, 84 (6),

and Planning A, 27, 425–425.

(7), 781–794.

1182–1238.

Ovsjanikov, M., et al., 2009 Year. ShapeGoogle: a computer vision approach to invariant shape
retrieval. In: Proceedings of second workshop on nonrigid shape analysis and deformable image
alignment. Kyoto, Japan: IEEE Publisher.

Richardson, L.F., 1961. A note: measuring compactness as a requirement of legislative apportion-

ment. Mid-west Journal of Political Science, 5, 70–74.

Rinder, D., Armstrong, A., and Openshaw, S., 1988. The domesday machine: a nationwide

geographical information system. Geographical Journal, 154 (1), 56–68.

Santiago, R.S. and Bribiesca, E., 2009. State of the art of compactness and circularity measures.

International Mathematical Forum, 4 (27), 1305–1335.

Tobler, W.R., 1970. Computer movie simulating urban growth in Detroit region. Economic

Geography, 46 (2), 234–240.

Weaver, J.B. and Hess, S.W., 1963. A procedure for nonpartisan districting: development of computer

techniques. The Yale Law Journal, 72, 288–308.

Wentz, E.A., 2000. A shape deﬁnition for geographic applications based on edge, elongation, and

perforation. Geographical Analysis, 32 (2), 95–112.

Wentz, L., 1997. Shape analysis in GIS. AutoCarto, 5, 204–213.
Young, H.P., 1988. Measuring the compactness of legislative districts. Legislative Studies Quarterly,

Zhao, Z.Q. and Stough, R.R., 2005. Measuring similarity among various shapes based on geometric

matching. Geographical Analysis, 37 (4), 410–422.

Zhang, S.Q., et al., 2006. Vector analysis theory on landscape pattern (vatlp). Ecological Modelling,

13 (1), 105–115.

193 (3–4), 492–502.

Downloaded by [University of Iowa Libraries] at 16:59 14 March 2015 