Geoinformatica
DOI 10.1007/s10707-014-0207-5

Stacked space-time densities: a geovisualisation approach
to explore dynamics of space use over time

Urška Demšar & Kevin Buchin & E. Emiel van Loon &
Judy Shamoun-Baranes

Received: 3 September 2012 / Revised: 19 December 2013
Accepted: 13 March 2014
# Springer Science+Business Media New York 2014

Abstract Recent developments and ubiquitous use of global positioning devices have
revolutionised movement ecology. Scientists are able to collect increasingly larger movement
datasets at increasingly smaller spatial and temporal resolutions. These data consist of trajec-
tories in space and time, represented as time series of measured locations for each tagged
animal. Such data are analysed and visualised using methods for estimation of home range or
utilisation distribution, which are often based on 2D kernel density in geographic space. These
methods have been developed for much sparser and smaller datasets obtained through very
high frequency (VHF) radio telemetry. They focus on the spatial distribution of measurement
locations and ignore time and sequentiality of measurements. We present an alternative
geovisualisation method for spatio-temporal aggregation of trajectories of tagged animals:
stacked space-time densities. The method was developed to visually portray temporal changes
in animal use of space using a volumetric display in a space-time cube. We describe the
algorithm for calculation of stacked densities using four different decay functions, normally
used in space use studies: linear decay, bisquare decay, Gaussian decay and Brownian decay.

U. Demšar (*)
Centre for GeoInformatics, School of Geography & Geosciences, University of St Andrews, Irvine Building,
North Street, St Andrews, Fife, Scotland KY16 9AL, UK
e-mail: urska.demsar@st-andrews.ac.uk

K. Buchin
Department of Mathematics and Computer Science, Technical University Eindhoven, Eindhoven, The
Netherlands
e-mail: k.a.buchin@tue.nl
E. E. van Loon : J. Shamoun-Baranes
Computational Geo-Ecology, Institute of Biodiversity and Ecosystem Dynamics (IBED), University of
Amsterdam, Amsterdam, The Netherlands

E. E. van Loon
e-mail: vanloon@uva.nl

J. Shamoun-Baranes
e-mail: shamoun@uva.nl

Geoinformatica

We present a case study, where we visualise trajectories of lesser black backed gulls, collected
over 30 days. We demonstrate how the method can be used to evaluate temporal site fidelity of
each bird through identification of two different temporal movement patterns in the stacked
density volume: spatio-temporal hot spots and spatial-only hot spots.

Keywords Animal movement . Space-time density. Space-time cube . Visual data exploration .
Home range estimation . Utilisation distribution

1 Introduction

Recent ubiquitous accessibility and widespread use of global positioning devices using Global
Navigation Satellite Systems (in particular the Global Positioning System, GPS) have enabled
location-tracking on an unprecedented scale and produced large spatial data sets on moving
objects. One of the scientific areas where these technological advances have brought a
particularly significant advancement is movement ecology, which studies the movement of
groups and individuals across different animal species, different scales of space and time and
different levels of complexity [25].

these methods were developed in times when animal

Increased availability and decreased size of animal-tracking tags allows movement
ecologists to collect
large data sets on animal movement [7]. These data typically
consist of trajectories in space and time: i.e. temporal sequences of measured locations
for each tagged animal, as it moves through the physical world. Trajectory data are
commonly used to describe the space use by the animal, and this is often done through
derivation of home range or utilisation distribution using traditional methods [30].
However,
tracking data were
collected using very high frequency (VHF) radio telemetry and were much more
sparsely sampled. These methods are therefore not always appropriate for the increased
size of tracking data sets, the dense spatial and/or temporal sampling and the complex-
ity of the measured trajectories. Moreover, time is rarely taken into account in these
approaches, which mainly focus on spatial/geographical distribution of data. One of the
reasons for this may be the long-standing challenge of inclusion of time into spatio-
temporal modelling and data representations in Geographic Information Science [36].
Alternative methods are required for analysis and visualisation of large and dense
animal tracking data sets in order to identify patterns of movement—methods that take
into consideration temporal information as well as the spatial (geographic) component.
In this paper we introduce stacked space-time densities of trajectories to visualise and
visually identify movement patterns in space and time. The approach is inspired by the
aggregated space-time density of trajectories within a space-time cube [13], but alters the
density algorithm and combines it with home range/utilisation distribution principles in order
to show the usage of space by an animal over time. The stacked densities volume in the space-
time cube facilitates the following tasks in particular:

1)

2)

to visually identify spatial patterns in animal movement (for example, whether areas exist
that are frequently visited by the animal) and
to explore temporal characteristics of animal movement and thus identify temporal
changes in the use of geographic space (for example, does the animal visit the same point
at the same time every day and stays there for a while, i.e. a spatio-temporal hot spot, or
does it come and go often, but does not stay there and does so at different times, i.e. a
spatial only hot spot).

Geoinformatica

This approach to visualisation can facilitate the identification of patterns in animal move-
ment that may reoccur in space, time or both. For example, a researcher could distinguish
between an area of intense use that is visited at the same time every day (spatio-temporal
hot spot), or a geographic area used intensively but irregularly in time (spatial hot spot).
Identification of such temporal patterns in movement has recently received much attention
in movement ecology [42].

This is a primarily methodology paper in that it presents an algorithm for a new
geovisualisation approach, which is not limited to animal trajectories in that it can be useful
for any type of trajectory analysis where identification of spatio-temporal patterns is of interest.
However, the approach was partially inspired by home range methods in movement ecology
and therefore we chose to describe it in context of movement ecology and demonstrate its
applicability on a case study with animal movement data.

The paper is structured as follows: first we introduce the concepts of home range and
utilisation distribution and give a brief overview on spatial approaches to the derivation of
these two quantities. We review approaches that focus only on space as well as approaches
where time and sequentiality of trajectory points are taken into consideration. Then we present
the algorithm for our new visualisation method—the stacked space-time densities—and the
different decay functions used for calculating the stacked densities. We demonstrate how the
method can be used to visually distinguish between two movement patterns: spatio-temporal
hot spots vs. spatial-only hot spots. We do this by constructing two sets of simulated
trajectories with the same spatial distribution of trajectory points but different temporal patterns
of movement. This means that they are indistinguishable if considered only in 2D space and if
only 2D density distribution is used to visualise the home range. We also evaluate the stacked
densities algorithm against the geometrically optimal space-time density [13] with regards to
identifiability of crucial visual elements (using Qualitative Result Inspection, QRI [29]) and
computational efficiency (using Algorithm Performance measures [29]). We further apply the
visualisation method to a case study of trajectories of lesser black backed gulls (Larus fuscus)
to identify two different types of bird behaviour by distinguishing between spatio-temporal and
spatial-only hot spot, similar to those in our synthetic example. Finally we conclude with some
ideas for further method development and potential future research directions.

2 Home range and utilisation distribution in movement ecology

In movement ecology, tracking data are often used to construct either the home range or the
utilisation distribution of an animal. A home range is most often defined as a set of bounded
areas used by an animal in the course of its normal activities (foraging, mating, caring for
young). A utilisation distribution is a probability surface over a 2D area, describing the
intensity of usage of a particular location by an individual [30, 56]. The two concepts are
linked, since home range is often defined by an probability contour of the utilisation distribu-
tion surface for a certain value. Often a 0.95 probability is used, however the choice is
subjective and may vary per study [20, 21].

A vast array of methods exists to estimate these two concepts. In this section we
give a brief overview of spatial and spatio-temporal methodological issues only, since
those are relevant to our extension into the 3D space-time cube. We characterise these
methods according to the incorporation (or lack thereof) of the temporal aspect of
animal movement into 1) static methods, 2) methods that take into consideration time
non-sequentially and 3) methods that take into consideration sequentiality of movement
the interested
(time between subsequent

location measurements). We further point

Geoinformatica

reader towards other reviews that are more informative from the ecological perspective
which is beyond the scope of this paper.

2.1 Static methods

Static methods for home range/utilisation distribution calculation derive these two concepts
from measurements of the animal location. However, they do not consider the temporal aspect
of the data. These methods were primarily developed for VHF telemetry data which are
characterised by much lower and more irregular observation frequencies in comparison to
modern GPS technology [30].

The oldest methods for the calculation of home ranges are geometric. The most prevalent
geometric method is the Maximum Convex Polygon (MCP), which fits a convex hull to a
certain percentage of observation points (usually 95 %) to define the home range. In spite of
the rudimentary results, this method is still popular for its simplicity, ease of implementation
and because it allows a relatively easy comparison between studies (e.g. [34] report that 68 %
of home range studies they reviewed used this method). Examples of more complex geometric
hull-based methods include the k-nearest neighbour convex hull, i.e. a union of convex hulls
associated with each point and its k-1 nearest points [19] and characteristic hull polygons,
which consist of the densest areas in a Delaunay triangulation of observed points [14].

To calculate the utilisation distribution, a kernel density estimator is most commonly used
to produce a probability surface from the location measurements of an animal. As with
geometric methods described above, the temporal distribution of these points is not taken into
account. Utilisation distribution methods normally use the standard two-dimensional point
pattern kernel density estimation [50], which places a decay probability density function on
each data point and then sums them up into a surface, thus producing an estimate of the
probability of the animal being in each location. Most often, the decay function is a symmetric
bivariate Gaussian kernel, although other decay functions are sometimes used [20]. As with the
MCP, often the 95 % area of such utilisation distribution surface is used to define the home
range of an individual [21]. There are numerous studies using some type of kernel density for
utilisation distribution estimation (e.g. [5, 8, 20, 45, 56] to give a few selected examples from a
very large body of literature spanning the last 25 years). Some reviews and comparative studies
include [30, 34, 55], the latter of which presents an evaluation of these traditional kernel
density approaches for the new dense and large trajectory data sets.

2.2 Methods taking into consideration time non-sequentially

Static methods typically make (implicit) assumptions about the temporal distribution of the
measurement points. Two common assumptions are regular observation rates and the inde-
pendence of locations. While the second assumption is not explicitly temporal, it requires
temporally sparse measurements because of the spatial autocorrelation of locations. Various
methods address the case when these assumptions do not hold.

Observation rates might be irregular because of missing data, e.g. unsuccessful GPS fixes,
or because of adaptive observation rates, e.g. observations only at daytime. Horne et al. [28]
discuss approaches to correct for irregular observation rates for various home range models.
Autocorrelation can be reduced by increasing the overall duration of observation and by
decreasing the sampling rate [18, 41].

Usually, space use changes over time. In various studies the temporal dynamics are dealt
with by aggregating location measurements over time. While sequentiality of points is not
taken in consideration, the aggregation over different time scales provides a general impression

Geoinformatica

of temporal patterns of the use of space. Temporal scale of aggregation varies with each study.
For example, space use can be determined separately for day time and night time or separately
for different seasons of the year [53], different months [9] or years [52].

2.3 Methods taking into consideration time via sequentiality of trajectory points

Most of the methods described in the previous sub-sections use kernel density estimation, and
thus explicitly or implicitly assume that the selected measurement points are (ideally) an
independent sample drawn from a static probability distribution. The following methods take a
more mechanistic perspective and are based on some model of movement, where the
sequentiality of measurement points is taken into consideration.

Hengl et al. [24] connect consecutive measurement points by line segments, overlay the
study area with a grid, and assign to each grid cell the parts of the line segments in the
corresponding grid cell. This gives an estimate on the distance travelled within a grid cell. To
obtain an estimate of time spent in a grid cell these distances are divided by estimated
velocities. Decoupling computation of distances and velocities in this way allows incorporat-
ing environmental conditions (e.g. temperature) that influence the velocities.

Many sequential models are 2D kernel densities based on line segment kernels, i.e. in contrast
with traditional point pattern kernel density (Fig. 1a), kernels are not placed over each measure-
ment point, but sequentially on each line segment (Fig. 1b-d). These segment kernels are then
added into a two-dimensional surface. We list some examples of this type of kernels below.

Long and Nelson [35] base their sequential line segment model on the space-time prisms
from time geography [23]. They define a potential path area between two consecutive
trajectory points as a projection of the space-time prism onto the geographical plane. This
projection forms an ellipse, which is a set of all possible locations that a moving object might
have traversed given the maximum possible velocity, the fixed start and end locations and the
elapsed time between the two locations. Ellipses of all the trajectory segments are then
combined into an estimation of the home range. Rather than producing a probability surface,
their approach results in a uniform home range area, similar to geometric models.

An alternative time-geographic approach is presented by [15, 16], where a distance-
weighted elliptical kernel, defined using the potential path area ellipse from the space-time
cube, is fitted to each pair of two consecutive points in the trajectory (Fig. 1b). This results in a
kernel that is symmetrical around the line segment of the trajectory. This methodology is
generalised in [17] to a Delaunay triangulation of movement points for trajectories with
irregular and infrequent sampling.

Krisp et al. [33] adapt the elliptical line segment kernel by weighing its interior in the
direction of movement (Fig. 1d). I.e. the kernel function is a 2D projection of a cone centred on
the first point of line segment and leaning towards the second point of line segment, where the
inclination of the cone is calculated based on velocity and direction of movement.

The Brownian bridge movement model [10, 26] is based on a conditional random walk
between every pair of successive measurement points. It also accounts for a location error at
the measurement points. If the measurement error is assumed to be normally distributed then
the location in any point in time is normally distributed. The mean of this distribution moves
linearly between the locations of successive measurement points. The variance increases when
moving away from a measurement point and then halfway to the next measurement point starts
decreasing again (Fig. 1c). This variance depends on the variance of the location error and on
the mobility of the animal expressed by the Brownian motion variance parameter. Horne et al.
[26] describe how to estimate this parameter using a maximum likelihood approach. In
traditional models, the Brownian motion variance is assumed to be static along the entire

Geoinformatica

Fig. 1 Two- (a, b, c, d) and three-dimensional kernels (e, f, g, h) for trajectories. Two-dimensional kernels
produce density surfaces, three-dimensional kernels produce volumes in geo-time space. Panels a and e show
point-based kernels that do not consider temporal dimension of trajectory points but instead use each point as an
independent measurement in a point data set. Panels b-d produce line-segment kernels: one kernel for each line
segment of the trajectory and these kernels are then summed up along the entire line: kernels from two
consecutive line segments overlap each other. Panels f-h produce polyline kernels: one kernel for the entire
trajectory (and not a separate kernel for each line segment). Distance from each voxel and trajectory in polyline
kernel in panel f (shown in kernel with a dashed grey line) is measured perpendicularly to the trajectory and can
thus be in any 3D direction. Distance from each voxel and trajectory in polyline kernels in panels g-h is always
measured in horizontal direction (at a constant moment in time) and is calculated as 2D distance. Although
stacked kernels in g-h produce a visually similar density volume to smooth kernel in panel f, they are not a
special case of f, since they are calculated differently

trajectory. Recently, [32] introduced a dynamic version of Brownian bridges, where the motion
variance is modelled to change over time.

Movement based kernel estimation [3] is an approach similar to Brownian bridges, which
places additional points regularly sampled between consecutive measurement points and then
places decay functions not only on the original measurements but also on the new points.
Benhamou [2] shows how this approach fits into a biased random walk model.

Benhamou and Riotte-Lambert [4] further extend this approach with calculating two
additional spatial distributions: intensity distribution based on the mean resident time in each
observed point and recursion distribution based on the number of visits to each point.

3 Stacked space-time densities of trajectories

Space-time density of trajectories is a generalisation of the 2D kernel density into 3D kernel
density around polylines in the space-time cube [13]. The principle is based on geometric

Geoinformatica

aggregation of movement data (i.e. trajectories) into a volume using a regular division of
geographic space and time into voxels. This provides a spatio-temporal visualisation that
displays movement patterns in a clearer way when compared to the space-time cube.

The standard space-time cube [23] can easily become cluttered and illegible when many
trajectories are present in the display [31]. Therefore, some sort of aggregation of trajectory
data is necessary for easier pattern recognition [1]. One important characteristic of the space-
time density aggregation is that it preserves the property of the original space-time cube: to
provide a visual illustration of continuity of movement in space and time, while at the same
time allowing a trajectory-centred view of movement.

Space-time density of trajectories as a visualisation method was first introduced by [13]. It
extends the principle of a sequential 2D line segment kernels (Fig. 1b-d) into a space-time
cube, but generalises the kernel to follow the entire trajectory (Fig. 1f), rather than building a
separate kernel around each segment. While this methodology presents a geometrically
optimal polyline density representation in 3D, it has a disadvantage in that it is computationally
complex due to calculation of distance in three dimensions [13]. In this paper, we address this
issue by introducing a geometrically simpler model of 3D polyline density, the stacked space-
time densities (Fig. 1g and h).

In stacked space-time densities, the temporal dimension is treated differently than the two
geographic dimensions—this is in contrast to [13]. In particular, the decay is calculated for each
moment in time, which in terms of implementation means for each horizontal voxel layer separately.
This per-layer calculation represents the probability distribution of a moving object being in a
certain location at one particular moment in time. Probability layers are then stacked one upon the
other, to form the stacked space-time density volume (Fig. 1g & h). An algorithm for calculating this
volume is presented below, including four different decay functions for probability estimation.

It should be noted that the methodology presented here is not a special case of the
methodology in [13]. There, kernels are calculated using distance from trajectory in 3D space
and thus each kernel can be envisaged as a poly-cylindrical form following the trajectory, with
spherical endings around end points (Fig. 1f). Distance in this kernel is calculated perpendic-
ularly to the trajectory, therefore its direction depends on the slope of the trajectory. This
requires calculation of 3D distance between the centre of a given voxel and the entire
trajectory, i.e. polyline (Fig. 1f). The stacked-densities kernel however consists of a union of
horizontal cylinders, one cylinder per voxel layer. In the case of temporally uniform kernel
functions (linear, bisquare, Gaussian, Fig. 1g), these cylinders are all of equal width. In the
case of 3D Brownian kernel (Fig. 1h), the width of each kernel depends on the location of the
voxel layer between two consecutive trajectory points. The distance between each voxel and
the trajectory is calculated only in the horizontal direction, i.e. in the temporal layer to which
each voxel belongs (Fig. 1g-h). This is therefore a 2D distance calculation between the centre
of a given voxel and the intersection of the relevant line segment with the voxel layer of the
given voxel. Geometrically, stacked kernels can be considered as special cases of the spherical
3D point pattern density (Fig. 1e) [39] with three simplifications:

–
–
–

uniform extent of the kernel in temporal direction (i.e. using cylinders instead of spheres),
temporal extent set to zero (only consider kernel in one particular voxel layer) and
rather than calculating kernels only at trajectory points (as [39]), we generate a separate
cylindrical kernel at intersections of trajectory with each voxel layer. Trajectory kernel is
then built as the union of all cylinders (Fig. 1g-h).

We implemented the algorithm for calculation of the stacked space-time densities in Matlab,
while the resulting density volumes were displayed in Voxler software, using volume rendering

Geoinformatica

and isosurfaces. Volume rendering considers the volume as a medium of semi-transparent voxels,
to which optical properties (colour and transparency) are assigned according to the volume value
in each particular voxel [11]. Isosurfaces are 2D surfaces in the 3D volume such that all the points
on the isosurface share the same value. Surfaces are displayed with different optical properties
(colour, transparency) to give an impression of the distribution of one particular value inside the
volume [22]. For more discussion on how to visualise space-time density volumes, see [13].

3.1 Algorithm for stacked space-time densities

The algorithm for calculating the stacked space-time densities takes as input a set of trajecto-
ries, each of which is given as a series of data points (x,y,t), specifying the 2D geographic
location (coordinates x and y) at time t. Geographic location has to be specified on a plane (i.e.
given in a projected coordinate system rather than as longitude and latitude). The resulting
volume is assumed to have the same spatial resolution in the x and y directions (i.e. Δx = Δy).
Temporal resolution of the volume, Δt, can differ from the spatial resolution. In the case study
that we present in this paper, the total temporal range on the z axis is 24 h (given in seconds,
i.e. 86,400 s) and the temporal resolution is 1,000 s. These values for temporal range and
resolution were chosen as we were interested in daily patterns of animal movement. The
method however is general and allows for any kind of temporal extent and resolution. For
example, the temporal range could be a month and the resolution a day, or the range could be a
year and a resolution a week or a day, depending on the purpose of the ecological study and the
temporal acquisition density of data available (i.e. temporal sampling rate).

The algorithm reads each trajectory sequentially and subsamples the points to the chosen
temporal resolution. In this context we consider a trajectory to be the sequence of locations
describing movement of one object over the entire temporal period (i.e. 24 h). For each line
segment of the subsampled trajectory, the algorithm finds all the temporal voxel levels that
belong to this particular line segment and calculates the density for each temporal voxel level.
This is done according to a selected decay function, where decay is based on geographic
distance of each voxel from the central point on the trajectory at that particular moment in time.
Decay functions are described in detail in the next sub-section. They are all given as 2D
probability distributions over x and y dimensions, i.e. given the central point on the trajectory
at a certain moment in time (voxel level), they describe the probability of the moving object
being in one particular voxel at that particular moment in time. These probabilities are then
stacked one upon the other to produce the stacked trajectory density volume. Finally, stacked
trajectory density volumes are added up for all trajectories and normalised by the number of
trajectories, which results in the final stacked total density volume.
The pseudo code of the algorithm is given in the appendix.

3.2 Different types of decay functions

As mentioned above, each decay function f is a function of the geographic distance from the
subsampled trajectory at a certain moment in time. We use a decay function which is
symmetrical around the z axis (i.e. the same in the x and y directions). Therefore, for simplicity,
we look at geographic distance only in the direction of the x axis and denote it by x. In our
notation, the decay function f therefore becomes a function of x, i.e. f(x).

We implemented four different decay functions: linear, bisquare, Gaussian and Brownian.
There is some evidence for 2D point density that the choice of kernel function does not affect
the general visual pattern [50, p. 42–43]. While for our 3D stacked densities we expect a
similar result for the first three decay functions (linear, bisquare and Gaussian), we further

Geoinformatica

function type.

expect that the Brownian decay will visually emphasise the certainty of location in the
measured points and uncertainty of movement between the points—something that will not
be directly observable in the pattern produced with the first three functions.

Figure 2 shows these functions and the resulting stacked space-time density for each

Fig. 2 Four different decays shown as density volumes on one artificial trajectory and corresponding decay
functions: a linear, b bisquare, c Gaussian and d Brownian. Linear and bisquare decay functions reach value 0 at
distance h from trajectory, where h denotes bandwidth. Height a is determined so that the functions satisfy the
requirement of their respective rotated surfaces being 2D probability distributions (i.e. volume under rotated
surface has to be equal to 1). Gaussian decay function is the normal distribution with the mean centred on
trajectory (i.e. μ=0) and variance σ2 dependent on bandwidth h, but constant the for entire trajectory. Brownian
decay is based on the Brownian bridges approach, where at each level in the space-time cube we use a Gaussian
decay function with constant mean as above (μ=0), but where variance depends on the length of the current line
segment (T) and the position of the current voxel layer on that particular line segment (t). The closer the voxel
position is to the ends of the line segment, the steeper and narrower is the shape of the distribution

Geoinformatica

Each of the decay functions z = f(x) is rotated around the z axis to produce a surface that is
used to calculate decay around the central point of the trajectory at one particular voxel layer.
Using these surfaces means that we can describe the resulting density value in each voxel of
this layer as the probability of the moving object being in that particular geographic location at
that particular time. To achieve this, the surfaces need to represent 2D dimensional probability
distributions and therefore need to fulfil the requirement that the volume underneath each
surface is equal to 1. We mention this condition specifically since sometimes in similar
derivations [27], a 1D probability distribution is used instead, although it does not satisfy
the volumetric requirement.

Linear and bisquare decay functions are given by the formulas (1) and (2) respectively:

zLinear xð Þ ¼ a⋅ h−x

ð

h

Þ

;

if x ≤ h
if x > h

0 ;

(cid:2)

x2−h2
h4

(cid:3)

;

0 ;

if x ≤ h
if x > h

zBisquare xð Þ ¼ a⋅

8
<

:

8
<

:

Here, h denotes the user-specified bandwidth and a the height of the linear triangle (Fig. 2a)
or the bisquare bell (Fig. 2b). In this particular derivation we do not discuss how the specific
bandwidth h is selected and assume that some study-specific method has been used to select an
appropriate bandwidth size. Optimal bandwidth selection is a large issue not only in ecology
but any time when kernel density estimation is used. In standard 2D kernel density estimation,
the size of the bandwidth determines the level of smoothing of any point pattern in 2D: a too-
small bandwidth emphasises individual points, while a too-large one over-smoothes the pattern
[50]. A similar bandwidth-choice effect may be observed in 3D around polylines. In multi-
variate visualisation, optimisation algorithms are typically employed to determine the best
bandwidth—in this respect we point the reader to [38] for more details.

The rotation of the linear decay function around z axis produces a cone with the top at the
central point of the trajectory and a linear decline to a circle with diameter h. Everywhere else
the surface is equal to zero. Rotation of the bisquare decay function around the z axis produces
a bell-shaped surface, which also reaches zero at the circle with diameter h. In both cases, the
height a is determined so that the volume under the rotated surface (i.e. the cone or the bell) is
equal to 1, to satisfy the condition for these being 2D probability distributions. In both cases
this height has to be equal to a=3/πh2. Therefore we use the following two functions in
density calculations:

ð1Þ

ð2Þ

ð3Þ

zLinear xð Þ ¼

zBisquare xð Þ ¼

8
<

:

3
πh2

Þ

ð
⋅ h−x
h

;

0 ;

And

8
<

:

(cid:2)

3
πh2

⋅

x2−h2
h4

(cid:3)2

;

0 ;

if x ≤ h
if x > h

if x ≤ h
if x > h

Geoinformatica

The Gaussian decay function (Fig. 2c) uses the standard 2D Gaussian distribution1:

Here, μ is the mean and σ2 the variance that describes the mobility of the object. In our case
the function needs to be centred on the trajectory, therefore we set μ=0. This results in the
following formula for Gaussian decay:

(cid:2)
z x; μ; σ2

(cid:3)

¼ 1
2πσ2

Þ2

− x−μð
2σ2

⋅e

zGaussian xð Þ ¼ 1
2πσ2

− x2
2σ2

⋅e

ð4Þ

ð5Þ

In this case, σ2 is a constant and does not depend on the position on the trajectory. For this
experiment we set it to σ2 = (h/2)2, since the purpose of this paper is primarily to develop the
visualisation method and this particular value allowed us to visually compare resulting
densities with the ones calculated using other decay functions. Here h is the user defined
bandwidth, as with linear and bisquare functions above. The actual value of this parameter in
home range studies depends on animal mobility and therefore varies with each animal species
under observation [26].

The rotation of the Gaussian decay function also produces a surface in the form of a bell
(Fig. 2c), which is similar to the bisquare one (Fig. 2b). However, this bell surface never
reaches zero, but falls towards zero in all directions. We also do not have to calculate the height
of the bell of this function to ensure that it satisfies the requirement of the volume beneath the
rotated surface to be 1, since we have started with a 2D probability distribution (Eq. 4) and this
condition is therefore already satisfied.

One property of the described decay functions (linear, bisquare, Gaussian) is that they only
depend on externally-set bandwidth h, which is constant for entire trajectory. Distance decay is
therefore the same regardless of the position on the trajectory. In Fig. 2a-c this is shown by the
fact that the isosurfaces for constant values of space-time density, while spaced differently for
each type of decay function, are parallel to the trajectory. This however does not consider
uncertainty in movement between two consecutive measurement points. To address this
uncertainty we introduced the fourth type of decay using the concept of Brownian bridges
[10, 26, 27].

Brownian decay is a concept based on the stochastic description of animal movement, [10,
26], as described in the previous section. Here, the probability of the moving object being in a
certain point depends on the start and end locations (i.e. on two consecutive measurement
points), the elapsed time t since the object left the start location and the speed of movement
(described by the time the object needed to go from start to end location, marked as T). In
terms of home range estimation, Brownian decay is modelled as Gaussian decay which varies
not only with distance from trajectory, but also with t and T (Fig. 2d), i.e. z = f(x,t,T). This
means that at each point on the trajectory we take the Gaussian decay function (Eq. 5), and set
the variance σ2 to vary with t and T. The way to model this dependency is given by [10] as:

σ2 t; Tð

Þ ¼ σ2
1

ð
⋅ 1−t

Þ⋅t⋅T þ σ2
2

(cid:4)
⋅T ⋅ 1−t
ð

Þ2 þ t2

(cid:5)

ð6Þ

1 Note that [26, 27] present the formula with a square root in the denominator, which corresponds to a 1D (not
2D, as required) Gaussian distribution. Their derivations are not affected by this.

Geoinformatica

Here, σ1

2 and σ2

2 are constants describing two different aspects of uncertainty in the
measurement of movement [10]. σ1
2 is the variance of movement along the trajectory (the
same as σ2 in Gaussian decay above). σ2
2 is the variance of the distribution that reflects the
uncertainty of the object being at start and end locations—i.e. the uncertainty of the location
measurement. σ1
2 is related to animal mobility and is a feature of a particular animal species
under observation, while σ2
2 depends on properties of the measurement equipment [26]. For the
purposes of this paper, we set the values to the following (h being the user defined bandwidth,
as in linear and bisquare densities above):

(cid:6) (cid:7)
2
1 ¼ h
σ2
2

; σ2
2

(cid:7)

(cid:6)
¼ 2σ2
5

1

ð7Þ

However, as discussed above, values of both these two parameters depend on animal
mobility and the measurement equipment and how these values are related to the bandwidth
h and to each other should be taken into consideration in each particular experiment,
depending on the animal species under investigation.

4 Why choose 3D over 2D? Identifying temporal patterns in movement data

One of the persisting questions in movement ecology are temporal patterns in space use.
Animal use their environment unevenly by spending more time in favourable locations or
revisit such locations more frequently than others and it is of specific interest to ecologists to
find out the role of time in this heterogeneous behaviour [4, 42]. Most methods for home range
estimation however are linked to two geographic dimensions and therefore do not allow visual
discovery of temporal patterns very easily. This is where incorporating the space-time cube
principle into visualisation for home range dynamics is needed to support distinction between
different types of patterns. In this section we show how traditional 2D density masks the
difference in two temporally different visitation patterns to a central location and how these
patterns are immediately obvious when using 3D densities.

To evaluate the 2D kernels vs. 3D kernels, we generated two synthetic sets of trajectories
and calculated their respective 2D and 3D densities (Fig. 3). Each set contained the same
number of trajectories. Each corresponding trajectory in both sets contained the same number
of points, which had an identical spatial distribution. That is, in both cases, each trajectory
described movement from the border of the study area ([0,10]×[0,10] rectangle in the x-y
plane) towards the central point and back. Corresponding trajectories in Fig. 3a, b and c are
coloured the same. However, in each case, the trajectories exhibited a different temporal
pattern of movement.

Set A consisted of four trajectories that first moved to a central point of the study area and
then outwards from this point, but where each of them reached the central point at a different
moment in time (Fig. 3a). These trajectories represent a spatial-only hot spot, i.e. an area which
the moving objects frequent, but never reach this point at the same time.

Set B consisted of four trajectories that met at the central point at the same time (Fig. 3b)
and thus demonstrated spatio-temporal convergence of trajectories. In this case, the central area
represents a spatio-temporal hot spot.

In both cases, A and B, the trajectory points produce an identical spatial pattern in two
geographic dimensions (Fig. 3c). This means that if a standard 2D kernel density is used for
estimation of home range on either data set, the result is an identical surface (Fig. 3d).
Specifically, Fig. 3d shows a traditional 2D kernel density surface, calculated on either of

Geoinformatica

Fig. 3 Comparison of 2D and 3D densities on two simulated sets of trajectories. Each set of trajectories includes
four trajectories. Panel a shows the space-time cube of trajectory set A, representing a spatial-only hot spot and
panel b the space time cube of trajectory set B, representing a spatio-temporal hot spot. Panel c shows the spatial
distributions of points in each set: these distributions are identical for both sets of trajectories. d is a map of the
2D density of trajectories in each set: these two densities are also identical for both sets of trajectories. However, e
the stacked space-time density volume of trajectory set A and f the stacked space-time density volume of
trajectory set B present a different pattern and enable visual distinction between two different types of movement

the two trajectory sets, using the bisquare decay point kernels (as those illustrated in Fig. 1a),
2D raster resolution of 0.1 and bandwidth size of 0.8. As noted, based on such a 2D-only case,
it is not possible to distinguish between sets A and B, since the only distinguishing factor
between A and B is the difference in the temporal pattern, which 2D density ignores.

Geoinformatica

Figure 3e and f show stacked space-time densities of cases A and B respectively, calculated
with the same parameters as the 2D density in Fig. 3d. We use 3D bisquare stacked density
kernel (as in Fig. 1g), voxel resolution of 0.1 and bandwidth size of 0.8. The 3D volumetric
patterns are clearly different and illustrate the difference between a spatial-only and a spatio-
temporal hot spot—something that is not identifiable in the 2D density of the same two data
sets (Fig. 3d). Stacked space-time densities therefore allow distinguishing between areas where
objects congregate at the same time and others where they visit only at different times.

5 Comparison of 3D densities: space-time density and stacked densities

In order to evaluate the two 3D density algorithms against each other, we developed a specific
evaluation procedure (Fig. 4). In ecology and statistics, different types of 2D densities are often
compared by using an artificial data set, calculating different density surfaces on the same data
and then evaluating differences between surfaces through calculation of various error measures
[20]. This is illustrated as the first purple arrow (“Statistical evaluation”) between two density
fields in Fig. 4. However, this kind of comparison, is only possible for multivariate densities if
all dimensions are treated in the same way across the different algorithms that are to be
compared [54]. Our two density algorithms treat the temporal dimension differently and
therefore we cannot compare them in this way.

An alternative method of comparison that may be considered is common in volumetric
visualisation: there, different types of volume rendering (which we use to display our density
fields) are often compared through calculation of efficiency measures, such as depth coherence
or distinguishability of features [57]. The second purple arrow (“Volumetric visualisation
evaluation”) indicates this possibility in Fig. 4. However, we use the same volume rendering
parameters for both density fields, hence with respect to these factors there is no difference
between our two algorithms and these measures are not applicable in our case either.

Fig. 4 Comparing space-time (ST) density [13] vs. stacked densities. We use the same artificial trajectory data sets
to calculate ST and stacked density fields. Each of these fields is then displayed as density volume using the same
volume rendering method. In statistics, density fields are often compared directly [20] using various error and other
measures (first purple arrow). We cannot do this, since our two density fields treat volume dimensions differently
[54]. In volumetric visualisation, different volumes are compared through quantification of efficiency [57] of their
respective volume rendering methods (second purple arrow). This is not applicable in our case, since we use the
same rendering for both volumes. Instead, we adopt two frequently applied evaluation methods from information
visualisation [29], algorithm performance (left green arrow) and qualitative inspection (right green arrow)

Geoinformatica

Instead, we employ evaluation measures from information visualisation [29] and use the
two most prevalent evaluation methodologies in the visualisation community: Qualitative
Result Inspection (QRI) and Algorithm Performance (AP). QRI is a method where a certain
visualisation methodology is used to produce an image that demonstrates how something that
could not be seen before can now be seen with the new method. An extensive review of
information visualisation studies [29] found that QRI was used in 95 % of all cases. An
example of this methodology used for 2D trajectory density can be found in [49]. AP was the
second most frequent evaluation method, used in 35 % of studies. It is a quantitative measure
of algorithm speed, which is linked to computational complexity.

For QRI in our case, we calculated space-time density [13] and stacked densities on the two
data sets from section 4 and visually compared the two results. Stacked density volumes for
these two data sets are shown in Fig. 3e and f, while space-time densities for the same two data
sets are shown in Fig. 5a and b respectively. All four density fields were in the same range
([0,10]3), volumes were of the same size (100×100×100, voxel size 0.1) and kernel size in all
cases was 0.5 (5 pixels on each side of trajectory). We used the same kernel size in both cases
(linear kernel). It is clear that Figs. 3e and 5a show a similar picture where non-interaction of
the four trajectories can be observed. In Figs. 3f and 5b, the spatio-temporal hotspot is also
clearly identifiable. The two 3D density algorithms therefore both allow visual identification of
patterns of interest to ecologists.

In terms of AP, we first calculated the asymptotic worst-case running times of both
algorithms. The asymptotic running time of the geometrically optimal space-time density
[13] is in O(n x m x v), where n is the number of trajectories, m the length of the longest
trajectory (number of measurement points in the longest trajectory) and v the number of voxels
in the density volume (and thus equal to vx x vy x vt). This results in long calculation times for
data sets with a large number of densely sampled trajectories and when density volumes are
required to have a detailed spatial and temporal resolution and thus many voxels in each of the
three dimensions (i.e. large vx, vy, vt). In contrast, the stacked space-time densities present a
computationally less demanding solution, as the asymptotic running time of the algorithm is in
O(n x v).

To demonstrate the change in algorithm speeds, we set up an experiment where we again
used case A and case B data from the previous section. We subsampled both data sets so that
trajectory length for each of the four trajectories in the data set was either 50 or 100 (i.e. there

Fig. 5 Space-time density [13] for a a spatial-only hotspot (case A) and b spatio-temporal hotspot (case B).
Densities are shown with identical volume rendering parameters as stacked densities in Fig. 3e and f respectively

Geoinformatica

were 50 or 100 points on each trajectory). We used the same data range for all cases, but set up
two different volume sizes, either 10x10x10 or 100x100x100. We used the same kernel type
(linear) and the same kernel size in all cases. With all parameters kept the same, Table 1 shows
the difference in processing times between the two algorithms. The much reduced times of
stacked densities clearly demonstrate the difference in processing times, in line with the
asymptotic worst-case running times.

The results of QRI and AP indicate that stacking the densities temporally vs. using a
geometrically optimal solution speeds up the calculation significantly while producing a
visually adequate density volume for identification of spatio-temporal patterns of interest.

6 Case study: using stacked space-time densities to visually explore movement patterns
of lesser black backed gulls

As part of a long-term field study, the movement of lesser black backed gulls is monitored and
analysed to better understand the foraging ecology of this species and ultimately link this to
breeding success [12]. Currently, the time budgets of individuals are quantified and areas
where they potentially feed are located. Lesser black backed gulls may exhibit inter-individual
differences in behaviour due to individual specialisation in foraging behaviour, spatial and
temporal variations in resource availability, influences from weather and breeding status.

Individuals may show different levels of site fidelity, revisiting the same area for short
periods of time on numerous occasions, or make rare long visits to specific locations
(especially when the resource is predictable and stable). In a spatial only context, both types
of behaviour could result in similar space use patterns. Identifying temporal differences in
spatial patterns and regularity of visiting a given area, in combination with the total time spent
at that location may therefore provide interesting and new insights with respect to foraging
strategy and behavioural ecology.

6.1 Data description

The data for this study were provided for an interdisciplinary workshop [47] and comprise
tracks from 1 June 2010 to 30 June 2010 of four adult male and four adult female lesser black-
backed gulls breeding on Texel, the Netherlands (Fig. 6). Data were collected using the UvA
Bird Tracking System (http://www.uva-bits.nl/, [6]). Nest-locations for each of the individuals
are also known. Considering trips with the nest as start and endpoint, and moving at least 3 km
away from the nest, on average 467 trips were made per individual, with a mean trip duration

Table 1 Algorithm performance of the two density algorithms: space-time density [13] and stacked densities

Max traj.
length

Data set
range

Volume
size

Voxel
size

Kernel
size

Processing times—space-time
density [13]

Processing times—
stacked densities

Case A

Case B

Case A

Case B

50

50
100

100

[0,10]3
[0,10]3
[0,10]3
[0,10]3

10×10×10

100×100×100
10×10×10

100×100×100

1

0.1
1

0.1

3

3
3

3

3.90 s

2816.27 s
7.68 s

5168.51 s

4.05 s

2966.29 s
8.45 s

5478.07 s

0.04 s

12.89 s
0.06 s

15.36 s

0.02 s

13.28 s
0.03 s

14.84 s

Geoinformatica

Fig. 6 Geographic positions of a bird 298 and b bird 311, covering a time period of 30 days (June 2010). c
Location of nests on Texel island and 150 m buffers around each individual nest that were used to compensate for
central-place foraging behaviour of lesser black backed gulls by d removing all trajectory points within the 150 m
of the nest (bird 311 in this example). In the background is the land use map of this area of the Netherlands

of 5.3 hours, the mean distance along the trajectory per trip was 69.0 km, and the mean
maximum Euclidian distance from the nest was 24.3 km.

Figure 4 shows observed location points of the two birds that we selected for density
calculation in this paper, no. 298 and no. 311 (Fig. 4a and b). These are both male birds and we
were interested in temporal patterns in their movement indicating site fidelity to locations away
from the nest. For this purpose, we excluded data points in the nest and its immediate vicinity
(150 m), as shown in Fig. 6c and d. The distance of 150 m was chosen to delineate start and
end of trips (i.e. when the bird moved far enough from the nest for the movement to be
considered a trip from the nest) as well as for correction for central-place foraging behaviour,
which we discuss in the next section.

Geoinformatica

6.2 Calculating the densities and correction for central-place foraging behaviour

In this section we describe the procedure for density calculation that takes into account a particular
type of animal behaviour: central-place foraging [40, cited in 51, p. 277]. This behaviour means
that during each day, the animal makes several back-and-forth foraging trips from a central
location, each time returning back to that location (to e.g. bring food to the young in the nest). This
behaviour introduces a geographic bias into the use of space, since it is more likely for the animal
to be located in the central location and its immediate neighbourhood than anywhere else at any
observed time. As we are interested in wider movements of the gulls and not in their movement in
nest area, here we adjust our calculations for this behaviour by removing data points from the nest
and its surroundings and further discuss other more complex solutions in the conclusions.

We calculated the stacked space-time densities for the two selected birds (no. 298 and no.
311) using the same spatial and temporal extent, to produce comparable density volumes. The
geographic area covered by the trajectories of both birds measured 100×100 km in E-W and
N-S directions. Temporal extent was 24 h=86,400 s, starting from 0 h at the bottom and
continuing towards 24 h at the top. Spatial resolution in both east–west and north–south
direction was 1,000 m and temporal resolution 1,000 s (16 min 40s), which resulted in a
density volume of 100×100×87 voxels. Kernel size (bandwidth h) was set to 5,000 m. The
temporal range of 24 h was chosen (as opposed to showing the entire month of data on the z
axis) to be able to identify daily behavioural patterns of birds (if any) and their potential
repetition over the study period. The temporal resolution of 87 voxels per day on the other
hand provided manageable computational complexity while still ensuring enough details to be
able to identify behavioural patterns in movement. Figure 7 shows the resulting space-time
density for all four decay functions for bird 298, shown with volume rendering.

If we compare the four decay functions visually, they all give a similar picture of the
movement of this bird. There are certain differences though, for example, linear decay density
has crisper borders than the others. Bisquare decay emphasises higher density values (more
and brighter red in the temporal columns, Fig. 7b). Gaussian density fades slower than the
others and never reaches zero (Fig. 7c). In Brownian decay uncertainty is taken into consid-
eration, which visually results in dense areas around measurement points (Fig. 7d). These
dense areas and areas of decreasing and increasing density in-between are the 3D visual
representations of the Brownian bridges concept.

One difficulty that we encountered at this point in the process was the fact that lesser black
backed gulls are central-place foragers, meaning that they return to a central point (in this case
a nest situated within a breeding colony), sometimes several times a day, as well as spend a
significant proportion of time at the nest. This means that a significant proportion of trajectory
points for each gull were collected while the animal was in the breeding colony where it does
not forage. Consequently these points do not describe the movements we are interested in. In
our case, over 30 days of measurements, bird 298 had 1,774 points in the nest out of 4,161
points in total (42.6 %) and bird 311 had 2,052 nest points out of 4,096 points in total (50 %).
Since the temporal sampling rate of original data was not constant over the data acquisition
period, these percentages do not equal percentage of time spent in the colony. However, if
these points are included in the space-time density calculation, the resulting volume has very
high values in a temporal column over the nest. This column is visually very prominent, while
the density over the rest of the geographic area is less clear, since the density values are lower
and therefore volume rendering method assigns higher transparency to these areas (Fig. 8a). To
avoid this effect we removed points within 150 m from the nest (Fig. 6c and d) and calculated
space-time densities on the remaining points only (Fig. 8b). The area around the nest is still
represented as a temporal column, since the bird has to pass this area when moving in and out

Geoinformatica

Fig. 7 Space-time density for bird 298 calculated using four different decay types: a linear decay, b bisquare
decay, c Gaussian decay and d decay using the Brownian bridges approach. The x and y axis show easting and
northing in metres and the z axis time in seconds (24 h=86,400 s). In this example, the nest is already removed
from the analysis

Fig. 8 Correction for central-place foraging behaviour of lesser black backed gulls. Figure shows two space-time
densities for bird 311, where in a all points were taken into account and in b points within the 150 m buffer
around the nest were removed prior to density calculation

Geoinformatica

of the nest. While bird 311 is at the nest predominantly during the night (hence more points
around the nest are removed during the night) a consequence is that especially the movements
in and out of the colony during the day become more visible in Fig. 8b. By removing the nest-
effects, Fig. 6b shows more clearly than Fig. 8a, that bird 311 moves much less at night. In
addition, the pattern of one key area outside the nest often revisited becomes more obvious
once nest effects are removed.

6.3 Results: identifying movement patterns from density volumes

Figures 9 and 10 show stacked space-time density volumes for birds 298 and 311. In both
cases, densities are shown with direct volume rendering using perspective view (Figs. 9a, b,
10a and b) and orthographic projections from the south or east (the front or the side of the
volume cube) and the top (Figs. 9c, d, 10c and d) using two different colour schemes. We also
show the two density volumes with isosurfaces in perspective view (Figs. 9e and 10e).

These volumes identify the daily movements of each of the birds, aggregated in a space-
time cube over the 30 days for which we had data. In these cubes, the x-y plane represents the
geographic plane and the z axis the temporal axis over the 24 h range. The value of density
represents the probability of the animal being in a particular area at a particular time of day,
which gives a visual impression of daily patterns of the space use.

In addition, particular types of visual patterns in the density volume can be used to explore
the properties of daily movement of each animal. In these two examples, we can identify a
prevalent temporal column in densities of both birds in the area surrounding the nest. This
column stretches across the entire 24 hours (i.e. across the entire extent of the z axis) and
represents movement in the vicinity of nest area, which is expected for a central place forager
during the breeding season. This column is an indication of when, during the course of
24 hours, an individual moves to and from the nest.

Another type of pattern of interest are hot spots, either spatio-temporal (a place where a bird
repeatedly visits at the same time each day and stays for a while) or spatial-only (bird returns to
this place often, but there is no temporal pattern to the visits). Visual exploration of density
volumes can help distinguish between the two, as demonstrated on simulated data in the previous
section. Bird 298 has one clear spatio-temporal hot spot with high density values that are in close
proximity to each other in both space and time (Fig. 9a-d, indicated with an arrow in 9d), which is
also shown as an isosurface (Fig. 9e). This hot spot represents a spatio-temporal convergence of
trajectories, which in the context of the bird movement means that the bird tends to visit this place
often (see arrow in Fig. 9d), comes there mostly in the early hours of the day and stays there for a
while (Fig. 9c). This pattern is similar to the pattern in case B of simulated data (Fig. 3b and f).
In contrast, bird 311 has a spatial-only hot spot. It is a spot that the bird visits often, best
seen from the view from top (Fig. 10d), however, there is no pronounced temporal pattern over
this spot as with bird 298. Visits are sporadic and short and occur at any time of day—this can
be best seen by a light-blue to dark-blue vertical area to the left of the nest column in the view
from the east (Fig. 10c). This means that the bird revisits this place, but does not stay there for
a longer time. The same pattern can be seen in the isosurface (Fig. 10e), where there is no
uninterrupted continuous isosurface of high density over the spot—instead there are several
smaller high density areas that each represent one or a few temporal visits to this particular
location. This pattern corresponds to case A in the simulation (Fig. 3a and e).

The next step is to explore the possible reason for visiting these sites and the potential
activities that take place there by adding the context and knowledge about the area. The spatial-
only hot spot visited by bird 311 is a water purification plant, visited by gulls for preening and
resting (A. Gronert, personal communication), whereas the spatio-temporal hot spot of gull

Geoinformatica

Fig. 9 Space-time density for bird 298 using Gaussian decay, shown from different angles with volume
rendering in a and b, c from the south, d from the top and e with an isosurface. The area around the
nest is identifiable as a temporal column that spans the entire height of the volume (24 h). There is an
additional smaller temporal column, south-east from the nest, which represents a spatio-temporal hot
spot. This is a place that the bird visited frequently, mostly in the mornings and stayed there for a
while. This is best seen in the view from the front, (c) and in the isosurface displays (e), where this hot
spot is one uninterrupted dense area. Geographical location of this hot spot can be identified in the top
view (d), where it is shown with an arrow for clarity

Geoinformatica

Fig. 10 Space-time density for bird 311 using Gaussian decay, shown with volume rendering in a and
b, c from the east, d from the top and e with an isosurface. The temporal column that identifies the area
around the nest is clearly identifiable. There is another area that is visited often, indicated with an
arrow in the top view d, which represents a spatial only hot spot, i.e. an area that the bird visits often,
but where it does not stay for long. This is most clearly identifiable in the isosurface, where this area
consists of several floating high density areas, located at different heights and therefore at different
moments in time

298 is an agricultural area where gulls potentially forage and roost. These and similar spatial
and spatio-temporal hot spot patterns could be a useful tool for identification of patterns of
periodicity in recursions to a particular location, a temporal characteristic of animal movement
[42]. Such observations could be further confirmed using either visual observations or
additional sensor observations (e.g. accelerometer [48]).

Geoinformatica

7 Conclusions

In this paper we presented stacked space-time densities as a method for visualising movement
patterns and temporal dynamics of space utilisation in a data set of animal trajectories. The
method is based on a concept of space-time cube, thereby preserving the fundamental linkage
between space and time, as introduced in time geography. The aim is to give a visual
impression of temporal dynamics of space use via volumetric aggregation of trajectory data.
We anticipate that the method could be of use in animal ecology, where animal tracking is
producing unprecedented amounts of data due to development of new tracking technologies.
We see this approach as primarily useful for the initial visual exploration of data and building
hypotheses about the spatio-temporal aspects of animal behaviour, which are not identifiable
via traditional 2D home range/utilisation distribution mapping, as demonstrated in simulated
cases A and B and real bird examples in the previous sections. Ecologists can then further
verify or reject these hypotheses using e.g. resource selection models [37].

In the paper most of the examples are shown using volume rendering of the density volume.
In terms of 2D home range methods this is equivalent to showing the utilisation distribution
surface as a raster map. In order to delineate home range from utilisation distribution, typically
some contour (isoline) of this surface is used. In our 3D density volume, the equivalent would
be to display an isosurface of the volume (as in Figs. 7e and 8e). In contrast with the 2D case,
where the isoline delineates the overall home range, the respective isosurface in the 3D volume
would show the changes of the home range over time, thus allowing visual identification of
temporal patterns in movement, such as periodicity of visits and their temporal extension.

From the algorithmic point of view of 3D density calculation we note that our approach
includes geometrically simple kernels, which are calculated per voxel layer. In cases where
kernel sizes are independent of time (using linear, bisquare and Gaussian kernels, Fig. 1g), this
implies that probabilities of animal being in a certain location at a particular time are only
connected to each other by the position of the kernels, which are centred around the
interpolated line segment in 3D space. In case of Brownian bridges there is a further implicit
inclusion of time into calculation in that kernel sizes depend on the position on the line
segment at each specific moment in time. More complex kernels that model probabilities
through time are possible, such as for example instead of a cylinder creating a half-spherical,
spherical or elliptical kernel at each voxel layer which extends into previous or future times.
More complexity could also be added by making the kernel non-symmetrical in 3D, but space
probabilities within the kernel based on movement direction and velocity (as an extension of
[33] into 3D). These variations present a future challenge for 3D visualisations of movement.
While developing the approach, we encountered certain issues, on which we speculate in
the rest of this section and point out potential future solutions. One such issue is that in our case
study, we use data from a central-place foraging animal. This type of behaviour introduces
certain biases in the use of space and is a well-known modelling problem [44]. In general,
methods to estimate home range are based on comparison with null model of animal
movement, which assumes that there is no spatial context for habitat use [44]. Our visualisa-
tion method is of this type—nowhere in the calculation of stacked space-time densities do we

Geoinformatica

assume that there is a different expectation of space use to anywhere else. However, as
mentioned above, lesser black backed gulls exhibit central-place foraging behaviour. This also
introduces a geographic bias to movement analysis, in that birds need to cross areas close to
the nest more often than those further away. Since the aim of this paper was to develop the new
visualisation method that is general for all types of movement (i.e. not specifically aimed a
central-place foraging animals), we settled for a relatively simple solution by removing the nest
points from the trajectory dataset. We are aware that this is a rather basic attempt and while
removing the nests did result in avoiding the visual domination of the nest as a temporal
column in the density volume, this does not solve the geographic bias of exiting and entering
the nest, therefore making it more likely for this area to have higher probability of presence. In
habitat use studies, this problem is sometimes solved by subtracting a null model of distance
use that takes into consideration declining resource use with distance [44]. I.e. the expected
probability of the animal being in a certain location decreases not only with the distance from
each measured location (trajectory point) but also with the distance from the central place. This
works well for space utilisation distribution via 2D density estimation, and we are currently
considering a generalisation into 3D space-time density using a similar principle.

Another potential development that we see is to use our ideas of calculating densities in
three dimensions to extend the home range/utilisation distribution methodology into real 3D
space (using elevation as the third dimension). This is particularly relevant for animals that
move in the air or in water changing their vertical distribution in relation to environmental
factors [46, 43]. We expect that it would be possible to calculate the use of space by the bird in
all three dimensions as a volume in a similar way as in a space-time cube, but where time
would now represent the fourth dimension and would therefore have to be shown in a different
way, perhaps with a slider or animation.

Another development that may be of interest is linked to the concept of Brownian decay
function. In our implementation, the form of the Brownian bridges depends on two types of
uncertainty: uncertainty in measurement of location and uncertainty in animal movement.
These two quantities are considered as constant, regardless of where on the trajectory we are
(Eqs. 6 and 7). However, the uncertainty in movement may not be the same everywhere. This
means that the parameter that describes this uncertainty (σ1
2) may also vary over total time,
depending on the type of movement of the animal [32]. For example, different flight types of a
bird (e.g. smooth soaring vs. flapping, where more tortuosity is present in the observed
trajectory) may result in a different values of σ1
2, which means that at certain types of
movement, the Brownian bridge would be wider or thinner than at other times. Such
considerations could be included in the density calculation.
In addition, uncertainty in location measurement (σ2

2) may also depend on several factors.
While precision and accuracy of the measurement equipment are often considered as constant
throughout the measurement process, positioning uncertainty can also be affected by spatially and
temporally varying factors such as land cover, topography, atmospheric conditions and coverage
of positioning satellites at each measurement location. If this uncertainty has a large impact on the
results and can be reliably estimated, it should be incorporated in Brownian decay modelling.

Acknowledgments Research presented in this paper is part of the collaboration under the COST (European
Cooperation in Science and Technology) ICT Action IC0903, “Knowledge Discovery from Moving Objects
(MOVE)” and facilitated by the Lorentz Center workshop on “Analysis and visualization of moving objects”
(http://www.lorentzcenter.nl/lc/web/2011/453/info.php3?wsid=453). We thank Kees Camphuysen (NIOZ) and
Arnold Gronert for all the field work and sharing expert knowledge related to the Lesser black backed gull
project. The tracking infrastructure is facilitated by the BiG Grid infrastructure for eScience (www.biggrid.nl).
The authors would like to thank Dr Jed Long and Dr Iain Dillingham from the Centre for Geoinformatics,
University of St Andrews, for useful discussions in preparation of revisions of this paper.

Geoinformatica

Appendix—algorithm for calculation of stacked space-time densities

This appendix presents the pseudo code of our algorithm.

Geoinformatica

Geoinformatica

References

1. Andrienko G, Andrienko N (2010) A general framework for using aggregation in visual exploration of

2. Benhamou S (2011) Dynamic approach to space and habitat use based on biased random bridges. PLoS

movement data. Cartogr J 47(1):22–40

ONE 6(1):e14592

3. Benhamou S, Cornélis D (2010) Incorporating movement behavior and barriers to improve kernel home

range space use estimates. J Wildl Manag 74(6):1353–1360

4. Benhamou S, Riotte-Lambert L (2012) Beyond the utilization distribution: identifying home
range areas that are intensively exploited or repeatedly visited. Ecol Model 227(2012):112–
116

5. Börger L, Franconi N, De Michele G, Gantz A, Meschi F, Manica A, Lovari S, Coulson T (2006)
Effects of sampling regime on the mean and variance of home range estimates. J Anim Ecol 75:
1393–1405

6. Bouten W, Baaij E, Shamoun-Baranes J, Camphuysen KJ (2013) A flexible GPS tracking system for

studying bird behaviour at multiple scales. J Ornithol 154:571–580

7. Bridge ES, Thorup K, Bowlin MS, Chilson PB, Diehl RH, Flacron RW, Hartl P, Roland K, Kelly JF,
Robinson WD, Wikelski M (2011) Technology on the move: recent and forthcoming innovations for
tracking migratory birds. Bioscience 61:689–698

8. Brillinger DR, Preisler HK, Ager AA, Kie JG (2004) An exploratory data analysis (EDA) of the paths of

9. Brito JC (2003) Seasonal variation in movements, home range, and habitat use by male vipera latastei in

moving animals. J Stat Plan Infer 122:43–63

Northern Portugal. J Herpetol 37(1):155–160

Geoinformatica

10. Bullard F (1999) Estimating the home range of an animal: a Brownian bridge approach. MSc thesis.

11. Callahan SP, Callahan JH, Scheidegger CE, Silva TC (2008) Direct volume rendering. Comput Sci Eng

University of North Carolina at Chapel Hill

2008(1):88–92

12. Camphuysen K (2013) A historical ecology of

two closely related gull species (Laridae):
multiple adaptations to a man-made environment. PhD thesis, University of Groningen, The
Netherlands

13. Demšar U, Virrantaus K (2010) Space-time density of trajectories: exploring spatiotemporal patterns in

movement data. Int J Geogr Inf Sci 24(10):1527–1542

14. Downs JA, Horner MW (2009) A characteristic-hull based method for home range estimation. Trans GIS

15. Downs JA (2010) Time-geographic density estimation for moving point objects. In: Fabrikant SI et al. (eds)

Proceedings of GIScience 2010. Lecture Notes in Computer Science, 6292. 16–26

16. Downs JA, Horner MW, Tucker AD (2011) Time-geographic density estimation for home range analysis.

13(5–6):527–537

Ann GIS 17(3):163–171

17. Downs JA, Horner MW (2012) Analysing infrequently sampled animal tracking data by incorporating
generalized movement trajectories with kernel density estimation. Comput Environ Urban Syst 36:
302–310

18. Fieberg J (2007) Kernel density estimators of home range: smoothing and the autocorrelation red herring.

Ecology 88(4):1059–1066

19. Getz WM, Wilmers CC (2004) A local nearest-neighbour convex-hull construction of home ranges and

utilization distributions. Ecography 27:489–505

20. Getz WM, Fortmann-Roe S, Cross PC, Lyons AJ, Ryan SJ, Wilmers CC (2007) LoCoH:
nonparametric kernel methods for constructing home ranges and utilization distributions. PLoS
ONE 2:e207

21. Ghisla A (2009) Limitation and applicability of methods for home range estimation in respect to
auto-ecological factors and data quality. MSc thesis (in Italian). Insubria University, Varese,
Italy

22. Hadwiger M, Sigg C, Scharsach H, Bühler K, Gross M (2005) Real-time ray-casting and advanced shading

of discrete isosurfaces. Eurographics 24(3)

23. Hägerstrand T (1970) What about people in regional science? Pap Reg Sci Assoc 24:7–21
24. Hengl T, van Loon EE, Shamoun-Baranes J, Bouten W (2008) Geostatistical analysis of GPS
trajectory data: space-time densities. Proceedings of the 8th International Symposium on Spatial
Accuracy Assessment in natural Resources and Environmental Sciences, 17-24. Shanghai, June
2008

25. Holden C (2006) Inching toward movement ecology. Science 313:779–782
26. Horne JS, Garton EO, Krone SM, Lewis JS (2007) Analyzing animal movements using Brownian bridges.

Ecology 88(9):2354–2363

27. Horne JS, Garton EO, Krone SM, Lewis JS (2007b) Analyzing animal movements using
Brownian bridges - appendix A: derivation of Brownian bridge probability distribution. Ecol
Arch E088-142-A1

28. Horne JS, Garton EO, Sager-Fradkin KA (2007) Correcting home-range models for observation bias. J Wildl

Manag 71(3):996–1001

29. Isenberg T, Isenberg P, Chen J, Sedlmair M, Möller T (2013) A Systematic review on the practice of

evaluating visualization. IEEE Trans Vis Comput Graph 19(12):2818–2827

30. Kie JG, Matthiopoulos J, Fieberg J, Powell RA, Cagnacci F, Mitchell MS, Gaillard J-M, Moorcroft PR
(2010) The home-range concept: are traditional estimators still relevant with modern telemetry technology?
Phil Trans R Soc Lond Ser B Biol Sci 365:2221–2231

31. Kraak M-J (2008) Geovisualization and time – new opportunities for the space-time cube. In: Dodge M,
McDerby M, Turner M (eds) Geographic visualization: concepts, tools and applications. Wiley, Chichester,
pp 293–306

32. Kranstauber B, Kays R, LaPoint SD, Wikelski M, Safi K (2012) A dynamic Brownian bridge
movement model to estimate utilization distributions for heterogeneous animal movement. J Anim
Ecol 81:738–746

Geoinformatica

Wildl Manag 63(3):1039–1044

Theor Biol 317(2013):238–243

Species Res 10:21–27

Wildl Manag 63(3):1028–1038

analysis. Ecology 77(7):2075–2085

33. Krisp JM, Peters S, Burkert F (2013) Visualizing crowd movement patterns using a directed kernel density
estimation. Earth Observation of Global Changes (EOGC), Lecture Notes in Geoinformation and
Cartography 255–268

34. Laver PN, Kelly MJ (2008) A critical review of home range studies. J Wildl Manag 72(1):290–298
35. Long JA, Nelson TA (2011) Time Geography and Wildlife Home Range Delineation. J Wildl Manag 76(2):

407–413

27(2):292–318

36. Long JA, Nelson TA (2013) A review of quantitative methods for movement data. Int J Geogr Inf Sci

37. Manly BF, McDonald L, Thomas DL, McDonald TL, Erickson WP (2002) Resource selection
field studies 2nd ed. Kluwer Academic

by animals: statistical design and analysis for
Publishers

38. Minnotte MC, Sain SR, Scott DW (2008) Multivariate visualization by density estimation. In: Chen C,
Härdle W, Unwin A (eds) Handbook of data visualization. Springer handbooks of computational statistics.
Springer Verlag, Berlin-Heidelberg, pp 390–413

39. Nakaya T, Yano K (2010) Visualising crime clusters in a space-time cube: and exploratory data-
analysis approach using space-time kernel density estimation and scan statistics. Trans GIS 14(3):
223–239

40. Orians GH, Pearson NE (1979) On the theory of central place foraging. In: Horn DJ, Mitchell
RD, Stairs GR (eds) Analysis of ecological systems. Ohio State University Press, Columbus, pp
154–177

41. Otis DL, White GC (1999) Autocorrelation of location estimates and the analysis of radiotracking data. J

42. Riotte-Lambert L, Benhamou S, Chamaillé-Jammes S (2013) Periodicity analysis of movement recursions. J

43. Ropert-Coudert Y, Beaulieu M, Hanuise N, Kato A (2009) Diving into the world of biologging. Endanger

44. Rosenberg DK, McKelvey KS (1999) Estimation of habitat selection for central-place foraging animals. J

45. Seaman DE, Powell RA (1996) An evaluation of the accuracy of kernel density estimators for home range

46. Shamoun-Baranes J, van Loon E, van Gasteren H, van Belle J, Bouten W, Buurma L (2006) A
comparative analysis of the influence of weather on the flight altitudes of birds. Bull Am Meteorol
Soc 87:47–61

47. Shamoun-Baranes J, van Loon EE, Purves RS, Speckmann B, Weiskopf D, Camphuysen CJ (2012) Analysis

and visualization of animal movement. Biol Lett 8(1):6–9

48. Shamoun-Baranes J, Bom R, van Loon EE, Ens BJ, Oosterbeek K, Bouten W (2012) From sensor data to

animal behaviour: an oystercatcher example. PLoS ONE 7:e37997

49. Scheepens R, Willems N, van de Wetering H, van Wijk JJ (2011) Interactive visualization of multivariate

trajectory data with density maps. IEEE Pac Visualisation Symp 2001:147–154

50. Silverman BW (1986) Density estimation for statistics and data analysis. Chapman and Hall, New York
51. Stephens DW, Brown JS, Ydenberg RC (2007) Foraging: behaviour and ecology. University of Chicago

Press, Chicago

52. Van Deelen TR, Campa H III, Hamady M, Haufler JB (1998) Migration and seasonal range dynamics of deer

using adjacent deeryards in northern Michigan. J Wildl Manag 62(1):205–213

53. Walter DW, Beringer J, Hansen LP, Fischer JW, Millspaugh JJ, Vercauteren KC (2011) Factors
affecting space use overlap by white-tailed deer in an urban landscape. Int J Geogr Inf Sci 25(3):
379–392

54. Wand MP, Jones MC (1993) Comparison of smoothing parametrizations in bivariate kernel density

estimation. J Am Stat Assoc 88(422):520–528

55. Worton BJ (1987) A review of models of home range for animal movement. Ecol Model 38:277–298
56. Worton BJ (1989) Kernel methods for estimating the utilization distribution in home-range studies. Ecology

70(1):164–168

57. Wu Y, Qu H, Chung K-K, Chan M-Y, Zhou H (2010) Quantitative effectiveness measures for direct volume

rendered images. IEEE Pac Visualisation Symp 2010:1–8

Geoinformatica

Urška Demšar is lecturer in Geoinformatics at the Centre for GeoInformatics, School of Geography and
Geosciences, University of St Andrews, Scotland. She received a PhD in Geographic Information Science from
the Royal Institute of Technology (KTH), Stockholm, Sweden, in 2006 and has two degrees in Applied
Mathematics from the University of Ljubljana, Slovenia. Dr. Demšar’s research interests and publications are
in geovisual analytics, spatial visualisation, spatio-temporal data analysis, spatial network analysis and spatial
mathematical modelling.

Kevin Buchin is assistant professor in computer science at the Technical University Eindhoven, the Netherlands.
He received his PhD in computer science from the Free University Berlin, Germany, in 2007. His main research
interest lies in geometric and graph algorithms with the focus on geographic applications.

Geoinformatica

E. Emiel van Loon is assistant professor in statistical ecology at the University of Amsterdam, the Netherlands.
He did receive his PhD at Wageningen University (Netherlands) in 2002. Dr. van Loon teaches introductory
statistics, experimental design as well as geo-statistics. His research concentrates on the development of statistical
methods to analyse the movement and distribution of organisms in the environment.

Judy Shamoun-Baranes is assistant professor in the Computational Geo-Ecology group at the University of
Amsterdam, the Netherlands. She is an Ornithologist and received her PhD in Zoology at Tel Aviv University
(Israel) in 2003. Through her research she tried to understand how birds movements (migration, foraging,
reaction to disturbance) are influenced by environmental (especially atmospheric conditions) and intrinsic factors
and the consequences these reactions may have on fitness and survival.

