International Journal of Geographical Information
Science

ISSN: 1365-8816 (Print) 1362-3087 (Online) Journal homepage: http://www.tandfonline.com/loi/tgis20

Geometric variability of raster cell class
assignment

A. M. Shortridge

To cite this article: A. M. Shortridge (2004) Geometric variability of raster cell class
assignment , International Journal of Geographical Information Science, 18:6, 539-558, DOI:
10.1080/13658810410001702012

To link to this article:  http://dx.doi.org/10.1080/13658810410001702012

Published online: 06 Oct 2011.

Submit your article to this journal 

Article views: 127

View related articles 

Citing articles: 8 View citing articles 

Full Terms & Conditions of access and use can be found at
http://www.tandfonline.com/action/journalInformation?journalCode=tgis20

Download by: [University of Lethbridge]

Date: 17 June 2016, At: 11:09

INT. J. GEOGRAPHICAL INFORMATION SCIENCE
VOL. 18, NO. 6, SEPTEMBER 2004, 539–558

Research Article

Geometric variability of raster cell class assignment

A. M. SHORTRIDGE
Department of Geography, Michigan State University, East Lansing,
MI 48824-1115, USA; e-mail: ashton@msu.edu

(Received 26 June 2003; accepted 5 December 2003 )

Abstract. Applications like land-cover mapping frequently require the trans-
formation of vector polygons to raster grids, such that each cell in the output
raster is assigned a single class. Cell value assignment is a direct function of the
geometric relationship between the vector polygons and the origin, orientation
and spatial resolution of the raster structure, acting in conjunction with the value
assignment rule employed by the algorithm. Results of an alternative approach
to characterizing origin assignment variability are reported. A simulation
approach is employed to perturb the origin of the grid lattice by amounts smaller
than the grid spacing. The distribution of results across all output raster
realizations indicates the rasterization variability for a particular input vector
map at a particular cell size. Results for a representative vector land-cover
dataset are presented,
indicating that substantial variability is possible. The
paper concludes with a discussion of theoretical and practical implications for
the identiﬁcation of appropriate cell resolutions, as well as for identifying
particular input shapes and polygon conﬁgurations that may be especially
sensitive to rasterization error.

1.

Introduction
Many spatial applications require the transformation of vector polygons
representing more or less homogenous classes to raster grids. The main technical
challenge for
the
assignment of a class for each cell in the output raster grid. Most commonly,
the largest-share rule is employed, in which the cell is assigned the class that covers
a plurality of its area. An alternative is the central-point rule, in which the class
occupying the central point of each cell is assigned to the entire cell.

this vector-to-raster conversion (rasterization) process

is

In either case, class assignment is a direct function of the geometric relationship
between the input polygons, and the origin, orientation and spatial resolution of the
output raster structure. Modiﬁcation of any of these raster characteristics may
result in a different pattern of assignment under either classiﬁcation rule. The
present paper investigates the variability in cell assignment due to grid origin and
spacing effects. While there is considerable research on the variability due to cell
resolution, geometric factors have not been investigated in as much detail; the paper
reports an alternative approach to characterizing origin-related assignment
variability.

International Journal of Geographical Information Science
ISSN 1365-8816 print/ISSN 1362-3087 online # 2004 Taylor & Francis Ltd
http://www.tandf.co.uk/journals
DOI: 10.1080/13658810410001702012

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 540

A. M. Shortridge

i.e. of concern is the error in the conversion process, not

The problem of converting spatial data from one form to another has attracted
researchers for decades, and the literature is rich in both theoretical and empirical
approaches to modelling and describing conversion error. This is especially true if
one considers the rasterization procedure as a speciﬁc sort of interpolation or
sampling problem, or includes work from the domain of remote sensing on the
mixed pixel problem. This paper, as well as the literature cited below, assumes that
polygons are
internally homogenous with well-deﬁned and inﬁnitely thin
the
boundaries,
uncertainty in the representation of the heterogeneous real-world phenomena. It
follows that error can only occur along the boundaries between polygons, and so
rasterization error is a function of input polygon complexity and output cell size.
Several important papers have attempted to identify general relationships between
these factors. Switzer (1975) determined the misclassiﬁcation probability for a
randomly chosen point within a cell as a function of its distance from the centre
point. This probability is a function of the classiﬁcation of nearby cells, and
therefore reﬂects both the variability of the values and the cell size. Switzer
developed an equation to estimate error based on the number of differing-value
order-1 and -2 neighbour cells. Goodchild (1980) modiﬁed the parameters of the
Switzer model based on a fractal model of scale and boundary complexity. Fractal
concepts were also used by Carver and Brundson (1994), who considered the effects
of modelled line complexity on the vector to raster conversion routine. They
developed an error prediction model based on the angular complexity of the vector
line. This model can be used to determine raster cell size, based on some acceptable
error criterion. Bregt et al. (1991) presented an alternative approach that rasterizes
the vector map both at a very ﬁne resolution (a ‘raster ground truth’) and at a set of
coarser resolutions. The difference is modelled as a function of the boundary index
(BI), which is a simple measure of boundary complexity (boundary length/area).
Bregt et al. reported very strong linear relationships between rasterization error and
the BI, indicating that the BI could be used to estimate this error for a given cell
size.

The intersection of simple polygons with a regular grid is a geometric problem,
and several researchers have employed geometric probability to characterize
classiﬁcation issues. Kirby (1997) used Buffons Needle-type solutions to estimate
intersection probabilities of
linear features on regular grids. Shortridge and
Goodchild (2002) extended this approach to the classiﬁcation problem and studied
intersection probabilities for small basic geometric areas on grids. Okabe and
Sadahiro (1997) considered the slightly different problem of transforming count
data in irregular areal zones to regular point meshes. They employed geometrical
methods to derive minimum variation statistics for the point-in-polygon algorithm
on several mesh structures,
including square grids. Crapper (1980) proposed a
formula for the standard error of Landsat pixel classiﬁcation based on the
intersection of the parcel boundary with pixels. He used a shape factor to predict
the classiﬁcation error for agricultural ﬁelds of different sizes and shapes.

Interest in the geometric aspects of this problem predates computer analysis.
Frolov and Maling (1969) considered the variability of polygon area estimation
using point-counting methods. At that time most analysts relied on laborious
manual techniques and specialized equipment like the planimeter to calculate
spatial measures. One common area calculation method of particular relevance here

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 Geometric variability

541

involved overlaying a paper map with a clear plastic sheet marked with a grid of
points. The analyst then counted the number of points falling within an area on the
map. An area estimate could be obtained by multiplying this count by the grid
spacing in map units. This method is equivalent to using the central-point rule to
classify raster cells. Frolov and Maling (1969) presented an approach to
characterize functionally the variance of this measurement to the parcel shape,
and supplied coefﬁcients for a variety of geometrical ﬁgures.

Empirical work on speciﬁc datasets has also been employed. Congalton (1997)
rasterized and then subsequently re-vectorized a set of simple polygons to study
area, shape and placement distortion. He identiﬁed a range of processing stages at
which discrepancies between initial vector polygons and subsequent rasterized
polygons might arise. Kam et al. (2000) used a similar approach and found that
area calculation for various raster grid orientations and resolutions varied
unpredictably. They also determined that results depended on the particular GIS
software implementation.

For most of these studies, a practical intent is to enable users to determine an
appropriate cell resolution for their applications. In most cases, this is accomplished
by developing graphs or functional models that characterize the relationship
feature complexity and raster cell size. Various
between rasterization error,
measures of shape complexity have been proposed and implemented; representative
values of these measures for simple geometrical shapes have been calculated and
results have been extended to more complex real-world forms.

shape,

type of

for any cell

The present paper uses the empirical perspective of Congalton (1997) and
others, but, importantly, also attempts to characterize variability of the raster-
ization for any particular
is
accomplished by treating the outcome of a rasterization process as a random
variable. By formalizing a simple rasterization model, alternative, equally likely
raster outcomes may be generated for any set of polygons. In Section 2, a
methodology is described that generates multiple raster realizations by system-
atically displacing the origin before performing cell class assignment. By producing
a large number of such raster realizations and assigning classes upon all of them,
the analyst can study empirically the variation of classiﬁcation results between
them. Signiﬁcantly, this approach enables the following:

resolution. This

. Assessment of variability in any metric that can be calculated on a spatial
including the total area occupied by each class,

. Results that are speciﬁc for the particular dataset and spatial resolution to

vector or raster data,
boundary length, etc.

which it is applied.

Section 3 reports on experiments testing the efﬁcacy of the approach. In the ﬁrst,
rasterization of circles is performed for a range of spatial resolutions. In the second,
a vector land-cover dataset is rasterized, area statistics are calculated on them and
models are developed to explain differences between classes in sensitivity to
rasterization cell size. Section 4 concludes with a discussion on the signiﬁcance of
the work for practical spatial data processing and implications for further research
in classiﬁcation.

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 542

A. M. Shortridge

2. Cell class assignment

The rasterization process consists of two general steps:

. Grid mesh is overlain on the input area-class vector map. This mesh is deﬁned

by its origin and orientation, along with the grid spacing.

. The class assignment rule is employed to determine the value to be assigned to

each cell.

The assignment rule employed is frequently the largest-share rule, which speciﬁes
that a cell is assigned the value of the polygon class occupying a plurality of the cell
area. This is a common implementation in GIS; this research employed the
POLYGRID function in the Grid Module of Arc 8.2 (ESRI 2002) to perform the
assignment. An alternative method is the central-point rule, which speciﬁes the cell
value as the value of the polygon occupying the central point in the cell. The
central-point rule is fast and relatively easy to program, but appears to be less
commonly employed in GIS rasterization. This research used both C code
developed by the author and the LATTICEREPLACE function in the TIN Module
of Arc 8.2 to accomplish this assignment. These classiﬁcation approaches are
fundamental operations that have been implemented in many GIS, and results
should not be considered platform speciﬁc.

The raster origin is typically given as the Cartesian coordinates of one corner of
the grid, typically the lower-left corner. Varying this origin alters the relative
position of each cell (as well as its associated centre) to the vector polygon data
without changing the grid spacing or the orientation. An important aspect of the
proposed methodology is the generation of multiple versions of the grid mesh by
displacing the original origin by a positive amount up to the length of a single cell
side. This allows the position of each cell to shift by small amounts, relative to the
cell resolution. The simulation and analysis procedure employed in Section 3.2
follows the following steps, using shell scripts, C code, and Arc macro language
(AML) code developed by the author. For each cell resolution of interest:

(1) A blank raster grid (all cell values set to 0) is exported from the GIS in text
format. The header, including origin information, is removed from the cell
value data.

(2) Ninety-nine origin offsets are randomly generated. Offsets o are drawn from
a uniform distribution: 20.5 * crvov0.5 * cr, where cr is the cell resolution
(m). Independent offsets are drawn for both x- and y-coordinates.

(3) Offsets are added to the initial origin x- and y-coordinates to generate a new

origin within one-half the cell resolution of the original origin.

(4) Each offset origin is saved in new raster header ﬁles and appended to blank

raster grids before being imported separately back into the GIS.

(5) Resulting 99 blank grids are employed to rasterize the original polygon layer
using both the polygrid and the latticereplace procedures outlined above.

(6) Summary area statistics are calculated for each raster grid.

The justiﬁcation for performing these displacements rests upon the discrepancy
between the resolution of the raster cells and the precision of their position.
Although spatial scale is poorly deﬁned for digital geographical data, cell resolution
is normally considered the spatial resolution of a raster (Longley et al. 2001, p. 152).

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 Geometric variability

543

Raster cells are typically assigned homogenous values, and no subcell scale
variability is retained. In contrast, the grid origin, and therefore the position of each
cell in the raster, is stored at a much higher resolution — essentially as a zero-
location, often employing atomic levels of numerical precision.
dimensional
Displacing the origin by an amount less than the cell resolution is an insigniﬁcant
change, given the overall spatial precision of the raster grid.

The effect on classiﬁcation according to the central-point rule is to enable the
classiﬁcation location to ‘roam’ across the area overlain by the raster cell placed
according to the original origin. For the largest-share rule, the new cell is displaced
according to the old one. This means that slightly different regions are rasterized,
which may account for a very small proportion of the overall variation between
realizations.

A viable alternative simulation approach to generating random offsets in Step 2
is to reposition the raster origin systematically to locations on a very ﬁne grid mesh
within a range of one cell of the original origin. This approach has several
advantages: it is simpler to compute and may be a more efﬁcient estimator of
rasterization variability. It is employed in the research described in Section 3.1. A
potential problem is that cell classiﬁcation results may be affected by interactions
between the regular microgrid spacing and cell classiﬁcation of spatial features
occurring at regular intervals in a highly systematic landscape.

Both the systematic and the random simulation method result in dozens or
hundreds of raster grids with slightly different origins. Either the central-point or
the largest-share classiﬁcation rules can then be employed on these realizations,
resulting in a distribution of potentially different classiﬁcation results. The results
may be of profound interest. For example, instead of having a single value for area
covered by Class X to compare against the original area in the polygon data, the
researcher has an entire distribution of values. The range of this distribution may be
much more informative than that of a single value. In addition, variability can be
mapped and problematic areas identiﬁed. To explore the value of this approach,
experiments using circles as well as representative land-cover data were developed;
their design and results are described below.

3. Experiments

Two experiments are reported. The ﬁrst involves the rasterization of a circle and
illustrates some general rules involving rasterization variability and cell size. The
second employs a typical vector land-cover dataset and demonstrates how
simulation can be employed to identify speciﬁc classes that are especially sensitive
to rasterization, i.e. they are subject to considerable variability in area for particular
cell resolutions. This experiment also develops models of the observed variability as
a function of various measures of the original vector data. It illustrates the utility of
the simulation approach for variability estimation and underscores the degree of
rasterization variability inherent in standard geographical data.

3.1. Circle study

In addition to being simple to analyse, the circle is the most compact form with
the smallest boundary for its area, and orientation is not a factor. Therefore, the
ﬁrst set of experiments deals with vector-raster variability of circle area with
changing cell resolution, using the central-point classiﬁcation rule. Circle position is

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 544

A. M. Shortridge

deﬁned entirely by the location of its centre point within a grid mesh with spacing
equal to 1. Circle size can be varied by changing the radius; this has the same effect
as keeping the circle size constant and varying cell resolution. Figure 1 portrays the
situation when the radius is equal to the grid spacing. It is clear that the circle
centre must fall within a square denoted by the four surrounding cell centres; these
are denoted by the circles in each corner (cell boundaries are shown as dotted lines
for reference, so that the centre is actually the intersection of four cell corners).
Depending on the location of the circle’s centre, one, two, three or four grid points
will be overlain by the circle, and therefore one, two, three or four cells will be
classiﬁed as falling in the circle.

As shown, a circle with its centre close to the cell boundaries overlaps more cell
centres than one located near a grid point. While ﬁgure 1 was developed using only
121 intermediate locations (of which only 99 are potential locations, according to
the above deﬁnitions), a more rigorous evaluation was conducted. A 2496249
microgrid (62 001 points) was established within the conﬁnes of a raster cell with
unit length sides. Each point represents a potential central point for a circle centred
on this single raster cell. Circles with radii varying from 0.4 to 32, relative to a
raster cell side length of 1, were rasterized for all of these centre points, and their
area estimated gridded cell centre locations falling within this zone. Area estimation
is only approximately correct for any one of these realizations, since rasterized
feature area must be an even multiple of the cell size, while the original area is equal
to a multiple of p (in ﬁgure 1, the rasterized circle area estimates of 4, 3, 2 and even

Figure 1. Map showing the number of cell centres intersected by a circle with the radius
equal to the cell spacing. Raster cell centres are circled in the corners. Dotted lines are
cell boundaries. A circle centred on a cell centre will intersect only that cell. A circle
centred on the corner of four cells will intersect all those cells. Intermediate locations
for the circle centre will result in four, three or two cell centres being intersected.

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 Geometric variability

545

1 are possible). However, on average, the estimation appears to be unbiased, which
may be demonstrated by dividing the mean area estimate by the square of the
radius for each circle (over 9.7 million circles were rasterized in this experiment). A
perfect estimate would equal p; the experimental average yields 3.14156. This
unbiasedness property supports the contention of Frolov and Maling (1969) and
appears to hold for all larger circle sizes.

The present paper is primarily concerned with the variance of the area estimate,
however. Figure 2 plots area variability as a proportion of circle size from the
experiment described above. As the circle radius increases, the precision of the area
estimate also increases. Figure 2 shows that standard deviation is as great as 25% of
circle area for cases in which circle radius is close to the cell resolution. However,
this proportion drops rapidly below 3% as the radius increases above 3.6 times the
cell side, and gradually drops below 1% as the diameter increases further. However,
the graph also demonstrates differing amounts of variability for similar cell sizes
(the trend is not very smooth for small circles). It appears that an incremental
change in cell resolution may lead to considerably different variability in area
estimation because the number of discrete cells intersected by the circle may change.

3.2. LULC study

This case study employs land use and land-cover (LULC) data from the US
Geological Survey (USGS) for a portion of southern Michigan, USA (USGS 1990).
This dataset, which is often referred to as GIRAS after its speciﬁc data format, was
developed primarily from manual
interpretation of 1970s’ and 1980s’ aerial
photography, and is at a nominal scale of 1:250 000 (USGS 1994). Data are stored
in polygons; each polygon contains a single land use/land-cover class based on the
Anderson Level 2 system (Anderson et al. 1976). Data for this project were
obtained from the GIRAS-derived Environmental Protection Agency (EPA)
datasets. The EPA ﬁles are identical to the original, except that the projection
origin and spatial units employ a global coordinate system, and the data are stored

Figure 2. Rasterized circle area variability as a function of circle radius. The y-axis indicates
the proportion of the standard deviation to the circle area.

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 546

A. M. Shortridge

in Arc Info.E00 export format. The Grand Rapids Quadrangle LULC data were
brought into Arc 8.2 (ESRI 2002), where the study area subset was extracted. Much
of the subsequent analysis was performed in Arc, with additional processing
employing C code, shell scripts and the R statistical package, version 1.7.0 (Ihaka
and Gentleman 1996).

3.2.1. Description and methods. The study area itself
is a 24624-km region
(576 km2) clipped from the Grand Rapids Quadrangle. The area includes portions
of the city of Battle Creek, Michigan, and a predominantly agricultural region
north and west of the city. This area was chosen for its relative diversity of classes
and polygon shapes and sizes. Figure 3 is a map of this region, while table 1
provides details about the various LULC classes comprising the area. Not all
Anderson classes are present, of course. Nearly two-thirds of the area is covered by
cropland and pasture. Over 20% is forested land or wetland, while just under 10% is
comprised of urban or built-up land. Natural lakes occupy nearly 4% of the area.
Polygon sizes vary tremendously, especially for the cropland category, which
includes a single polygon of 353 km2. Maximum and minimum polygons for each
area are listed in table 1; for most classes, these span orders of magnitude of area
within each class and differ widely between classes as well. Disregarding cropland,
mean polygon size was 0.68 km2 with a standard deviation of 1.16 km2. The smallest
polygon was residential, covering only 1761 m2, while the next smallest polygon was
9231 m2; these are equivalent to the area of a square cell 40 and 96 m on a side,

Figure 3. Original polygon data for the study area.

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 Geometric variability

547

Table 1. LULC class characteristics.

Polygons

Total
area

Maximum
area

Mean
area

Minimum
area

Average
S

1 — Urban or built-up land

11 — Residential
12 — Commercial and Services
13 — Industrial
14 — Transportation
16 — Mixed urban or built-up
17 — Other urban or built-up

2 — Agricultural land

21 — Cropland and Pasture
22 — Orchards, groves, etc.
24 — Other agricultural land

4 — Forest land

41 — Deciduous
43 — Mixed

5 — Water

52 — Lakes
53 — Reservoirs

6 — Wetland

61 — Forested
62 — Non-forested

7 — Barren land

46
23
3
4
2
16

11
3
3

74
5

58
1

29
22

2
2

31.865
10.565
1.850
2.660
0.378
7.914

6.457
4.105
1.400
2.456
0.258
1.299

0.693
0.459
0.617
0.665
0.189
0.495

376.413
2.094
0.306

353.835
1.687
0.142

34.219
0.698
0.102

66.208
2.328

21.998
0.086

40.360
9.363

0.725
0.888

5.548
1.178

7.752
0.086

9.103
1.136

0.452
0.779

0.895
0.466

0.379
0.086

1.392
0.426

0.362
0.444

0.002
0.031
0.06
0.009
0.12
0.016

0.011
0.146
0.062

0.027
0.217

0.036
0.086

0.121
0.029

0.027
0.011

1.29
1.06
1.51
0.83
1.47
1.25

2.86
1.17
1.10

1.20
1.12

1.04
1.17

1.28
1.10

1.47
1.32

75 — Strip mines, quarries, etc.
76 — Transitional areas

Area units are in km2; S, a compactness measure, is unitless.

respectively. In addition to these basic measures, an average compactness statistic
for each class was calculated. S, a perimeter–area ratio described in Longley et al.
(2001, p. 288), is deﬁned as:

p
S~P=3:54 ﬃﬃﬃﬃA
where P is the average perimeter of polygons in a particular class and A is the
average area of polygons in a particular class. S differs from a straightforward
perimeter/area ratio in that it has been scaled so that S~1 for a circle. Relatively
compact shapes have S close to 1. Polygons with long perimeters relative to their
areas have larger S values. S for each of the 17 classes in the dataset are presented
in table 1.

ð1Þ

,

For the purposes of this study, the initial vector layer represents the ‘ground
truth’. It is assumed that the classiﬁcation is perfect, and there is no gap between
the conceptual model for actual land cover around Battle Creek and the land cover
as depicted in the dataset. This work is focused on the problem of cell classiﬁcation
uncertainty along boundaries due to the geometry of the raster, and not on the
many other very interesting problems of uncertainty in classiﬁcation generally. The
problem of modelling uncertainty generally shall be considered below.

How might a user choose an appropriate cell size for the data? One approach
treats the minimum mapping unit as equal to the smallest polygon, and sets the cell
size equal to this (or, alternatively, to one-half of this area). For this study, a cell
size of 40 or 20 m would satisfy this approach. Another approach considers the US
National Map Accuracy Standard relating to the nominal scale of the vector data.

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 548

A. M. Shortridge

LULC data are listed as 1:250 000 scale. Assuming that the minimum distinguish-
able distance on a map is about 0.5 mm (Longley et al. 2001, p. 333), a reasonable
minimum distance would therefore be 125 m. A third approach considers the cell
resolution of raster products nominally scaled at 1:250 000, such as the USGS
1:250 000 DEM series. This product employs postings at 3 arc-second intervals,
which equates to variable ground units depending on direction and latitude, but a
reasonable compromise might be about 90 m. In this work many different
resolutions are considered.

The vector LULC data for the study area were converted to raster using two
methods: the POLYGRID command, which classiﬁes cells according to the largest-
share rule and an approach employing the LATTICEREPLACE command to
implement the central-point rule. These approaches are described in more detail in
Section 2. Raster grids with cell resolutions of 30, 50, 60, 80, 100, 120, 150, 200,
240, 250, 300, 400, 500 and 600 m were developed using both methods. These
particular cell sizes were chosen to be at once representative of a wide range of
spatial scales and to reﬂect plausible, relatively ﬁne resolutions. Cell count/area
statistics for selected classes are reported in table 2. As expected, area totals differ
considerably across resolutions. Small cell sizes show considerable agreement, while
area summaries of rasters with larger cell sizes show increasing discrepancies with
the original polygon data. At the larger sizes, certain land use classes drop out
entirely, as class 53 demonstrates (although it reappears at the 600-m cell resolution
using the central-point method). Some classes appear to be quite susceptible to area
gain or loss with increasing cell size, while others appear to be more robust;
differences may be related to differences in polygon size, shape or conﬁguration, as
reported (Goodchild 1980, Bregt et al. 1992, Congalton 1997). The present work is
not primarily concerned with identifying deviations between cell sizes for individual

Table 2. Effect of cell resolution on area for selected classes.

150

100

600

500

400

300

250

200

0.063

0.040

0.023

0.010

0.360

0.250

0.160

0.090

2.660
2.660

28.800
30.960

50
0.003

31.950
31.980

31.568
31.635

31.140
31.590

31.600
31.800

31.750
32.063

29.750
33.750

30.560
31.200

2.660
2.658
2.655

31.865
31.810
31.803

Cell size
Cell area
Class 11
Actual size
Largest-share
Central-point
Class 14
Actual size
Largest-share
Central-point
Class 21
Actual size
Largest-share 376.535 376.350 376.965 377.960 379.250 379.260 382.080 388.750 398.520
Central-point 376.418 375.890 375.953 375.960 376.125 375.300 377.920 371.750 379.080
Class 52
Actual size
Largest-share
Central-point
Class 53
Actual size
Largest-share
Central-point

21.998
21.965
22.003

0.086
0.080
0.080

20.480
23.200

17.250
21.250

21.680
22.240

21.125
22.000

21.893
22.185

21.240
22.050

21.780
21.960

18.360
22.680

0.000
0.000

0.000
0.360

3.000
2.750

2.880
2.160

0.000
0.000

0.000
0.000

0.000
0.000

2.688
2.688

2.790
2.790

2.720
3.040

0.113
0.090

0.040
0.120

0.090
0.090

2.600
2.600

2.655
2.655

376.413

Cell size is in m, other units are in km2.

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 Geometric variability

549

layers or classes, but instead endeavours to identify variability of classiﬁcation at
each cell size using multiple realizations.

Rasters at each of the 14 cell resolutions listed above were exported to text
for simulation. The simulation and analysis procedure employed the
format
procedure detailed in Section 2 to produce 99 rasterized realizations of the initial
polygon dataset for each of the 14 cell resolutions.

3.2.2. Results. The key ﬁndings, not all unexpected, of this analysis are as follows:

. Largest-share method is biased towards the dominant cover class, especially
for larger (coarser) cell resolutions, while the central-point rule is unbiased.
. Classiﬁcation variability increases with increasing cell size, regardless of the

. Rate of variability increase for each class is related to the total boundary

method.

length of each class.

The ﬁrst two points are discussed in more detail below, while the third result is
covered in the next subsection.

First, area estimation methods differ in their treatment of dominant classes. In
particular, the largest-share rule is biased in favour of dominant classes. This
dominance is scale dependent and clearly directly related to cell resolution. If the
cell resolution is equal to the size of the study area, the (single!) cell value will be set
to the most common land class in the study area. As the region is partitioned into
more and more cells, locally dominant classes will be assigned to particular cells.
For the Battle Creek study area, class 21 (Cropland and Pasture) is the most
common cover type. As ﬁgure 4 shows, the area occupied by this cover type
increases as cell size increases, while all other classes decline in total area covered.
At a cell size of 150 m, the classiﬁed raster overestimates the total area of class 21
by 1 km2. At 250 m, the overestimate is over 3 km2, and at 500 m, the overestimate
is more than 13 km2. Classes occupying small, isolated polygons are systematically
underestimated for larger cell sizes. The percentage difference can be substantial
(ﬁgure 4); for cell sizes larger than 300 m, all classes except for 21 experience
declines in total area. This is not characteristic of the central-point method for
classiﬁcation, since it is essentially a scale-free classiﬁer.

Second, estimating area variability in the rasterization process for a class at a
given cell resolution is possible through analysis of the many realizations generated
by the process outlined above. For each realization, the total area occupied by class
X may be calculated by multiplying the number of cells classed as X by the
resolution (km2) of the cell. The standard deviation for the area occupied by class X
across all 99 realizations is straightforward to calculate. Figure 5 shows plots of
standard deviation against cell size for both the central-point and largest-share
methods. Note that these methods produce similar but not identical patterns of
variability across resolution. Especially for coarser cell resolutions, the central-point
method gives more variable results. It is also apparent that the standard deviation
tends to increase as cell size increases. Perhaps less apparent is that classes
occupying more land show greater variability, e.g. standard deviation for crops and
pasture (class 21) is approximately 3 km2 for larger cell sizes, which is considerably
larger than that of any other class. This is consistent with its tremendous size

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 550

A. M. Shortridge

Figure 4. Largest-share method: change in class area (km2) versus cell size (m).

— small variations along the boundary of class 21 can add up into square km of
additional area, whereas a comparatively rare class like 22 lacks the boundary
length to generate much absolute variability.

For visualization and discussion purposes, it is useful to calculate the ratio of
standard deviation to the area occupied by that class. This transformation enables a
direct comparison between the amount of variability and the total area occupied by
that class. Figure 6 portrays the relationship between this ratio and cell size for the
central-point classiﬁcation method. For the smaller cell sizes, the ratio is low for all
classes, but as cell size increases, the ratio increases in a nearly linear fashion for
each class. However, the rate of increase depends very much on the class. For
example, in ﬁgure 6, classes 11 and 14 have ratios close to zero for cell size of 30 m.
At a cell size of 200 m, class 11 has a ratio of 1.35%, i.e. the standard deviation of
the area estimate is 1.35% of the total area occupied by class 11. At this resolution,
class 14 has a ratio of 5%, i.e. the standard deviation of the area estimate is 5% of
the total area occupied by class 14. For some applications, knowledge of this ratio
could enable the user to decide on an appropriate raster cell size.

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 Geometric variability

551

Figure 5. Plots of standard deviation against cell size for both the central-point and largest-
share methods.

3.2.3. Modelling differences in class variability. The preceding paragraphs indicate
substantial differences in area variability between classes for different cell sizes.
What factors appear to be most important for sensitivity in rasterization variability
to increasing cell size? This section identiﬁes key factors in classiﬁcation variability
via a two-step regression analysis procedure. All modelling described in this section
was performed using data derived from the central-point methodology only.

The independent variable for this model is the increase in variability with cell
size. A visual examination of this relationship in ﬁgure 5 suggests that a simple
linear relationship between standard deviation (v) and cell size (c) is worth
investigation:

v~b1cze:
Note that this is a non-intercept model. Fourteen observations are available for
each class. Model parameters were estimated via ordinary least squares upon the
observed relationships. Model goodness of ﬁt, indicated by the uncentred R2, and
the estimate for b1 (model slope, multiplied by 100 for representation in the table)

ð2Þ

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 552

A. M. Shortridge

Figure 6. Relationship between SD/area ratio and cell

size

for

the

central-point

classiﬁcation method.

are supplied for the 17 independent models for each land-cover class in table 3.
Variability explained by the models, as measured by R2, ranged from 0.91 to over
linear models explained most of the variability in the
0.98,
indicating that all
standard deviation–cell
size relationships. The non-intercept model appears
linear models were
warranted in this case because intercept terms for 17 full
close to zero, and for each class the uncentred R2 differed only slightly from the full
model R2. Use of this model form is desirable for prediction purposes, as will be
the
explained shortly. Diagnostics conducted on all models

indicated that

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 Geometric variability

553

Table 3. Linear regression model results by class.

LULC class

Slope (6100)

11
12
13
14
16
17
21
22
24
41
43
52
53
61
62
75
76

R2

0.9219
0.9494
0.9565
0.9757
0.9430
0.9161
0.9668
0.9523
0.9883
0.9089
0.9745
0.9175
0.9539
0.9466
0.9696
0.9187
0.9286

0.2965
0.1355
0.0638
0.0745
0.0536
0.1660
0.5722
0.0661
0.0306
0.3506
0.0612
0.2256
0.0209
0.2241
0.1164
0.0589
0.0444

relationships satisﬁed basic ordinary least-squares regression assumptions, and that
no single observation exerted undue inﬂuence on any of the models. The b1
estimates listed in table 3 are class-speciﬁc measures of sensitivity to cell size.
Classes with high b1 values experienced large degrees of variability in area
estimation for larger cell sizes. Classes with low b1 values experienced slower
growth in area estimation variability as cell size increased.

The next step is to model the relationship of the sensitivity measure b1 using
measures of polygon characteristics. A successful model accomplishes two things: it
explains the observed variation between classes, and it provides a way to estimate
class
than resorting to
computationally expensive simulation. Several measures appear reasonable to
test. These include the following:

sensitivity using readily calculated measures

rather

. Total class area (km2).
. Average class polygon size (km2).
. Average class compactness, as measured by S.
. Total class perimeter length (km).

None of these measures is necessarily independent of the others. Most are subject to
orders of magnitude of variation between classes. For this reason,
log–log
relationships were modelled where appropriate. The strongest model was:
Þ~b0

zb1ln perimeter
ð

ln sensitivity

ð3Þ

Þ:

ð

Figure 7 depicts both a scatterplot of these two variables and the linear regression
model, determined via ordinary least squares. The model was an excellent ﬁt
(R2~0.97), and overall model performance was
(F1,15~529.3,
p%0.0001). The estimated b1 (slope) coefﬁcient was 0.507, indicating a positive
relationship between the variables. An increase of 1 in ln(perimeter) corresponded
to a rise of 0.507 in ln(sensitivity). This coefﬁcient differed signiﬁcantly from zero

signiﬁcant

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 554

A. M. Shortridge

Figure 7. Relationship of ln(perimeter) to ln(area sensitivity to cell size). The model
intercept is 28.551 and the slope is 0.507. Point labels are land-cover class codes.

(t12~23.01, p%0.0001). Standard regression diagnostics revealed no problems with
this model.

A model employing ln(total area) performed nearly as well (R2~0.96), but
perimeter length appears to be a more justiﬁable factor, as classiﬁcation variability
due to rasterization may only occur along class boundaries. The natural logs of
area and perimeter are very highly correlated (r~0.99), which explains the similar
model results. Average polygon size is more weakly positively related to slope (log–
log model R2~0.58). Compactness did not explain signiﬁcant variability, either
alone or in concert with other variables.

4. Discussion and conclusion

This paper has considered variability in raster cell assignment by treating the
position of the origin as arbitrary, within the limits of cell resolution. An empirical
approach was adopted that enables the generation of multiple raster realizations for
any particular vector area-class map. This approach is sensitive to the particular
qualities of any dataset. Variability in circle area following rasterization is much
less than that
for irregular polygons. This is due to its compactness, and
rasterization sensitivity reported for the circle should be regarded as a best-case
example.

Choice of classiﬁcation rule appears to matter little for the methodology
adopted here, as long as polygon size is large relative to cell size. Other studies
suggested (and this was conﬁrmed for the experimental data employed here) that
the largest-share rule is subject to slightly less variability following rasterization and
subsequent vectorization. Both methods performed in very similar fashion in the
origin displacement experiments for smaller cell sizes. As cell size increased relative
to polygon size, differences emerged. In particular,
less common classes were
underclassiﬁed following rasterization at large cell sizes, while common classes
experienced systematic increases in area. Spatial applications requiring rasterization
may be affected by this bias of the largest-share method towards more dominant
classes.

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 Geometric variability

555

An interesting property of the central-point classiﬁcation rule when it is applied
using the methodology described here is that the cell value will be assigned in
proportion to the percentage of the cell area it covers. That is, if class A covers 25%
of a particular cell and class B covers 75%, the cell will be identiﬁed as covered by A
in about 25% of the realizations. This is because the central-point rule samples the
vector data at a particular (very ﬁne) scale, without regard to the output cell size.
Varying the position of the classiﬁcation point develops a set of point-scale samples
for each cell. Taken together, the multiple realizations generated by the techniques
in this paper effectively increase the spatial resolution of the raster grid. This is not
true of the largest-share rule, which adjusts the sampling window when the grid
origin is perturbed or when the cell size is changed.

The case study reveals a number of important issues in rasterization variability.
Most importantly, treating rasterization as a straightforward deterministic exercise
appears to be at best simplistic. The degree of classiﬁcation variability induced by
relatively small perturbations to the grid origin was substantial, especially for larger
cell sizes. Likewise, variability is not uniform across classes. The large differences
observed in rasterization sensitivity between land-cover classes are not surprising,
but they do suggest that much care needs to be taken with determining appropriate
cell size for the rasterization operation — one size clearly does not ﬁt all. Third,
total boundary length is a critical factor in explaining sensitivity of different land-
cover classes to rasterization. For the data employed here, boundary length
explained over 97% of the variability between classes in sensitivity to larger cell
sizes. The longer the boundary, the greater the variability, in absolute magnitude. If
infrequently occurring
variability is considered relative to total area, however,
classes display the most variability, as ﬁgure 6 demonstrates. Even at fairly ﬁne cell
resolutions like 100 meters, area estimation variability for such classes exceeds 2%
of their total area; at coarser resolutions this may surpass 10%.

The modelling approach presented in Section 3.2.3 might be employed to
identify an appropriate cell resolution in the following manner. Consider a
hypothetical class occupying a similar study region of equivalent size with a total
perimeter length of 60 km and an area of 8 km2. We wish to choose a cell size such
that variability (deﬁned here as 1 standard deviation), is less than 5% of the total
area. Assuming that the relationships modelled in the case study hold, the model
presented in equation (3) can be used to estimate class sensitivity:

ln sensitivity

ð

Þ~{8:551z0:507 ln 60ð

ð

Þ

Þ~{6:475

sensitivity~e{6:475~0:00154:

ð4Þ

The resulting value is an estimate for the slope of a linear model with a zero-
intercept that characterizes the relationship between cell size and the standard
deviation of the total area estimate for the class. Using this model, a maximum cell
size can be extracted that will satisfy the criterion: 259.7 m.

However, this approach has two major drawbacks. First, it is necessary to
assume that the modelled relationship holds for alternative, possibly quite different
situations. More signiﬁcantly, it is limited to a single application — in this case, the
effect of cell size on total area assigned via rasterization. If the application is
sensitive to other factors, such as fragmentation, relative position, etc., then the
model is of limited utility. In the example just provided, one might ask why the

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 556

A. M. Shortridge

threshold is set at 5% rather than at 3 or 8%. This is a general problem of such
approaches.

The general,

simulation-based methodology adopted here bypasses

these
problems by enabling the propagation of uncertainty — in this case area
estimation variability due solely to the interaction between polygon edges and the
raster grid mesh — directly through the spatial application of interest (Heuvelink
et al. 1989). There is no need to parameterize a model relating variability to the
the
particular GIS application;
application over many realizations and studying the results.
In this way,
peculiarities of both the spatial dataset and the application are explicitly accounted
for.

is accomplished directly via repetition of

it

A number of research directions appear promising. First, it may be useful to
link the variability observed in these examples to the BI statistic employed by Bregt
et al. (1991). This enables area calculation variability due to small origin shifts to be
compared against the variation observed in previous research. Second, while this
paper has focused on area, other important metrics may be particularly sensitive to
classiﬁcation variability. Landscape pattern metrics,
including fragmentation
indices, are commonly employed on derived raster data (McGarigal et al. 2002).
Understanding the sensitivity of these metrics to the rasterization process may be
very important for analysis employing them. Spatial topological properties may
change as a result of rasterization; for example, a continuous but narrow riparian
feature might be transformed into a set of discontinuous cells. The methodology
described in this paper could serve as a tool to investigate important metrics and
spatial properties that could be particularly sensitive to rasterization error, and to
choose appropriate cell
for applications employing them. Third, grid
orientation was not addressed in this paper, but could be of considerable interest
for research involving remote sensing imagery, including which grid orientation
between different sensors and the desired raster orientation may vary considerably.
Work on orientation is complicated by the problem that a potentially large
mismatch exists in spatial coverage between an original rectangular raster grid and
a derived, rotated raster. Variability arising from rotation could be more substantial
than that resulting from that arising from origin translations as presented in this
paper. Fourth, the geometric regularities apparent in the map of circle cell counts
are interesting and suggest that links to more formal theoretical models of area
classiﬁcation are possible. Indeed, Frolov and Maling (1969) present a formula for
determining the range of the number of points that can overlie a circle of arbitrary
radius.

sizes

While this paper has framed the research question within the geometric
uncertainty of the vector-to-raster conversion context, the more general problem of
object representation in the raster data structure includes a broad spectrum of
uncertainties. Raster discrepancy with respect to the real world may arise due to
factors throughout data production and processing, not least from the abstraction
of the real world into discrete categories, partitioned into homogenous regions. It
may be useful to consider spatial representation generally as a stochastic process. A
number of researchers, such as Goodchild et al. (1992) and McGwire and Fisher
(2001), have developed approaches for modelling error stochastically for categorical
data. Such approaches generally increase the boundary length, resulting in
potentially greater raster classiﬁcation variability, according to the ﬁndings of

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 Geometric variability

557

this paper. Coupling such models with the approach advanced in this paper to
characterize geometric boundary variability may result
complete
characterizations of classiﬁcation uncertainty, and enable the propagation of
such uncertainty through data processing to the results of any particular
application.

in more

Acknowledgements

Three anonymous reviewers supplied valuable comments on the manuscript.

References
ANDERSON, J. R., HARDY, E. E., ROACH, J. T., and WITMER, R. E., 1976, A Land Use and
Land Cover Classiﬁcation System for Use with Remote Sensor Data. Paper 964 (US
Geological Survey Professional) (Washington DC: US Government Printing Ofﬁce).
BREGT, A. K., DENNEBOOM, J., GESINK, H. J., and VANRANDEN, Y., 1991, Determination of
rasterizing error: a case study with the soil map of the Netherlands. International
Journal of Geographical Information Systems, 5, 361–367.

CARVER, S. J., and BRUNDSON, C. F., 1994, Vector to raster conversion error and feature
complexity: an empirical study using simulated data. International Journal of
Geographical Information Systems, 8, 261–270.

CONGALTON, R. G., 1997, Exploring and evaluating the consequences of vector-to-raster and
raster-to-vector conversion. Photogrammetric Engineering and Remote Sensing, 63,
425–434.

CRAPPER, P. F., 1980, Errors incurred in estimating an area of uniform land cover using
Landsat. Photogrammetric Engineering and Remote Sensing, 46, 1295–1301.
ESRI, 2002, Arc Version 8.2 (UNIX) (Redlands: Environmental Systems Research Institute).
FROLOV, Y. S., and MALING, D. H., 1969, The accuracy of area measurement by point

counting techniques. Cartographic Journal, 6, 21–25.

GOODCHILD, M. F., 1980, Fractals and the accuracy of geographical measures. Mathematical

Geology, 12, 85–98.

GOODCHILD, M. F., SUN, G., and YANG, S., 1992, Development and test of an error model
for categorical data. International Journal of Geographical Information Systems, 6,
87–104.

HEUVELINK, G. B., BURROUGH, P. A., and STEIN, A., 1989, Propagation of errors in spatial
modelling with GIS. International Journal of Geographical Information Systems, 3,
303.

IHAKA, R., and GENTLEMAN, R., 1996, R: a language for data analysis and graphics. Journal

of Computational and Graphical Statistics, 5, 299–314.

KAM, S. P., CHU, T. H., and ALVERAN, A., 2000, Area representation errors associated with
rasterization. In Proceedings of
the 4th International Symposium on Spatial
Accuracy Assessment in Natural Resources and Environmental Sciences, Amster-
dam, the Netherlands (available at: http://gissrv.iend.wau.nl/Accuracy2000/abstracts/
kam.htm) (accessed on 1 December 2003).

KIRBY, H. R., 1997, Buffon’s needle and the probability of intercepting short-distance trips

by multiple screen-line surveys. Geographical Analysis, 29, 64–71.

LONGLEY, P. A., GOODCHILD, M. F., MAGUIRE, D., and RHIND, D. W., 2001, Geographical

Information Systems and Science (New York: Wiley).

MCGARIGAL, K., CUSHMAN, S. A., NEEL, M. C., and ENE, E., 2002, FRAGSTATS: spatial
software program
pattern analysis program for categorical maps. Computer
produced by the authors at
the University of Massachusetts, Amherst, MA,
USA (available at: http://www.umass.edu/landeco/research/fragstats/fragstats.html)
(accessed on 1 December, 2003).

MCGWIRE, K. C., and FISHER, P. F., 2001, Spatially variable thematic accuracy: beyond the
confusion matrix. In Spatial Uncertainty in Ecology: Implications for Remote Sensing
and GIS Applications, edited by C. T. Hunsaker, M. F. Goodchild, M. A. Friedl and
T. J. Case (New York: Springer), pp. 308–329.

OKABE, A., and SADAHIRO, Y., 1997, Variation in count data transferred from a set of

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 558

Geometric variability

irregular zones to a set of regular zones through the point-in-polygon method.
International Journal of Geographical Information Science, 11, 93–106.

SHORTRIDGE, A. M., and GOODCHILD, M. F., 2002, Geometric probability and GIS: some
applications for the statistics of intersections. International Journal of Geographical
Information Science, 16, 227–243.

SWITZER, P., 1975, Estimation of the accuracy of qualitative maps. In Display and Analysis of
Spatial Data, edited by J. C. Davis and M. J. McCullagh (New York: Wiley),
pp. 1–13.

USGS, 1990, Land Use and Land Cover Digital Data from 1:250,000- and 1:100,000-scale

Maps: Data User Guide 4 (Reston: US Geological Survey).

USGS, 1994, GIRAS Landuse/Landcover Data for the Conterminous United States by
Quadrangles at Scale 1:250,000 (Reston: US Geological Survey) (available at: http://
geo-nsdi.er.usgs.gov/metadata/other/epa/giras-lulc/sdd/metadata.html) (accessed on 1
December 2003).

Downloaded by [University of Lethbridge] at 11:09 17 June 2016 