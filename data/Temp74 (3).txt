Transactions in GIS, 2010, 14(s1): 177–195

Research Article

A Spatial Analysis System for Integrating
Data, Methods and Models on
Environmental Risks and Health Outcomes

Chetan Tiwari
Department of Geography
University of North Texas

Gerard Rushton
Department of Geography
University of Iowa

Abstract
Integrating data on health outcomes with methods of disease mapping and spatially
explicit models of environmental contaminants are important aspects of environ-
mental health surveillance. In this article, we describe a modular, web-based spatial
analysis system that uses GIS, spatial analysis methods and software services deliv-
ered over computer networks to achieve this end. The Environmental Health Sur-
veillance System (EHSS) is a prototype system that is designed to serve three
purposes: a secure environment for producing maps of disease outcomes from
individual-level data while preserving privacy; an automated process of linking
environmental data, environmental models, and GIS tasks like geocoding for the
purposes of estimating individual exposures to environmental contaminants; and
mechanisms to visualize the spatial patterns of disease outcomes via Web-based
mapping interfaces and interactive tools like Google Earth.

1 Introduction

People receive different degrees of exposure to different kinds of environmental hazards
as part of the environment in which they live. Measures of their health and the burdens
of illness they experience can be regarded as outcomes of such exposure processes. In
order to improve the effectiveness of public health programs whose primary purpose is
to reduce the human and economic burdens of such illnesses, there is a need to develop
methods and systems that can monitor environmental exposures and their effects on
human health. This entails the need to create systems that have the ability to identify
spatial patterns of disease burdens (Elliott and Wartenberg 2004, Walter 2000), obtain
better estimates of human exposures to environmental contaminants (Schwartz et al.

Address for correspondence: Chetan Tiwari, Department of Geography, University of North Texas,
1155 Union Circle #305279, Denton, TX 76203-5017, USA. E-mail: chetan.tiwari@unt.edu.

© 2010 Blackwell Publishing Ltd
doi: 10.1111/j.1467-9671.2010.01220.x

178

C Tiwari and G Rushton

2005), and aid in the process of assessing the effectiveness of disease prevention and
environmental protection programs (McGeehin et al. 2004, Teutsch 1992).

1.1 The Need for an Environmental Health Surveillance System

Environmental and health data to support surveillance activities are increasingly becom-
ing available through state and federal agencies. The analysis of such datasets to deter-
mine trends and patterns in health outcomes often requires the use of spatial analysis
methods and Geographic Information Systems (GIS) software. Although desktop GIS
software allows one to combine and analyze such spatial data, they are generally
designed to serve a wide variety of application domains and are not speciﬁcally built for
environmental health surveillance related activities. The lack of a comprehensive system
to monitor the spatial patterns of disease outcomes and the impacts of environmental risk
factors on human health has been recognized by several state and federal agencies in the
United States. In 2001, the Pew Environmental Health Commission recommended the
creation of a “nationwide health tracking network with appropriate privacy protections
to better understand, respond to and prevent chronic disease” (Pew Environmental
Health Commission 2001). In 2005, the Centers for Disease Control and Prevention
(CDC) released their strategic vision document for the establishment of an environmental
public health tracking program (CDC 2005). The director of the CDC states in this
report that the purpose of the program is to “build a national integrated environmental
and public health information system that supports national efforts to standardize and
facilitate the electronic exchange of information. Linking environmental and health data
will enable a timely response to potential health problems related to the environment”.
Although recent efforts have targeted the need to electronically exchange health data and
information (Halamka et al. 2008), efforts towards building systems that link, analyze,
and visualize environmental risk factors and disease outcomes remain inadequate.

1.2 A System to Link, Analyze, and Visualize Environmental and Health Data:
The Environmental Health Surveillance System (EHSS)

The environmental health surveillance system (EHSS), a Web-based spatial analysis
system that is designed to provide environmental health surveillance functions, can be
used by researchers, public health departments and others interested in examining the
spatial patterns of diseases and environmental hazards without the need for expert
knowledge in the areas of spatial analysis or geographic information science (Tiwari
2008). It uses a Web-based interface to provide the following services: (1) compute
disease rates from aggregated or individual-level health outcome data using methods that
preserve the privacy of the data used in the analysis, (2) estimate individual exposures to
environmental contaminants from conﬁned animal feeding operations (CAFOs) in Iowa
using an existing Gaussian plume model, (3) visualize disease burdens using a Web-based
mapping interface and interactive tools like Google Earth, and (4) provide GIS functions
to perform spatial data re-projections, format conversions, and geocoding. The EHSS
presented in this article describes a suite of spatial analysis methods developed speciﬁ-
cally for the environmental public health surveillance process within an extensible,
Web-based GIS framework.

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

Spatial Analysis System for Health Surveillance

179

2 A GIS Framework for Environmental Health Surveillance

The conceptual framework for the EHSS is based on a geographical extension to a
classical public health surveillance framework for modeling the mechanisms by which
environmental hazards can result in adverse health outcomes (Thacker et al. 1996).
Thacker et al. (1996) argue that the processes of public health surveillance should not
only focus on the systematic collection, analysis and interpretation of health data, but
also on the surveillance of environmental hazards and their presence in human popula-
tions. For many environmental hazards, these processes of assessing individual exposures
to risk factors in the environment and consequently measuring the burdens of their
impacts on human health vary across geographic space. The conceptual framework for
the EHSS is based on this geographical context (Figure 1).

2.1 Geographic Counterpart to Hazard Surveillance: Environmental Modeling

Researchers often rely on a combination of spatial analysis methods and ecological or
environmental models to assess the spatial distribution of environmental hazards and
the risks they present to human populations (Goodchild et al. 1993, Nuckols et al.
2004, Poulstrup and Hansen 2004). These range from simple geometric measures
of dispersion like circles emanating from a point source contaminant (Aylin et al.
1999) to complex mathematical (Bellander et al. 2001, Crawford-Brown 2001) and
geostatistical (Wartenberg et al. 1991) models of pollutant dispersion. The EHSS
demonstrates the ability to incorporate the surveillance of environmental hazards
using a spatially-explicit model for determining the annual average concentrations of
hydrogen sulﬁde (H2S) dispersed by Conﬁned Animal Feedlot Operations (CAFO) in
Iowa (O’Shaughnessey and Altmaier,
in preparation). Although the current imple-
mentation uses models that have been calibrated using meteorological data on wind
direction, speed, class and mixing height for Iowa, the system can be extended
to provide coverage for any geographic area for which such meteorological data are
available.

Figure 1 A geographical framework for environmental health surveillance

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

180

C Tiwari and G Rushton

2.2 Geographic Counterpart to Exposure Surveillance: Exposure Assessment

Geocoding methods are commonly used to link individual or group exposures to con-
taminant estimates that can be modeled geographically. Its role has been well discussed
in the literature particularly with regards to potential biases in either geocoding com-
pleteness, or accuracy, or both (Armstrong and Tiwari 2007, Bellander et al. 2001,
Maantay 2002, Vine et al. 1998, Ward et al. 2005). In addition to these concerns, privacy
and conﬁdentiality restrictions placed on health data often force researchers to obtain
exposure estimates that are generalized to aggregate populations. As a result, associative
or causal hypotheses generated from such analyses are susceptible to inaccuracies, biases,
and random errors (Elliott and Wakeﬁeld 1999, Elliott and Wartenberg 2004, Ward and
Wartenberg 2006). The EHSS provides three mechanisms that can help alleviate some of
the potential biases that may occur as a result of the geocoding process. First, in terms of
completeness, the EHSS is conﬁgured to use multiple geocoding service providers where
addresses that are not successfully geocoded from one data provider are automatically
sent to others. Second, the EHSS can be conﬁgured to ﬁlter geocodes based on their
reported levels of accuracy. Lastly, and more importantly, the EHSS integrates the
geocoding and exposure assessment mechanisms with methods of privacy protection that
can use individual level data and provide privacy-protected estimates of environmental
exposures.

2.3 Geographic Counterpart to Outcome Surveillance: Disease Mapping

Disease maps are commonly used for hypothesizing and modeling the changing relation-
ships between diseases and their risk factors in the environment, visualizing and under-
standing the geographical spread of their burdens, and for control and prevention
activities (Elliott and Wartenberg 2004, Wakeﬁeld and Elliott 1999, Whitelegg 1986).
The EHSS implements the spatially adaptive ﬁlters method with variations that allow
users to (1) constrain the disease maps by geographic objects, and (2) adjust the estimated
rates by the age-sex structures of the populations being studied.

3 Addressing the Needs of Environmental Health Surveillance

3.1 Creating Maps of Disease Burdens

There are many methods for creating maps of disease burdens (Bithell 2000). Generally,
the purpose for which a map is created determines what method is most appropriate for
its construction. From an environmental health perspective, it is reasonable to assume
that the risk of exposure from an environmental contaminant varies continuously across
geographical space and is generally not constrained by artiﬁcially deﬁned areas such as
census entities. Consequently, the EHSS implements mapping methods that portray
disease burdens as a continuous function across geographical space. Such maps are
particularly important from an exploratory standpoint as they are representative of risk
and therefore provide a crucial starting point for epidemiologic enquiry. Kernel density
estimation based methods are commonly used to produce such spatially continuous
representations of disease risk (Figure 2). The methodology used for computing this map
from approximately 9,000 individual cancer records geocoded to the ZIP code level is
described below.

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

Spatial Analysis System for Health Surveillance

181

Figure 2 Rate of late-stage colorectal cancer incidence in Iowa, 1993–97. Rate computed
using the EHSS. Map output produced using ESRI ArcGIS software

Maps produced using such methods use a kernel or spatial ﬁlter that is characterized
by a particular shape, size and density function (Gatrell et al. 1996, Silverman 1986).
Rates of disease burdens are computed using a series of overlapping spatial ﬁlters or
kernels, generally circular in shape, that are placed at each point of a predetermined grid
of regularly or irregularly spaced points that cover the geographic extent of the study
area. The overlapping spatial ﬁlters are the basis for computing disease rates. They are
calculated by dividing the number of “diseased cases” by the number of “population
controls” that fall inside each circle (Figure 3).

Because population densities vary across geographical space, the number of popu-
lation controls that may be captured inside each circle can vary as the spatial ﬁlter moves
from densely populated urban areas to sparsely populated rural areas. This can result in
unstable estimates of disease rates, a problem that is commonly referred to as the
small-number problem (Jones and Kirby 1980). Therefore, it is important to control the
size of the spatial ﬁlter so that it includes some minimum number of denominators every
time a rate is calculated. This is accomplished by expanding or contracting the size of the
spatial ﬁlter to reﬂect the underlying population density (Figure 4). The advantage of this
method, the spatially adaptive ﬁlters method, is that it equalizes the variance in estimated
rates while maximizing the amount of geographic detail portrayed on the map (Talbot
et al. 2000, Tiwari and Rushton 2005). Note that every individual included within a ﬁlter
is given an equal weight. The map in Figure 2 was produced using adaptive ﬁlters and a
threshold population of 75 expected incidence cases.

It must be noted that disease rates estimated using this method borrow strength by
using larger sized ﬁlters in areas with sparse population densities. Maps produced using

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

182

C Tiwari and G Rushton

Figure 3 Fixed size spatial ﬁlters

Figure 4 Spatially adaptive ﬁlters

this method therefore tend to be smoother in rural areas that have fewer people.
Additionally, rate estimates obtained in sparsely populated areas that surround densely
populated urban areas (such as the suburbs of a major metropolitan area) will be
unevenly inﬂuenced by populations from the denser areas. A solution to this problem,
which has not been implemented yet, would be constrain the ﬁlters to operate within or
outside predeﬁned geographic areas such as city boundaries.

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

Spatial Analysis System for Health Surveillance

183

Figure 5 Quadtree-based approach to deﬁne a grid

Additional control on the smoothing can be exercised by carefully deﬁning the grid
on which these spatial ﬁlters are constructed. Recall that disease rates are computed at all
points of a predeﬁned grid that is overlaid on the study area. A coarse grid overlaid on
an area of high population densities will result in a loss of geographic detail. On the other
hand, no additional insight is gained when a ﬁner grid is placed over areas that are
sparsely populated. The issue of selecting an appropriate grid resolution has been
discussed previously in the kernel density estimation literature. Silverman (1986) recom-
mends the use of a “reasonably coarse” grid that balances the need for geographic detail
with computational efﬁciency. The deﬁnition of “reasonably coarse”, however, is left to
the interpretation of the reader. Yiannakoulias et al. (2007) previously note that a serious
shortcoming of a regularly spaced grid is that, in many cases, the grid is not represen-
tative of the underlying population density. A solution to this problem is to use the
density of the population itself to deﬁne the grid (Yiannakoulias et al. 2007). The EHSS
implements a quadtree-based approach that recursively divides the study area into four
equal area rectangles, each of which contains no more than a user-speciﬁed threshold of
population controls (Samet 1984). The centroids of the polygons then form the grid on
which the spatially adaptive ﬁlters method is applied (Figure 5). We call this a “densiﬁed
grid” as opposed to a “regular grid” where points are placed at regular intervals without
any consideration given to the density of the underlying population.

3.2 Creating Age-Adjustment Maps of Disease Burdens

The spatially adaptive ﬁlters and densiﬁed grid methods control for population densities.
However, for many diseases, it is also important to account for the underlying differences
in the age-sex structures of the populations being mapped. The spatially adaptive ﬁlters
method is modiﬁed to account for two forms of age-adjustment that are commonly used

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

184

C Tiwari and G Rushton

in the epidemiological literature – the indirect and direct methods of age-adjustment.
Both these methods are available in the EHSS.

3.2.1 Indirect age-adjustment

Indirect age-adjustment controls for differences in population composition by multiply-
ing the age-speciﬁc rates derived from a reference population (for example, rates of
colorectal cancer for each 5-year age group in the US) by the number of people in each
age group of the local population (for example, the number of people in each 5-year age
group in Johnson County, IA). This gives an expected number of cases in the local area
if the local area experienced the same age-sex speciﬁc disease rates as the reference
population (Waller and McMaster 1997). Recall that the spatially adaptive ﬁlters method
requires the user to specify a minimum number of denominators. Note that this value,
called the threshold value, controls the size of the spatial ﬁlter and is always applied to
the denominators. In indirectly age-adjusted maps, the denominators are the expected
number of cases. The rate that is calculated using these denominators is commonly
known as the standardized incidence rate (SIR) or the standardized mortality rate (SMR).
It is computed as a ratio of the sum of the observed number of cases across all population
subgroups to the sum of the expected number of cases across all population subgroups.
Mathematically, the indirect age-adjustment method is given by:

SIR
k

=

O
k
E
k

where Ok refers to the observed cases in the local area “k”; Ek refers to the expected

cases in local area “k” =

; m refers to the number of population subgroups in

m

∑

=

1

g

⋅
R Pg

,
g k

the reference population; Rg refers to the disease rate in subgroup “g” of the reference
population; and Pg,k refer to the population in subgroup “g” and local area “k” of the
study population.

The rate computed by the indirect age adjustment method is a ratio where values
greater than one indicate that the local area (such as the county) has a greater burden of
disease than the reference area (such as the country). Conversely, values less than one
indicate that the local area has a lower rate of disease than the reference area. Such maps
are easy to read and are particularly useful for resource allocation decisions (Rushton
2003).

3.2.2 Direct age-adjustment

The direct age-adjustment method controls for differences in population composition by
using locally observed rates computed for each age group of the local population (for
example, rates of colorectal cancer calculated for each 5-year age group in ZIP code
52240) weighted by the number of people in the corresponding age groups of a standard
population (for example: the number of people in each 5-year age group of the US
standard population). The resulting rates describe the burden of disease in a local area if
the local area had the same population structure as the remainder of the country.
Mathematically, the direct age-adjustment method is given by:

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

Spatial Analysis System for Health Surveillance

185

=

R
k

m

g k

O
∑ ,
P
g k
,

=

1

g

⋅

W
g

where Rk refers to directly age-adjusted rate in local area “k”; m refers to the number of
population subgroups; Og,k refers to the observed cases in population subgroup “g” and
local area “k”; Pg,k refers to population in subgroup “g” and local area “k”; and Wg
refers to the standard weights for population subgroup “g”.

The implementation of this method is not quite as straightforward as the imple-
mentation of the indirect method of age standardization. The primary concern with
this approach is that locally observed rates that are determined from the subgroups
of the study population (for example, the rate of a disease in the 6–10 year old
subgroup in ZIP code 52240) are known to be unstable in areas that have small
populations (i.e. the small numbers problem). Hence, the application of these unstable,
locally observed rates to the population subgroups of the reference population can
lead to unstable age-adjusted rate estimates. A solution to this problem lies in
applying the spatially adaptive ﬁlters method to each population subgroup in order to
determine a constant sized ﬁlter at each grid point that would ensure that all popu-
lation groups reached the threshold of expected number of cases. By using the largest
ﬁlter size that was recorded at each grid, we guarantee stable rate estimates at all
levels of the population, while providing a consistent (identical) ﬁlter size at each grid
point.

3.3 Implementing a Model to Estimate Exposures to CAFO Contaminants

The model for estimating the annual average concentrations of hydrogen sulﬁde (H2S)
dispersed by Conﬁned Animal Feedlot Operations (CAFO) is a Gaussian Dispersion
model with parameter values based on daily meteorological data depicting wind direc-
tion, speed, class and mixing height that were averaged over a period of one year (2006).
The EHSS presently contains 10 model outputs for Iowa that were produced using data
provided by 10 National Weather Service (NWS) stations serving different parts of the
state. Note that the model outputs were produced by the developers of this Gaussian
Dispersion model (O’Shaughnessey and Altmaier, in preparation). The EHSS itself is
designed to work with model outputs for any part of the country for which NWS data
and CAFO locations are available. The model output for each NWS region consists of a
6 km by 6 km grid that is centered on a CAFO. The grid is further subdivided into
58,081 cells of 25 m2 each. The model estimates hydrogen sulﬁde (H2S) concentrations in
each cell. These estimates can be scaled up or down depending on the size of the CAFO,
which is determined by the number of animal units they are permitted to hold. Data on
the locations and attributes of CAFOs in Iowa are obtained from the Iowa Department
of Natural Resources (IDNR).

The scaled cell value is the exposure estimate for any individual who resides in a cell
covered by the model footprint. Note that a location may be inﬂuenced by multiple
CAFOs. In such cases, the exposure estimate at that location is calculated as a sum of the
individual exposures. Input data can be provided as geographic coordinates or as street
addresses. To maintain the conﬁdentiality of the data, the user can choose to mask the
outputs that are returned from the EHSS. A description of the masking process is
provided in the following section.

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

186

C Tiwari and G Rushton

3.4 Protecting the Privacy of Individually-Identiﬁable Health Data

Concerns of privacy and conﬁdentiality have often limited the availability of individual
level health data to researchers and others interested in studying and understanding the
many different aspects of public health research. From a spatial data perspective, mecha-
nisms to protect the privacy and conﬁdentiality of the geographic identiﬁers of health
data have commonly included methods such as spatial aggregation and geographic
masking (Armstrong et al. 1999). The processes of aggregating spatial data to higher
levels of geography or those of randomly perturbing the locations of conﬁdential data
points almost always results in loss of geographic detail. In many environmental expo-
sure assessment studies, such uncontrolled loss of detail is not acceptable.

Linking exposure estimates from environmental models of contaminants to health
outcomes at the individual level, while desirable, is often not possible due to privacy
constraints. One may argue that if the interest is only in studying the association between
high values of exposure and some adverse health outcomes, then one may use the
unmasked locations to obtain the exposure estimates and then strip away any personal
identiﬁers including address and location. However, in some cases the value of the
exposure estimate itself may serve as a unique identiﬁer. The CAFO model used in the
EHSS often provides exposure estimates that are unique to a particular location. These
values can be used as unique identiﬁers for a set of x and y coordinates, which can be
reverse-geocoded to reveal the identity of the persons involved in the study.

A solution to this problem is based on the principle of k-anonymity, which demands
that every row in a table (such as a table of contamination estimates) is indistinguishable
among at least “k” other entities (Sweeney 2002). When applied to an environmental
exposure assessment study, estimates obtained at any individual address location can be
confused with at least “k” other addresses that have contaminant estimates that are close
to the value determined at the given address (Mazumdar et al. 2008). In the EHSS, the
user starts by providing a table of exposure estimates that need to be masked. Each row
in the table consists of a location with its associated contamination estimate. The user
also provides the value of “k”. For every row in the table, the masking algorithm
determines the upper (UB) and lower (LB) bounds of the exposure estimates. These are
the contamination values at k/2 rows above and below the current row. For each row, the
masked contamination estimate is calculated as LB + {(UB-LB)*Random()}.

While this process does distort the true contamination value, the distortion is not the
outcome of an uncontrolled process. For example, a geographical mask that is typically
applied as a random perturbation in the location of a conﬁdential data point can result
in drastically different exposure estimates depending on the scale of the model being used
and the amount of displacement applied. A privacy protection module based on the
k-anonymity principle provides better control over the masking process, which is applied
on the contamination value and not on the location.

From a disease mapping standpoint, disease rates estimated using the spatially
adaptive ﬁlters method are produced at all points of a regular or irregular grid generated
over the study area. These rate estimates are interpolated to create a smoothed, continu-
ous surface of disease risk across the study area (Figure 2). In addition to being a robust
mapping method, the output from the spatially adaptive ﬁlters method and the EHSS
makes it impossible to determine the actual locations, and therefore the identities, of the
underlying data values that were used to produce the map. The ability of the EHSS to
produce disease maps using individual-level data in a manner that protects the conﬁden-

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

Spatial Analysis System for Health Surveillance

187

tiality of the data points is an approach that is based on the observed spatial distribution
of the cases and the method of privacy protection provided by the k-anonymity principle
rather than the commonly used spatial randomization of the location of the event. This
customization of the privacy protection tool to the facts of the spatial distribution of the
observations is a superior tool for ensuring privacy protection with a guaranteed level of
privacy protection at minimal effect on the validity of the results.

3.5 Visualization

A continuous surface of disease burdens can be created using the output from EHSS.
Recall that disease rates are computed at all points of a regular or irregular grid placed
over the study area. A simple interpolation method can be used to generate a continuous
surface from the grid points. We use the inverse distance weighted (IDW) method with
eight neighbors and a high power value. The rationale behind the IDW method and these
parameters is to place maximum inﬂuence on only the closest points. This is done to
avoid any “double” smoothing that may occur in addition to what has already been
performed by the spatially adaptive ﬁlters method. An IDW smoothing parameter in the
Geospatial Data Abstraction Library (GDAL) is used to reduce artifacts that commonly
result when the IDW interpolation method is used on a set of regularly spaced points.
The interpolated surface is then colorized using an equal-interval or quantiles classiﬁca-
tion method. The colorized raster is converted to a georeferenced image, which is further
divided into a discrete number of zoom levels. Each zoom level contains a number of
identically sized “tiles”. This process of breaking an image down into multiple pieces is
frequently used to provide efﬁcient access to large images, particularly when they are
being accessed over a network. The OpenLayers map library (OpenLayers 2010) is used
to overlay these tiles on base data that is obtained from a variety of online map providers
including Google, Yahoo, and Microsoft (Figure 6). This library also provides map
zoom, pan, and transparency functions that allow users to enable or disable base layers,
zoom into speciﬁc areas, or pan the map to any geographic location. The class breaks
used in this map are the same as those used to produce the map in Figure 2. Labels
indicating the locations of major urban centers were manually overlaid for reference,
although a user of this system can use the transparency and zoom functions to focus in
on speciﬁc areas. The map is made available as a password-protected webpage that is
linked to an EHSS user account. These maps can be produced for any dataset for which
disease rates have been calculated using the disease mapping module on EHSS.

3.6 Creating Maps of Temporal Change in Disease Burdens

The disease mapping module in the EHSS can be used to create maps that show temporal
changes in the spatial patterns of disease burdens. When two maps for the same disease
and geographic area are being compared over different time periods, care must be taken
to ensure that the spatial basis of support (i.e. the ﬁlter sizes) that are used to compute
disease rates in both the maps are exactly the same. The implication being that the
populations used to compute a rate at each grid point in both the time periods are the
same. In the EHSS, this is accomplished by allowing the user to either specify a popu-
lation threshold (for time period t) or an existing set of ﬁlter size deﬁnitions (for time
period t + 1). Consequently, the spatial basis of support used to compute a rate at each

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

188

C Tiwari and G Rushton

d
e
c
u
d
o
r
p

t
u
p
t
u
o

p
a
M

.

S
S
H
E

e
h
t

g
n
i
s
u

d
e
t
u
p
m
o
c

e
t
a
R

.
7
9
–
3
9
9
1

,
a
w
o
I

n

i

e
c
n
e
d
i
c
n

i

r
e
c
n
a
c

l
a
t
c
e
r
o
o
c

l

e
g
a
t
s
-
e
t
a
l

f
o

e
t
a
R

6
e
r
u
g
i
F

s
r
e
y
a
L
n
e
p
O
d
n
a

L
A
D
G
g
n
i
s
u

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

Spatial Analysis System for Health Surveillance

189

grid point for both the maps is exactly the same and valid comparisons of change can be
produced. The resulting output from the EHSS is converted to a spatially continuous
surface using the IDW method described in Section 3.5. The resulting raster surfaces can
then be subtracted to obtain an absolute measure of change. Alternately, a rate of change
for each pixel of the map may also be computed by dividing the estimated rate in time
period t + 1 to the estimated rate in the time period t.

4 Design and Implementation of the EHSS

The design and implementation of the EHSS is inﬂuenced by recent developments in
computer science and geography that have led to the transition of GIS software from
standalone, proprietary systems to Web-centric, platform independent systems (Moreno-
Sanchez et al. 2007). These developments have been most notable in two areas:

1. Ability to provide software services over computer networks, and
2. Ability to store spatial

information in traditional

relational/object-oriented

databases.

4.1 Providing GIS Services over Computer Networks

Geographical Information Systems (GIS) are invaluable tools for managing, manipulat-
ing, analyzing and visualizing spatial data for a wide variety of applications. While
traditional desktop and enterprise-level GIS software have successfully fulﬁlled this role,
they are typically available as monolithic software that is expensive to license and have
steep learning curves. Tsou and Buttenﬁeld (2002) argue that traditional closed or
centralized GIS systems are no longer appropriate for a modern networked environment,
which requires interoperability, reusability, and ﬂexibility. Frehner and Brändli (2006)
note that the increasing use of the Internet is shifting the closed architecture paradigm of
GIS software towards a distributed geographic information services paradigm (Chang
and Park 2006, Preston et al. 2003, Tsou and Buttenﬁeld 2002, Tsou and Peng 2003).
The development of “geoportals” is an example of such developments in the GIS domain
that rely on using web services technologies to query, search and map geospatial data
using web-based catalogues of geographic content and services (Beaumont et al. 2005,
Kiehle et al. 2007, Tait 2005).

The impetus needed for such a paradigm shift comes from efforts in computer
science. Most notably, the development of Service Oriented Architecture (SOA) provides
an interoperable environment for creating customized applications based on a set of
loosely-coupled and reusable modules or “services” (Erl 2005, Friis-Christensen et al.
2007). These applications are typically accessed over networks without the need for
speciﬁc knowledge about their underlying implementation or platform. Within the
GIScience context, there are many examples of spatial data exchange and transformation
services that are based on SOA. They can be broadly categorized into three classes: data
exchange services (such as Web Feature Service, Web Mapping Service, and Web Cov-
erage Service); data processing services (such as the Coordinate Transformation Service);
and catalogue services (such as Web Catalog Service). However, many of these services
are limited to search and retrieval functions for data that continues to exist in proprietary
data formats. Any analysis on such data is still dependent on a user’s knowledge of GIS

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

190

C Tiwari and G Rushton

methods and software. While there have been notable developments in building explor-
atory spatial data analysis systems (Haining et al. 1998), visual data exploration and
knowledge generation systems (Andrienko and Andrienko 1999, Gahegan et al. 2002,
Takatsuka and Gahegan 2002), and web-based tools for health information exchange
(Boulos and Wheeler 2007) and dissemination (Theseira 2002), the emphasis on inte-
grating the speciﬁc needs for environmental health surveillance (i.e. the hazard-exposure-
outcome surveillance process) within a secure, networked, and interactive mapping
environment is unique to the EHSS.

4.2 Performing GIS Operations Using Spatial Databases

A spatial database is a database that offers support for spatial data types in its modeling,
query languages and implementation (Güting 1994). The requirement that a spatial
database must be a database clariﬁes that it must be a full-ﬂedged database system that
is capable of handling both spatial and non-spatial attribute data. Additionally, a spatial
database must provide mechanisms to (1) determine relationships among geographic
objects, (2) determine the properties of geographic objects, and (3) perform spatial
operations such as joins or overlays on geographic objects. A ﬁnal requirement is that it
must provide efﬁcient mechanisms for retrieving collections of geographic objects that
are within a particular subset of the entire geographic extent of the spatial database
without having to scan it completely each time a query is made. Such mechanisms for
spatial indexing are commonly available in most spatial database management systems
(Hellerstein et al. 2005).

A number of spatial database systems, both in the open source and commercial
domain, provide capabilities to store, manage and manipulate large collections of geo-
metric objects that are stored as georeferenced binary representations within tables that
can contain both spatial and aspatial attributes. The analytical component of EHSS,
which contains the disease mapping, exposure assessment and masking algorithms, is
implemented in PostgreSQL which is an open source, object-relational database man-
agement system (ORDBMS). PostGIS is an extension that provides support for storing,
manipulating, and retrieving geographic objects in PostgreSQL. The disease mapping,
exposure estimation, and masking methods are programmed in PL/pgSQL, which is a
procedural language for the PostgreSQL database system.

The analytical components of the EHSS are programmed on the PostgreSQL data-
base system for multiple reasons. First, the ability to create customized GIS functions in
PostgreSQL using PostGIS allows one to combine the querying and indexing capabilities
of a database management system (DBMS) with the ability to manipulate spatial data,
thereby resulting in an extremely ﬂexible platform for research and software develop-
ment. Second, one of the primary advantages of coding the analytical functions in
procedural SQL (PL/pgSQL) is that it allows one to execute a series of database queries
(including spatial queries) natively on the database server. As a consequence, this
approach results in increased performance because the communication overheads
involved between the data and a loosely coupled analytical engine are eliminated. Third,
the ability to analyze conﬁdential data on the database server eliminates the need to build
additional security mechanisms to protect the ﬂow of data between the database server
and an external analytical engine. And lastly, the EHSS is fully constructed using free and
open-source technologies. PostgreSQL and PostGIS are not only a powerful platform for

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

Spatial Analysis System for Health Surveillance

191

Figure 7 EHSS components

manipulating spatial data, but are also products that are available in the open-source
domain.

4.3 Components of the EHSS

The EHSS consists of several components that are linked together to provide disease
mapping, exposure assessment and other spatial data handling services. The UML
component diagram in Figure 7 provides a higher-level abstraction of the system design.
The Web interface to the EHSS is written in PHP, a general purpose scripting
language that is well-suited for Web applications. The primary role of the Web interface
is to provide mechanisms to load data onto the analytical system, provide parameters
needed by the individual methods deployed on the EHSS, and to visualize disease maps
using Web mapping interfaces.

The geocoding service uses external programming interfaces to facilitate communi-
cations and interaction with a variety of online geocoding service providers. Although no
attribute data is passed onto the service providers, one must be mindful of the conﬁden-
tiality requirements of their data. Of course, a limitation of the EHSS is that it cannot
control how address data is handled once it is passed onto the geocoding service provider.
The exposure assessment module relies on environmental models that have been pro-
duced externally. Gaussian plume models for hydrogen sulﬁde exposures from CAFOs in
Iowa were built into this prototype system. The privacy masking component provides
mechanisms for attribute masking that are based on the k-anonymity principle. The
crude and age-adjusted disease mapping components implement the spatially adaptive
ﬁlters method on individual-level or aggregated count data. Disease rates estimated by
these components can either be visualized using a web interface or they can be exported
as shapeﬁles for further processing in a GIS software package.

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

192

C Tiwari and G Rushton

Although the EHSS does provide a high degree of automation, particularly for
spatial data handling tasks, it is important to note that the system does not completely
eliminate the need for user input. For example, in the disease mapping modules, the end
user is ultimately responsible for specifying many of the key parameters that are used to
create disease maps. These include the threshold value that controls what sized spatial
ﬁlters are used in the rate calculations, the type of age-adjustment method, and the
number of age-groups that are most appropriate for the data. Although the EHSS allows
users to easily produce maps of different input parameters, formal methods for evaluat-
ing the impact of their choices have not been developed yet.

4.4 Availability of the EHSS

The EHSS is built using several open source components. The source code for most of the
methods implemented in the EHSS is publicly available under the Creative Commons
Attribution-NonCommercial-ShareAlike 3.0 Unported License. More information about
installing the system is available on http://www.webdmap.com

5 Conclusions

The EHSS uses GIS, spatial analysis methods and Web technologies to develop an
analysis system for tracking the spatio-temporal patterns of disease outcomes, estimating
exposures to environmental contaminants using an existing Gaussian dispersion model,
and visualizing this information using Web-based mapping technologies. EHSS demon-
strates how complex analysis methods can be embedded within automated systems that
require minimal user expertise in manipulating and managing spatial data. The EHSS
also provides an alternative to traditional methods of privacy protection that have relied
on using statistical and/or modeling approaches to address concerns regarding the
privacy and conﬁdentiality of individual-level health data. The design of the EHSS
provides a secure environment where an analysis can occur on computers that can
potentially utilize individual-level data and provide outputs that protect the privacy of
individuals who were included in the analysis. Finally, the ability to visualize disease
burdens in local contexts using free and interactive Web mapping applications can be
extremely useful for engaging the public in matters of health and the environment in
which they live.

Acknowledgments

We thank Marc Armstrong, David Bennett, Kirsten Beyer, Martha Carvour, Kelley Donham, David
Haynes, Soumya Mazumdar, Patrick O’Shaughnessy and Alberto Segre from The University of
Iowa; David Stinchcomb from the National Cancer Institute; James Cucinelli and Dan Kavan from
Information Management Services Inc.; Benjamin Goodrich and Sam LeFevre from the Utah
Department of Health; and Kevin Henry from the New Jersey Department of Health and Senior
Services. Partial support for this research was provided by Contract #5883CA2 from the Iowa
Department of Public Health and Contract #N01PC35143 N; Add.#8 from the National Cancer
Institute.

References

Andrienko G L and Andrienko N V 1999 Interactive maps for visual data exploration. Interna-

tional Journal of Geographical Information Science 13: 355–74

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

Spatial Analysis System for Health Surveillance

193

Armstrong M P and Tiwari C 2007 Geocoding methods, materials, and ﬁrst steps toward a
geocoding error budget. In Rushton G, Armstrong M P, Gittler J, Greene B R, Pavlik C E, West
M M, and Zimmerman D L (eds) Geocoding Health Data: The Use of Geographic Codes in
Cancer Prevention and Control, Research and Practice. Boca Raton, FL, CRC Press: 11–35
Armstrong M P, Rushton G, and Zimmerman D L 1999 Geographically masking health data to

preserve conﬁdentiality. Statistics in Medicine 18: 497–525

Aylin P, Maheswaran R, Wakeﬁeld J, Cockings S, Jarup L, Arnold R, Wheeler G, and Elliott P 1999
A national facility for small area disease mapping and rapid initial assessment of apparent
disease clusters around a point source: The UK Small Area Health Statistics Unit. Journal of
Public Health 21: 289

Beaumont P, Longley P A, and Maguire D J 2005 Geographic information portals: A UK perspec-

tive. Computers, Environment and Urban Systems 29: 49–69

Bellander T, Berglind N, Gustavsson P, Jonson T, Nyberg F, Pershagen G, and Jarup L 2001 Using
geographic information systems to assess individual historical exposure to air pollution from
trafﬁc and house heating in Stockholm. Environmental Health Perspectives 109: 633–9
Bithell J F 2000 A classiﬁcation of disease mapping methods. Statistics in Medicine 19: 2203–

Boulos M N K and Wheeler S 2007 The emerging Web 2.0 social software: An enabling suite of
sociable technologies in health and health care education. Health Information and Libraries
Journal 24: 2–23

CDC 2005 Cdc’s Strategy for the National Environmental Public Health Tracking Program.

Atlanta, GA, National Center for Environmental Health

Chang Y S and Park H D 2006 XML Web Service-based development model for Internet GIS

applications. International Journal of Geographical Information Science 20: 371–99

Crawford-Brown D 2001 Mathematical Methods of Environmental Risk Modeling. Norwell, MA,

15

Kluwer

Elliott P and Wakeﬁeld J C 1999 Small area studies of environment and health. In Barnett V,
Turkman K F, and Stein A (eds) Statistics for the Environment: 4, Health and the Environ-
ment. Chichester, John Wiley and Sons: 3–27

Elliott P and Wartenberg D 2004 Spatial epidemiology: Current approaches and future challenges.

Environmental Health Perspectives 112: 998–1006

Erl T 2005 Service-oriented Architecture: Concepts, Technology, and Design. Upper Saddle Creek,

NJ, Prentice Hall

Frehner M and Brändli M 2006 Virtual database: Spatial analysis in a Web-based data management
system for distributed ecological data. Environmental Modelling and Software 21: 1544–54
Friis-Christensen A, Ostländer N, Lutz M, and Bernard L 2007 Designing service architectures for
distributed geoprocessing: Challenges and future directions. Transactions in GIS 11: 799–818
Gahegan M, Takatsuka M, Wheeler M, and Hardisty F 2002 Introducing GeoVISTA Studio: An
integrated suite of visualization and computational methods for exploration and knowledge
construction in geography. Computers, Environment and Urban Systems 26: 267–92

Gatrell A C, Bailey T C, Diggle P J, and Rowlingson B S 1996 Spatial point pattern analysis and
its application in geographical epidemiology. Transactions of the Institute of British Geogra-
phers 21: 256–74

Goodchild M F, Parks B O, and Steyaert L (eds) 1993 Environmental Modeling with GIS. New

Güting R H 1994 An introduction to spatial database systems. The International Journal on Very

York, Oxford University Press

Large Data Bases 3: 357–99

Haining R, Wise S, and Ma J 1998 Exploratory spatial data analysis in a Geographic Information
System environment. Journal of the Royal Statistical Society, Series D (The Statistician) 47:
457–69

Halamka J D, Mandl K D, and Tang P C 2008 Early experiences with personal health records.

Journal of the American Medical Informatics Association 15: 1–7

Hellerstein J M, Naughton J F, and Pfeffer A 2005 Generalized search trees for database systems.
In Hellerstein J M and Stonebraker M (eds) Readings in Database Systems. Cambridge, MA,
MIT Press: 562–73

Jones K and Kirby A 1980 The use of chi-square maps in the analysis of census data. Geoforum 11:

409–17

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

194

C Tiwari and G Rushton

Kiehle C, Greve K, and Heier C 2007 Requirements for next generation spatial data infrastructures:
Standardized web-based geoprocessing and web service orchestration. Transactions in GIS 11:
819–34

Maantay J 2002 Mapping environmental injustices: Pitfalls and potential of geographic informa-
tion systems in assessing environmental health and equity. Environmental Health Perspectives
110: 161–71

McGeehin M A, Qualters J R, and Niskar A S 2004 National Environmental Public Health
Tracking Program: Bridging the information gap. Environmental Health Perspectives 112:
1409–13

Mazumdar S, Rushton G, Smith B, Zimmerman D, and Donham K 2008 Geocoding accuracy and
the recovery of relationships between environmental exposures and health. International
Journal of Health Geographics 7: 13

Moreno-Sanchez R, Anderson G, Cruz J, and Hayden M 2007 The potential for the use of open
source software and open speciﬁcations in creating Web-based cross-border health spatial
information systems. International Journal for Geographic Information Science 21: 1135–63
Nuckols J R, Ward M H, and Jarup L 2004 Using geographic information systems for exposure
assessment in environmental epidemiology studies. Environmental Health Perspectives 112:
1007–15

Pew Environmental Health Commission 2001 Transition Report to the New Administration:
Strengthening Our Public Health Defense against Environmental Threats. Baltimore, MD,
John Hopkins School of Hygiene and Public Health

Poulstrup A and Hansen H L 2004 Use of GIS and exposure modeling as tools in a study of cancer
incidence in a population exposed to airborne dioxin. Environmental Health Perspectives 112:
1032–6

Preston M, Clayton P, and Wells G 2003 Dynamic run-time application development using CORBA
objects and XML in the ﬁeld of distributed GIS. International Journal of Geographical
Information Science 17: 321–41

Rushton G 2003 Public health, GIS, and spatial analytic tools. Annual Review of Public Health 24:

Samet H 1984 The quadtree and related hierarchical data structures. ACM Computing Surveys 16:

Schwartz D A, Weis B, and Wilson S H 2005 The need for exposure health sciences. Environmental

Health Perspectives 113: A650

Silverman B W 1986 Density Estimation for Statistics and Data Analysis. London, Chapman and

Sweeney L 2002 k-anonymity: A model for protecting privacy. International Journal on Uncer-

tainty, Fuzziness and Knowledge-based Systems 10: 557–70

Tait M G 2005 Implementing geoportals: Applications of distributed GIS. Computers, Environ-

ment and Urban Systems 29: 33–47

Takatsuka M and Gahegan M 2002 GeoVISTA Studio: A codeless visual programming environ-
ment for geoscientiﬁc data analysis and visualization. Computers and Geosciences 28:
1131–44

Talbot T O, Kulldorff M, Forand S P, and Haley V B 2000 Evaluation of spatial ﬁlters to create

smoothed maps of health data. Statistics in Medicine 19: 2399–408

Teutsch S M 1992 A framework for assessing the effectiveness of disease and injury prevention.

Morbidity and Mortality Weekly Report 41: 1–12

Thacker S B, Stroup D F, Parrish R G, and Anderson H A 1996 Surveillance in environmental
public health: Issues, systems, and sources. American Journal of Public Health 86: 633
Theseira M 2002 Using Internet GIS technology for sharing health and health related data for the

West Midlands Region. Health and Place 8: 37–46

Tiwari C 2008 A Spatial Analysis System for Environmental Health Surveillance. Unpublished PhD

Dissertation, University of Iowa, Iowa City, Iowa

Tiwari C and Rushton G 2005 Using spatially adaptive ﬁlters to map late-stage colorectal cancer
incidence in Iowa. In Fisher P (ed) Developments in Spatial Data Handling. Berlin, Springer-
Verlag: 665–78

Tsou M and Buttenﬁeld B P 2002 A dynamic architecture for distributing geographic information

services. Transactions in GIS 6: 355–81

43–56

187–260

Hall

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

Spatial Analysis System for Health Surveillance

195

Tsou M H and Peng Z R 2003 Internet GIS: Distributed Geographic Information Services for the

Internet and Wireless Networks.New York, John Wiley and Sons

Vine M F, Degnan D, and Hanchette C 1998 Geographic Information Systems: Their use in

environmental epidemiological research. Environmental Health Perspectives 105: 598–605

Wakeﬁeld J C and Elliott P 1999 Issues in the statistical analysis of small area health data. Statistics

in Medicine 18: 2377–99

Waller L A and McMaster R B 1997 Incorporating indirect standardization in tests for disease

clustering in a GIS environment. Geographical Systems 4: 327–42

Walter S D 2000 Disease mapping: A historical perspective. In Elliott P, Wakeﬁeld J C, Best N G,
and Briggs D J (eds) Spatial Epidemiology: Methods and Applications. Oxford, Oxford
University Press: 223–39

Ward M H and Wartenberg D 2006 Invited commentary: On the road to improved exposure
assessment using Geographic Information Systems. American Journal of Epidemiology 164:
208–11

Ward M H, Nuckols J R, Giglierano J, Bonner M R, Wolter C, Airola M, Mix W, Colt J S, and
Hartge P 2005 Positional accuracy of two methods of geocoding. Epidemiology 16: 542
Wartenberg D, Uchrin C, and Coogan P 1991 Estimating exposure using Kriging: A simulation

study. Environmental Health Perspectives 94: 75–82

Whitelegg J 1986 The spatial patterning and supply of health services. In Pacione M (ed) Medical

Geography: Progress and Prospect. London, Croom Helm: 162–99

Yiannakoulias N, Karosas A, Schopﬂocher D P, Svenson L W, and Hodgson M J 2007 Using quad
trees to generate grid points for applications in geographic disease surveillance. Advances in
Disease Surveillance 3: 2

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(s1)

