Received: 16 August 2018‚ÄÉ |‚ÄÉ Revised: 18 December 2018‚ÄÉ |‚ÄÉ Accepted: 31 December 2018
DOI: 10.1111/tgis.12523

R E S E A R C H   A R T I C L E

A method for the extraction of partition lines 
from long and narrow patches that account for 
structural features

Chengming Li1,2,3‚ÄÉ|   Zhaoxin Dai1 ‚ÄÉ|   Yong Yin2‚ÄÉ|   Pengda Wu1

1Chinese Academy of Surveying and 
Mapping, Beijing, China

2Shandong University of Science and 
Technology, College of Geomatics, Qingdao, 
China

3Henan Polytechnic University, Jiaozuo, 
China

Correspondence
Zhaoxin Dai, Chinese Academy of Surveying 
and Mapping, 28 West Lianhuachi Road, 
Beijing 100830, China.
Email: daizx@lreis.ac.cn

Funding information
National Natural Science Foundation of 
China (Grant Number 41871375) and 
the National Key R&D Program of China 
(Grant Numbers 2016YFF0201301 and 
2016YFF0201305).

Abstract

The extraction of partition lines for long and narrow patches 

(LN patches) is an important yet difficult problem in the gen-

eralization  of  thematic  data.  When  current  methods  are 

used to process polygons with irregular shapes or complex 

branch  convergence  zones,  the  extracted  line  structural 

features tend to be inaccurate and topologically erroneous. 

In  this  article,  we  propose  an  improved  partition  lines 

 extraction algorithm of constrained Delaunay triangulation 

to counter these issues. The proposed method aims to main-

tain consistency between the extracted line structure char-

acteristics  and  the  actual  object  structure,  especially  for 

complex branch convergence zones. First, we describe three 

types of aggregation patterns (Type A, B, and C aggregation 

zones) that occur in partition line extractions for LN patches 

of complex branch convergence zones using Delaunay trian-

gulation. Then, a partition line extraction algorithm that ac-

counts for the direction between the edges of triangles and 

the  distance  of  nodes  in  aggregation  zones  is  proposed. 

Finally, we test our method for a dataset relating to Guizhou 

Province,  China.  Compared  with  the  current  method  that 

uses quantitative indicators and visualization, the results in-

dicate that our method not only has applicability for simple 

situations  but  also  is  superior  for  preserving  structural 

 features of complex branch convergence zones.

Transactions in GIS. 2019;1‚Äì16. 

wileyonlinelibrary.com/journal/tgis 

 ‚ÄÉ|‚ÄÉ 1

¬© 2019 John Wiley & Sons Ltd2‚ÄÉ |‚ÄÉ ‚ÄÉ‚ÄÇ

1‚ÄÉ| ‚ÄÉI NTRO D U C TI O N

Extracting  partition  lines  is  an  important  procedure  in  patch  dimensionality  reduction  and  patch  partitioning/

merging operations. The accuracy of this process is crucial for ensuring that the spatial characteristics of the patch 

data (i.e. full patch coverage without overlapping patches), and the areas of the various land‚Äêtype patches are not 

significantly altered by map generalizations (Ai & Liu, 2002; Jiang, Wu, & Wan, 2014). One of the most challenging 

aspects  of  partition  line  extraction  is  the  determination  of  partition  lines  in  long  and  narrow  (LN)  patches.  LN 

patches refer to long and narrow targets in thematic data, such as low‚Äêlevel road polygons, highways, and field 

ridges, or fine and long river polygons. Due to the shape features of LN patches, the boundaries of these patches 

are often jagged and irregular, which makes the extraction of partition lines from LN patches an especially difficult 

task. Therefore, the accurate and rational determination of partition lines in LN patches is currently a major chal-

lenge, and research on this aspect is important for the development of better‚Äêperforming partition line extraction 

methods (Ai, Yang, & Li, 2010).

The determination of partition lines in LN patches is based on the extraction of polygon skeletons. The three 

most  common  skeleton  extraction  (i.e.  skeletonization)  methods  are  medial  axis  skeletonization  (Lee,  1982), 

straight  skeletons  (Das,  Mukhopadhyay,  Nandy,  Patil,  &  Rao,  2010;  Tian,  Luo,  &  Hu,  2005),  and  constrained 

Delaunay  triangulation‚Äêbased  skeletonization  (Chen  &  Ai,  2004;  Sintunata  &  Aoki,  2016;  Wang  &  Yan,  2011). 

Partition line extraction via constrained Delaunay triangulation is typically performed due to its advantages of 

proximity, optimality, and convex polygons (Ware, Jones, & Bundy, 1997). Moreover, Delaunay triangulation con-

sists of more nodes and thus more triangles by encrypting the node distance, which can more easily adjust and 

capture microstructures and make the resulting split line smoother.

DeLucia and Black (1987) were the first researchers to propose a skeletonization method based on constrained 

Delaunay triangulation (CDT). Zou and Yan (2001) used this method to construct polygon skeletons, which pro-

vided evidence for the effectiveness of this method. In the method used by Li (2006), the skeleton nodes in a trian-

gle mesh were classified to facilitate polygon skeletonization via the tracking of its primary skeleton. This method 

provides an excellent reflection of the shape features and primary spread directions of map polygons. Penninga, 

Verbree, Quak, and van Oosterom (2005) noted that the direct extraction of skeleton lines with a boundary CDT 

suffers from at least the following three shortcomings: (1) the appearance of ‚Äúzigzagging‚Äù skeletons at junctions; 

(2) tiny bumps at the boundary that lead to extraneous ‚Äúspiked‚Äù skeleton lines; and (3) the stretching and offsetting 

of skeletons toward endpoints due to a lack of boundary nodes. To address these issues, Jones, Bundy, and Ware 

(1995), Uitermark, Vogels, and van Oosterom (1999), and Penninga et al. (2005) proposed corresponding solutions 

for the correction of CDT skeletons, such as the use of branch skeleton vectors, boundary simplification, and the 

insertion of boundary points. These methods have proved to be very successful in resolving the issues of CDT 

skeletonization. Morrison and Zou (2007) proposed an improved algorithm by inserting new triangulation points 

in strategic locations in end, normal, and junction triangles based on the work of Zou and Yan (2001). Shen, Wu, 

and Yang (2014) proposed an effective processing algorithm to improve the skeleton extraction efficiency for the 

more complex area features of a triangular network by establishing a binary tree structure for a triangle network. 

Yu (2017) generated an intracommunity roads skeleton between neighboring building footprints using Delaunay 

triangulation. Smogavec and ≈Ωalik (2012) presented a new algorithm to approximate a polygon's medial axis by 

inserting Steiner points that heuristically correct triangulation.

However, previous studies were typically intended for Delaunay triangulation of regions that contained only 

one or two adjacent Type III triangles (henceforth referred to as Type A aggregation zones). In complex patch data 

such as road (branch) convergence zones, a triangle mesh might contain multiple adjacent Type III triangles (i.e. a 

Type B aggregation zone) or Type III triangles with intervening Type II triangles (i.e. a Type C aggregation zone). 

When skeletonization is performed using the aforementioned methods, the internal structural features of Type B 

and Type C aggregation zones tend to become very vague, which subsequently results in the incorrect extraction 

LI et aL.‚ÄÉ‚ÄÇ ‚ÄÉ| ‚ÄÉ3

of structural features and topological errors. To address these issues, a constrained Delaunay triangulation‚Äêbased 

method for the extraction of partition lines in LN patches that accounts for structural features was proposed.

This article is organized as follows. Section 2 describes the methods that are currently available for the ex-

traction of partition lines from LN patches and the inadequacies of these methods in real applications. Section 

3 describes our Delaunay triangulation‚Äêbased method for the extraction of partition lines from LN patches, 

which properly accounts for structural features. The experimental validation of our method and the results 

of the validation experiments are discussed and analyzed in Section 4. Section 5 presents the discussion and 

conclusions.

2‚ÄÉ| ‚ÄÉR E L ATE D WO R K

2.1‚ÄÉ|‚ÄÉCurrent methods for the extraction of partition lines in LN patches

2.1.1‚ÄÉ|‚ÄÉThe principles of partition line extraction via constrained Delaunay triangulation

The extraction of partition lines from LN patches via CDT involves two steps, which are explained with the help 

of Figure 1 (Ai & Zhang, 2007).

Step 1: The LN patch is segmented using the construction of a constrained Delaunay triangle mesh. The tri-

angles of a Delaunay triangle mesh may be classified according to the number of neighboring triangles they have 

inside the polygon (Delucai & Black, 1987; Meijers, Savino, & van Oosterom, 2016).

Type I triangles: These triangles only have one adjacent triangle, and two of the edges that compose a Type I 

triangle are also the edges of a polygon. ‚ñ≥ABC in Figure 1a is an example of a Type I triangle, and vertex B is one 
of the endpoints of the skeleton.

Type II triangles: These triangles have two adjacent triangles, and they are the backbone structures that define 

skeleton extension. ‚ñ≥ABC in Figure 1b is an example of a Type II triangle. The direction of the skeleton is shown 
to be uniquely defined in Type II triangles.

Type III triangles: These triangles have three adjacent triangles, and they represent the intersection of skeleton 

branches. The origin of tri‚Äêdirectional skeleton extensions is located in these triangles. ‚ñ≥ABC in Figure 1c is an 
example of a Type III triangle that shows three directions of extension from point O.

Step 2: Axial lines are extracted from the three aforementioned types of triangles using the following meth-

ods; these lines are then connected to form a skeleton, and the edges shared by two adjacent triangles are called 

Type I triangles: The midpoint of the only adjacent edge in this triangle is connected to its corresponding ver-

adjacent edges.

tex (e.g. BD in Figure 1a).

Type II triangles: The midpoints of the two adjacent edges are connected (e.g. DF in Figure 1b).

(a)

A

E

D

(b)

G

A

F

D

(c)

G

A

E

E

F

D

O

B

C

H

I

B

C

B

C

F I G U R E   1 ‚ÄÉTriangle classification: (a) Type I triangle; (b) Type II triangle; and (c) Type III triangle

LI et aL.4‚ÄÉ |‚ÄÉ ‚ÄÉ‚ÄÇ

in Figure 1c).

Type III triangles: The center of gravity is connected to the midpoints of all three edges (e.g. OD, OF, and OH 

2.1.2‚ÄÉ|‚ÄÉCommon methods for the extraction of partition lines in LN patches

When CDT is used to extract the partition lines of LN patches, false triangles or zigzags will often manifest in the 

skeleton  around  branch  junctions.  Jones  et  al.  (1995)  proposed  a  ‚ÄúT‚Äù‚Äêshaped  connection  to  address  this  issue. 

When  there  is  only  one  Type  III  triangle  in  a  polygon,  this  triangle  is  modified  by  computing  the  directions  of 

its three associated skeleton branches, as shown in Figure 2. However, this method cannot be used in ‚Äú+‚Äù junc-

tions that contain two adjacent Type III triangles. In this case, Penninga et al. (2005) proposed that four skeleton 

branches should be connected to the midpoint of the shared edge of the two Type III triangles, thus producing a 

solution for the connection of branches in ‚Äú+‚Äù‚Äêshaped junctions, as shown in Figure 3.

2.2‚ÄÉ|‚ÄÉThe inadequacies of current methods in partition line extraction

When the partition lines of LN patches are extracted using Delaunay triangulation, it is possible to correct for top-

ological distortions in the patch boundaries of Type A aggregation zones, redundant skeletons in curved patches, 

and patch perturbations in branch junctions, using methods that are currently available in the literature. However, 

these methods cannot adequately handle complex Type B and Type C aggregation zones. The weaknesses of these 

methods are highlighted in the scenarios described below.

Type B aggregation zones (multiple adjacent Type III triangles in a triangle mesh): Figure 4a is a branch junction 

that consists of five branches: a, b, c, d, and e. The a‚Äìb and c‚Äìd pairs of skeletons have the same direction. Multiple 

L3

L4

L6

L5

L2

L1

L3

L5

L4

L2

L1

F I G U R E   2 ‚ÄÉSkeletonization of polygons that only have a single Type III triangle: (a) skeletonization based on 
conventional Delaunay triangulation; and (b) the ‚ÄúT‚Äù‚Äêshaped connection of Jones et al. (1995) based on Delaunay 
triangulation

(a)

(a)

(b)

(b)

F I G U R E   3 ‚ÄÉSkeletonization of polygons that contain two neighboring Type III triangles: (a) ‚ÄúT‚Äù‚Äêshaped 
connection; and (b) the ‚Äú+‚Äù‚Äêshaped connection of Penninga et al. (2005) based on a triangle mesh

LI et aL.‚ÄÉ‚ÄÇ ‚ÄÉ| ‚ÄÉ5

F I G U R E   4 ‚ÄÉThe results of partition line extraction from Type B and Type C aggregation zones using current 
methods: (a) Type B aggregation zone; and (b) Type C aggregation zone

adjacent Type III triangles will appear when a triangle mesh is constructed for this complex patch. The use of cur-

rent triangulation‚Äêbased methods to extract the partition lines of this patch will result in the skeletons shown in 

Figure 4a. A skeleton might not preserve the primary directions or structural features of the roads. Furthermore, 

false triangles are also observed in the skeleton junctions.

Type C aggregation zones (Type III triangles with intervening Type II triangles): The direction of a skeleton 

refers  to  its  primary  direction  of  extension.  A  skeleton  direction  is  usually  defined  by  the  nodes  of  Type  III 

triangles and their adjacent Type II triangles, in a fixed and stable manner. However, because Type III triangles 

are typically located in branch convergence zones, the directions formed by their adjacent Type II triangles in 

curved corners (especially when the distances between the edges of the Type II triangles are less than 0.4 mm) 

are  not  a  good  representation  of  the  branch  skeleton's  direction,  such  as  the  example  shown  in  Figure  4b. 

Consequently, the use of a current triangulation‚Äêbased method for partition line extraction in patches that have 

a large number of curves and irregular boundaries typically results in misidentification of the patch's primary 

extensions and internal structural features.

3‚ÄÉ| ‚ÄÉA  M E TH O D FO R TH E E X TR AC TI O N O F PA RTITI O N LI N E S FRO M  LN 
PATC H E S TH AT ACCO U NT S FO R  S TRU C T U R E  FE AT U R E S

The most important aspect of partition line extraction in LN patches is the preservation of the overall shape and 

internal structural features of the patch. In other words, the skeleton must extend linearly as a whole, and the 

consistency of the skeleton's shape and structure must be maintained in areas such as branch convergence zones. 

Therefore, we proposed a CDT‚Äêbased method of skeletonization that accounts for geometric and structural fea-

tures, to improve the extraction of partition lines.

The algorithm works in two primary steps. The first recognizes the long and narrow patches and generates 

original  skeletons  based  on  constrained  Delaunay  triangulation.  Next,  original  split  lines  are  heuristically  cor-

rected, primarily for branch convergence zones. The first step will not be described further here, but the details 

can be referenced in the study by DeLucia and Black (1987). In the second step, three phases are mentioned. First, 

the obtained Type III triangles are classified into three classes; then, the node aggregation zone is determined; 

finally, the nodes in aggregation zones are remodeled using such indices as length and angle of skeleton lines, thus 

heuristically correcting split lines to maintain object nature characteristics. The processes and flowchart of this 

algorithm are represented in Figure 5.

LI et aL.6‚ÄÉ |‚ÄÉ ‚ÄÉ‚ÄÇ

Recognize long and narrow 
patches 

Generate original skeletons 
based on CDT

Identifying Type III triangles

Type A aggregation zones
only one or two adjacent Type III triangles

Type B aggregation zones
multiple adjacent Type III triangles

Type C aggregation zones
Type III triangles with intervening Type II triangles

Part1: Generating original skeletons 
based on CDT

Total skeleton length in Type II 
triangles < 0.4mm

Determining node aggregation zones

Yes

Yes

Skeleton azimuth angle < Œ¥dir?

Connecting these two directional skeletons
Extending other skeletons to the connection line

Yes

Intersection nodes < 0.4mm?

No

Fitting intersection nodes into the 
nodes‚Äô center

Merging nodes into the geometric center of  
the aggregation zone
Extending other skeletons to this node 

Correcting split lines

Part2: Heuristically correcting original split lines, primarily for branch convergence zones

F I G U R E   5 ‚ÄÉFlowchart of our proposed method

3.1‚ÄÉ|‚ÄÉIdentification of Type III triangles

First, the Type III triangles contained in a triangle mesh are identified according to the previously defined clas-

sification of triangle types.

3.2‚ÄÉ|‚ÄÉThe determination of node aggregation zones

In triangle meshes that only contain one or two adjacent Type III triangles, the ‚Äúsuspended‚Äù nodes of the topologi-

cal structure are eliminated first. The node aggregation zone is then determined using all internal nodes within the 

intersection nodes of Type III triangles‚Äô boundaries and skeleton lines.

However, in complex branch convergence zones that either contain several adjacent Type III triangles (a dense 

distribution of nodes) or two Type III triangles that are far apart from each other (a scattered distribution of nodes), 

the length of the skeleton between each of the branch nodes is calculated to identify the node aggregation zone. 

Through training and experiments, we propose that: (i) if the internal skeleton of a Type II triangle between two 

branch  nodes  has  a  total  length  that  is  smaller  than  the  width  threshold  (0.4 mm),  then  these  nodes  form  an 

LI et aL.‚ÄÉ‚ÄÇ ‚ÄÉ| ‚ÄÉ7

aggregation zone (such as the skeleton between N1 and N2 of the Type C aggregation zone shown in Figure 4b); 
(ii) if there are adjacent branch nodes that meet the conditions for aggregation, then these nodes form an aggre-

gation  zone  and  all  of  these  nodes  (including  branch  nodes)  are  recorded  as  ‚Äújunction  remodeling‚Äù  nodes;  and 

(iii) if the internal skeleton of the Type II triangle between two branch nodes has a total length that is equal to or 

greater than 0.4 mm, then this skeleton describes a ground‚Äêobject structure that cannot be directly covered‚Äîit 

is therefore necessary to retain this skeleton (such as the skeleton between N1 and N3 in the Type C aggregation 
zone shown in Figure 4b).

The triangles in a triangulation network are all irregular, creating a boundary of polygons that are all different 

lengths. Additional nodes need to be added to encrypt the node density between adjacent nodes using a long‚Äêdis-

tance boundary. In this article, the node encryption distance D is introduced, which typically is defined as 0.4 mm 

or a multiple of 0.4 mm. When the boundary distance of adjacent nodes is greater than D, additional nodes will 

be  added  to  increase  the  node  density.  The  skeleton  lines  are  expected  to  be  smoother  using  this  procedure, 

especially  for  narrow  and  long  patches.  According  to  the  characteristics  of  actual  experimental  data,  1.6 mm 

(4 √ó 0.4 mm) is used in this study.

3.3‚ÄÉ|‚ÄÉNode remodeling in node aggregation zones

For the remodeling of aggregation zones, Haunert and Sester (2008) proposed the use of a direct aggregation 

method to process branch skeletons: if the linear extension of a skeleton intersects at a point, then this point is 

a remodeling node. This method is very effective for remodeling linearly extended branches that exhibit zigzag-

ging perturbations. However, the skeletons produced by this method tend to be excessively vague in describing a 

ground object's structural features, especially if the aggregation zone is intrinsically ‚Äúzigzagged‚Äù and morphologi-

cally complex. We address this issue by proposing the principle of directional consistency. Directional consistency 

is an important reference for judging whether a skeleton satisfies the rules of visual perception, but studies on 

this aspect are relatively scarce in the literature. We propose that a pair of skeleton lines in a node aggregation 

zone are directionally consistent if the azimuth angle between these skeletons differs by less than the direction 
threshold (ùúïdir) and their parallel separation is less than 0.4 mm; then, the two lines are deemed to be directionally 
the same (e.g. a‚Äìb and c‚Äìd in Figure 6a and L1‚ÄìL2 in Figure 6b). According to the actual experimental data and 

multiple threshold tests, this value is set at 5¬∞ in this article.

The following methods are proposed to remodel the nodes of aggregation zones, in accordance with the direc-

tional features of skeletons associated with the nodes of aggregation zones:

F I G U R E   6 ‚ÄÉThe extraction of partition lines from Type B and Type C aggregation zones using our method: (a) 
Type B aggregation zone; and (b) Type C aggregation zone

LI et aL.8‚ÄÉ |‚ÄÉ ‚ÄÉ‚ÄÇ

1.  If  a  pair  of  skeletons  are  directionally  consistent,  then  the  connection  of  these  skeletons  to  form  a 

straight  line  will  be  prioritized;  the  remaining  skeletons  will  extend  up  to  this  straight  line  along  their 

individual  extensions.  However,  if  an  aggregation  zone  is  sufficiently  wide,  the  extensions  of  each  branch 

skeleton  may  not  intersect  at  a  single  point;  in  this  case,  it  is  necessary  to  reaggregate  extension  line 

nodes  that  are  relatively  near  each  other.  This  process  is  as  follows:  if  the  distance  between  two  nodes 

is  smaller  than  the  minimum  width  threshold  (0.4 mm),  then  these  nodes  are  replaced  by  a  node  whose 

position  on  the  horizontal  coordinate  is  the  average  of  both  nodes  (e.g.  point  O  in  the  Type  B  and  Type 

C  aggregation  zones  shown  in  Figure  6).  If  the  distance  between  two  nodes  is  larger  than  the  minimum 

width  threshold,  then  these  nodes  do  not  have  to  be  remodeled  and  their  associated  branch  structures 

are  preserved.

2.  If a pair of skeletons are not directionally consistent, then the Euclidean distance between their nodes is used as 

a similarity index. The geometric center of this area is then merged with the ‚Äújunction remodeling‚Äù node defined 

in Section 3.2, whereas the remaining skeletons will extend along their own extensions and connect with the 

merged node (e.g. skeleton e in the Type B aggregation zone shown in Figure 6).

When the skeletons were extended, it was found that some branch convergence zones contain a large number 

of boundary nodes, leading to a dense distribution of Type II triangles whose polygon boundary edges are very small. 

Generally, they are less than the node encryption distance (D). If a skeleton's line length in Type II triangles was less 
than the threshold distance (ùúïdis), it was recognized and categorized as a curved skeleton. The distance threshold in 
this article is set at 1/4D.

For any Type III triangle, the Type II triangles connected to it are recognized through adjacency relations, and the 

azimuth angle (Ai) and length (Li) of their internal skeletons are then computed sequentially. If the internal skeleton 
of a Type II triangle has a length shorter than ùúïdis (Li < ùúïdis), then this triangle is ‚Äúfiltered‚Äù (such as points P1 and P2 in 
Figure 7); this process continues until four triangles are obtained whose skeletons are directionally consistent with Li 
‚â• ùúïdis; the direction of the skeleton is then defined by these internal skeletons (the direction of arc segments formed 
by P3, P4, P5, P6, and P7 in Figure 7, with P3 representing the starting node of the direction). If four triangles that can 
be used to determine the direction of the skeleton cannot be found after a certain number of Type II triangles have 

been computed, then it is implied that this particular branch skeleton has a large curvature. In this case, the direction 

of the skeleton is defined by the internal skeletons of the four Type II triangles that are closest to the Type III triangle.

Figure  6  illustrates  the  skeletons  of  Type  B  and  Type  C  aggregation  zones  that  were  extracted  using  our 

method. Red dashed lines are a repeat of the extraction results from Figure 4. A visual inspection quickly reveals 

F I G U R E   7 ‚ÄÉDetermination of skeleton direction

LI et aL.that the extracted skeleton is consistent with the structural features of junction areas, and the linear extension 

of each branch skeleton has been preserved in the final skeleton. Our method is therefore superior to currently 

existing methods in the extraction of partition lines from branch convergence zones.

‚ÄÉ‚ÄÇ ‚ÄÉ| ‚ÄÉ9

4‚ÄÉ| ‚ÄÉE X PE R I M E NT S A N D R E S U LT S A N A LYS I S

Our CDT‚Äêbased method for the extraction of partition lines from LN patches was embedded into the WJ‚ÄêIII map-

ping  workstation  developed  by  the  Chinese  Academy  of  Surveying  and  Mapping.  The  OpenMP  interface  was 

used in a C++ environment to perform the extraction of partition lines from national geographic conditions data, 

to  validate  the  rationality  and  effectiveness  of  the  method  proposed  in  this  article.  The  validation  experiment 

was performed using road data from a county in Guizhou Province (Figure 8) that was derived from national geo-

graphic conditions data, with an original scale of 1:10,000. The target scale of the generalization was 1:100,000. 

The experimental environment operates using a Microsoft Windows 7 64‚Äêbit operating system, equipped with 

an 8‚Äêthread quad‚Äêcore Intel Core i7‚Äê4790 CPU, 16 GB of RAM, and a 1,024 GB solid‚Äêstate drive.

To verify the accuracy of the proposed method, indices of graph complexity, node counts (NC), number of 

arcs connected to nodes (AN), and split line complexity, which can reflect the generalization level and structural 

features  of  extracted  partition  lines,  are  selected  and  used  to  create  a  quantitative  comparison  to  traditional 

F I G U R E   8 ‚ÄÉExperiment area

LI et aL.10‚ÄÉ |‚ÄÉ ‚ÄÉ‚ÄÇ

F I G U R E   9 ‚ÄÉQuantitative indices for comparison analysis. (a) Traditional method (b) our method

methods. As shown in Figure 9, in creating a buffer for the convergence area (red dashed circle), NC are the nodes 

in green, which are the intersection of more than two arcs in the buffer zone. AN are the arc numbers that connect 

to NC (red color), the value of which is 5 in Figure 9a and 4 in Figure 9b. Line complexity is performed using two 

indices, one being all joint counts (JC) in the aggregation zones (black and green points in Figure 9) and the other 

being the total length of all arcs connected by these joints (Arclength). The larger the two indices, the more complex 
the partition line.

Regarding the graph's complexity, there are 1,505 areas of the experimental region that contain Type III tri-

angles, and 1,368 of these areas (91%) contain Type III triangles that only have one or two neighboring Type III 

triangles (i.e. Type A aggregation zones). There are only two branch convergence patches that contain multiple 

neighboring Type III triangles (i.e. Type B aggregation zones), and there are 135 (9%) branch convergence patches 

that contain Type III triangles with intervening Type II triangles (i.e. Type C aggregation zones).

4.1‚ÄÉ|‚ÄÉGeneralizability analyses

Type A aggregation zones are often encountered during the extraction of partition lines from roads. To quantita-

tively validate the generalizability of our method, node counts, arc number, and split line complexity of partition 

lines  for  Type  A  aggregation  zones  extracted  using  our  method  for  road  data  were  compared  with  traditional 

methods, as illustrated in Table 1. For any pattern of Type A aggregation zones, the differences in node counts, 

arc number, and split line complexity of partition lines in our method and the traditional method are very small, 

with values that are approximately zero. This suggests that our method is generally applicable for the extraction of 

partition lines from the LN patches of Type A aggregation zones. For split line complexity, the values of both joint 

counts and Arclength in our method are smaller, indicating that the partition lines extracted by our method perform 
more smoothly and explicitly than the current method.

Three patches in the experimental area that represent three different partition line extraction scenarios are 

selected to verify the generalizability of our method for the extraction of partition lines from Type A aggregation 

zones. As shown in Figure 8, the partition lines that were extracted from the experimental area using our method 

are indicated by black lines, whereas the lines that were extracted using current methods are indicated by red 

dotted lines in the inserts.

The partition lines extracted from Type A aggregation zones (Figure 10) using our method are an excellent 

reflection of the extension and spatial features of the road network. Furthermore, transitions in ‚Äújitter‚Äù regions, 

T‚Äêjunctions, and ‚Äú+‚Äù‚Äêjunctions (as shown in the inserts) are smooth and free from redundant ‚Äúsuspended‚Äù nodes. 

Hence, the general structure of the road network has been neatly and accurately summarized by the partition 

lines of our method. By comparing our results with those produced using current methods (the red dotted lines 

LI et aL.‚ÄÉ‚ÄÇ ‚ÄÉ| ‚ÄÉ11

 
 

y
t
i

x
e

l

p
m
o
c
 
e
n

i

L

)

h
t
g
n
e

l

c
r
A
/
C
J
(

,

.

3
3
1
0
5
/
2
7
2
1

,

,

.

1
2
9
8
9
1
/
4
9
0
5

,

,

.

7
6
4
3
3
/
7
5
5

4
8
4
2

,

0
6
2

6
7
6

8
2
8

5
6

0

 
 

y
t
i

x
e

l

p
m
o
c
 
e
n

i

L

)

h
t
g
n
e

l

c
r
A
/
C
J
(

,

.

3
3
1
0
5
/
2
7
2
1

,

,

.

7
1
5
5
9
1
/
6
6
9
4

,

,

.

2
1
7
0
3
/
0
2
5

3
8
4
2

,

0
6
2

6
7
6

.

o
n
 
c
r
A

s
t
n
u
o
c
 
e
d
o
N

.

o
n
 
c
r
A

s
t
n
u
o
c
 
e
d
o
N

n
r
e
t
t
a
P

 

A
e
p
y
T

8
2
8

5
6

0

n
o
i
t
c
n
u
j
‚Äê
‚Äù
T
‚Äú

i

n
o
g
e
r
 
r
e
t
t
i
J

e

l

g
n
a

i
r
t
 
I
I
I
 
e
p
y
T
e
n
O

 

n
o
i
t
c
n
u
j
‚Äê
‚Äù
+
‚Äú

 
I
I
I
 
e
p
y
T
 
t
n
e
c
a
d
a
 
o
w
T

j

s
e

l

g
n
a

i
r
t

d
o
h
t
e
m

 
l

a
n
o
i
t
i
d
a
r
T

 

d
o
h
t
e
m
d
e
s
o
p
o
r
P

e
n
o
z
 
n
o
i
t
a
g
e
r
g
g
a
 
A
e
p
y
T
 
r
o
f
 
d
o
h
t
e
m

 

 
l

a
n
o
i
t
i
d
a
r
t
 
a
 
d
n
a
 
d
o
h
t
e
m

 

 
r
u
o
 
f
o
y
r
a
m
m
u
s
 
s
e
c
i
d
n

i
 

e
v

i
t
a
t
i
t
n
a
u
Q
‚ÄÉ
1

 

E
L
B
A
T

LI et aL.12‚ÄÉ |‚ÄÉ ‚ÄÉ‚ÄÇ

in the inserts), it was found that our method performs better than these methods for roads that exhibit a degree 

of complexity. In summary, our method is generally applicable for the extraction of partition lines from the LN 

F I G U R E   1 0 ‚ÄÉGeneralizability analysis

patches of Type A aggregation zones.

4.2‚ÄÉ|‚ÄÉSuperiority analyses

Table 2 presents the summaries of node counts, arc number, and split line complexity of the partition lines for 

Type B and Type C aggregation zones. Unlike Type A aggregation zones, the node counts, arc number, and split line 

complexity of partition lines in our method are significantly smaller than for traditional methods. Within the length 

threshold, the nodes of split lines in aggregation zones are more likely to be aggregated to maintain the nature of 

objects and make an explicit generalization performance using our method. Similarly, the values in line complex-

ity extracted using our method are all smaller than those in the current methods, also proving that the partition 

lines extracted using our method are smoother and more distinguishable. One caveat worth noting is that the arc 

number in our method is very similar to the number of the road bifurcation intersection. Again, the partition lines 

extracted using our method can capture the natural structural characteristics of the objects.

Two  scenarios  from  the  national  geographic  conditions  data  were  selected  to  verify  the  superiority  of  our 

method in qualitatively preserving the spatial structures and topological relationships of ground objects in com-

plex branch convergence zones. During the process in which our method was used to extract partition lines from 

the experimental data, the LN patches were segmented via CDT, and the boundary nodes were densified accord-

ing to a certain distance. The length threshold for the remodeling of aggregation zone nodes was set at 0.4 mm.

The features of the area shown in Case 1 are as follow: (1) the node aggregation zone is a typical Type B aggre-

gation zone with multiple adjacent Type III triangles in the triangle mesh; and (2) there are two roads in the branch 

junction that are directionally consistent with each other. These features are shown in the insert to Figure 11a.

LI et aL.‚ÄÉ‚ÄÇ ‚ÄÉ| ‚ÄÉ13

 
 

y
t
i

x
e

l

p
m
o
c
 
e
n

i

L

)

h
t
g
n
e

l

c
r
A
/
C
J
(

.

3
7
0
1
/
1
3

2

.

8
8
2
/
3
2

,

.

6
0
5
3
0
1
/
7
4
5
3

,

7

7

0
9
6

3

3

7
7
2

 
 

y
t
i

x
e

l

p
m
o
c
 
e
n

i

L

)

h
t
g
n
e

l

c
r
A
/
C
J
(

.

4
7
6
/
0
1

.

7
0
5
2
/
0
1

,

.

4
5
0
1
7
/
2
8
4
1

,

5

5

8
4
5

1

1

5
3
1

5

5

8
4
5

 

1
B
e
p
y
T

 

2
B
e
p
y
T

 

C
e
p
y
T

.

o
n
 
c
r
A

s
t
n
u
o
c
 
e
d
o
N

.

o
n
 
c
r
A

s
t
n
u
o
c
 
e
d
o
N

 

r
e
b
m
u
n
n
o
i
t
a
c
r
u
f
i
B

.
)

 

 

2
B
e
p
y
T
d
n
a
 
1
B
e
p
y
T

 

(
 

l

 

 

m
e
h
t
 
f
o
h
t
o
b
 
s
t
n
e
s
e
r
p
e
b
a
t
 
s
i
h
t
 
;
s
e
n
o
z
 
n
o
i
t
a
g
e
r
g
g
a
 
B
e
p
y
T
n
a
t
n
o
c
 
t
a
h
t
 
s
e
h
c
t
a
p
e
c
n
e
g
r
e
v
n
o
c
 
h
c
n
a
r
b
o
w

 

 

 

 

i

l

 

t
 
y
n
o
e
r
a
 
e
r
e
h
T

 
.

e
t
o
N

d
o
h
t
e
m

 
l

a
n
o
i
t
i
d
a
r
T

 

d
o
h
t
e
m
d
e
s
o
p
o
r
P

 

s
e
n
o
z
 
n
o
i
t
a
g
e
r
g
g
a
 
C
d
n
a
 
B
e
p
y
T
 
r
o
f
 
d
o
h
t
e
m

 

 
l

a
n
o
i
t
i
d
a
r
t
 
a
 
d
n
a
 
d
o
h
t
e
m

 

 
r
u
o
 
f
o
y
r
a
m
m
u
s
 
s
e
c
i
d
n

i
 

e
v

i
t
a
t
i
t
n
a
u
Q
‚ÄÉ
2

 

E
L
B
A
T

LI et aL.14‚ÄÉ |‚ÄÉ ‚ÄÉ‚ÄÇ

F I G U R E   1 1 ‚ÄÉCase 1: Type B aggregation zone with directionally consistent skeletons. (a) Original skeleton 
lines (b) Intermediate result of our method (c) Final skeletons

First, it was determined that the skeletons of roads a and e are separated by a distance greater than 0.4 mm 

(Figure 11a). This indicates that the rectangle contains two aggregation zones that must be processed separately. 

The junction of roads d, f, and e is ‚ÄúT‚Äù‚Äêshaped and thus relatively straightforward to process; the processing of this 

junction is therefore omitted from discussion. In the junction of roads a, b, c, f, and g, the structure of the skeleton 

of road f is preserved. Because roads a and b are directionally consistent, their skeletons connect to form a straight 

line, and directional consistency is prioritized in our method. The branch skeletons of roads c, f, and g are then 

extended to this straight line. The resulting partition lines are shown in Figure 11b. Nodes A and B in the insert 

to Figure 11b are separated by a length greater than 0.4 mm on the map, whereas the distance between A and C 

is smaller than 0.4 mm. A and C are therefore merged, whereas the A‚ÄìB structure is retained. The final partition 

lines are shown in Figure 11c.

The features of the area shown in Case 2 are as follows: (1) the node aggregation zone is a typical Type C ag-

gregation zone that contains multiple Type III triangles separated by Type II triangles, and the total length of the 

Type II triangles is smaller than 0.4 mm; and (2) the branching roads from the road junction shown in the insert 

to Figure 12a are not directionally consistent. The features of Case 2 are illustrated in the insert to Figure 12a.

Because  the  branches  are  not  directionally  consistent,  it  is  very  difficult  to  ensure  that  the  branches  will 

converge at the same node if skeleton extension‚Äêbased methods for junction aggregation and reconstitution are 

F I G U R E   1 2 ‚ÄÉCase 2: Type C aggregation zone without directionally consistent skeletons. (a) Original skeleton 
lines (b) Intermediate result of our method (c) Final skeletons

LI et aL.used, as shown in Figure 12b. In our method, all the nodes in the area are first remodeled and merged into a single 

geometric center. The remodeled node (i.e. the geometric center) is then connected to the branch skeletons to 

obtain the partition lines of this branch convergence zone, as shown in Figure 12c. The skeletons in this scenario 

are shown to be correctly remodeled using our method. However, this procedure also induces minor perturbations 

in the skeletons in this area, which must be addressed in future work.

‚ÄÉ‚ÄÇ ‚ÄÉ| ‚ÄÉ15

5‚ÄÉ| ‚ÄÉCO N C LU S I O N S

The extraction of partition lines from LN patches is an important yet challenging issue for the generalization of 

thematic land‚Äêuse data. The partition lines extracted from these data must be geometrically natural and smooth, 

structurally compatible with the rules of visual perception, and consistent with the topological features of the 

data.  The  methods  that  are  currently  available  for  this  purpose  are  more  than  adequate  for  the  extraction  of 

partition lines from morphologically regular and simple patches. However, the data of roads and river systems 

often includes complex junctions and winding sections; the use of current methods for partition line extraction 

in these cases often leads to errors in the extraction of structural features or the appearance of ‚Äújuts and spikes.‚Äù 

To resolve these issues, a CDT‚Äêbased method for the extraction of partition lines from LN patches that accounts 

for structural features was proposed. In this method, the partition lines that are extracted via CDT are adjusted 

according to the principles of directional consistency and distance factors, to eliminate morphological perturba-

tions, structural deviations, and topological inconsistencies in the extracted skeletons. Our method was validated 

experimentally using patch data that was quantitatively and visually derived from actual national geographic con-

ditions. The following conclusions were drawn from an analysis of the experimental results.

1.  Our  method  is  generally  applicable  for  the  extraction  of  partition  lines  from  morphologically  regular  LN 

patches  (i.e.  patches  that  only  contain  one  or  two  adjacent  Type  III  triangles).  The  differences  in  node 

counts  and  arc  number  of  partition  lines  in  our  method  and  traditional  methods  are  approximately  zero, 

whereas  the  value  of  split  line  complexity  in  our  method  is  smaller.  The  partition  lines  extracted  using 

our  method  are  similar  to  those  extracted  using  currently  available  methods.  Thus,  our  method  performed 

better  for  roads  that  exhibit  mild  irregularities  in  shape.

2.  The partition lines of our method have successfully preserved the structural features and topological consist-

ency of LN patches which contain irregular or complex branch convergence zones. For Type B and Type C nodes, 

node counts, arc number of partition lines, and line complexity in our method are significantly smaller than in 

traditional methods, indicating that the partition lines extracted using our method are smoother and more dis-

tinguishable. The lines extracted using our method are proven to be consistent with human visual perception of 

ground objects using visual comparison analysis.

The threshold distance for boundary node densification plays an extremely important role in preventing offsets 

in the skeleton of polygon boundaries, and the computation of skeleton directions in branch convergence zones. In 

future research, we will investigate the selection of threshold distances for the densification of polygon boundary 

nodes, using a geometrically diverse set of polygons, in a variety of regions. In addition, we will also optimize the ex-

traction of partition lines from directionally ambiguous patches (e.g. overpasses and roundabouts).

O R C I D

Zhaoxin Dai 

 https://orcid.org/0000‚Äê0001‚Äê8194‚Äê9530 

LI et aL.16‚ÄÉ |‚ÄÉ ‚ÄÉ‚ÄÇ

R E F E R E N C E S

Ai, T. H., & Liu, Y. L. (2002). Aggregation and amalgamation in land‚Äêuse data generalization. Geomatics and Information 

Science of Wuhan University, 27(5), 486‚Äì492.

Ai,  T.  H.,  Yang,  F.,  &  Li,  J.  Z.  (2010).  Land‚Äêuse  data  generalization  for  the  database  construction  of  the  Second  Land 

Resource Survey. Geomatics & Information Science of Wuhan University, 35(8), 887‚Äì891.

Ai, T. H., & Zhang, X. (2007). The aggregation of urban building clusters based on the skeleton partitioning of gap space. 
In S. I. Fabrikant & M. Wachowicz (Eds.), The European information society: Leading the way with geo‚Äêinformation (pp. 
153‚Äì170). Berlin, Germany: Springer.

Chen, T., & Ai, T. H. (2004). Automatic extraction of skeleton and center of area feature. Geomatics & Information Science 

of Wuhan University, 29(5), 443‚Äì446.

Das, G. K., Mukhopadhyay, A., Nandy, S. C., Patil, S., & Rao, S. V. (2010). Computing the straight skeleton of a monotone 
polygon  in  O(nlogn)  time.  In  Proceedings  of  the  22nd  Annual  Canadian  Conference  on  Computational  Geometry  (pp. 
207‚Äì210). Winnipeg, Manitoba, Canada.

DeLucia, A. A., & Black, R. T. (1987). A comprehensive approach to automatic feature generalization. In Proceedings of the 

International Cartographic Conference. Mexico City, Mexico.

Haunert, J. H., & Sester, M. (2008). Area collapse and road centerlines based on straight skeletons. GeoInformatica, 12(2), 

169‚Äì191. https://doi.org/10.1007/s10707‚Äê007‚Äê0028‚Äêx

Jiang, B. D., Wu, X. C., & Wan, L. (2014). Consistency correction for long and narrow polygon dimension‚Äêreducing gener-

alization in land‚Äêuse. Science of Surveying & Mapping, 39(12), 116‚Äì119.

Jones, C. B., Bundy, G. L., & Ware, M. J. (1995). Map  generalization with a triangulated data structure. Cartography & 

Geographic Information Systems, 22(4), 317‚Äì331.

Lee, D. T. (1982). Medial axis transformation of a planar shape. IEEE Transactions on Pattern Analysis & Machine Intelligence, 

4, 363‚Äì369. https://doi.org/10.1109/TPAMI.1982.4767267

Li, Z. L. (2006). Algorithmic foundation of multi‚Äêscale spatial representation. Boca Raton, FL: CRC Press.
Meijers, M., Savino, S., & van Oosterom, P. (2016). SPLITAREA: An algorithm for weighted splitting of faces in the context 

of a planar partition. International Journal of Geographical Information Science, 30, 1522‚Äì1551.

Morrison, P., & Zou, J. J. (2007). Triangle refinement in a constrained Delaunay triangulation skeleton. Pattern Recognition, 

40, 2754‚Äì2765. https://doi.org/10.1016/j.patcog.2006.12.021

Penninga, F., Verbree, E., Quak, W., & van Oosterom, P. (2005). Construction of the planar partition postal code map 

based on cadastral registration. GeoInformatica, 9(2), 181‚Äì204. https://doi.org/10.1007/s10707‚Äê005‚Äê6430‚Äê3

Shen,  L.  H.,  Wu,  B.  G.,  &  Yang,  N.  (2014).  Areal  feature  main  skeleton  extraction  algorithm.  Geomatics  &  Information 

Science of Wuhan University, 39(7), 767‚Äì771.

Sintunata, V., & Aoki, T. (2016). Skeleton extraction in cluttered image based on Delaunay triangulation. In Proceedings of 

the 2016 IEEE International Symposium on Multimedia (pp. 365‚Äì366). San Jose, CA: IEEE.

Smogavec, G., & ≈Ωalik, B. (2012). A fast algorithm for constructing approximate medial axis of polygons, using Steiner 

points. Advances in Engineering Software, 52, 1‚Äì9. https://doi.org/10.1016/j.advengsoft.2012.05.006

Tian, Q. M., Luo, Y. P., & Hu, D. C. (2005). Rounder straight skeleton and its implementation. Journal of Computer‚ÄêAided 

Design & Computer Graphics, 17(12), 2642‚Äì2646.

Uitermark, H., Vogels, A., & van Oosterom, P. (1999). Semantic and geometric aspects of integrating road networks. In 
M. F. Goodchild, M. J. Egenhofer, R. Fegeas, & C. Kottman (Eds.), Interoperating geographic information systems (pp. 
177‚Äì188). Berlin, Germany: Springer.

Wang, Z. H., & Yan, H. W. (2011). Design and implementation of an algorithm for extracting the main skeleton lines of 

polygons. Geography & Geo‚ÄêInformation Science, 27(1), 42‚Äì44, 48.

Ware,  J.  M.,  Jones,  C.  B.,  &  Bundy,  G.  L.  (1997).  A  triangulated  spatial  model  for  cartographic  generalization  of  areal 
objects. In M. J. Kraak & M. Molenaar (Eds.), Advances in GIS research II (7th International Symposium on Spatial Data 
Handling) (pp. 173‚Äì192). London, UK: Taylor & Francis.

Yu, W. (2017). Assessing the implications of the recent community opening policy on the street centrality in China: A 
GIS‚Äêbased method and case study. Applied Geography, 89, 61‚Äì76. https://doi.org/10.1016/j.apgeog.2017.10.008
Zou,  J.  J.,  &  Yan,  H.  (2001).  Skeletonization  of  ribbon‚Äêlike  shapes  based  on  regularity  and  singularity  analyses.  IEEE 
Transactions on Systems, Man, & Cybernetics, Part B (Cybernetics), 31(3), 401‚Äì407. https://doi.org/10.1109/3477.931528

How to cite this article: Li C, Dai Z, Yin Y, Wu P. A method for the extraction of partition lines from long 

and narrow patches that account for structural features. Transactions in GIS. 2019;00:1‚Äì16. https://doi.

org/10.1111/tgis.12523

LI et aL.