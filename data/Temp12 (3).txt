G   E   O   M   A   T   I   C   A

                                       DEM FUSION OF ELEVATION REST API
                   DATA IN SUPPORT OF RAPID FLOOD 
                   MODELLING

                                                  H. McGrath1, E. Stefanakis1, M. Nastev2
                                                  
                                                  1University of New Brunswick, Fredericton, Canada
                                                  2Natural Resources Canada, Geological Survey of Canada, Quebec City, Canada
                                                  

Digital elevation models (DEM) are an integral part of flood modelling. High resolution DEM data are
not always available or affordable for communities, thus other elevation data sources are explored. While
the  accuracy  of  some  of  these  sources  has  been  rigorously  tested  (e.g.,  SRTM,  ASTER),  others,  such  as
Natural Resources Canada’s Canadian Digital Elevation Model (CDEM) and Google and Bings’ Elevation
REST APIs, have not yet been properly evaluated. Details pertaining to acquisition source and accuracy are
often unreported for APIs. To include these data in geospatial applications and test and reduce uncertainty,
data fusion is explored. Thus, this paper introduces a new method of elevation data fusion. The novel method
incorporates clustering and inverse distance weighting (IDW) concepts in the computation of a new fusion
elevation surface. The results of the individual DEMs and fusion DEMs are compared to high-resolution
Light  Detection  and  Ranging  (LiDAR)  surface  and  flood  inundation  maps  for  two  study  areas  in
New Brunswick. Comparison of individual surfaces to LiDAR find that the results meet their posted accuracy
specifications,  with  the  Bing  data  computing  the  smallest  mean  bias  and  the  CDEM  the  smallest  RMSE.
Fusion of all three surfaces via the proposed method increases the correlation and minimizes both RMSE
and mean bias when compared to LiDAR, independent of the terrain, thus producing a more accurate DEM.

Les modèles numériques d’altitudes (MNA) font partie intégrante de la modélisation des inondations.
Les données MNA à haute résolution ne sont pas toujours disponibles ou abordables pour les collectivités
et ainsi d’autres sources de données altimétriques sont examinées. Bien que la précision de certaines de ces
sources ait été rigoureusement vérifiée (p. ex., SRTM, ASTER), d’autres, telles que les API REST du modèle
numérique d’élévation du Canada (MNÉC) de Ressources naturelles Canada et les API REST d’élévations
de  Google  et  Bing,  n’ont  pas  encore  été  correctement  évaluées.  Les  détails  concernant  la  source
d’ac qui si tion  et  la  précision  sont  souvent  non  publiés  pour  les  API.  Pour  inclure  ces  données  dans  les
appli cations  géospa tiales  afin  d’évaluer  l’incertitude  et  la  réduire,  la  fusion  des  données  est  examinée.
Ainsi, cet article présente une nouvelle méthode de fusion des données altimétriques. La nouvelle méthode
intègre les con cepts de partitionnement des données et de pondération inverse à la distance (PID) dans le
calcul  d’une  nouvelle  surface  altimétrique  fusionnée.  Les  résultats  des  MNA  individuels  et  des  MNA
fusion nés  sont  com parés  à  une  surface  LiDAR  (détection  et  télémétrie  par  ondes  lumineuses)  à  haute
réso lu tion et aux cartes des inondations pour deux zones d’étude au Nouveau-Brunswick. La comparaison
des surfaces indi viduelles avec celle du LiDAR conclut que les résultats respectent leurs spécifications de
précision affichées, les données de Bing calculant les plus petits biais moyens et le MNÉC les plus petits
écarts  types.  La  fusion  des  trois  surfaces  au  moyen  de  la  méthode  proposée  augmente  la  corrélation  et
min imise  l’écart  type  et  le  biais  moyen  lorsqu’on  la  compare  au  LiDAR,  indépendamment  du  terrain,
pro duisant ainsi un MNA plus précis.

H. McGrath
Heather.McGrath
@unb.ca

Emmanuel
Stefanakis
estef@unb.ca

1. Introduction

DEMs are an integral part of flood modelling
[Cook  and  Merwade 2009].  Using  the  best  avail-
able  elevation  data  is  advised,  as  DEM  resolution
and  accuracy  are  the  main  properties  that  affect
hydraulic and hydrologic modelling results [Vaze et
al.  2010].  Flood  modelling  therefore  typically

involves  high  resolution,  e.g.  1 m  or  less,  LiDAR
elevation  data.  While  LiDAR  data  is  increasingly
popular, it is still costly to acquire and computation-
ally  expensive  [Hummel  et  al.  2011].  Many  larger
communities  in  Canada  have  budgeted  for  the
expense and invested in a LiDAR dataset; however,

M. Nastev

                                                                                              dx.doi.org/10.5623/cig2016-402

GEOMATICA  Vol. 70, No. 4, 2016, pp. 283 to 297

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.G   E   O   M   A   T   I   C   A

this  is  not  feasible  for  all  communities.  In  lieu  of
high  resolution  elevation  data,  coarser  and  freely
available  datasets  are  investigated  for  rapid  flood
modelling.

Currently there are several providers of online
elevation  data  with  varying  levels  of  coverage,
spa tial  resolution  and  accuracy.  For  example,
Shuttle  Radar  Topography  Mission  (SRTM)
(lta.cr.usgs.gov/SRTM), ASTER (asterweb.jpl.nasa.
gov/gdem.asp),  Google  (developers.google.com)
and  Bing  (msdn.microsoft.com)  offer  global
cov er age.  Natural  Resources  Canada  (NRCan)
offers the CDEM, a Canada-wide elevation dataset
(geogratis.gc.ca).  At  the  provincial  level,  several
provinces provide access to elevation data, and at a
micro  level,  some  municipalities  have  acquired
LiDAR  data  and  enable  online  access  to  it.
Consequently,  multiple  datasets  covering  a  single
ter rain area exist; however, details pertaining to accu-
ra cy, acquisition source or technology and collection
date vary amongst them and, in some cases, are not
clearly documented [Buckley and Mitchell 2004]. 
While  the  accuracy  of  SRTM,  ASTER  and
Cartosat-1  are  well  documented  [Mangoua  and
Goïta 2008;  Mukherjee  et  al. 2013;  Patel  et  al.
2016; etc.], the reliability and accuracy of elevation
data  available  from  REST  APIs,  specifically
Google and Bing, for uses other than purely recre-
ation,  are  not.  Representational  State  Transfer
(REST) is an architectural style for designing net-
worked applications [Masse 2011]. An application
program interface (API) “exposes a set of data and
functions  to  facilitate  interactions  between  com-
put er programs” and allows for exchange of infor-
mation [Masse 2011]. If an API conforms to REST
architectural style and guidelines, it is considered a
REST API.  Though  readily  available  and  easy  to
use, there are certain limitations to these API serv-
ices,  including:  source  data  are  often  not  clearly
documented; resolution is not clearly reported; and
the interpolation method applied for the calculation
is  unknown  [Stefanakis 2015].  For  example,  the
Google  Elevation API  (developers.google.com) is
said  to  be  comprised  of  data  from  hundreds  of
providers  and  is  stitched  together  to  provide  the
best  level  of  coverage  available  [Thor 2010].
Recognizing  these  limitations,  there  are  several
advantages  to  inclusion  of  these  data  in  the  flood
modelling process: (1) utilization of REST services
is  convenient  and  powerful,  as  there  is  simple,
machine  readable  data  access  available  through  a
lightweight solution accessed via a URL; (2) data
are processed on the providers’ server; and (3) the
data  are  returned  in  a  well-formatted  document

(JSON  or  XML).  The  consistency  in  the  returned
data,  the  ease  of  access  and  speed  of  data
acqui si tion  combine  to  make  this  a  desirable
serv ice  to  include  in  web  projects;  and  what  is
probably most important, using these data is com-
putationally inexpensive, resulting in generation of
rapid flood models.

Data  fusion  is  considered  to  improve  the
trust worthiness of the elevation data of REST API
services.  This  is  particularly  relevant  as  resolution
and  accuracy  are  the  main  properties  of  a  DEM,
which affect hydraulic and hydrologic results [Vaze
et al. 2010]. Many researchers, including Costantini
et al. [1997] and Buckley and Mitchell [2004] found
that  fused  datasets  convey  improved  knowledge
about an area compared to a single dataset. Rationale
supporting fusion include the availability of duplicate
or partially overlapping datasets, different acquisition
techniques,  different  angles  or  positions  of  sensors
over  different  times,  which  may  support  identifica-
tion  of  outliers  or  inconsistencies  [Buckley  and
Mitchell  2004].  The  benefits  of  fusion  include:
(1)  surmounted  deficiencies  associated  with  one
dataset/representation of the area; (2) increased prob-
ability of better surface representation (collection at
different  angles);  (3)  removal  of  systematic  errors,
including errors or drifts captured by the inertial nav-
igation system or GPS of the collection sensor; and
(4)  variation  in  resolution,  accuracy  and  scale
[Buckley and Mitchell 2004]. 

Several  data  fusion  techniques  have  been
pro posed, from simple techniques such as data gap
filing  and  weighted  averaging  [Roth  et  al.  2002],
spatial  distribution  of  error  and  residual  density
weighting [Reinartz et al. 2005], and weighting by
a  priori DEM  error  and  derivatives  of  terrain
[Papasaika et al. 2009], to more sophisticated tech-
niques,  including  sparse  representations  using
seg mented patches (unique combinations of terrain
shape) along with error weights derived from DEM
slope  and  roughness  [Papasaika  et  al.  2009],  fre-
quency  domain  filtering  [Honikel  1998;  Crosetto
and  Aragues 2000;  Karkee  et  al.  2008],  self-
con s is tency where two DEMS are generated from
the same pair of images by switching the reference
and target [Schultz et al. 1999], multi-scale kalman
filtering  [Slatton  et  al.  2002],  k-means  clustering
[Fuss 2013], etc. Many of the fusion techniques are
successful in increasing the accuracy and precision
of  the  elevation  estimates  and  typically  involve
only two DEMs in the analysis. However, despite
this synergistic effect, there is no consistent globally
applicable solution in place that facil i tates merging
multiple  DEMs  [Buckley  and  Mitchell 2004;

284

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.Papasaika et al. 2009]. In addition, most approach-
es  are  not  data-driven,  instead  relying on  a  high
quality DEM to improve a less accurate one and on
a  priori knowledge  of  the  accuracy  of  the  input
datasets [Fuss 2013]. 

Clustering  algorithms,  typically  used  in  data
mining,  seem  to  be  one  of  the  most  promising
methods for merging multiple DEMs. They explore
data  via  “unsupervised  learning”  data  driven
approach, where a priori knowledge of the dataset is
not  required  [Jain  and  Dubes  1988].  Data  are
grouped/clustered  based  on  data  similarity,  without
the need of category labels or described relationships
between data. Clusters are considered “a set of enti-
ties which are alike,” in that the distance between any
points within a cluster is less than the distance of any
point  outside  the  cluster  [Jain  and  Dubes  1988].
Many types of clustering algorithms exist and may be
selected based on the data type (e.g., interval, nomi-
nal,  binary,  ratio,  etc.)  and  how  clusters  versus
indi viduals will be determined (recursive or iterative,
strict  or  fuzzy  membership,  etc.).  Fuss  [2013]  ana-
lyzed  the  applicability  of  k-means,  which  requires
user input of the number of clusters, initial centroid
locations and multiple iterations. On the other hand,
the Density-Based Spatial Clustering of Applications
with  Noise  (DBSCAN)  method  works  by  finding
core samples of high den sity data and expands clus-
ters from them [Duan et al. 2007].

The development of a framework for simplified
flood risk assessment that may be used by any com-
munity  is  explored.  The  focus  is  placed  on  DEM
use in supporting flood modelling for regions with-
out  access  to  a  high  resolution  DEM.  A  fused
ele va tion grid from multiple open elevation sources
(CDEM, Google and Bing Elevation APIs) is gen-
erated using a data-driven approach. The proposed
method  incorporates  the  fundamentals  of  the
DBSCAN  algorithm  [Sander  et  al.  1998]:  neigh-
borhood  (eps)  and  minimum  points  (MinPts)  to
form a cluster and identify outliers to exclude from
an inverse distance weighted estimate of elevation.
To illustrate the effectiveness of the fused DEM for
flood  modelling,  flood  grids  were  created  and  the
resulting grid compared to one derived from a high-
accuracy  LiDAR  surface  for  two  study  locations,
Bathurst and Fredericton, New Brunswick (N.B.).

Input Data and Study Areas

Elevation Data

Elevation  data  used  in  the  fusion  process
include  the  Canadian  Digital  Elevation  Model
(CDEM)  from  NRCan  (geogratis.gc.ca),  Google

G   E   O   M   A   T   I   C   A

Maps  (developers.google.com)  and  Bing  Maps
(msdn.microsoft.com)  REST  API  data.  Metadata
regarding these data sources are found in Table 1. A
statistical comparison of the datasets in the two study
areas is found in Table 2. In Bathurst, the CDEM and
Google datasets are very similar, with an RMSE of
1.10 and a mean bias of – 0.07 m. The highest corre-
lation  is  found  between  the  CDEM  and  Google
datasets,  while  the  poorest  involve  the  Bing  DEM,
with R2 values of 0.9714 (Google/Bing) and 0.9706
(CDEM/Bing).

The  CDEM  data  were  extracted  from
“hyp s o g raphic  and  hydrographic  elements  of  the
National  Topographic  Database  or  various  scaled
positional  data  acquired  from  the  provinces  and
ter ritories”  [NRCan 2015].  This  dataset  stores
ground  elevations  in  metres  relative  to  Mean  Sea
Level (MSL) based on the North American Datum
1983 (NAD83) horizontal reference datum and the

Table 1: Elevation service data resources.

CDEM
(Geogratis)

Google Maps
(Google)

Bing Maps (Bing)

LiDAR

10–900 m
(depending on
location)

10–900 m (depending
on location) 
*rounded to nearest m

1 m 
horizontal

Resolution/
horizontal 
vertical

23 x 16 m to 
93 x 65 m
0–70 m 
*rounded to
nearest m

Source

NRCan 

Google

Bing 

Vertical
Reference

(CGVD28) WGS84

EGM96 Geoid

EGM2008 2.5’ or
Height Above
Ellipsoid (HAE)
WGS84

Date

unknown

2008

2011–2013

1945–2011
(study area:
1981–1990)

Coverage
Area

Canada-wide Global

Global: Only latitude
in range – 85 to + 85 

Study-wide

Leading
Edge
Geomatics

(CGVD28)

Table 2: Statistical comparison of CDEM, Google and Bing. Shaded boxes
with bold characters indicate best fit values, μ = mean bias, σ = standard
deviation, RMSE = root mean square error, R2 = correlation. 

Location

DEMs

μ

Fredericton CDEM/Google

0.60

Bathurst

CDEM/Google

-0.07

Fredericton CDEM/Bing

Bathurst

CDEM/Bing

Fredericton Google/Bing

Bathurst

Google/Bing

0.82

0.27

0.22

0.37

Avg. 
μ 

0.26

0.54

0.30

σ

RMSE

Avg.
RMSE

2
R

2.87

1.10

3.58

3.34

4.01

3.31

2.93

1.10

3.68

3.35

4.01

3.33

2.02

3.52

3.67

0.9978

0.9969

0.9964

0.9706

0.9956

0.9714

   

285

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.G   E   O   M   A   T   I   C   A

national  Canadian  vertical  reference  Canadian
Vertical Geodetic Datum of 1928 (CGVD28). The
measured altimetric accuracy of the CDEM varies
across the country from 0–70 m. In the chosen N.B.
study areas, these data are reported to be vertically
accurate  0–10 m  and  verified  between  1981  and
1990.  Horizontally,  the  cell  size  of  the  CDEM
varies  across  the  country  with  changing  latitude,
from  23 m  x  16 m  to  93 m  x  65 m.  In  these  two
study  areas,  the  resolution  of  available  data  from
the Google and Bing REST APIs is 30 m. 

Local  LiDAR  data,  acquired  by  Leading
Edge  Geomatics  in  2011  (Fredericton)  and  2013
(Bathurst)  are  used  for  the  base  elevation  data.
The  average  flying  height  for  the  Fredericton
project area is 1400 m, which produces a horizon-
tal  accuracy  of  ~ 0.35 m  @  1  sigma  [Leading
Edge  Metadata 2011].  The  elevation  data  were
tested  against  200  GPS  RTK  survey  points,
0.13278 m  at  95%  confidence  interval,  and
RMSE of 0.067745 m.

REST Elevation API

The  REST  Elevation  API  requests  are
con structed  as  Uniform  Resource  Locator  (URL)
strings  which  contain  information  about  the  geo-
graphic  location  of  interest,  data  spacing,  and  an
API key. Once sent to the server, the URL request
is processed, and the elevation data are returned to
the  user  in  a  formatted  JSON  or  XML  document.
An  example  of  a  request  to  the  Google  Elevation
API service is shown below:

https://maps.googleapis.com/maps/api/elevation/
xml?path=y1,x1|y2,x2&samples=s&key=API_KEY

Variables  that  are  user  defined  and  may  change
per request include the start and end coordinates of the
request: y1, x1, y2, x2 and the number of data points to
extract  along  the  path,  samples = s.  Additionally,  an
API key is required to access these services.

A  python  script  was  developed  that  relies  on
user input in the form of a bounding box and cell
resolution.  The  script  takes  this  input  and  forms
requests of appropriate syntax and length to call to
the  server.  For  Bing API,  the  request  format  is  in
the form of bounding box, including the number of
rows and columns—where the number of returned
elevation  points  cannot  exceed  1024—while  the
Google API utilized the path request, as illustrated
above.  CDEM  is  also  accessible  via  REST  API,
taking a similar “path” form as the Google service.
Python libraries, including Math, Urllib2, and Json,
were utilized to take the user input and compute the
appropriate  individual  requests,  such  that  the

num ber of points requested in a single request did
not  exceed  the  stated  capabilities.  Once  the  API
request URL was sliced and formatted, the request
was  sent  to  the  appropriate  server,  the  returned
JSON document was parsed to extract position and
elevation data, stitched together to generate a single
array,  and  then  converted  to  GeoTIFF.  Geospatial
Data Abstraction Library (GDAL) was utilized for
the creation of a georeferenced raster from the ele-
vation data points. 

CDEM Extraction

Extraction 

An  alternative  to  accessing  CDEM  from  the
REST  API  is  via  interactive  web  browser.  The
CDEM  can  be  downloaded  by  selecting  the  geo-
graphic extent on the web map from the Geospatial
Geogratis,
Data 
(geogratis.cgdi.gc.ca/).  The  GeoTIFF  DEM  is
emailed  to  the  user  once  the  request  has  been
processed  by  the  servers,  additionally  other  DEM
derived products can be downloaded: slope, shaded
relief,  etc. The  time  this  takes  depends  on  current
server load and complexity of request.

page 

of 

2. Study Areas

To evaluate the suitability of elevation data from
CDEM,  Google  and  Bing  Elevation  APIs  and  the
proposed fusion technique for rapid flood modelling,
two  study  areas  in  New  Brunswick  were  selected:
Fredericton  and  Bathurst,  N.B.  These  areas  have
been  selected  for  their  mix  of  urban  and  rural  land
uses, as well as shallow and steep sloping terrain with
rivers and waterbodies in the vicinity. 

Fredericton

The  city  of  Fredericton  is  the  capital  of  N.B.
and  is  located  in  the  west-central  portion  of  the
province  in  Atlantic  Canada,  at  a  latitude  of
~ 45.96°N. The city is split by the Saint John River,
which  flows  from  west  to  east  through  the  city
(Figure 1a). The local topography varies consider-
ably  with  elevations  ranging  from  2 m  to  ~120 m
above  sea  level,  and  includes  fairly  flat  land  sur-
rounding the Saint John River [Stobbe 1940]. The
Fredericton  area  is  predominately  low  slope,  with
66.7% of the area having slopes < 5°, and less than
2%  of  the  area  having  slopes  > 10°.  The  city  and
surrounding  region  has  a  population  of  56 000
[Statistics  Canada  2011]  with  approximately
12 000  dwellings.  The  study  area  selected  for
analysis is 5 x 5 km. 

286

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.G   E   O   M   A   T   I   C   A

Bathurst

Bathurst  is  located  on  the  northeast  coast  of
N.B., approximately 47.62°N, on the estuary of the
Nepisiguit  River  and  the  southernmost  part  of
Chaleur Bay (Figure 1b). Two spits of land, Carron
Point and Alston Point, nearly enclose the entrance
to Bathurst Harbour. Additionally, two major rivers
flow  into  Bathurst  Harbour,  the Tetagouche  River
and Nepisiguit River. Although riverine flooding is
a  concern,  the  primary  susceptibility  to  flooding
within the region is sea level rise and storm surge.
Bathurst  has  about  12 300  residents  and  approxi-
mately 6 300 dwellings [Dietz 2016]. The city cen tre
is relatively protected by its location well above sea
level;  however  houses  and  cottages  built  along  the
sand pits are directly exposed to high velocity winds
and storm events coming off the bay [Dietz 2016].
The study area is approximately 10 x 15 km, with an
elevation  range  of  0–113 m  above  sea  level.  The
slope  distribution  in  the  Bathurst  area  is  similar  to
Fredericton:  over  72%  of  the  area  is  low  slope
(< 5°), 6% in the mid-range, (5–10°) and 2% of the
area has slopes steep er than 10°.

3. Fusion Method 

This section describes the proposed method of
fusion,  which  incorporates  concepts  of  clustering
and  inverse  distance  weighting  (IDW). The  aim  of
fusion is to derive a better quality DEM, where “bet-
ter” is defined as minimizing the mean bias and rel-
ative height accuracy (RMSE). A multi-step process
was applied to generate the fusion DEM: (1) a DEM

stack  was  created  first  from  the  input  surfaces;
(2) clustering to determine which values fall within
each cluster; (3) IDW to compute new fusion eleva-
tion data; and (4) the fusion DEM sur face compiled. 

DEM Stack

horizontal 

In this first step, all images were projected to the
(NB  Double
same 
projection 
Stereographic) NAD83 CSRS, and vertical reference
datum of Canadian Geodetic Vertical Datum of 1928
(CGVD28). The cell resolution of each of the data
sources differ, varying from 1 m (LiDAR) to 30 m
(Bing  and  Google),  with  the  CDEM  within  this
range  ~23 m.  A  common  cell  size  of  30 m  was
selected,  as  it  was  the  coarsest  of  the  available
datasets.  Point  data  from  the  LiDAR  and  CDEM
datasets  were  used  to  generate  DEM  of  common
cell size, 30 m, using kriging interpolation method.
The LiDAR and CDEM data are both available as
CGVD28 reference. For the Bing dataset, the data
were downloaded from the REST API referenced to
height  above  ellipsoid  and  converted  to  CGVD28
via  the  Natural  Resources  Canada  GPS-H  tool
(webapp.geod.nrcan.gc.ca/geod/tools-outils/
gpsh.php?locale=en).  The  Google  data  have  an
unknown  vertical  reference.  An  assumption  was
made  that,  in  Canada,  the  vertical  reference  of
mean sea level is to CGVD28, and thus data were
not vertically adjusted. Once all the DEMs were in
the  same  horizontal  and  vertical  projection,  they
were clipped to the same extents, and the number of
rows  and  columns  counted  to  ensure  the  cell
assignments  were  consistent  among  the  DEMs,
cre ating a DEM stack.

(a) Fredericton (LiDAR 2011)

(b) Bathurst (LiDAR 2013)

Figure 1: Topography of two New Brunswick study areas, (a) Fredericton and (b) Bathurst. Dashed boundaries indicate extent shown
in Figures 4 and 5.

287

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.G   E   O   M   A   T   I   C   A

Clustering 

The method proposed utilizes the fundamentals
of DSCAN clustering. The key concepts of (a) neigh-
bourhoods (eps) of a given radius and (b) minimum
number of points (MinPts) to form a cluster are used,
where  clusters  are  considered  dense  regions  in  the
data space. The idea is for each data point, the neigh-
bourhood  (eps)  of  a  given  radius  has  to  contain  at
least  a  minimum  number  of  points,  otherwise  a
clus ter is not formed [Xu 1997]. The neighborhood of
a point, p, is denoted by NEps(p) and is defined by:

NEps (p)={q ∈ D | dist (p,q) ≤ Eps}

(1)

where dist(p,q) is a distance function for two points,
p,q. Any data points which do not satisfy the con di tion
of MinPts, are outliers and considered noise.

For  each  cell  in  the  DEM,  the  primary  cell
ele vation  (zi,j)  value  was  extracted  along  with  its
eight surrounding neighbors, Figure 2. In the case
of  all  three  DEMS,  each  cell  passes  27  elevation
data  points  through  to  the  DBSCAN  algorithm
from the scikit-learn machine learning library for
Python  to  determine  cluster  assignment.  During
cluster  assignment,  the  elevation  values  were  the
only  considered  data,  thus  the  cell  location  and
horizontal  distance  (e.g.,  zi+1, j-1)  was  ignored.
Based on the selection of eps and MinPts, the ele-
vation values were classified into clusters or noise,
Figure 3a.  In  Figure  3a,  there  are  two  clusters
which  are  generated,  based  on  the  condition  of
MinPts = 7  and  eps = 1.75,  and  three  elevation
points are considered noise as they do not meet the
minimum density or number of points required to
form  a  cluster.  Of  the  two  derived  clusters,  the

cluster with the greater number of members (Cmax),
in this example Cluster 1, is selected and passed to
IDW  to  compute  the  new  fusion  elevation  (zf).  If
zero  clusters  are  formed,  ele vation  data  from  only
cell zi,j are passed to IDW.

The values of eps and Minpts parameters were
varied using set values, 0.5 to 10, and values which
floated  based  on  the  range  of  the  input  elevation
data  to  determine  the  most  suitable  values.  The
floating value was computed as the standard devi-
ation  of  the  input i,j  cell  elevations.  MinPts  was
also varied to determine the best parameter value.
MinPts values between 2 and 12 were used as was
a floating value of MinPts, based on the range of
input  elevation  values.  For  example,  if  the  input
elevation range was less than 3 m, 10 points were
required  for  a  cluster,  and  if  the  elevation  range
was greater than 6 m, 3 points were required for a
cluster. The results of the derived fusion surfaces
were compared to the LiDAR DEM and the mean
difference (bias) and RMSE statistics were consid-
ered to determine the most suitable eps and MinPts
for  each  of  the  fusion  combination  surfaces,
Figure 3b.  The  minimum  mean  difference  and
RMSE was found when eps was between 1.25 and
2,  depending  which  input DEMs were used, and a
MinPts value of 7 for all three DEMS, or 6 for the
two sur face DEM fusion.   

Inverse Distance Weight

Elevation data that are part of Cmax are passed
to the inverse distance weight algorithm to compute
fusion elevation value (zf).

To  compute  zf  for  cell  i,j,  data  in  Cmax are
aver aged based on the inverse distance to the cell

Figure 2: (a) Data extraction for fusion of cell i,j and cell size, (b) example data from single cell (i,j) and neighbors.

(b) 

(a) 

288

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.G   E   O   M   A   T   I   C   A

(a) 

(b)

Figure 3: (a) Sample cluster classification based on EPS = 1.75 and MinPts = 7, and (b) accuracy results of from varying eps and MinPts
parameters; accuracy results with respect to Mean Difference and RMSE in comparison to LiDAR elevation data.

centre of i,j (Eq. 2). Data from i,j are given weight
of 100%, orthogonal cells (o) have distance of 30 m
and  those  diagonal  (d)  are  42.42 m  centre-to-
cen tre;  these  elevation  points  are  thus  assigned
weights of 30% and 20% respectively.

z f =

(cid:2)o

n i + (cid:2)o
n o (cid:3) wo + (cid:2)o
ni (cid:3) +no (cid:3) wo + nd (cid:3) wd

n d (cid:3) wd

(2)

i = cell i,j data,  o = orthogonal  cells,
where 
d = diagonal  cells  and  wij = 1,  wo = ((1)⁄30) * 10,
wd = (1 ⁄ 42.42) * 10.

Final DEM

The  point  data  were  then  converted  to  an
ele vation raster surface using the GDAL write array
to raster function.

4. Results

The  results  are  divided  into  two  sections:
(a) evaluation of the elevation data of the individual
and  fusion  DEMs,  and  (b)  comparison  of  DEM
flood  grids  to  the  flood  surface  derived  from  the
LiDAR  surface—including  both  water  depth  and
spatial coverage of flood extent. 

DEMs 

To  facilitate  comparison,  all  DEMs  were
ana lyzed with cell size of 30 m. While this increase
of  cell  size  of  the  LiDAR  data  reduces  accuracy,
when input to hydrologic program, the estimate of
volume  of  runoff  is  relatively  insensitive  to  this
increase [Fellows and Ragan 1986]. Goulden et al.
[2014]  found  that  changes  in  cell  size  affect  the
topography  and  contribute  to  variability  in  water-
shed attributes, including basin area, stream length
and  location.  However,  given  the  width  of  water-
bodies  in  these  study  areas,  the  chosen  30 m  cell
resolution  is  sufficiently  able  to  represent  the
watershed attributes. 

Individual DEMS 

The  three  individual  surfaces  fit  the  LiDAR
well  within  their  posted  accuracy  specifications
(Table 1, Table 3). The largest errors are found in
the  area  of  an  old  growth  forest  in  Fredericton
(5–20 m)  and  within  the  boundaries  of  the  water
bodies. In Fredericton, DEM errors within the Saint
John River are found to be up to 4 m (CDEM), 2 m
(Bing), and less than 1 m (Google). 

All individual DEMs have a positive bias, on
average over-estimating the elevation. This is likely

289

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.G   E   O   M   A   T   I   C   A

a  result  of  the  elevation  data  containing  surface
returns, not just bare-earth measurements as found
in the LiDAR dataset. For example, if the elevation
data  of  the  Bing  or  Google  REST  API  are  com-
prised of the SRTM data, elevations will likely be
overestimated, as SRTM does not produce a bare-
earth  DEM  [Zanderbergen 2008].  In  the  SRTM
dataset  forested  areas,  elevation  values  typical ly
fall somewhere between ground and canopy, and in
urban  areas,  pixel  elevations  are  affected  by  any
buildings  in  that  pixel  [Zanderbergen 2008],  thus
producing a positive bias to a bare-earth dataset.

The  root  mean  square  error  (RMSE)  of  the
CDEM  dataset  is  lower  than  either  the  Bing  or
Google  data,  making  it  a  better  fit  (Table  3).
However,  the  overall  error  bias  of  the  Bing  data  is
more  closely  aligned  to  the  LiDAR  in  both  study
areas,  with  an  average  bias  over  the  two  areas  of
0.68 m  above  the  LiDAR.  Results  of  the  Google
dataset  find  better  overall  mean  bias,  but  lower
RMSE than the CDEM, and the inverse when com-
pared to the Bing results; thus the Google dataset is
ranked second in both statistics. The elevation scat-
ter  plots  in  Figures  4  and  5 compare  cell-by-cell
ele va tion  values  and  indicate  a  strong  linear  trend
across all elevations and fairly high density, indicating
good  correlation.  The  Google  dataset  from
Fredericton has the largest R2, indicating the regres-
sion  model  accounts  for  0.9951  of  the  variance;
how ever all individual DEMs are found to have R2

values above 0.97. In the histograms of Figure 4, the
individual  DEM  differences  (Figure  4a–c)  from
LiDAR show the Google data with the most normally
distributed  data,  with  most  of  the  elevation  differ-
ences  within  ±2 m,  while  the  Bing  data  are  more
widely  distributed  with  a  large  frequency  of  pixels
around –2 m, and the CDEM data have a right-tailed
distribution. The Pearson correlation coefficient (r) of
all datasets indicates strong cor re lation of the individ-
ual  DEM  data  to  the  LiDAR  data,  with  values
rang ing from 0.9861 to 0.9987. 

As  the  resolution  of  the  CDEM  dataset  varies
with latitude, 0.75 arc seconds (south-north) to 3 arc
seconds (west-east), and the vintage of the data from
CDEM varies across the country from 1945 to 2011,
fusion  of  this  dataset  with  a  more  current  dataset
would  provide  greater  confidence  in  the  validity  of
the data and the representation of pres ent day terrain. 

Fusion DEMs

Four  fusion  DEM  surfaces  were  created  using
unique  combinations  of  the  individual  DEMs
(CDEM/Bing,  Bing/Google,  CDEM/Google,  and
CDEM/Google/Bing).  The  LiDAR  DEM  is  sub-
tract ed from the results of the fusion DEMs to cre ate
difference DEMs (dDEM).

The fusion dDEMs in Fredericton all have rel a-
tively high computed values for Pearson’s cor relation
coefficient (r) and R2, with values rang ing from 0.973
to 0.9974 and 0.9864 to 0.9987, respectively (Table 4).

Table 3: Statistical comparison of individual DEMs to LiDAR. Shaded boxes with bold characters indicate best
fit values, μ = mean bias, σ = standard deviation, RMSE = root mean square error, R2 = measure of fit to
regression line, r = Pearson’s correlation coefficient.
σ

RMSE Average RMSE

Average μ

Location

DEM

R2

μ

r

Table 4: Statistical comparison of fusion DEMs to LiDAR. Shaded boxes with bold characters indicate best fit
values, μ = mean bias, σ = standard deviation, RMSE = root mean square error, R2 = correlation to best fit line,
r = Pearson’s correlation coefficient. 

Location

Fusion

Avg μ

RMSE Avg RMSE

Fredericton
Bathurst
Fredericton
Bathurst
Fredericton
Bathurst

0.53

Bing
0.83
Bing
0.75
Google
Google
0.83
CDEM 1.35
CDEM 0.86

0.68

0.79

1.11

Fredericton CDEM/Google/Bing
Bathurst
CDEM/Google/Bing
Fredericton CDEM/Bing
CDEM/Bing
Bathurst
Fredericton CDEM/Google
Bathurst
CDEM/Google
Fredericton Bing/Google
Bing/Google
Bathurst

μ

0.60
0.84
0.62
0.85
0.75
0.85
0.59

0.82

3.33
2.30
3.04
2.71
2.15
2.71

0.72

0.73

0.80

0.71

3.37
2.44
3.13
2.83
2.54

2.84

σ

2.81
2.61
2.61
2.65
2.61
2.68
2.98
2.65

2.91

2.98

2.69

2.27

2.74
3.04
2.79
2.71
2.81
2.87
2.77

2.50

2.92

2.76

2.82

0.9937
0.9789
0.9951

0.9724
0.9974
0.9726

R2

0.9974

0.9742
0.9950
0.9730
0.9964
0.9730
0.9958
0.9730

0.9969
0.9894
0.9976
0.9861
0.9987

0.9862

r

0.9987

0.987
0.9975
0.9864
0.9982
0.9864
0.9979
0.9864

290

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.G   E   O   M   A   T   I   C   A

Figure 4: Fredericton study
area—flood depth grids,
correlation scatter plot, and
histogram of indi vidual
DEMs: 
(a) CDEM, 
(b) Google, 
(c) Bing and fusion DEMs,
(d) CDEM/Google/Bing,
(e) CDEM/Bing,
(f) CDEM/Google,
(g) Bing/Google 
compared to LiDAR (red)
and LiDAR derived flood
grid (blue) determined as
the baseline surface.

291

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.G   E   O   M   A   T   I   C   A

Figure 5: Bathurst study
area—flood depth grids,
correlation scatter plot and
histogram of indi vidual
DEMs: 
(a) CDEM, 
(b) Google,  
(c) Bing and fusion DEMs,
(d) CDEM/Google/Bing,
(e) CDEM/Bing,
(f) CDEM/Google,
(g) Bing/Google 
compared to LiDAR (red)
and LiDAR derived flood
grid (blue) determined as
the baseline surface.

292

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.G   E   O   M   A   T   I   C   A

The  highest  correlation  coefficient  (r)  and  R2 is
found  for  the  fusion  surface,  which  uses  all  three
DEMs.  This 
fusion  dataset
three  DEM 
(CDEM/Google/Bing)  also  reports  the  lowest  root
mean square error in each study area, with an average
RMSE = 2.50.  However,  this  fusion  DEM  has  the
second  smallest  mean  bias,  average  +0.01 m  larger
than  the  Bing/Google  dataset.  The  poorest  results
were  from  the  CDEM/Bing  and  CDEM/Google
fusion DEMs: however, the average bias and RMSE
of these two fusion datasets is equal to or less than
that of the individual Google and CDEM DEMs.

As discussed above for the individual surfaces,
Bing has the lowest mean bias; however it does not
have the smallest RMSE. CDEM, on the other hand,
shows the smallest RMSE, but not the smallest mean
bias, with the Google dataset ranking sec ond in each
of these statistics. In both study areas, comparison of
the  individual  to  the  fusion  DEM  data,  the
CDEM/Google/Bing  fusion  surface  produced  the
best  DEM  when  compared  to  LiDAR  DEM,  with
respect to RMSE and R2. The correlation (r) of the
data of the CDEM/Google/Bing dataset is equivalent
to the best individual result of CDEM in Fredericton.
The average mean bias is smallest in the individual
Bing datasets, μ = 0.68; however the average mean
bias  in  the  Bing/Google  and  CDEM/Google/Bing
fusion data are not much larger, μ = 0.71 and μ = 0.72
respectively.  Thus,  the  fusion  process  improves
DEM accuracy.

Flood Inundation Maps

To  verify  the  spatial  distribution  of  the
cor re la tion to the LiDAR dataset and the impact of
the  terrain  on  the  accuracy  of  the  final  DEMs,

inun dation maps were created for the three individual
DEM  surfaces  and  the  four  final  fusion-generated
DEMs  using  the  Flood  Information  Tool  (FIT)  in
ArcMap 10.0 [FEMA 2010]. The inputs required to
compute  the  flood  depth  grid  include  the  DEM,
floodplain boundary and a series of cross sections
with attributes containing height of water and dis-
charge.  The  Fredericton  flood  scenario,  which  is
approximately  representative  of  the  2008  flood
event,  was  used  with  a  discharge  volume  of
9120 m3/s; in Bathurst, the scenario was based on
sea level rise of 4.5 m. 

First, the total flooded area is used as a simple
measure of the accuracy of the DEMs. Applying the
LiDAR DEM surface, a total of 8.45% and 18.35%
of  the  study  area  is  flooded  in  Fredericton  and
Bathurst  respectively  (Table  5).  In  the  Fredericton
scenario,  the  flood  surface  obtained  with  the
CDEM/Google/Bing fusion DEM showed the closest
match to the LiDAR surface, indicating 8.79% of the
area is flooded, an overestimation of 0.34%, which is
equivalent  to  0.26 km2.  In  Bathurst,  the  individual
Bing data were the best match when comparing total
area flooded, with a difference of – 0.09%, while the
Google  and  the  CDEM/Google/Bing  fusion  were
ranked second, with a difference of 0.30%. All flood
surfaces correlated within ±1.6% of total flooded area
or 0.75 km2 (Fredericton) and 1.59 km2 (Bathurst). In
both study areas, the flood grids from the fusion sur-
faces,  on  average,  over-estimated  the  total  flooded
area,  while  the  individual  DEMs  in  Fredericton
underestimated total flood area.

However, just comparing the total flooded area
does  not  take  into  consideration  the  overlapping,
i.e., which cells are flooded and which are dry, in
each of the flood grids. A robust approach to derive

Table 5: Difference in flooded area (%) using individual and fusion derived elevation data surfaces and
Fit measure (F). Flooded area computed using Flood Information Tool [FEMA 2010]. Results compared
to flood surface generated from LiDAR DEM. Shaded boxes with bold values represent best values.

Fredericton

Bathurst

% Flooded

% change

% Flooded

% change

LiDAR

CDEM ONLY

Google ONLY

Bing ONLY

Fusion

CDEM/Bing

CDEM/Google

Bing/Google

CDEM/Google/Bing

8.45

7.46

7.94

7.79

8.79

9.22

9.67

7.79

-

-0.99

-0.51

-0.66

0.34

0.77

1.22

–0.66

F

1

0.8856

0.7652

0.9183

0.7933

0.7246

0.7866

0.7354

18.35 

19.03

18.65

18.26

18.65

19.88

18.81

19.04

0.68

0.30

-0.09

0.30

1.53

0.46

0.68

F

1

0.9233

0.9282

0.8956

0.9154

0.8796

0.9252

0.9464

293

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.G   E   O   M   A   T   I   C   A

areal  statistics  is  achieved  using  a  fit  measure,  as
suggested  by  Bates  and  De  Roo [2000],  Eq. 3.  In
this approach the observed inundated area (Aobs) is
compared to that predicted by the model (Amod):

F =

Aobs (cid:2) Amod
Aobs (cid:3) Amod

(cid:4)100

(3)

In  Fredericton, 

When F = 1, the two flood rasters coincide perfectly. 
the  CDEM/Google/Bing
results  most  closely  matched  the  LiDAR  total
flooded  area,  with  a  difference  of  just  0.34%
flood ed area; however the fit measure, or cell-by-
cell comparison, finds a relatively low correlation
of  flooded  areas,  F = 0.7933,  Table 5.  This  indi-
cates that many of the cells flooded in the LiDAR
flood 
the
not 
CDEM/Google/Bing  grid.  The  Bing  dataset  has  a
much higher fit measure, F = 0.9183 in Fredericton
and  F = 0.8956  in  Bathurst.  Overall,  the  fit  meas-
ures  in  Bathurst  study  area  are  higher  than
Fredericton, with nearly all being greater than 0.9.
In  Fredericton,  the  fit  measures  of  the  individual
surfaces range from 0.7652 (Google) up to 0.9183
(Bing),  while  the  fusion  DEMs  have  fit  measures
between F = 0.73 and F = 0.80.

flooded 

grid 

are 

in 

Fredericton

In  the  CDEM/Google  flood  grid,  49%  of  the
cells indicate water depth ±1 m of the LiDAR flood
grid, with 37% of these within ± 0.30 m, Figure 4f.
The  CDEM/Google/Bing  fusion  DEM  created  the
next best result, with 48% within ±1, with 31% of
these within 0.3 m, Figure 4d. The individual Bing
DEM  has  the  poorest  result,  with  just  5%  within
± 0.3 m and 11% within ± 1 m, Figure 4c.

In the northwest portion of the flood maps of
Figure 4, north of the Saint John River, the entire
area is flooded in the base LiDAR case. The Bing,
Google  and  fusion  surfaces  capture  nearly  the
extent of flooding in this neighborhood, while the
CDEM does not. While these surfaces capture the
flooding  in  this  area,  the  reported  depth  of  water
varies from 0.20 m to 5 m. Moving east along the
north bank of the river, the Bing and CDEM/Bing
surfaces  do  not  illustrate  flooding  at  all  along  the
north bank, from Ring Road to Gibson St., contrary
to the LiDAR flood grid. The remainder of the sur-
faces  do  present  flooding  along  the  north  bank,
though  not  perfectly  representing  the  base  case,
although the CDEM/Google/Bing and CDEM/Google
surfaces  are  good  approximations.  On  the  north
shore  south  of  the  Nashwaak  River,  the  CDEM

in 

sur face greatly overestimates flooding, and the Bing
underestimates  flooding 
this  area.  The
CDEM/Google/Bing and the CDEM/Google best
correspond  to  the  LiDAR  in  this  area.  On  the
southern  shore  of  the  Saint  John  River,  in  the
downtown  area,  all  surfaces  overestimate  flood-
ing,  however  the  Bing  data  do  the  worst  job  at
representing  flooding,  overestimating  flooding
from the western extent of the study area by up to
6 m,  all  along  the  southern  shore  to  University
Avenue in the east. Overall, based on qualitative
analysis,  the  CDEM/Google/Bing  fusion  surface
provides the nearest approximation to the LiDAR
flood surface.

The correlation plots in Figure 4, which compare
cell-by-cell  elevation  values,  indicate  a  strong
lin ear trend and fairly high density, indicating good
correlation  in  elevation  data.  The  mean  and
stan dard deviation are computed from the observed
data  to  the  polynomial  fit  line.  The  mean  for  all
ele vation  data,  individual  and  fusion  surfaces,
are  slightly  below  zero,  while  the  mean  for  all
flood  grid  data  is  zero.  The  individual  CDEM
data  have  the  lowest  standard  deviation,  with
respect  to  the  elevation  data,  σ = 2.15,  with  the
CDEM/Google/Bing  being 
σ = 2.16, and the Bing dataset the highest, σ = 3.3.
Of the flood grids, the Bing/Google surface has the
lowest standard deviation, σ = 1.64.

slightly 

larger,

the 

than 

The  RMSE  of  all  fusion  flood  grids  area  is
smaller 
individual  surfaces.  The
CDEM/Google fusion, in terms of relative mean
error,  computes  the  best  matching  flood  grid,
with RMSE = 1.17, Figure 4f. This flood surface
also  has  a  relativly  small  positive  mean  bias,
μ = 0.48. All of the flood grids produce a positive
correlation  (r > 0).  The  elevation  histograms
(Figure  4)  for  the  fusion  flood  surfaces  better
approximate  a  normal  distribution  than  do
the  idi vidual  DEMs.  Overall,  the  fusion  surface
of 
the  CDEM/Google,  Google/Bing  and
CDEM/Google/Bing  produce  flood  grids  with
strong correlation, r = 0.5758 to 0.6194. The indi-
vidual  CDEM  surface  is  weakly  correlated  with
the LiDAR generated flood grid, with r = 0.2833. 

Bathurst

The  flood  grids  generated  by  the  individual
and fusion DEMs better approximate the LiDAR
flood  grid  in  Bathurst  than  in  the  Fredericton
area. All DEMs produce flood grids that approxi-
mate the flooding extent along both Alston Point
and Carron Point, Figure 5a–g; however the mag-
nitude  of  the  computed  flood  differences  varies

294

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.G   E   O   M   A   T   I   C   A

amongst  the  grids  in  these  areas,  with  ranges
within ± 2 m of the LiDAR derived flood surface.
Along  the  northwestern  shore  of  Chaleur  Bay,
west  of Alston  Point,  some  inland  flooding  cap-
tured in the LiDAR surface is not represented by
any of the individual or fusion DEMs. On the east
shore  of  Chaleur  Bay,  flooding  is  generally
underestimated, as many cells are flooded in the
LiDAR  surface  and  not  in  any  of  the  others.
However  the  Google  and  CDEM/Google/Bing
surfaces  show  a  more  mixed  composition  of
under and overestimation of flood ing in this area.
The  elevation  scatter  plots,  which  plot  the
LiDAR elevation values against the DEM surface
elevation  values,  show  lower  density  than  those
of  the  Fredericton  study  area,  especially  in  the
lower  elevation  ranges,  0  to  40 m.  Some  of  this
may  be  explained  by  differences  in  elevation
computed  in  water  bodies  of  Chaleur  Bay,
Bathurst Harbour and the rivers. The mean differ-
ences  from  the  elevation  data  to  the  polyfit  line
approximate  zero.  The  fusion  surfaces  derived
from  combining  Bing  with  CDEM  or  Google
show more outliers, indicating the poorer correla-
tion  to  the  LiDAR  data.  Overall,  the  standard
deviation  of  all  surfaces  is  similar,  within  the
range of σ = 2.2 to 2.6. 

The  histograms  for  each  surface  follow  a
nor mal  distribution,  with  peaks  near  zero.  The
elevation data from the Bing/Google fusion have
the  smallest  mean  bias,  μ = 0.82,  with  the  Bing
and  Google  surfaces  having  the  next  smallest
bias, μ = 0.83. The elevation histograms all have
two peaks: –1 m and 0.8 m. Reviewing the spatial
distribution  of  these  peaks  finds  these  to  be  pri-
marily within Bathurst Harbour and Chaleur Bay. 
Of  the  individual  datasets,  the  CDEM/
Google/Bing surface produces the flood grid which
is  most  statistically  similar  to  the  LiDAR  flood
grid.  The  CDEM/Google/Bing  fusion  flood  grid
computes a large correlation value, r = 0.9945, and
a computed relative height accu ra cy, RMSE = 0.92,
Figure 5d. 

to 

In  the  individual  datasets,  in  both  locations,
the  Bing  dataset  has  the  smallest  mean  bias,  the
CDEM has the smallest RMSE, while the Google
surface is in between in each of these measures.
With  respect 
the
CDEM/Google/Bing  DEMs  compute  smaller
RMSE and higher correlation when compared to
the LiDAR DEM. This fusion surfaces therefore
results in flood grids that better approximate the
flooding  extent  and  depth  than  the  individual
DEMs for both study areas.

the  fusion  surfaces, 

5. Conclusion

framework 

The  development  of  a 

for
sim pli fied flood risk assessment that may be used
by  any community  is  explored,  with  a  focus  on
how such a framework can support flood estima-
tion for regions without their own high resolution
DEM.  This  is  particularly  relevant,  as  resolution
and  accuracy  are  the  main  properties  of  a  DEM
that  affect  flood  mod elling  results. Three  readily
available  Canada-wide  elevation  datasets  were
con sidered: CDEM, Google Maps and Bing Maps
REST  APIs.  Limited  transparency  exists  regard-
ing  the  source  of  the  data  from  these  providers,
thus  data  fusion  is  considered  to  improve  their
reliability.  A  fused  elevation  grid  is  generated
using a data-driven approach to achieve the best-
accuracy  DEM  possible  from  these  inputs.  The
proposed method used fundamentals of DBSCAN
clustering  algorithm:  eps  and  MinPts,  to  deter-
mine  elevation  clusters  from  noise,  and  inverse
distance weighting to generate a new fusion DEM.
To  illustrate  the  effectiveness  of  the  individual
and fusion DEMs for flood modelling, they were
imported  to  flood  modelling  software  and  the
result ing flood depth grid compared to one  derived
from high-accu racy LiDAR.

Two locations in eastern Canada were used as
study areas to test the applicability of open source
REST  API  elevation  data  over  different  terrain
configurations.  Overall,  the  three  individual  sur-
faces fit the LiDAR well within their posted accu-
racy  specification.  The  CDEM  dataset  has  the
lowest RMSE, making it a better choice; however,
the  error  bias  of  Bing  is  more  closely  aligned  to
the  LiDAR  in  both  study  areas,  with  the  Google
dataset ranking second in each of these statistics. 

Fusion  was  performed  via  a  novel  approach
that incorporates clustering and inverse distancing
weighting  to  combine  the  DEMs,  with  the  aim  of
improving  DEM  accuracy.  In  both  study  areas,
fusion was able to reduce the RMSE and mean bias
while  increasing  the  R2 and  correlation.  The  best
results were found when all three DEMs were com-
bined. Flood grids derived from the fusion DEMs
generated a better match, in both spatial extent and
depth, to the LiDAR derived flood surface than any
of the individual DEMs.

Based  on  these  results,  the  combination  of
open source CDEM elevation data fused with Bing
and  Google  REST  API  elevation  data  provides  a
better DEM than any individual surface. While the
resolution  of  these  data,  ~30 m,  is  significantly
coarser  than  LiDAR,  many  applications  exist  for

295

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.G   E   O   M   A   T   I   C   A

which  data  of  this  resolution  and  accuracy  are
suit able, including rapid flood modelling.

Future  recommendations  include  analysis  of
other  geographic  locations  to  see  if  they  validate
these  findings,  and  testing  these  data  sources  using
other documented fusion techniques to determine if
this  method  may  provide  better  results  than  those
pre viously proposed. Additionally, the effect of main-
taining three dimensions in the clustering algorithm
and  other  clustering  methods  may  be  tested  to
deter mine if these methods provide better results.  

Acknowledgements

this  project 

This  project  is  supported  by  the  Canadian
Safety and Security Program (CSSP) which is led by
Defence  Research  and  Development  Canada’s
Centre  for  Security  Science,  in  partnership  with
Public  Safety  Canada.  Natural  Resources  Canada
in  partnership  with  New
leads 
Brunswick EMO, U. of New Brunswick, PS Canada
N.B.  Office,  and  N.B.  Ministry  of  Transport.  The
CSSP  is  a  federally-funded  program  to  strengthen
Canada’s ability to anticipate, pre vent/mitigate, pre-
pare for, respond to, and recover from natural disas-
ters, serious accidents, crime and terrorism through
the  convergence  of  science  and  technology  with
policy, operations and intelligence.

References

Bates,  P.  and A.P.J.  De  Roo.  2000. A  simple  raster-based
model  for  flood  inundation  simulation.  Journal  of
Hydrology. 236(1–2): 54–77.

Buckley,  Simon  J.  and  H.L.  Mitchell.  2004.  Integration,
validation  and  point  spacing  optimisation  of  digital
elevation  models.  The  Photogrammetric  Record.
19(108): 
10.1111/j.0031-
868X.2004.00287.x. 

277–27295. 

doi: 

Cook,  A.  and  V.  Merwade.  2009.  Effect  of  topographic
data, geometric configuration and modelling approach
on flood inundation mapping. Journal of Hydrology.
377(1–2): 131–142.

Costantini, M., A. Farina and F. Zirilli. 1997. The fusion of
different resolution SAR images. Proceedings of the
IEEE. 85(1): 139–146.

Crosetto, M. and F. Pérez Aragues. 2000. Radargrammetry
and SAR interferometry for DEM generation: valida-
tion and data fusion.

Dietz, S. 2016. Climate Change Adaptation Plan, Coastal
Erosion and Flooding. City of Bathurst. Available at
http://www.bathurstsustainabledevelopment.com/use
rfiles/file/adapt-en.pdf

Duan, L., L. Xu, F. Guo, J. Lee and B. Yan. 2007. A local-
density based spatial clustering algorithm with noise.
IS Information Systems. 32(7): 978–986.

Fellows, J.D. and R.M. Ragan. 1986. The role of cell size
in  hydrology  oriented  geographic  information  sys-
tems. Hydrologic Applications of Space Technology.
Proceedings of the Cocoa Beach Workshop, Florida,
August 1985. IAHS. No. 160.

Fuss,  C.E.  2013.  Digital  elevation  model  generation  and

fusion. MSc. University of Guelph.

Goulden, T.,  C.  Hopkinson,  R.  Jamieson  and  S.  Sterling.
2014. Sensitivity of watershed attributes to spatial res-
olution and interpolation method of LiDAR DEMs in
three distinct landscapes. Water Resources Research.
50(3): 1908–1927.

Honikel, M. 1998. Improvement of InSAR DEM accuracy
using data and sensor fusion. Geoscience and Remote
Sensing Symposium Proceedings. IGARSS '98. IEEE
International. 

Hummel, S., A.T. Hudak, E.H. Uebler, M.J. Falkowski and
K.A. Megown. 2011. A comparison of accuracy and
cost of LiDAR versus stand exam data for landscape
management on the Malheur National Forest. Journal
of Forestry. 109(5): 267–273.

Jain, A.K. and R.C. Dubes. 1988. Algorithms for Clustering

Data. Englewood Cliffs, N.J.: Prentice Hall.

Karkee,  M.,  B.L.  Steward  and  S.  Abd  Aziz.  2008.
Improving quality of public domain digital elevation
models through data fusion. Biosystems Engineering.
101(3): 293–305.

Leading  Edge  Geomatics.  2014.  LiDAR  Collection
Metadata. Available at http://legeo.ca/services/lidar/
Mangoua, F.H. and K. Goïta. 2008. A comparison between
Canadian  digital  elevation  data  (Cded)  and  Srtm
data  of  Mount  Carleton  in  New  Brunswick
(Canada). The Intl. Archives of the Photo-gramme-
try,  Remote  Sensing  and  Spatial  Information
Sciences. 37 (B4): 1423–1430.

Masse,  M.  2011.  REST  API  Design  Rulebook.  O'Reilly

Media Inc.

Mukherjee,  S.,  P.K.  Joshi,  S.  Mukherjee,  A.  Ghosh,
R.D.  Garg  and A.  Mukhopadhyay.  2013.  Evaluation
of  vertical  accuracy  of  open  source  digital  elevation
model  (DEM).  Intl.  Journal  of  Applied  Earth
Observation and Geoinformation. 21(14): 205–217.

NRCan.  2015.  Canadian  Digital  Elevation  Data  (CDED)

Source.

Papasaika, H., D. Poli and E. Baltsavias. 2009. Fusion of
digital  elevation  models  from  various  data  sources.
doi:10.1109/GEOWS.2009.22. 

Patel, A., S.K. Katiyar and V. Prasad. 2016. Performances
evaluation  of  different  open  source  DEM  using
Differential  Global  Positioning  System  (DGPS).  The
Egyptian Journal of Remote Sensing and Space Science.
doi:http://dx.doi.org/10.1016/j.ejrs. 2015.12.004. 
Reinartz,  P.,  R.  Müller,  D.  Hoja,  M.  Lehner  and
M. Schroeder. 2005. Comparison and fusion of DEM
derived from SPOT-5 HRS and SRTM data and esti-
mation of forest heights. Proc. EARSeL Workshop on
3D-Remote Sensing.

296

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.G   E   O   M   A   T   I   C   A

Zandbergen,  P.A.  2006.  The  effect  of  cell  resolution  on
depressions in digital elevation models. Applied GIS.
2(1): 04.1–04.35.

Roth,  A.,  W.  Knopfle,  G.  Strunz,  M.  Lehner  and
P. Reinartz. 2002. Towards a global elevation product:
combination of multi-source digital elevation models.
Intl.  Archives  of  Photogrammetry  Remote  Sensing
and Spatial Information Sciences. 34(4): 675–679.
Sander,  J.Ã.,  M.  Ester,  H.-P.  Kriegel  and  X.  Xu.  1998.
Density-based  clustering  in  spatial  databases:  the
algorithm  GDBSCAN  and  its  applications.  Data
Mining  and  Knowledge  Discovery. 2(2):  169–194.
doi:10.1023/A:1009745219419. 

Schultz,  H.,  E.M.  Riseman,  F.R.  Stolle  and  D.-M.  Woo.
1999.  Error  detection  and  DEM  fusion  using  self-
con sistency. doi:10.1109/ICCV.1999.790413.

Slatton, K.C., M. Crawford and L. Teng. 2002. Multiscale
fusion  of  INSAR  data  for  improved  topographic
map ping. IEEE International. 1.

Statistics  Canada.  2011.  http://www12.statcan.gc.ca  /cen-
sus-recensement/2011/as-sa/fogs-spg/Facts-csd-
eng.cfm?LANG=Eng&GK=CSD&GC=1310032.
Stefanakis,  E.  2015.  Elevation  Web  services:  limitations
and prospects. GoGeomatics Canada. Nov. 2.
Stobbe,  P.C.  1940.  Soil  survey  of  the  Fredericton-
Gagetown 
area,  New  Brunswick. Ottawa:
Experimental  Farms  Service,  Dominion  Dept.  of
Agriculture in co-operation with the New Brunswick
Dept. of Agriculture.

Thor. 2010. [Google Maps API V3] Comparison of Google

Elevation Data and SRTM3 Elevation Data.

Vaze,  J.,  J.  Teng  and  G.  Spencer.  2010.  Impact  of  DEM
accuracy  and  resolution  on  topographic  indices.
ENSO  Environmental  Modelling  and  Software.
25(10): 1086–1098.

Xu,  X.,  M.  Ester,  H.-P.  Kriegel  and  J.  Sander.  1997.
Clustering  and  knowledge  discovery  in  spatial  data-
bases.  Vistas  Astronomy.
41(3):  397–403.
doi: 10.1016/S0083-6656(97)00044-5.

Zandbergen, P. 2008. Applications of shuttle radar topogra-
phy  mission  elevation  data.  Geography  Compass  2.
(5): 1404–1431.

MS rec’d 16/08/31
Revised MS rec’d 17/01/30

Authors

Heather  McGrath  is  a  PhD  candidate  in  the
Geodesy  and  Geomatics  Engineering  Department
at  the  University  of  New  Brunswick,  under  the
advisement  of  Dr.  Stefanakis  and  Dr.  Nastev.  Her
research  focus  is  on  reducing  the  gap  between
existing  sophisticated  tools  for  flood  risk  analysis
and  rapid,  user-friendly  tools  to  support  informed
emergency response and mitigation planning whilst
leveraging open data.

Emmanuel  Stefanakis,  PhD,  PEng,  is  an
Associate  Professor  of  Geographic  Information
Systems and Science and the Director of Graduate
Studies  in  the  Department  of  Geodesy  and
Geomatics  Engineering  at  the  University  of
New Brunswick. Home Page: http://www2.unb.ca/~estef/

Miroslav  Nastev is  a  Civil  Engineer  with  a
PhD degree in Engineering Geology. He works as a
research  scientist  with  the  Geological  Survey  of
Canada,  Natural  Resources  Canada.  His  present
interests focus on the development of standardized
methods  and  tools  for  quantitative  analysis  of
phys ical  vulnerability  and  social  and  economic
losses from natural hazards. q

297

Geomatica 2016.70:283-297.Downloaded from www.nrcresearchpress.com by University of Toronto on 10/13/18. For personal use only.