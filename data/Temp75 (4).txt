This article was downloaded by: [University of Alabama at Tuscaloosa]
On: 18 December 2014, At: 16:18
Publisher: Taylor & Francis
Informa Ltd Registered in England and Wales Registered Number: 1072954 Registered
office: Mortimer House, 37-41 Mortimer Street, London W1T 3JH, UK

International Journal of Geographical
Information Science
Publication details, including instructions for authors and
subscription information:
http://www.tandfonline.com/loi/tgis20

Detection of spatial conflicts between
rivers and contours in digital map
updating
J. Chen a , W. Liu a b , Z. Li c , R. Zhao a & T. Cheng d
a National Geomatics Centre of China , 1 Baishengcun, Zizhuyuan,
Beijing, PR China
b China University of Mining & Technology , Xuzhou, Jiangsu, PR
China
c Department of Land Surveying and Geo‐Informatics , The Hong
Kong Polytechnic University , Hong Kong
d Department of Geomatic Engineering , University College
London, Gower Street, WC1E 6BT , London, UK
Published online: 20 Nov 2007.

To cite this article: J. Chen , W. Liu , Z. Li , R. Zhao & T. Cheng (2007) Detection of spatial
conflicts between rivers and contours in digital map updating, International Journal of
Geographical Information Science, 21:10, 1093-1114, DOI: 10.1080/13658810701300071

To link to this article:  http://dx.doi.org/10.1080/13658810701300071

PLEASE SCROLL DOWN FOR ARTICLE

Taylor & Francis makes every effort to ensure the accuracy of all the information (the
“Content”) contained in the publications on our platform. However, Taylor & Francis,
our agents, and our licensors make no representations or warranties whatsoever as to
the accuracy, completeness, or suitability for any purpose of the Content. Any opinions
and views expressed in this publication are the opinions and views of the authors,
and are not the views of or endorsed by Taylor & Francis. The accuracy of the Content
should not be relied upon and should be independently verified with primary sources
of information. Taylor and Francis shall not be liable for any losses, actions, claims,
proceedings, demands, costs, expenses, damages, and other liabilities whatsoever or
howsoever caused arising directly or indirectly in connection with, in relation to or arising
out of the use of the Content.

This article may be used for research, teaching, and private study purposes. Any
substantial or systematic reproduction, redistribution, reselling, loan, sub-licensing,

systematic supply, or distribution in any form to anyone is expressly forbidden. Terms &
Conditions of access and use can be found at http://www.tandfonline.com/page/terms-
and-conditions

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 International Journal of Geographical Information Science
Vol. 21, No. 10, November 2007, 1093–1114

Research Article

Detection of spatial conflicts between rivers and contours in digital map
updating

J. CHEN*{, W. LIU{{, Z. LI§, R. ZHAO{ and T. CHENG"
{National Geomatics Centre of China, 1 Baishengcun, Zizhuyuan, Beijing, PR China
{China University of Mining & Technology, Xuzhou, Jiangsu, PR China
§Department of Land Surveying and Geo-Informatics, The Hong Kong Polytechnic
University, Hong Kong
"Department of Geomatic Engineering, University College London, Gower Street,
WC1E 6BT, London, UK

(Received 29 May 2006; in final form 14 February 2007 )

In the process of topographic map updating, spatial conflicts (inconsistency)
between rivers and contours may be created. This project studies the particularity
and complexity of the relationships between rivers and contours, and develops a
method for automatic detection of the spatial conflicts between them. This
method consists of a refined descriptive spatial model (called a topological
chain), an algorithm for the computation of spatial relations, and a set of rules
for the determination of spatial conflicts. In the spatial relation model, the
topological relationships, order relationships, and metric relationships are
integrated to describe the line–line spatial relationships. The rules are derived
from the natural relations between rivers and contours in the real world. The
effectiveness of this method has been verified by using the national 1:50 000
topographic map databases. An accuracy of 91% has been achieved.

Keywords: Map updating; Spatial conflict; Spatial relation; Plane sweep
algorithm

1.

Introduction

It is understandable that out-of-date maps might not be as useful as they should be:
they need to be updated frequently. Indeed, frequent updating of map data has
become a huge task for national mapping agencies. After a map is updated, spatial
inconsistencies may be found between features. Such inconsistencies are also
referred to as spatial conflicts. The detection and resolution of spatial conflicts have
traditionally been carried out manually by cartographers (Weibel and Jones 1998).
Recently, automatic detection of spatial conflicts has attracted interest from many
researchers (Dettori and Enrico 1996, Li and Su 1996, Li et al. 2002, Chen et al.
2004).

Spatial conflicts mean contradictory (or impossible) relations between objects in
geographical space. Therefore, it is natural to think about the modelling of spatial
conflicts using spatial relation models. Cockcroft (1998), Spe´ry (1998), and Kadri-
Dahmani et al. (2001) suggested constructing consistency constraints for spatial
objects and making use of semantics of objects. Ubeda et al. (1997) and Servigne

*Corresponding author. Email: chenjun@nsdi.gov.cn

International Journal of Geographical Information Science
ISSN 1365-8816 print/ISSN 1362-3087 online # 2007 Taylor & Francis
http://www.tandf.co.uk/journals
DOI: 10.1080/13658810701300071

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 1094

J. Chen et al.

et al. (2000) defined a set of constraints for forbidden topological relationships by
using the nine-intersection model (Egenhofer and Franzosa 1991) with semantic
information. Gadish (2001) proposed a method based on the four-intersection
model with rule discovery. However, as shown in figure 1, if only the topological
relations are considered, some conflicts from the valley in figure 1(b) cannot be
detected, as the topological relation between contours and river is selfsame in
figure 1(a) and (b). In fact, other information such as the metrics, directions, and
altitudes also needs to be integrated.

This project studies the particularity and complexity of the relationships between
rivers and contours, and develops a method for automatic detection of spatial
conflicts between them. This method consists of a refined descriptive spatial model
(called a topological chain), an algorithm for the computation of spatial relations,
and a set of rules for the determination of spatial conflicts. In the spatial relation
model, the topological relationships, order relationships, and metric relationships
are integrated to describe the line–line spatial relationships. The rules are derived
from the natural relations between rivers and contours in the real world. The
calculated spatial relations are compared with these rules to check whether there is a
spatial conflict. The main idea for this new methodology is summarized in figure 2.
According to this framework, this paper is organized as follows. In section 2,
the possible spatial conflicts between rivers and contours are analysed. In section 3,
the rules for detecting spatial conflicts between them are presented. In section 4, the
strategies for calculating topological relationships between rivers and contours are
described. In section 5, a new method for calculating the line–line local topological
relation based upon the plane sweep algorithm is explained. In section 6, assembly
of local topological relationships into global relationships for conflicts detection is
discussed. In section 7, the process of automatic detection of spatial conflicts
between rivers and contours using real-life data from the national topographic map
database is illustrated. Finally, section 8 presents the conclusions.

2. Spatial conflicts between rivers and contours

2.1 Causes of spatial conflicts

For digital-map generalization, Li and Su (1996) have identified two types of causes
for spatial conflicts, i.e. the nature of scale reduction and the use of inadequate

Figure 1. Spatial conflicts created (but with topological relation unchanged). (a) Proper
representation between contours and river. (b) Spatial inconsistency between contours and
river.

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 Detection of spatial conflicts between rivers and contours

1095

Figure 2. Framework of spatial conflict detection.

algorithms/operations. However, in digital-map updating, another two causes may
be added: errors in spatial data and use of data acquired at different times.

The first two should be considered as the causes only if updating is required to
derive maps on a smaller scale from those on a larger scale. The third includes the
resolution of images and the precision of the image registration. The last may mean
different years and/or different seasons, and could be the most serious among these
four.

Rivers on small-scale topographical maps are usually updated by using up-to-date
aerial images. These images are overlaid with rivers of the old version on the
topographical maps in the same region to detect the change. If a change is detected,
then the new-version data are collected to replace the old data. Synchronously, the
attributes of the new rivers are validated by consulting the other attribute data. The
water level of rivers could be significantly affected by the season, and so river data
obtained from images could be significantly influenced by the season in which the
images are taken. In the rainy season, the water level is higher, and so the channel is
wider, while in the dry season, the channel becomes narrower. As a result, the
difference in width could indicate a true change or a seasonal change.

Compared with rivers, the change in terrain topography is more difficult to detect
from images. In practice, the percentages of change in terrain topography and rivers
could be quite different. Therefore, the cycles for updating rivers and contours could
be different. In such a case, more serious conflicts between rivers and contours will
be apparent.

2.2 Classification of the spatial conflicts between the rivers and the contours

The changes in rivers can be represented in different ways: i.e.

1. a double-line river broadened or narrowed;
2. a single-line river changed into a double-line river;
3. a double-line river changed into a single-line river;
4. a new river created and added to the database;
5. a river that has disappeared and has been deleted from the database; and
6.

the course of a river changed and altered in the database.

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 1096

J. Chen et al.

Figure 3. Spatial conflicts between rivers and contours. (a) River climbing up a slope. (b)
Contour falling into a double-line river. (c) Contour crossing a double-line river with a sharp
angle. (d) River leaving a valley.

Due to these changes, various types of spatial conflicts between rivers and contours
can be created as follows (also see figure 3):

N Type I: A river goes up and down slopes: As we know, the water flows from a
higher position to a lower one. If the terrain topography is represented by
contours, the river should flow from contours with a higher altitude to
contours with a lower altitude. If a river were to flow from a lower contour to a
higher contour, it would have to climb up the slope, which is impossible. This
type of conflict is indicated by such representations as (a) a river crossing the
same contour more than once, (b) a contour partially overlapping with a river,
(c) a river meeting with a contour, or (d) a river flowing from a lower contour
to a higher contour (figure 3(a)). In this case, the river flows from a higher
altitude to a lower altitude, and then to a higher altitude, etc.
N Type II: A contour falls into the area covered by two banks of a river, leading
to the phenomenon that the contour falls into the water. Figure 3(b) shows an
example. The contour intersects one line of the double-line river more than
once. This means that the water plane is oblique in the direction perpendicular
to the river.
N Type III: A contour crosses the river with a sharp angle. If the contour crosses
the river, the tangent line of the contour at the intersection should be
perpendicular to the river. Figure 3(c) shows a contour crossing a double-line
river without a proper crossing, leading to the phenomenon that the water
plane is oblique in the direction perpendicular to the river.
N Type IV: A river deviates from the valley, also leading to the phenomenon that
the river exists in an impossible location. A valley line is the line connecting the

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 Detection of spatial conflicts between rivers and contours

1097

local minima points of the valleys; thus it is the channel for water to flow along.
Figure 3(d) shows that the intersection points between a river and contours are
not on the valley lines. This contradicts the natural phenomenon.

3. Rules for detecting spatial conflict between rivers and contours

3.1 Correct spatial relationships between rivers and contours

In the real world, the spatial relationships between rivers and the terrain should
conform to the natural law that water flows downstream according to gravity and
accumulates into streams, which join and form rivers. This implies that, on the
topographic maps, the reasonable spatial relationships between a river and terrain
topography should be:

1.
2.

It is possible to have a disjoint relation between a river and a contour.
If the intersection between a river and a contour is not empty, their spatial
relationship must be crossing, rather than meeting or overlapping.

3. Water flows from higher to lower contours along the river.
4. When a contour crosses a single-line river, they have only one intersection
point; on the other hand, when a contour crosses a double-line river, they have
one and only one intersection point on each side of the riverbanks.

5. When a contour crosses a river, the crossing direction should be perpendicular

6. The river flows along the channel formed by connecting the local minima

to the river course.

points of the valleys.

3.2 Representing spatial conflicts by the spatial relations

To describe the spatial conflict between a river and a contour, further, we formalize
these spatial relations between them to six constraints:

ð

1: Disjoint Ai, Bi
2: Ai\Bi=w and Cross Ai, Bi

Þ~True

ð

Þ~True

3: HB1

wHB2

wHB3 . . . wHBN

Þ~1
(cid:1)
(cid:1)ve

(cid:1)
(cid:1)
(cid:1)
(cid:1)

4: Num Ai, Bi
ð
5: ai{bBi
{VBi
6: PAi
j

(cid:1)
(cid:1){900
jƒd

ð1Þ

where Ai denotes a river, B denotes a group of contours (B1, B2, … Bn) that
intersect with the river in order, each expressed by Bi with altitude value HBi (i51,
…, n); VBi denotes the valley point; PAi denotes the intersection point between the
river and a contour (Bi); ai represents the river’s direction of flow; bBi represents the
tangent line’s direction of contour on the intersection point (i51, …, n); Num
denotes the number of intersection points; e denotes the threshold value of the
angle formed by river and contour; d denotes the threshold value of distance
from a intersection point by river and a contour to a valley point; and Cross and
Disjoint represent two different types of topological relationship between rivers and
contours.

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 1098

J. Chen et al.

Table 1. Constraints between spatial conflicts and spatial relations between rivers and
contours.

Constraint
1

Constraint
2

Constraint
3

Constraint
4

Constraint
5

Constraint
6

Type I (a)
Type I (b)
Type I (c)
Type I (d)
Type I
Type III
Type IV

6
6
6
6
6
6
6

!
6
6
!
!
!
!

6
6
6
6
*
*
*

6
6
!
!
6
!
!

*
*
*
*
*
6
*

*
*
*
*
*
*
6

Table 1 lists the spatial conflicts and corresponding relationships between the
rivers and the contours, where 6 denotes the case that the spatial conflict does not
meet this constraint, while ! denotes the reverse; * denotes that the spatial conflict
has no relation to this constraint. The condition is discussed below.

3.3 Rules for detecting conflicts between rivers and contours

Based on table 1, the rules for detecting spatial conflicts between rivers and contours
are defined as follows:

1. A river climbs up the slope

(a)

(b)
(c)

If Intersection (AS
I5True;
If Cross (As
If Cross (each side of (Ad
I5True;

i, Bi)?w and (Cross (As

i>Bi)5False,

then Type

i>Bi)5True and Num(As

i>Bi).1 then Type I5True;

i>Bi)5True and Num(Ad

i>Bi).2 then Type

2. The contour falls into the double-line river

(d)

If Cross (one side of Ad
Type II5True;

i, Bi)5True and Num (one side of Ad

i>Bi).1 then

3. The contour crosses the river with a sharp angle

(e)

If (Cross (As
Ad
III5True

i>Bi)5True and Num(Ad

i>Bi)5True and Num(As

i>Bi)52) and ai{bBi

i>Bi)51 or Cross (each side of
(cid:1)
(cid:1)we, then Type

(cid:1)
(cid:1){900

(cid:1)
(cid:1)
(cid:1)
(cid:1)

4. The river deviates from the valley

(f)

If Cross(Ai, Bi)5True and PAi
i denotes a single-line river, and Ad

j

where As

{VBi

jwd, then Type IV5True.

i denotes a double-line river.

4. Strategies for calculating topological relationships between rivers and contours

From the rules in section 3, we can see that the spatial conflicts between rivers and
contours can be represented by those illogical spatial relations. So, the issue on the
detection of spatial conflicts can be translated into the issue on the calculation of
spatial relations.

In order to detect the spatial conflicts between rivers and contours, it is necessary
to derive valleys from contour lines and to calculate their metric relationships and

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 Detection of spatial conflicts between rivers and contours

1099

topological relationships. The metric relationships include altitude, the crossing
angle, and the distance between a river and a valley, etc. The line–line topological
relationship includes the local intersection type (Clementini and Felice 1998) and the
number of intersections between river and contour. Since there are algorithms
available for the computation of metric relation and extraction of the valley lines
(Liu et al. 2005b), in this paper, we will concentrate on the calculation of the
topological relationships between rivers and contours. When the double-line river is
considered as two lines side by side, only the calculation of line–line topological
relationships need be discussed.

4.1 Global topological relationship as an assembly of local topological relationships

The spatial relationships between two line objects with spatial conflicts are rather
complicated. In different parts, there may be various local intersections (Clementini
and Felice 1998), which are called local topological relationships in this paper. These
local intersection types can be classified into three categories, i.e. local cross, local
meet and local overlap (Liu et al. 2005a). These relations are shown in figure 4, where
the sequences of such relations are local meet (marked as 1), local cross (marked as
2), local overlap (marked as 3), and local cross (marked as 4), respectively. The
global line–line topological relationships can be expressed as the assembly of these
local topological relationships in sequence.

4.2 Hierarchy of the topological relationships between line segments

The topological relationship between line segments has a property of hierarchy.
Figure 5 shows such a hierarchy. In this hierarchy, relations can be classified as two
groups, i.e. disjoint and joint. The joint is divided into other two types, i.e. co-line
and not-co-line, according to the direction of two line segments. The co-line relation
can be further divided into four types, i.e. include, overlap, equal, and meet at end-
point (End-Meet), and the not-co-line relation can be further divided into three
types, i.e. cross, meet at end-point, and meet at inner (In-Meet), based on the
topological relationship between two end-points or end-point of one line segment
and inner of the other.

5. Computation of local topological relationships between rivers and contours

The topological relationships between line segments can be calculated in three steps:

1. Calculate the intersection of line segments.
2. Judge the direction of line segments.
3. Compare the points’ coordinates.

Figure 4. Local topological relationships of line objects L1 and L2.

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 1100

J. Chen et al.

Figure 5. Hierarchy of the topological relationships between line segments.

5.1 Plane sweep algorithm for calculating the intersections of massive line segments

The whole process is based on the detection of intersections between segment pairs.
The most widely used algorithm is the plane sweep algorithm. This algorithm is an
evolution of the classical sweep-line method of Bentley and Ottman (1979) for
reporting the intersections in a set of line segments. The principle is illustrated in
figure 6. The basic idea is to move a vertical line from the left to the right on the
plane, and monitor the line segments intersected by such a line (Floriani et al. 1999).
The lower bound in computation complexity of the plane sweep algorithm is O(n
log(n)), where n is the number of points. A large n results in high CPU costs (Huang
1998).

To increase efficiency, a strategy for data pre-processing is usually employed, and

such a process typically consists of three steps:

Figure 6. Plane sweep algorithm for calculating the intersections of massive line segments:
the dashed vertical line is a sweeping line, the red rectangle is the MBR of the river, the blue
rectangle is the MBR of contour2, and the shadow is the intersection of the two MBRs.

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 Detection of spatial conflicts between rivers and contours

1101

1. Select the feature according to pre-defined rules, so that a number of features
that cannot have conflicts with contours (such as aqueduct) are eliminated. As
a result, the number of segments is reduced.

2. Select line segments that have at least one point at the intersection (which is
called as COM-MBR) of the river’s MBR and contour’s MBR to reduce the
number of line segments. The shadowed area in figure 6 is the COM-MBR of
the river and contour, in which the line segments r2, r3, c21, c22, and c23 are
located.

3. Calculate the intersection only between the line segments of the objects in

different layers (Egenhofer 1994a, Chen et al. 2001).

The procedure for the computation of the intersection relation between rivers and
contours by the plane sweep algorithm is as follows:

1. Compute the azimuth angle of line segments.
2. Compare the coordinates of the end-points.
3. Judge the topological relationships between line segments according to

4. Record the result of plane sweep processing in a table similar to table 2.

figure 7.

Table 2 includes the following:

1.
2.
3.
4.

the PID (pointID) and the plane coordinates (X, Y) of the intersection point;
the identifier of each river (Fid1);
the river-layer’s label (GB1);
the coordinates (X01, Y01, X02, Y02) of ends of intersecting line segment in
the river layer;

Figure 7. Reasoning process for the topological relation of line segments.

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 1
1
0
2

Table 2. Records of the intersection points between rivers and contours in figure 6.

PID

x

Fid1 GB1

I1
I2
I3
I4
I5

5
34.7
41.8
57
71.5

y

10.5
12
9
9
14

R
R
R
R
R

21011
21011
21011
21011
21011

X01

5
23.5
23.5
48
48

Y01

10.5
16.5
16.5
6.5
6.5

X02

23.5
48
48
71.5
71.5

Y02

16.5
6.5
6.5
14
14

Fid2 GB2

C1
C1
C2
C2
C1

71010
71010
71010
71010
71010

X11

10.5
29.3
26
51.3
44

Y11

23.5
10
5
11.5
15.2

X12

19.5
44
51.3
66.5
71.5

Y12

Topology

Meet at end

13
15.2 Cross
11.5 Cross
Cross
5
Meet at end
14

J
.

C
h
e
n

e
t

a
l
.

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 Detection of spatial conflicts between rivers and contours

1103

5.
6.
7.

8.

the identifier of the contour (Fid2);
the corresponding contour layer’s label (GB2);
the coordinates (X11, Y11, X12, Y12) of ends of intersecting line segment of
the contour; and
the topological relation between line segments, etc.

Two especial cases must be considered: (1) if the topological relation between two
line segments is overlap or include, then take one end that is in the other line segment
as the intersection point; (2) when two line segments are equal, select one end of any
line segment as the intersection point.

5.2 Sort the intersecting line segments pairs

Once the topological relationship between the two line segments of two different
objects is defined, the local topological relationship of two line–line objects can be
derived. With table 2, the process is as follows:

Select distinct [Fid1] from IntersectTable
For each Fid1

Select distinct [Fid2] from IntersectTable
Select intersecting segments from IntersectTable where Fid15R and Fid25C1

Next

With this method, every two intersecting line objects and all of their intersecting
line segment pairs can be found. In order to calculate the local topological
relationships of the two line objects, the intersecting line segment pairs should be
sorted out according to the direction of the line segment flow of one line (Fid1). If a
line segment of one line (Fid1) intersects several segments of another line (Fid2), the
several line segments should be further sorted by the flow direction of the line
segment of another line (Fid2). Figure 8 shows such a sorting process. In this figure,
the intersecting line segment pairs 5, 6, 7, 8, 9, 10 and 11 have a common line
segment of line (Fid1), and we should then sort them by the other line (Fid2), the
final order is: 5, 6, 9, 10, 11, 8, and 7.

Figure 8. Sorting of the intersecting line segment pairs. The arrows denote the direction of
the line segments flow; the number denotes the order of the intersecting line segments pairs.

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 1104

J. Chen et al.

5.3 Rule to judge the local topological relationships

Suppose that line object (A) is composed of a group of consecutive segments (a1, a2,
line object (B) is composed of a group of consecutive
a3???ai???am). Similarly,
segments (b1, b2, b3???bj???bn). Then, according to the following rules, the local
topological relation between two objects (A and B) can be derived by that of ai and
bj (i51???m; j51???n):

1. Two line object disjoint: If each line segment of one line object does not
intersect any line segment of the other, then the two line objects must be
disjoint. This leads to:
Rule 1: If ;(ai g A, bj g B) and Disjoint(ai, bj)5True, then Disjoint(A, B)5True

2. Two line objects equal.

In the spatial database, it is very unlikely that two line objects are equal. If a
line object belongs to more than one layer, generally, it is copied to other
layers, rather than rebuilding it. So, an ‘equal’ relation between two line
objects can be defined as: if all the corresponding line segments of two line
objects are equal, then the two line objects are equal. This leads to:
Rule 2: If i5j and (;ai g A, ’(bj g B and Equal(ai, bj)5True)) and (;bj g B,
’(ai g A and Equal(ai, bj)5True)), then Equal(A, B)5True

3. Line object B includes line object A

If, for each line segment in line object A, there must exist an equal line
segment in line object B, and there is at least a line segment which has no equal
line segment in line A, then the line object B includes A. This leads to:
Rule 3: If i,j and (j?1 or j?n) and (;ai g A, ’(bj g B and Equal(ai,
bj)5True)) then Include(A, B)5True

4. Local cross

As illustrated in figure 9, there are three types of cross formed by line segments:

(i) Two line segments cross, the judging rule is:
Rule 4: If ’(ai g A, bj g B and Cross(ai, bj)5True) then ’(Cross(A, B)5True)

(ii) Cross formed by four line segments that meet at a common end.
(iii) Cross formed by a line segment of one line object meeting two
consecutive line segments of another one. The two cases can be judged
by the following method:

If End-Meet (ai, bj)ep1 denotes that ai End-Meets bj at point ep1; In-Meet (ai, bj)ep1
denotes that ai In-Meets bj at point ip1; End(ai) and End(bj) denote the other
end-points of ai and bj, which are not equal the point ep1 or ep2; and the
azimuth angles of each line segment starting from point (o) are denoted as
ao(cid:1)End aið
then sorting the four
azimuth angles by ascending order, Adjacent() denotes that two azimuth angles
are neighbouring. In particular, the maximal and the minimal azimuth angles are
considered to be neighbouring, as illustrated in figure 10, and so rule 5 can be
derived.

Þ, bo(cid:1)End bjð Þ, bo(cid:1)End bjz1

Þ, ao(cid:1)End aiz1

respectively,

ð

Þ

ð

Rule 5: If ’(End-Meet (ai, bj)ep15True and (End-Meet (ai + 1, bj + 1)ep25True and
ep15ep2 or (In-Meet (ai, bj)ip15True and (In-Meet (ai + 1, bj)ip25True or In-Meet (ai,
~False or
bj + 1)ip25True) and ip15ip2)) and Adjacent ao(cid:1)End aið
(cid:4)
Adjacent bo(cid:1)End bið

Þ, ao(cid:1)End aiz1
(cid:5)
~FalseÞ then ’(Cross(A, B)5True)

Þ, bo(cid:1)End biz1

(cid:2)

(cid:3)

(cid:2)

ð

Þ

ð

Þ

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 Detection of spatial conflicts between rivers and contours

1105

5. Local meet

As illustrated in figure 11, there are five types of meet formed by line segments:

(i) One line segment meets at the inner of another line segment;
(ii) Two line segments meet at a common end-point;
(iii) Three line segments meet at a common end-point;
(iv) Meet formed by four line segments that meet at a common end;
(v) Meet formed by a line segment of one line object meeting two consecutive

line segments of another line object.

Cases (1), (2), and (3) in figure 11 can be judged by rule 6.

Figure 9. Three types of local cross-relations between two line objects.

Figure 10. Dealing with two spatial cases.

Figure 11. Five types of local meet relations between two line objects.

Figure 12. Fifteen types of local overlap relations between two line objects.

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 1106

J. Chen et al.

Rule 6: If ’(End-Meet (ai, bj)ep15True and (ep15End(A) or ep15End(B)) or In-
then ’(Meet(A,

(ai, bj)ip15True and (ip15End(A) or

ip15End(B))),

Meet
B)5True).

Cases (4) and (5) in figure 11 can be judged by rule 7.
Rule 7: If ’(End-Meet (ai, bj)ep15True and End-Meet (ai + 1, bj + 1)ep25True and
ep15ep2 or (In-Meet (ai, bj)ip15True and (In-Meet (ai + 1, bj)ip25True or In-Meet (ai,
~True or
bj + 1)ip25True) and ip15ip2)) and Adjacent ao(cid:1)End aið
(cid:4)
Adjacent bo(cid:1)End bið

(cid:2)
ð
(cid:5)
~TrueÞ then ’(Meet(A, B)5True)

Þ, bo(cid:1)End biz1

Þ, ao(cid:1)End aiz1

(cid:3)

(cid:2)

Þ

ð

Þ

6. Local overlap

Figure 12 shows 15 types of local overlap, Graphs (1), (2), (3), (4), (5), (6), and
(7) can only exist in the inner parts of two line objects, which is called interior
overlap, and can be judged by rule 8. Graphs (8), (9), (10), (11), (12), (13),
(14), and (15) always appear at the end of one or two line objects, which are
called End-overlap; Graphs (8), (9), (10), and (11) always appear at the start
end of one or two line objects, which can be judged by rule 9; while Graphs
(12), (13), (14), and (15) always appear at the tail end of one or two line
objects, which can be judged by rule 10.

Rule 8: If Meet(ai, bj)5True and (Equal(ai + 1, bj + 1)5True or Overlap(ai + 1,
bj + 1)5True or Overlap(ai, bj + 1)5True or Overlap(ai + 1, bj)5True or Include(ai + 1,
bj + 1)5True or Include(ai, bj + 1)5True or Include(ai + 1, bj)5True) and (Meet(ai + 2,
bj + 2)5True or Meet(ai + 1, bj + 2)5True or Meet(ai + 2, bj + 1)5True or Meet(ai + 1,
bj + 1)5True or Meet(ai, bj + 2)5True or Meet(ai + 2, bj)5True) then ’(Overlap(A,
B)5True)

Rule 9: If (i51 or j51) and (Equal(ai, bj)5True or Overlap(ai, bj)5True or
Include(ai, bj)5True) and (Meet(ai + 1, bj + 1)5True or Meet(ai, bj + 1)5True or
Meet(ai + 1, bj)5True) then ’(Overlap(A, B)5True)

Rule 10: If (i5m or j5n) and (Meet(ai-1, bj-1)5True or Meet(ai-1, bj)5True or
Meet(ai, bj-1)5True) and (Equal(ai, bj)5True or Overlap(ai, bj)5True or Include(ai,
bj)5True) then ’(Overlap(A, B)5True)

6. Re-assemble local topological relationships into global relationships for conflict
detection

6.1 Re-assemble the local topological relationships

The topological relationship of ‘disjoint’, ‘equal’ and ‘include’ between the whole
line objects of A and B can be derived by rules (1), (2), and (3). However, by rules
(4), (5), (6), (7), (8), (9), and (10), we can judge whether this kind of topological
relationship between the whole objects or local relationships of A and B exists.

Calculated metric relationships, order relationships, and local

topological
relationships can be described by a topological chain model (Liu et al. 2005a). In
this model, the topological relationships, order relationships, and metric relation-
ships are integrated to describe the line–line spatial relationships. The local
topological relationships of cross, meet, and overlap are represented by the capital
letters ‘C’, ‘M’, and ‘O’, respectively. The intersection sequence (Clementini and
Felice 1998, Nedas and Egenhofer 2004) is represented by an ordinal number. The
various properties of the topological links are expressed by an ordinal matrix of one
column and seven rows. Rows 1–7 of the matrix denote the local order relations
(direction), the topological link’s area (area), portrait length (pd), lateral length (ld),

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 Detection of spatial conflicts between rivers and contours

1107

the distance (vd) from the topological link’s first node to a valley point, perimeter
(perimeter), and intersecting angle (a1, a2 … an) at the nodes, respectively. Thus, the
line–line spatial relationships can be expressed by a group of numbers (k0, k1 … km),
the capital letters (T0, T1 … Tm) and a matrix.
1

1

0

0

direction1
area1

direction2
area2

R L1L2

ð

Þ~k0T0

k1T1

pd1

sd1

vd1

B
B
B
B
B
B
B
B
B
B
B
@

C
C
C
C
C
C
C
C
C
C
C
A

pd2

sd2

vd2

B
B
B
B
B
B
B
B
B
B
B
@

C
C
C
C
C
C
C
C
C
C
C
A

perimeter1

a11 a12 . . . a1n

perimeter2

a21 a22 . . . a2n

ð2Þ

. . . km{1Tm{1

kmTm

directionm
aream

pdm

sdm

vdm

0

B
B
B
B
B
B
B
B
B
B
B
@

perimeterm

am1 am2 . . . amn

1

C
C
C
C
C
C
C
C
C
C
C
A

For example, in figure 13, the spatial relationships of line objects L1 and L2 can be
expressed as follows:

R L1, L2

ð

Þ~1C

2C

4C

3O

ð3Þ

{
32
6

10

0

B
B
B
B
B
B
B
B
@

24
29
800, 850

1

C
C
C
C
C
C
C
C
A

z
335
30
15

0

B
B
B
B
B
B
B
B
@

18
77
850, 450, 1800

1

C
C
C
C
C
C
C
C
A

{
110
12

20

0

B
B
B
B
B
B
B
B
@

24
55
1350, 150

1

C
C
C
C
C
C
C
C
A

In equation (3), ‘1C’, ‘2C’, and ‘4C’ denote the first, second, and fourth crosses
between L1 and L2. ‘30’ means that the third intersection between L1 and L2 is an
overlap. The symbol ‘ + ’ in the matrix means that L2 is on the left of L1.

Figure 13. Expression of line–line spatial relationships based on the topological chain model
(Clementini and Felice 1998, Nedas and Egenhofer 2004, Liu et al. 2005).

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 1108

J. Chen et al.

In the model, if the number (ki) is arranged by an ascending order, it denotes that
the extending directions of two lines are consistent. If two numbers are arranged by
two lines are
a descend order,
inconsistent. Once the local relationships have been derived, the number of cross-
relations between river and contour can also be calculated.

the extending directions of

this means that

6.2 Detecting the spatial conflict using global topological relationships: the principle

As we know, spatial relationships express the spatial constraints of the spatial data
(Egenhofer 1994b), the metric relationship is the strongest constraint, the order
relationship takes second place, and the topological relationship is the weakest
(Schlieder 1995). Spatial conflicts mean that the spatial constraints are violated.
Therefore, we should judge the spatial conflict according to the intensity order of the
spatial constraints. In this paper, only the topological relationship and the metric
relationship are considered.

The detection of the spatial conflicts is the process to match the calculated spatial
relations and the pre-defined rules. Whenever a rule is violated, a spatial conflict is
detected. First, we should compare the calculated topological relationship with the
forbidden one defined by the rules. If they are matched, then a spatial conflict is
detected; otherwise, they are judged by the metric relationship defined by the rules.
If the metric relationship is violated, then a spatial conflict is detected. In this
process, the location and type of the detected spatial conflict should be recorded for
its future adjusting. The judgement process for such a spatial conflict is illustrated in
figure 14.

7. Prototype for automatic detecting of the spatial conflict of river and contours

Based on the basic principles, rules and algorithms proposed in the previous
sections, we have realized the automatic detection of the spatial conflicts between
rivers and contours by programming with VB6.0 + MapObject.

This system has been intensively tested. The test data are a digital sheet of topo-
graphic map of a mountainous area, which is at a scale of 1:50 000 and 5 km65 km in
size. This was obtained from the National Geomatics Centre of China, including the
updated hydrographic layer (version 2003) (Figure 15) and un-updated contour
layer (Figure 16). The data format is Arc/Info coverage. The size of the hydro-
graphic layer file is 0.292 MB, and the size of the contour layer is 2.09 MB (illustrated
in table 3). This is a hilly area, with the highest contour at 1530 m and lowest at
1180 m. The contour interval is 10 m. Most rivers in this region are at the developing
stage. There are the double-line Season River, single-line Season River, double-line
Perennial River, and single-line Perennial River in the hydrographic layer.

The strategies for spatial conflict detection are as follows:

1. Open the hydrograph layer and contour layer files, respectively, and define the

rules for judging the spatial conflicts.

2. Define the metric parameters that are discussed in section 3 by experience,
including the threshold value (e) of the angle between the river and the
contour, and the threshold value of distance (d) from the river to the valley
line.

3. Carry out spatial data pre-processing based on the method addressed in
section 5.1, filter the data for the hydrograph layer to reduce the number of
line segments, and group the line segments to minimize computation costs.

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 Detection of spatial conflicts between rivers and contours

1109

Figure 14.

Judging process for spatial conflict.

4. Adopt the method expressed in sections 4 and 5 to automatically calculate the
topological relations, metrical relations, and valley points related to the river.
5. Determine spatial conflicts according to the method illuminated in section
6, and identify them on the digital map. Create some statistics for the
detected spatial conflicts, which should record the layer label of the river and
contour, feature ID and spatial conflict type, for the adjustment of spatial
conflict.

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 1110

J. Chen et al.

Figure 15. Layer of hydrographic (updated) layer data.

Figure 16. Layer of contours (not updated).

Table 3. Description of test data.

Data description

Layer

River
Contour

Format

Coverage
Coverage

File Size

Number of objects

Number of line
segments

0.292 MB
2.09 MB

332
1568

2504
89 128

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 Detection of spatial conflicts between rivers and contours

1111

Figure 17. Detection results of spatial conflict between river and contours.

The test results are illustrated in Figure 17. The triangle symbols denote the
locations of spatial conflicts. In fact, a total of 38 places have been detected. By
zooming into the spatial conflict area, we can discern and validate the true spatial
conflicts. Figure 18(a) shows a river climbing up the slope. There are two types of

Figure 18. Detection results of spatial conflict between river and contours. (a) Zoomed
location (1); (b) zoomed location (2); (c) zoomed location (3); (d) zoomed location (4).

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 1112

J. Chen et al.

spatial conflicts in Figure 18(b): one being that the contour falls into the double-line
river and the other being that the contour crosses the double-line river with a sharp
angle. Figure 18(c) represents the river deviating from the valley. Figure 18(d) shows
the contour falling into the double-line river.

The efficiency of spatial conflict detection is tested by 12 groups of data. This
shows that the quantity of the intersection line segments is the key factor to affect
the detection efficiency. As illustrated by figure 19, the consumed time for detecting
spatial conflicts varies with the number of
intersection line segments. The
correlation coefficient between them is 0.9547.

8. Conclusions

In this paper, we have analysed spatial relations between the rivers and terrain both
in the real world and in a spatial database. Based on the corresponding relations
between spatial conflicts and spatial relations, we have defined the judging rules of
each type of spatial conflict between rivers and contours. The global spatial relation
comprises a sequence of local spatial relations. In order to calculate the local spatial
relations, a method (called a plane sweep) is proposed. In this method, the line is
decomposed into consecutive segments, the intersection points of segments are
calculated, and the topological relations of segments are determined. At the end, the
topological relations between two line objects can be derived. According to the basic
principles, rules and algorithms are proposed, and we have implemented a prototype
system for automated detection of the spatial conflicts between rivers and contours.
This system has been used to check the quality of the national 1:50 000 map
database. The result of 323 sheets of mountainous area shows that the detection rate
of spatial conflict, defined by the rules, is 100%, and the accurate rate is 91.7%.

Further research will be conducted on how to improve the accurate rate of
detection and how to adjust these detected spatial conflicts automatically or semi-
automatically.

Acknowledgements
The work described in this paper was substantially supported by the National
Nature Science Foundation of China (No. 40337055) and partially supported by two

Figure 19. Relation between the number of intersection line segments and response time.

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 Detection of spatial conflicts between rivers and contours

1113

grants from the National Nature Science Foundation of China (No. 40329001,
No. 40301042).

References
BENTLEY, J.L. and OTTMAN, T.A., 1979, Algorithms for reporting and counting geometric

intersections. IEEE Transactions on Computers, 28, pp. 643–647.

CHEN, J., LI, C.M., LI, Z.L. and GOLD, C.M., 2001, A Voronoi-based 9-intersection model
for spatial relation. International Journal of Geographical Information Science, 15, pp.
201–220.

CHEN, J., LI, Z.L. and JIANG, J., 2004, Key issues of continuous updating of geo-spatial

databases. Geomatics World, 2, pp. 1–5 (in Chinese).

CLEMENTINI, E. and FELICE, P.D., 1998, Topological invariants for lines. IEEE Transactions

on Knowledge and Data Engineering, 10, pp. 38–54.

COCKCROFT, C., 1998, User defined spatial business rules: storage, management and
implementation—a pipe network. In 10th Colloquium of the Spatial Information
Research Centre, University of Otago, New Zealand, pp. 16–19.

DETTORI, G. and ENRICO, P., 1996, How generalization interacts with the topological and
metric structure of maps. In Proceedings of the 7th International Data Handling, Deft,
Netherlands, pp. 9a.27.

EGENHOFER, M.J., 1994a, Definitions of line–line relations for geographic databases. Data

Engineering, 16, pp. 479–481.

EGENHOFER, M.J., 1994b, Deriving the composition of binary topological relations. Journal

of Visual Languages and Computing, 5, pp. 133–149.

EGENHOFER, M.J. and FRANZOSA, R.D., 1991, Point-set topological spatial relations.
International Journal of Geographical Information Systems, 5, pp. 161–176.
FLORIANI, L.D., PUPPO, E. and MAGILLO, P., 1999, Applications of computational geometry
to geographic information systems. In Handbook of Computational Geometry, J.R.
Sack and J. Urrutia (Eds). Elsevier Science, Amsterdam, pp. 333–388.

GADISH, D.A., 2001, Inconsistency detection and adjustment of spatial data using rule

discovery. PhD thesis, University Of Guelph, Canada.

HUANG, Y.W., 1998, Symbolic intersect detection: a method for improving spatial intersect

joins. Geoinformatica, 2, pp. 149–174.

KADRI-DAHMANI, H., 2001, Updating in GIS: towards a more generic approach. In
Proceedings of the 20th International Cartographic Conference, Beijing, pp. 1463–1471.
LI, Z.L. and SU, B., 1996, Algebraic models for feature displacement in the generalization of

digital map data using morphological techniques. Cartographica, 32, pp. 39–56.

LI, Z.L., ZHAO, R.L. and CHEN, J., 2002, A Voronoi-based spatial algebra for spatial

relations. Progress in Nature Science, 12, pp. 528–536.

LIU, W.Z., CHEN, J., ZHAO, R.L. and CHENG, T., 2005a, A refined line–line spatial
relationship model for spatial conflict detection. In 24th International Conference on
Conceptual Modeling, Berlin, pp. 239–248.

LIU, W.Z., CHEN, J. and ZHAO, R.L., 2005b, Detecting the spatial inconsistency of the
updated rivers and valley lines. In Proceedings of the 4th International Symposium on
Spational Data Quality’05, Beijing, pp. 294–303.

LIU, W.Z. and ZHAO, R.L., 2004, A study on the automatic detecting of spatial conflict in
river updating. In Proceedings of 8th Annual Conference of China Association for GIS,
Beijing, pp. 145–153 (in Chinese).

NEDAS, K.A. and EGENHOFER, M.J., 2004, Splitting ratios: metric details of topological line–
line relations. In 17th International FLAIRS Conference, Miami Beach, FL.
SCHLIEDER, C., 1995, Reasoning about ordering. In Lecture Notes in Computer Science, pp.

341–349 (New York: Springer).

SERVIGNE, S., UBEDA, T., PURICELLI, A. and LAURINI, R., 2000, A methodology for spatial

consistency improvement of geographic databases. Geoinformatica, 4, pp. 7–34.

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 1114

Detection of spatial conflicts between rivers and contours

SPE´ RY, L., 1998, Spatial data transfer in the case of update. In ISPRS Commission IV

Symposium ‘GIS-Between Visions and Applications’, Stuttgart, pp. 1–7.

UBEDA, T. and EGENHOFER, M.J., 1997, Topological error correcting in GIS. In Advances in
Spatial Databases SSD’97, M. Scholl and A. Voisard (Eds). Springer, LNCS 1262, pp.
283–297.

WEIBEL, R. and JONES, C.B., 1998, Computational perspectives on map generalization guest

editorial for special issue on map generalization. GeoInformatica, 2, pp. 307–314.

Downloaded by [University of Alabama at Tuscaloosa] at 16:18 18 December 2014 