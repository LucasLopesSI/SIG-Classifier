Page 1 of 29

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

20

21

22

23

24

25

26

27

28

29

30

Pedestrian network information extraction based on VGI

Xuejing Xie1, Guojian Ou1

1 Chongqing College of Electronic, Chongqing 401331, China 

Abstractï¼š

Pedestrian  network  information  plays  an  important  role  in  pedestrian  LBS  (Location  Based 

Service),  and  its  completeness  determines  the  quality  of  a  pedestrian  LBS  service.  This  study  used 

volunteered  data  and  BaiduMap  to  research  how  to  extract  pedestrian  network  information  on  the 

basis  of  pedestrian  GPS  trajectories.  The  method  extracts  human  road  information  by  three  steps: 

cleaning track data, extracting the road network, and detecting and analysing the recognised pedestrian 

road  facilities.  Once  the  road  network  information  is  extracted,  the  information  regarding  road 

facilities  can  be  obtained;  for  instance,  pedestrian  crossings,  overpasses,  and  underground  passages. 

This paper describes a new method for incremental updating of electronic maps.

Key words: VGI    Pedestrian LBS    Pedestrian road facilities    Data cleaning

Trajectory clustering

1 Introduction

With the rapid development of the mobile Internet, the number of users is increasing and the size 

of the market is rapidly expanding, which leads geographical  location and  information services to a 

golden  development  period.  Intelligent  mobile  devices,  including  mobile  phones,  personal  digital 

assistants  (PDAs),  and  other  terminal  devices  have  become  popular  in  recent  years  for  mobile 

communications and navigation. Pedestrian navigation use has gradually increased. Thereby bringing 

convenience to peopleâ€™s lives. Pedestrian navigation systems, including electronic maps, location, path 

planning, and route guidance, are widely used to help pedestrians reach their destinations. It is highly 

useful for people in unfamiliar places (Zhang et al 2013).

In addition, the rise of web 2.0 technology and the popularity of smart phones have also greatly 

contributed to the development of volunteered geographic information (VGI) (Goodchild 2008).    As 

a typical case of VGI, OpenStreetMap (OSM) (Zhou et al 2015) allows users to edit with the aid of 

hand-held  GPS  devices,  aerial  photography  photos,  satellite  imagery,  or  even  the  userâ€™s  space 

knowledge. Research on VGI can be divided into three areas: human behaviour analysis (Wang et al. 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 2 of 29

31

32

33

34

35

36

37

38

39

40

41

42

43

44

45

46

47

48

49

50

51

52

53

54

55

56

57

58

59

60

61

62

63

2016;  Heikinheimo  et  al  2017),  natural  disasters  (McCallum  et  al  2016;  Haklay  2013;  Sosko  and 

Dalyot 2017), and land use mapping (Antoniou et al 2016; Fonte et al 2017).

Researching VGI road networks can usually be categorized into two stages: First, cleaning VGI 

data and controlling quality, and second, extracting the linear structure from the various characteristics 

of VGI; that is, using VGI to extract road information. For the former, Xu et al (2017) assessed the 

OSM  data  quality  by  deep  learning.  Bimonte  et  al  (2014)  presented  a  new  aggregation  extract, 

transform  and  load  (ETL)  operator  to  assess  VGI  data  quality.  Wang  et  al  (2015)  used  the  kernel 

density function to eliminate outliers at low spatial densities. Lyu et al (2017) used the symmetrical 

arc  similarity  method  to  compare  a  VGI  road  network  with  the  corresponding  authoritative  road 

network to evaluate the quality of VGI road networks. Because there are various technologies around 

the assessment methods, Hansi Senaratnea et al (2017) analysed them by analogy among the current 

methods. 

A  common  method  in  road  extraction  is  clustering.  Edelkamp  et  al  (2003)  used  the  K-means 

algorithm to cluster GPS trajectories and fitted the road skeleton line with curve fitting. Worrall and 

Nebot (2007) built a line-arc model to represent the centre line of the road, where a straight segment 

of road is indicated by a line segment, and a turning section is expressed by an arc. While extracting a 

road  network,  the  K-means  clustering  algorithm  is  severely  limited  for  low  sampling  frequency 

trajectory  data.  BrÃ¼ntrup  and  Edelkamp  (2005)  proposed  a  trajectory  partition  filtering  optimization 

method,  and  then  the  trajectory  merging  method  was  used  to  extract  the  road  network,  which 

improved the efficiency of the algorithm.

Another methodology in road extraction is intersection point connection (Fathi and Krumm 2010; 

Karagiorgou and Pfoser 2012). First, it extracted the intersection, then generated the road structure by 

connecting  all  the  intersections.  Fathi  and  Krumm  et  al  (2010)  trained  a  shape  descriptor  to 

discriminate intersections, connecting each intersection with a road segment. Karagiorgou and Pfoser 

(2012) used the direction and speed in a turning point to indicate an intersection.

To  assist  disabled  people  in  fully  participating  in  urban  social  activities,  an  urban  spatial 

accessibility evaluation method based on user confidence was proposed to evaluate the accessibility of 

pedestrian networks (Gharebaghi et al 2017). The author also used a pedestrian network database with 

more  detailed  environmental  information,  such  as  sidewalks,  crosswalks,  building  entrances,  and 

pedestrian bridges and tunnels. 

2 Methods

This study used VGI data to extract the pedestrian network information as shown in Fig. 1. The 

proposed method is separated into four parts: data cleaning, trajectory clustering, road generation, and 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 3 of 29

64

65

66

67

68

69

70

71

72

73

74

75

76

77

78

79

80

81

82

83

84

85

86

87

88

89

90

91

92

93

pedestrian facility extraction.

2.1 Data cleaning

<Insert Fig.1 here>

GPS  trajectory  VGI  data  were  utilized  in  this  study;  the  records  were  collected  by  volunteersâ€™ 

hand-held GPS devices in Hefei. The VGI data were accompanied by a large amount of redundant and 

invalid data, as shown in Fig. 2. These data were produced for two reasons: First, the device receives 

the  last  record  repeatedly  when  device  chip  obtains  a  failure  signal.  Second,  the  device  will  still 

receive the signal according to the set frequency when it moves at low speed. Redundant data does not 

improve  the  effect  of  follow-up  processing;  instead,  it  reduces  the  efficiency  of  the  algorithm.  It  is 

thus necessary to clean the original data in advance.

<Insert Fig.2 here>

There are three steps in the process of cleaning track data, as follows:

a. Initialization. This stage mainly defines and initializes the variables and data structures used in 

the process. The size of the prefix queue and the suffix queue are determined by the road correlation 

algorithm.  In  general,  a  larger  the  queue  means  more  track  fragments  are  saved  in  the  queue;  as  a 

result,  richer  information  trajectory  features  are  obtained.  Moreover,  the  accuracy  of  the  extracted 

geometric network and pedestrian facilities is also higher.

b.  Obtaining  the  road  information  around  the  track.  While  calculating  the  relationship  between 

trajectory  and  road,  it  is  necessary  to  obtain  the  geometric  information  of  the  road.  However,  the 

quantity of tracks in a road network is extremely large. Traversing all the trajectories requires a large 

amount of calculation. Therefore, in order to improve the processing efficiency, grid processing was 

used in the method in advance.

c. Eliminating redundant data. This stage is a trajectory segment filtering process that retains the 

trajectory  segment  relatively  close  to  road  network.  When  the  redundant  data  are  eliminated,  the 

original trajectory is divided into multiple sub-tracks.

2.2 Trajectory Similarity Measure

2.2.1 Trajectory Expression

The  trajectory  is  a  set  of  track  points  with  time  stamps,  which  can  be  expressed  as  t  =  {P1,  P2, 

P3, â€¦ , PN}, and the track sampling points are set according to the time series.

The trajectory steering angle is defined as the angle between two adjacent tracks. As shown in Fig. 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 4 of 29

94

95

96

97

98

99

100

101

102

103

104

105

106

107

108

109

110

111

112

113

114

115

116

117

118

119

120

121

3, Î± is the angle between successive segments a and b at the point P4, and the rotation angle of Î± is the 

angle Î¸1. Therefore, Î¸1 and Î¸2 in the figure are the steering angles at P4 and P5, respectively. For the 

convenience of calculating the structure similarity of the trajectory, the Î¸1 value is positive and Î¸2 is 

negative. The trajectory steering angle can reflect the movement of the entire trajectory.

<Insert Fig.3 here>

2.2.2 Trajectory Similarity Measure

Most  mobile  objects,  including  pedestrians,  are  limited  by  the  road  traffic  networks,  but  road 

networks and Euclidean space are quite different. Therefore, it is inappropriate to measure the degree 

of  similarity  between  tracks  by  Euclidean  distance  directly.  From  these  considerations,  this  work 

draws  on  the  ideas  of  Wang  et  al  (2004)  and  uses  a  standardized  structural  distance  to  measure  the 

similarity between movement patterns and trajectories.

The trajectory structure distance takes four weights W = {w1, w2, w3, w4}. w1, w2, w3, and w4 

are  the  weights  of  position,  speed,  direction,  and  corner,  respectively.  The  sum  of  the  four  weight 

vectors  is  1,  and  all  weights  are  greater  than  zero.  The  weights  of  the  vectors  can  be  adjusted 

according to the sensitivity degree of the trajectory. In the case of location-sensitive trajectories, one 

can  set  the  position  weight  vector  as  large  as  possible,  while  the  other  weights  are  small.  The 

trajectory similarity of this value is almost exclusively considered the position factor.

Therefore, the standardized structure distance function is:

SDist = w1 âˆ— Loc + w2 âˆ— Spe + w3 âˆ— Dir + w4 âˆ— Ang

  (1)

Where 

Loc

, 

Spe Dir Ang

, 

, 

  represent  the  location,  speed,  direction  and  corner  values, 

respectively.

There  is  a  negative  correlation  between  the  similarity  of  a  trajectory  and  the  distance  of  the 

standardized structure. A larger SDist corresponds with a smaller trajectory similarity. Therefore, the 

trajectory similarity is calculated as follows:

TS = 1 â€• SDist

  (2)

where TS is the track similarity.

a. Direction comparison

The following are the speed, location, direction, and angle information comparison analyses: 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 5 of 29

122

123

124

125

126

127

128

129

130

131

132

133

134

135

136

137

138

139

140

141

142

143

144

145

146

147

148

Dir  is  defined  as  the  variation  degree  of  the  trajectory  segment 

ğ‘‡ğ‘—

  corresponding  with 

ğ‘‡ğ‘–

  in 

terms of direction. It is shown in formula (3).

When Dir â‰ˆ 0, the direction angle of the two track segments is zero or tends to zero. The worst 

case  for  the  direction  information  is  that  the  angle  between  the  two  trajectories  is  equal  to  or 

approximately  equal  to  180Â°.  As  shown  in  Fig.  4, 

âˆ…

  is  the  comparison  angle  of  the  direction 

information between the two track segments 

ğ‘‡ğ‘– 

and 

ğ‘‡ğ‘—

.

Dir(ğ‘‡ğ‘–,ğ‘‡ğ‘—) ={â€–ğ‘‡ğ‘–â€– âˆ— sin (âˆ…),  0Â° â‰¤ âˆ… â‰¤ 90Â°;

â€–ğ‘‡ğ‘—â€–,  90Â° â‰¤ âˆ… â‰¤ 180Â°

             

(3)

<Insert Fig.4 here>

b. The contrast of speed

Spe(ğ‘‡ğ‘–,ğ‘‡ğ‘—)

  indicates the change degree of the moving object in terms of speed. Equation (4) is the 

contrast formula for speed information.

Spe(ğ‘‡ğ‘–,ğ‘‡ğ‘—)

  takes  into  account  the  maximum,  minimum  and  average  speeds  of  the  trajectory 

segments to simulate the speed variation between the trajectories.

Spe(ğ‘‡ğ‘–,ğ‘‡ğ‘—) =

3(ğ‘†ğ‘šğ‘ğ‘¥(ğ‘‡ğ‘–,ğ‘‡ğ‘—) + ğ‘†ğ‘ğ‘£ğ‘”(ğ‘‡ğ‘–,ğ‘‡ğ‘—) + ğ‘†ğ‘šğ‘–ğ‘›(ğ‘‡ğ‘–,ğ‘‡ğ‘—))

  (4)

1

Smax

ã€ ã€   represents  the  maximum,  mean,  minimum  speed  between  the  trajectory 

Smin

Savg

segments respectively. 

Spe(Ti,Tj)

  represents the average of these three speeds.

c. Corner of the contrast

Ang(ğ‘‡ğ‘–,ğ‘‡ğ‘—)

  reflects  the  degree  of  internal  change  within  the  trajectory,  including  the  change  of 

direction.  Similar  to  the  steering  angle  mentioned  in  the  previous  paragraph,  the  inner  angle  is 

assigned a positive value and the outward angle is negative. The contrast of this information mainly 

accumulates the values of all the corners of the entire trajectory.

Ang(ğ‘‡ğ‘–,ğ‘‡ğ‘—) =   

âˆ‘min (ğ‘ƒ(ğ‘‡ğ‘–),ğ‘ƒ(ğ‘‡ğ‘—))

1

(|ğœƒğ‘– â€• ğœƒğ‘—|)/(|ğœƒğ‘– + ğœƒğ‘—|)

ğ‘ƒ(ğ‘‡ğ‘–) + ğ‘ƒ(ğ‘‡ğ‘—)

   (5)

ğ‘ƒ(ğ‘‡ğ‘–)

  represents the number of sampled points in the trajectory.

d. Position comparison

ğ¿ğ‘œc(Ti,Tj)

  is the most important factor in similarity calculation of the trajectory. In order to take 

full  consideration  of  the  trajectory  structure,  the  position  of  two  trajectories  is  compared  with  the 

reasonable Hausdorff distance. The Hausdorff distance as shown in (6):

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 6 of 29

149

150

151

152

153

154

155

156

157

158

159

160

161

162

163

164

165

166

167

168

169

170

171

172

ğ¿ğ‘œc(Ti,Tj) = max (h(Ti,Tj),h(Tj,Ti))
ğ‘  âˆˆ Tj),ğ‘ƒğ‘–
ğ‘˜,ğ‘ƒğ‘—
ğ‘˜ âˆˆ Ti),ğ‘ƒğ‘—
ğ‘ ,ğ‘ƒğ‘–

â„(Ti,Tj) = max (min (â€–ğ‘ƒğ‘–
â„(Tj,Ti) = max (min (â€–ğ‘ƒğ‘—

ğ‘ â€–,ğ‘ƒğ‘—
ğ‘˜â€–,ğ‘ƒğ‘–

{

ğ‘˜ âˆˆ Ti)
ğ‘  âˆˆ Tj)

   

(6)

â„(Ti,Tj)
the nearest 

ğ‘‡ğ‘—

is the Hausdorff distance, which represents the maximum distance from the point in 

ğ‘‡ğ‘–

  to 

. The minimum distance from the point in the trajectory 

  to all the sampled points in 

ğ‘‡ğ‘–

ğ‘‡ğ‘—

  is calculated first, and then the maximum value can be found in all the minimum distances.

2.3 Trajectory Clustering

Trajectory  clustering  is  a  process  of  finding  the  similarity  between  trajectories  by  analysing  the 

userâ€™s  historical  trajectory  data.  Clustering  techniques  are  helpful  in  extracting  information  in  the 

trajectory.  Because  pedestrians  generally  move  along  a  road,  there  is  an  abundance  of  road 

information hiding in the pedestrian track data, which can roughly reflect the geometric shape of the 

road.

In this work, the trajectory clustering algorithm is based on structural similarity. Moreover, highly 

similar  trajectories  are  clustered  into  a  class,  so  these  trajectories  form  a  neighbour  set.  The  main 

parameters are the neighbour threshold 

Î¼

  and the nearest-neighbour threshold 

Ïƒ

.

The 

Î¼

-Neighbour set refers to the trajectories set of trajectory similarity with 

ğ‘‡ğ‘–

  greater than or 

equal to the nearest neighbour threshold 

. That is, according to a given neighbour threshold 

Î¼

, for 

the trajectory 

ğ‘‡ğ‘–

, if there is a trajectory 

j), TS â‰¥ Î¼, then,

ğ‘‡ğ‘—

  belongs to the 

Î¼

-Neighbour of the 

Î¼
ğ‘‡ğ‘— ï‚¹
  (i

The neighbour number threshold 

Ïƒ

  judges whether the number of trajectories in the 

Î¼

-Neighbour 

set satisfies the density of the cluster. That is, when the number of trajectories in the 

Î¼

-Neighbour set 

is larger than 

Ïƒ

, the trajectories in the neighbourhood set are regarded as in the same class. Otherwise, 

From  the  similarity  between  the  pedestrian  tracks,  the 

Î¼

-Neighbour  set  of  the  trajectory 

ğ‘‡ğ‘–

  is 

formed by setting the neighbourhood threshold 

Î¼

. The specific algorithms for trajectory clustering are 

trajectory 

.ğ‘‡ğ‘–

they are noise.

as follows:

Algorithm1 Trajectory Clustering

Input: After the cleaning of the trajectory set  I = {T1,T2,T3,T4}

The relevant parameters: weight vector W; neighborhood similarity threshold 

ğ›

; neighbor 

number threshold  ğ›”

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 7 of 29

2: 

TS_Computer(Ti,Tj) âˆ— W

  / * Calculate the trajectory similarity between tracks * /

Output: Trajectory clustering set  O = {C1,C2,â€¦,Cm}

/ * The first stage: the track similarity calculation * /

1: initialize 

TS(Ti,Tj)

;

3: if  TS(Ti,Tj) â‰¥ Î¼

4: then 

NÎ¼(Ti)â†Tj

, / * Set the 

ğ›

-neighbor set of Ti * /

/ * The second stage: trajectory clustering * /

5: initialize the cluster ID = 0,

7: For each  Ti

8: if the trajectory number in Î¼-neighbor set of 

Ti

  is 

NÎ¼(Ti) â‰¥ Ïƒ

9: Add Ti to Queue Q, / * Extended the clusters of neighbor* /

10: Cluster ID = ID + 1

173

174

175

176

177

178

179

180

181

182

183

184

185

186

187

The  algorithm  is  divided  into  two  stages:  trajectory  similarity  calculation  and  trajectory 

clustering. The main idea is to calculate the similarity between the trajectories according to the weight 

of  feature  vectors,  and  then  calculate  the 

Î¼

-Neighbour  set  of  the  trajectory 

Ti

  by  setting  the 

neighbourhood similarity threshold 

Î¼

. The neighbour number threshold 

Ïƒ

  is the basic condition for 

determining whether the clustering density is satisfied.

2.4 Road Network Generation

The key to generating a road network is finding a line that represents the road in the clusters; in 

other words, calculating the road centre line. In this work, the major process of extracting the centre 

line of the road is as follows: a. Establish a buffer for each trajectory in the clusters, b. use the ArcGIS 

fusion tool to fuse the line buffer into a buffer, and c. use the Level Cutting Skeleton of Midpoint Line 

method to extract the centre line of the road from the buffer.

2.4.1 Buffer analysis

Buffer  analysis  is  defined  as  giving  a  spatial  object  or  object  set,  automatically  creating  its 

neighbourhood radius of the polygon area, and then analysing and obtaining the desired results.

The space between the line formed by the mass trajectory and the concavity of the buffer at the 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 8 of 29

188

189

190

191

192

193

194

195

196

197

198

199

200

201

202

203

204

205

206

207

208

209

210

211

212

213

214

215

216

corners causes some small holes to appear in the line buffer. In order to solve this problem, this study 

used a line buffer fusion method to reduce the errors.

2.4.2 Level Cutting Skeleton of Midpoint Line Method

As a vector method, the Level Cutting Skeleton of Midpoint Line method is usually used to extract 

polygon skeleton lines. The track buffer is also a polygon, so the method is applied to extract the road 

centre line.

The steps of extracting the road centre line in this study are as follows:

a. Convert  the  buffer  polygon  into  polylines,  then  extract  the  vertex  coordinate  information. 

Afterwards, we regard the vertex as the cutting point.

b. Cut the line horizontally according to the cutting point; the line is called the cutting line.

c. Calculate  the  midpoint  of  each  cutting  line  according  to  formula  (7);  these  midpoints  are 

connected in order to form the road skeleton line, as shown in Fig. 5.

{x,y} = {x1 + x2
,

2

y1 + y2
2

}

  (7)

<Insert Fig.5 here>

2.5 Pedestrian Facilities Detection

The goal of pedestrian facility detection is finding new pedestrian facilities within the pedestrian 

trajectory. This process can play two roles: One is judging whether there are new pedestrian facilities, 

and the other is finding the new tracks for facilities. This study used the method published by Xu et al 

(2016) to achieve these two goals.

Therefore,  the  most  important  part  of  this  phase  is  detecting  the  possible  regions  where 

pedestrian facilities appear. In general, a trajectory is always along the sides of a road. However, the 

trajectory  of  a  user  traversing  a  walking  facility  will  intersect  the  road  network.  These  intersections 

may be caused by positioning errors, but in most cases, they are formed by pedestrian facilities. Thus, 

we  assume  that  the  pedestrian  facility  detection  strategy  is:  In  a  certain  road,  if  the  number  of 

intersecting trails exceeds a threshold, it is considered a new pedestrian facility on the road.

The trajectories of the pedestrian facilities are densely intersected in a certain range of areas in the 

road, and those trajectories appear to be divergent and agglomerate. According to this observation and 

analysis,  this  study  designed  the  necessary  and  sufficient  conditions  to  judge  the  new  pedestrian 

facilities: Suppose that the existence of K trajectories intersects the road section Î±, and the intersection 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 9 of 29

217

218

219

points are  {P1, P2, P3, ..., Pk}. If the distance between the K intersection  points does not exceed the 

distance threshold Î³, and K â‰¥ 

MinNum

, then a new pedestrian facility is judged to be found on the 

section Î±. The algorithm is described as follows:

Algorithm2 Pedestrian Facilities Finding

Input: Pedestrian trajectory set 

T ï€½

t
,{
1

t

2

,...,

nt

}

,   road network 

Road = {V,E}

   Output: Road facilities tack set  TrajSubSet

1: Initialize the index set 

IdxSet

  and the trajectory subset 

TrajSubSet

2:  For  each  trajectory  ti  in  the  trajectory  set,  calculate  the  Minimal  inclusion  rectangle 

Recti

3: For each 

Recti

, add i to

IdxSet

, find all rectangles 

Recti(j! = i)

  that intersect Recti, and 

add j to  IdxSet

4:  Use  all  the  values  in 

IdxSet

  as  indexes  to  find  the  corresponding  trajectory  in  the 

trajectory set and add the trajectory to the  TrajSubSet

5: Returns if the size of the 

TrajSubSet

  is less than 

MinNum

6:  Otherwise,  for  each  trajectory  in  the 

TrajSubSet

,  calculate  its  intersection  P  with  the 

road, record the intersection position and intersect road number  road_id

7: Classify the intersection according to the road number 

road_id

, and abandon the class 

less then 

MinNum

.

8: Otherwise calculate the distance of the intersections in the class 

9: If the distance less than threshold 

Î³

  and the number of intersections more than or equal 

to 

MinNum

, then we find the new road facilities, or return.

10: Output trajectory subset 

TrajSubSet

.

3 Experiment and Results

220

221

222

223

224

Here, in order to validate the feasibility of the proposed method, the trajectory data of some areas 

in Hefei were used in the experiment. The road information extraction process based on the pedestrian 

trajectory  is  described  in  detail,  including  extracting  the  geometric  spatial  information  of  the 

pedestrian road network and detecting pedestrian facilities.

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 10 of 29

225

226

227

228

229

230

231

232

233

234

235

236

237

238

239

240

241

242

243

244

245

246

247

248

249

250

251

252

253

254

255

256

In  this  study,  the  GPS  trajectory  data  were  collected  by  more  than  30,000  volunteers  using 

mobile  phones  and  PDAs,  conducted  by  the  Baidu  research  institute;  the  research  area  was  Hefei, 

China.  The  acquisition  time  was  from  August  to  November  2013,  for  a  duration  of  more  than  3 

months. Up to 1,444,372 track points and 107,752 pedestrian trajectories were obtained the size of the 

data  set  is  approximately  45  MB.  The  process  of  volunteer  data  collection  highlights  pedestrian 

randomness and regularity, and it is more similar to the pedestrian walking process.

The  experimental  area  is  the  city  centre  of  Hefei,  bounded  approximately  by 

117Â°15â€²

E  ~ 

117Â°20â€²

E, 

31Â°51â€²

N~ 

31Â°54â€²

N, as shown in Fig. 6. This is a prosperous region in Hefei, with more 

parks and shopping malls, and a region with more pedestrian tracks.

<Insert Fig.6 here>

3.1 Data Cleaning

Itâ€™s  important  to  eliminate  unstable  and  erroneous  factors.  Fig.  7  shows  the  overlay  between 

partial pedestrian trajectory and road network data. It can be clearly seen that the majority of the track 

data and the road network are generally coincident, but there are some trajectories beyond the existing 

road network, as shown in the red-box-marked trajectory, which is treated as redundant data.

<Insert Fig.7 here>

For these problems, first, ARCGIS was used to simplify and remove the redundant line segments, 

and  then,  the  above-mentioned  algorithm  was  applied  to  clean  up  the  road  independent  track  data. 

Line simplification reduced the number of points, using a series of points to represent the trajectory. 

The  key  is  the  choice  of  threshold  value.  In  this  experiment,  half  the  width  of  a  normal  road  was 

selected as the threshold; this simplified obtaining the pedestrian data after the line. On the one hand, 

line  simplification  corrected  some  errors  from  pedestrian  trajectories;  on  the  other  hand,  it  also 

reduced the amount of data.

We can see some small lines from Fig. 2; these lines are often meaningless. Under the premise of 

the large amount of data, the deletion of these data will not affect the results, but reduce the error and 

the data quantity. This study chose twice the width of the road as the threshold to remove those lines 

smaller  than  the  threshold  from  the  figure.  The  algorithm  traversed  each  trajectory  in  parallel  and 

calculated the trajectory length. If the length was less than the threshold, the line segment was deleted 

from the data.

Then,  the  data  processing  algorithm  proposed  in  this  paper  was  used  to  process  the  trajectory 

data. After a calculation period, the redundant data in Fig. 2 had the elimination effect of the regions 

shown in Fig. 8. From the figure, we can see that the data cleaning algorithm removed the redundant 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 11 of 29

257

258

259

260

261

262

263

264

265

266

267

268

269

270

271

272

273

274

275

276

277

278

279

280

281

282

283

284

285

286

287

data reasonably well.

<Insert Fig.8 here>

3.2 Calculation of Track Similarity and Its Clustering

In the process of trajectory clustering, we first calculated the structural weighting factors of the 

trajectory segments, and computed the similarity between the two trajectories according to a certain 

ratio.  Then,  we  traversed  all  the  trajectories  to  complete  the  clustering.  In  order  to  achieve  better 

clustering performance, we should consider carefully how to set the structural weight of the trajectory, 

and the parameters such as the neighbourhood threshold Î¼ and the neighbour number threshold 

 Ïƒ 

.

In  the  extraction  of  road  geometry,  the  trajectory  position  information  is  the  primary  factor 

measuring  the  similarity  of  the  trajectory.  Speed  information  is  also  an  important  factor  in 

distinguishing  road  facility  types.  Therefore,  by  analysing  the  characteristics  of  the  pedestrian 

trajectory  data  and  drawing  on  the  existing  empirical  knowledge,  we  supposed  that  the  ratio  of  the 

position, speed, direction and corner weight are w1: w2: w3: w4 = 0.6: 0.2: 0.1: 0.1.

When  neighbourhood  threshold  Î¼  increases,  the  number  of  the  Î¼_neighbour  set  of  ti  decreases. 

Thus,  when  Î¼  is  too  large,  the  number  of  the  Î¼_neighbour  set  cannot  satisfy  the  neighbour  number 

threshold

 Ïƒ 

,  which  results  in  a  large  number  of  clusters.  The  sparsely  localized  area  is  regarded  as 

noise, and the trajectories that belong to the same category cannot be clustered. On the contrary, when 

Î¼ is too small, it cannot reflect the structural characteristics of the track. Therefore, the parameter Î¼ 

value was chosen as the middle Î¼ value of 0.65 to clustering.

The  choice  of  neighbour  number  threshold 

 Ïƒ 

also  affects  the  number  of  clusters.  When  the 

threshold 

Ïƒ 

is  become  larger,  the  number  of  extracted  roads  will  be  correspondingly  smaller,  and 

some roads with small trajectories are likely to be extracted as noise. On the contrary, more roads will 

be extracted when 

Ïƒ 

becomes smaller, but it is easy to gather noise tracks and other unrelated road 

trajectories into the same class. Because of the large quantity of data in this study, we chose a larger Ïƒ 

value of 35 for comparison in this study.

3.3 Load Network Generation

In  this  study,  the  width  of  the  road,  GPS  positioning  error,  pedestrian  trajectory  of  the  road 

activity range, and other data were considered comprehensively. In this experiment, the road skeleton 

line was constructed by the Level Cutting Skeleton of Midpoint Line method.

The new roads constructed by the road skeleton line and Baiduâ€™s old road network were matched 

to find the new roads not contained in the Baidu old road network, as shown by the blue line in Fig. 9.

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 12 of 29

288

289

290

291

292

293

294

295

296

297

298

299

300

301

302

303

304

305

306

307

308

309

310

311

312

313

314

315

316

317

The effects of these experimental steps to process the experimental data are shown in Fig. 9.

<Insert Fig.9 here>

3.4 Pedestrian Facilities Detection

In  order  to  determine  whether  there  is  a  new  pedestrian  facility  within  the  coverage  of  the 

pedestrian  trajectory,  we  designed  a  pedestrian  facility  discovery  method.  Fig.  10  (a)  shows  a  new 

pedestrian facility found in the experimental data, and a large number of tracks through these walking 

facilities were found as well. These trajectories generally focus on certain sections and intersect with 

the road. In the experiment, with the distance Î³ set to 10 m, the minimum number of tracks MinNum 

was 20. We can find a total of 143 through pedestrian facilities in the whole experimental data set; the 

green box indicates the area where pedestrian facilities may appear. In order to clarify the location of 

the pedestrian facilities, a buffer of length 3 m was set in the experiment for the pedestrian facility. 

The  MinTrs  was  10  for  the  representative  trajectory.  The  blue  trajectory  in  Fig.  10  (b)  is  the 

representative trajectory. It can be seen that the representative trajectory is at the average position of 

the trajectory sequence. 

<Insert Fig.10 here>

4. Results Assessment

4.1 Road Network Evaluation

A  road  network  evaluation  method  is  necessary  to  assess  the  results.  Generally  speaking,  the 

quantitative method is used to represent the extraction effect by geometric precision such as coverage 

and  other  indicators.  This  work  used  a  method  from  the  literature  (OU  et  al  2014)  to  evaluate  the 

extracted road network quantitatively.

In this study, we tried to quantitatively assess the road extraction accuracy using two indicators: 

coverage rate   and mistake rate 

 F

E

. Treating the official data as reference data, buffer zones with a 

buffer  radius  of  3  m,  6  m,  and  9  m  were  calculated  on  the  basis  of  the  official  vector  road.  The 

coverage rate and mistake detection rate were calculated according to the length and percentage of the 

centre line in the buffer area. Coverage rate 

F

  and mistake rate 

E

  were calculated as follows:

F =

âˆ‘

âˆ‘

P âˆˆ Ïƒlen(P)
P âˆˆ Ï†len(P)

ï¼ˆ8ï¼‰

E =

âˆ‘

PÏµÏƒlen(P)
P âˆˆ Ï‰len(P)

âˆ‘

ï¼ˆ9ï¼‰

Here, 

Ï†

  is the official vector road set, 

Ï‰

  is the road set of this work extracted, while 

Ïƒ

  is the 

two sets matching road respectively.

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 13 of 29

<Insert Table 1 here>

Coverage rates and mistake rates obtained by different buffer radius values are shown in Table 1. 

It was proved that the coverage rate can reach more than 95% when the buffer radius is more than 6 

m,  and  the  road  network  can  be  extracted  effectively.  Although  there  are  errors  in  some  roads,  the 

accuracy of road extraction can be improved as long as there are enough trajectories.

4.2 Facility Evaluation

In  order  to  assess  the  accuracy  of  the  facilities  detection  results,  we  used  a  street-view  map  as 

comparison. The detection result is correct when a facility really exists in the corresponding location 

of the street-view map. By comparing the 143 output results one by one, 132 of them were found to be 

correct,  for  an  accuracy  rate  of  92%.  The  facilities  corresponding  to  Fig.  10  verified  by  the  Baidu 

street-view map are shown in Fig. 11.

<Insert Fig.11 here>

5 Conclusion

In  this  study,  we  used  standardized  structural  distance  to  measure  the  similarity  between  the 

trajectories, which considers four vectors: position, speed, direction, and corner. We also introduced 

the  horizontal  cutting  midpoint  method  to  extract  the  road  centre  line;  the  method  is  simple  and 

effective for extracting the skeleton line of the road. This study used the methods of Xu et al. (2016) 

to obtain the location of pedestrian facilities.

The data cleaning algorithm effectively guarantees the accuracy of data and reduces duplication 

and  redundancy.  This  method  can  effectively  extract  the  pedestrian  network  information  through 

trajectory  clustering  on  the  basis  of  structural  distance.  Finally,  experimental  results  confirmed  the 

validity and feasibility of the method.

This work is supported by Intelligent Robot Technology Research Center of Chongqing College 

of  Electronic  Engineering  (No.  XJPT201705)  and  the project of ChongQing Municipal education 

Acknowlegements

Commission (No. KJKJ1602909). 

 

318

319

320

321

322

323

324

325

326

327

328

329

330

331

332

333

334

335

336

337

338

339

340

341

342

343

344

345

346

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 14 of 29

347

348

349

350

351

352

353

354

355

356

357

358

359

360

361

362

363

364

365

366

367

References

Antoniou V, Fonte C, See L, et al. Investigating the feasibility of geo-tagged photographs as sources 

of land cover input data[J]. ISPRS International Journal of Geoinformation, 2016, 5(5): 64.

Bimonte  S,  Boucelma  O,  Machabert  O,  et  al.  From  Volunteered  Geographic  Information  to 

Volunteered Geographic OLAP: A VGI Data Quality-Based Approach[C].in Computational Science 

and Its Applications(ICCSA), Guimaraes, Portugal, 2014, 8582:69-79.

BrÃ¼ntrup  R,  Edelkamp  S.  Incremental  map  generation  with  GPS  traces[C].  Proceedings  of  the  8th 

International IEEE Conference on Intelligent Transportation Systems, Vienna, Austria, 2005: 13-16.

Edelkamp  S,  SchrÃ¶dl  S.  Route  Planning  and  Map  Inference  with  Global  Positioning  Traces[M]. 

Computer Science in Perspective, Springer Berlin Heidelberg, 2003: 128-151.

Fathi  A,  Krumm  J.  Detecting  Road  Intersections  from  GPS  Traces[C].  Geographic  Information 

Science, GIScience 2010, Springer, Berlin, Heidelberg, 6292:56-69.

Fonte C C, Minghini M, Patriarca J, et al. Generating up-to-date and detailed land use and land cover 

maps  using  OpenStreetMap  and  GlobeLand30[J].  ISPRS  International  Journal  of  Geoinformation, 

2017, 6(4): 125.

Goodchild MF. GeoJournal, 2008, 72(3-4): 239-244. https://doi.org/10.1007/s10708-008-9190-4.

Gharebaghi A, Mostafavi M, Edwards G, et al. A Confidence-Based Approach for the Assessment of 

Accessibility  of  Pedestrian  Network  for  Manual  Wheelchair  Users[C].in  International  Cartographic 

Conference, Springer, Cham, 2017.

Haklay  M.  Citizen  science  and  volunteered  geographic  information:  Overview  and  typology  of 

participation[M]. in Crowdsourcing Geographic Knowledge, 2013:105â€“122.

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 15 of 29

368

369

370

371

372

373

374

375

378

379

380

381

382

383

Heikinheimo  V,  MininE  D,  Tenkanen  H,  et  al.  User-generated  geographic  information  for  visitor 

monitoring  in  a  national  park:  A  comparison  of  social  media  data  and  visitor  survey[J].  ISPRS 

International Journal of Geoinformation, 2017, 6(3): 85.

Karagiorgou  S,  Pfoser  D.  On  Vehicle  Tracking  Data-Based  Road  Network  Generation[C].in 

Proceedings  of  the  20th  International  Conference  on  Advances  in  Geographic  Information  Systems, 

Redondo Beach,California, 2012.

Lyu, Haiyang, et al. Geometric quality assessment of trajectoryâ€generated VGI road networks based 

on the symmetric arc similarity [J]. Transactions in GIS, 2017, 21(5): 984-1009.

376 McCallum I, Liu W, See L, et al. Technologies to support community flood disaster risk reduction[J]. 

377

International Journal of Disaster Risk Science, 2016, 7(2): 198â€“204.

Ou  Y  H,  Liu  J  X,  Liu  Y  Z,  et  al.  An  Extraction  Method  of  Road  Network  Based  on  Walking  GPS 

Trajectories[J]. Computer and Modernization, 2014, 222:124-128.

Sosko  S,  Dalyot  S.  Crowdsourcing  user-generated  mobile  sensor  weather  data  for  densifying  static 

geosensor networks[J]. ISPRS International Journal of Geoinformation, 2017, 6(3): 61.

Senaratnea H, Mobasheri A, Ali A L, et al. A review of volunteered geographic information quality 

assessment methods[J]. International Journal of Geographical Information Science, 2017, 31:139-167.

384 Wang Z, Bovik A C, Sheikh H R, et al. Image quality assessment: from error visibility to structural 

385

similarity[J]. IEEE Transactions on Image Processing, 2004,13(4):600-612.

386 Wang Y, Jiang W, Liu S, et al. Evaluating trade areas using social media data with a calibrated Huff 

387

model[J]. ISPRS International Journal of Geoinformation, 2016, 5(7): 112.

388 Worrall  S,  Nebot  E.  Automated  Process  for  Generating  Digitised  Maps  through  GPS  Data 

389

Compression[C]. in Australasian Conference on Robotics and Automation, 2007.

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 16 of 29

390 Wang J, Rui X, Song X, et al. A novel approach for generating routable road maps from vehicle GPS 

traces[J]. International Journal of geographical Information Science, 2015, 29(1): 69-91.

Xu,  Y  Y,  Chen  Z  L,  Xie  Z,  et  al.  Quality  assessment  of  building  footprint  data  using  a  deep 

autoencoder  network[J].  International  Journal  of  Geographical  Information  Science,  2017,  31(10): 

Xu  Z  Y,  Zhong  S  H,  Yang  C,  et  al.  Extracting  New  walking  Facilities  from  VGI  Data  Sources[J]. 

Journal of Residuals Science &Technology, 2016, 13(7):1-9.

Zhang  X,  Li  Q  Q,  Fang  Z  X,  et  al.  Landmark  and  Branch-based  Pedestrian  Route  Complexity  and 

Selection Algorithm [J]. Geomatics and Information Science of Wuhan University,2013,38(10): 1239 

Zhou X G, Zeng L, Jiang Y, et al. Dynamically Integrating OSM Data into a Borderland Database [J]. 

ISPRS International Journal of Geoinformation, 2015, 4(3):1 707-1 728.

391

392

393

394

395

396

397

398

399

400

401

1929-1951.

- 1242.

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 17 of 29

402

Figure captions

403

Fig. 1. Workflow of General Technology 

404

Fig. 2. Redundant data 

405

Fig. 3. Schematic diagram of trajectory 

406

Fig. 4. The comparison of angel 

407

Fig. 5. Level Cutting Skeleton of Midpoint Line Method 

408

Fig. 6.Trajectory(a) and research area(b, map data: Baiduï¼ŒChang Di Wan Fang) 

409

Fig. 7.Overlaying the trajectory data and road data 

410

Fig. 8. Cleaning handle effect 

411

Fig. 9. Pedestrian network 

412

Fig. 10. (a) is Pedestrian facility discovery.   (b) is representative pedestrian trajectory 

413

Fig.11. Verified by Baidu street-view map(map data: Baidu, Chang Di Wan Fang)  

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 18 of 29

Table 1. Evaluate accuracy

Buffer radius(m)

Coverage rate(%)

Mistake rate(%)

3

6

9

53.46%

95.07%

98.62%

49.63%

89.39%

94.40%

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 19 of 29

 

Fig. 1 Workflow of General Technology 

222x141mm (300 x 300 DPI) 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 20 of 29

 

Fig. 2 Redundant data 

86x86mm (300 x 300 DPI) 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 21 of 29

 

Fig. 3 Schematic diagram of trajectory 

90x39mm (300 x 300 DPI) 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 22 of 29

 

Fig. 4 The comparison of angel 

62x29mm (300 x 300 DPI) 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 23 of 29

 

Fig. 5 Level Cutting Skeleton of Midpoint Line Method 

265x153mm (300 x 300 DPI) 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 24 of 29

 

Fig. 6 Trajectory(a) and research area(b, map data: Baiduï¼ŒChang Di Wan Fang) 

507x187mm (300 x 300 DPI) 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 25 of 29

 

Fig. 7 Overlaying the trajectory data and road data 

405x195mm (300 x 300 DPI) 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 26 of 29

 

Fig. 8 Cleaning handle effect 

87x87mm (300 x 300 DPI) 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 27 of 29

 

Fig. 9 Pedestrian network 

168x108mm (300 x 300 DPI) 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 28 of 29

 

Fig. 10  (a) is Pedestrian facility discovery.  (b) is representative pedestrian trajectory 

57x32mm (300 x 300 DPI) 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. Page 29 of 29

 

Fig. 11 Verified by Baidu street-view map(map data: Baidu, Chang Di Wan Fang). 

268x151mm (300 x 300 DPI) 

Geomatica Downloaded from www.nrcresearchpress.com by TULANE UNIVERSITY on 02/15/19For personal use only. This Just-IN manuscript is the accepted manuscript prior to copy editing and page composition. It may differ from the final official version of record. 