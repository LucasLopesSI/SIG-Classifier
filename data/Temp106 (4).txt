This article was downloaded by: [Eindhoven Technical University]
On: 15 February 2015, At: 13:51
Publisher: Taylor & Francis
Informa Ltd Registered in England and Wales Registered Number: 1072954 Registered
office: Mortimer House, 37-41 Mortimer Street, London W1T 3JH, UK

International Journal of Geographical
Information Science
Publication details, including instructions for authors and
subscription information:
http://www.tandfonline.com/loi/tgis20

Deriving ground surface digital
elevation models from LiDAR data with
geostatistics
Christopher D. Lloyd a & Peter M. Atkinson b
a School of Geography , Queen's University , Belfast BT7 1NN, UK
b School of Geography , University of Southampton , Southampton
SO17 1BJ, UK
Published online: 20 Feb 2007.

To cite this article: Christopher D. Lloyd & Peter M. Atkinson (2006) Deriving ground surface
digital elevation models from LiDAR data with geostatistics, International Journal of Geographical
Information Science, 20:05, 535-563, DOI: 10.1080/13658810600607337

To link to this article:  http://dx.doi.org/10.1080/13658810600607337

PLEASE SCROLL DOWN FOR ARTICLE

Taylor & Francis makes every effort to ensure the accuracy of all the information (the
“Content”) contained in the publications on our platform. However, Taylor & Francis,
our agents, and our licensors make no representations or warranties whatsoever as to
the accuracy, completeness, or suitability for any purpose of the Content. Any opinions
and views expressed in this publication are the opinions and views of the authors,
and are not the views of or endorsed by Taylor & Francis. The accuracy of the Content
should not be relied upon and should be independently verified with primary sources
of information. Taylor and Francis shall not be liable for any losses, actions, claims,
proceedings, demands, costs, expenses, damages, and other liabilities whatsoever
or howsoever caused arising directly or indirectly in connection with, in relation to or
arising out of the use of the Content.

This article may be used for research, teaching, and private study purposes. Any
substantial or systematic reproduction, redistribution, reselling, loan, sub-licensing,
systematic supply, or distribution in any form to anyone is expressly forbidden. Terms &

Conditions of access and use can be found at http://www.tandfonline.com/page/terms-
and-conditions

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 International Journal of Geographical Information Science
Vol. 20, No. 5, May 2006, 535–563

Research Article

Deriving ground surface digital elevation models from LiDAR data with
geostatistics

CHRISTOPHER D. LLOYD*{ and PETER M. ATKINSON{
{School of Geography, Queen’s University, Belfast BT7 1NN, UK
{School of Geography, University of Southampton, Southampton SO17 1BJ, UK

(Received 03 February 2004; in final form 14 December 2005 )

This paper focuses on two common problems encountered when using Light
Detection And Ranging (LiDAR) data to derive digital elevation models
(DEMs). Firstly, LiDAR measurements are obtained in an irregular configura-
tion and on a point, rather than a pixel, basis. There is usually a need to
interpolate from these point data to a regular grid so it is necessary to identify the
approaches that make best use of the sample data to derive the most accurate
DEM possible. Secondly, raw LiDAR data contain information on above-
surface features such as vegetation and buildings. It is often the desire to
(digitally) remove these features and predict the surface elevations beneath them,
thereby obtaining a DEM that does not contain any above-surface features. This
paper explores the use of geostatistical approaches for prediction in this
situation. The approaches used are inverse distance weighting (IDW), ordinary
kriging (OK) and kriging with a trend model (KT). It is concluded that, for the
case studies presented, OK offers greater accuracy of prediction than IDW while
KT demonstrates benefits over OK. The absolute differences are not large, but to
make the most of the high quality LiDAR data KT seems the most appropriate
technique in this case.

Keywords: LiDAR; Kriging; DEM

1.

Introduction

Light Detection And Ranging (LiDAR) has been shown to be an appropriate
technology for obtaining accurate topographic data (Samberg 1997). The
application of LiDAR for obtaining digital elevation models (DEMs) has been
discussed by several authors (for example, Lohr 1998, Wehr and Lohr 1999a). The
research presented here focuses on the use of LiDAR data to derive altitude
matrices. Since LiDAR measurements are obtained in an irregular configuration
and on a point, rather than a pixel, basis, it is usually necessary to interpolate from
these point data to a regular grid (Lloyd and Atkinson 2002a).

Raw LiDAR data contain information on above-ground features such as
vegetation and buildings. It is often the desire to remove these features and predict
the surface elevations beneath them, thereby obtaining an above-surface DEM
which contains only ground heights and not above-ground features (Jaafar et al.
1999). Therefore, it is important to identify the approaches that will make the best
use of the sample data to derive the most accurate DEM possible after removal of

*Corresponding author. Email: c.lloyd@qub.ac.uk

International Journal of Geographical Information Science
ISSN 1365-8816 print/ISSN 1362-3087 online # 2006 Taylor & Francis
http://www.tandf.co.uk/journals
DOI: 10.1080/13658810600607337

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 536

C.D. Lloyd and P.M. Atkinson

above-ground features. There is some confusion in the literature about terminology
used to refer to DEMs (Wise 2002). Here, ‘DEM’ is used as a generic term that
includes altitude matrices representing ground heights only as well as altitude
matrices representing above-ground features (Jaafar et al. 1999 term models that
include the latter a Digital Surface Model, DSM). The objective is to construct a
DEM that represents only ground heights by removing above-ground features
digitally and predicting ground heights across the areas from which the features
have been removed.

This paper explores the use of three different approaches for predicting ground
heights after the digital removal of above-surface features. The approaches used
were: (i) inverse distance weighting (IDW), (ii) ordinary kriging (OK), and (iii)
kriging with a trend model (KT; also known as universal kriging). The main concern
is to ascertain if the geostatistical approaches of OK and KT offer clear benefits over
IDW for predicting ground heights where above-surface features have been removed
digitally.

The subject of gap fill in DEMs has been explored by Doucette and Beard (2000)
who used kriging, splines, IDW and trend surfaces for filling gaps in DEMs. In that
paper, the main concern was in filling gaps due to occlusions such as clouds (termed
scene-intrinsic occlusions). In such cases, re-acquisition of data may be an option
but, in the present paper, the concern is with permanent features which are likely to
be present over many years. Doucette and Beard (2000) analysed gridded DEMs
with relatively small gaps, but the concern in this research is to analyse raw data
with potentially large gaps although not so large that the predicted values are
unstable. In the study by Doucette and Beard (2000) splines were found to provide
the most accurate results overall, although, as the authors note, kriging is equivalent
to splines in specific cases. Wackernagel (2003) provides an account of the
equivalence of the approaches.

2. Theory and techniques

The three techniques employed in this paper (IDW, OK and KT) are summarised
only briefly as IDW is very well known and detailed accounts of OK and KT are
provided in many geostatistical text books (for example, Matheron 1971, Journel
and Huijbregts 1978, Isaaks and Srivastava 1989, Cressie 1991, Goovaerts 1997,
Armstrong 1998, Chile`s and Delfiner 1999). Curran (1988) and Curran and
Atkinson (1998) provide introductions to geostatistics in a remote sensing context.
Rossi et al. (1994) explore the use of indicator kriging (IK) for prediction in cases
where remotely sensed data are obscured when, for example, there are clouds or
cloud shadow or data are missing.

IDW is applied in this paper as it is a commonly used method that requires no
user input except where the distance weighting exponent is varied; here it is set to the
usual value of 2. OK has been called ‘the anchor algorithm of geostatistics’ (Deutsch
and Journel 1998, p. 66). OK predictions are weighted averages of the available data.
The weights are assigned on the basis of the mathematical model fitted to the
variogram. Goovaerts (1997) provides a more detailed account of OK and related
algorithms. In some instances there are marked changes in the mean of the variable
of interest over even small areas. In such cases, OK may provide biased predictions.
One technique that may be used to remove the locally varying mean is termed KT.
Since elevation may vary markedly over small areas, such as on the side of a hill, KT
was employed in this analysis. With KT, the trend m(x), that is, the expected value

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 Ground surface DEMs from LiDAR

537

of Z(x), is modelled as a deterministic function of the co-ordinates. The application
of KT to LiDAR data has been explored briefly by Lloyd and Atkinson (2002a).
A major problem with KT is that the underlying trend-free variogram is assumed
known. However, estimating the trend-free variogram prior to KT can be
problematic. Cressie (1991) and Chile`s and Delfiner (1999) have summarised some
potential solutions. Olea (1975, 1977, and reviewed by Webster and Burgess 1980)
developed an approach termed structural analysis to estimate the underlying
variogram. Olea’s approach was based on the assumption of a linear variogram.
This approach was used by Lloyd and Atkinson (2002b) for the analysis of a DEM
but it was not used here because it is dependent on regularly gridded data and the
assumption of a linear variogram was considered restrictive. Rather, a similar
process was followed that is appropriate for irregularly gridded data.

The underlying, trend-free, variogram was estimated iteratively using several
steps. In turn, these were: (i) fit a polynomial trend to the data in a window using
ordinary least squares, (ii) estimate the variogram of the residuals, (iii) move the
window on a step, and (iv) obtain the weighted average of all previously estimated
variograms before returning to (i). The variogram estimated in this manner will be
biased. Beckers and Bogaert (1998) have demonstrated that variograms estimated
from ordinary least squares residuals tend to under-estimate the total variance and
may over-estimate the nugget variance. However, various studies have indicated
that the bias does not tend to affect detrimentally the kriged estimates (Cressie and
Zimmerman 1992, Christensen 1993, Kitanidis 1993). Therefore, the variogram of
ordinary least squares residuals was accepted in this case.

Global variograms were estimated using Gstat (Pebesma and Wesseling 1998) and
models were fitted to the variograms using the weighted least squares functionality
of Gstat. Variograms of residuals from a local trend were estimated using a modified
version of the variogram code provided within the Geostatistical Software Library
(GSLIB; Deutsch and Journel 1998). IDW was carried out using Fortran 77 code
written specifically for the purpose and was later tested using the Geostatistical
Analyst (Johnston et al. 2001) ArcGISTM extension. Gstat was used for OK and KT
and the latter was employed with a quadratic trend model.

3. LiDAR data and study sites

3.1 LiDAR

LiDAR is based on laser range finders that make accurate line of sight
measurements. In basis, a laser pulse is fired at a target and the time taken for the
pulse to hit the target and return is measured. LiDAR consists of two parts: (i) the
airborne module, and (ii) the ground-based module. The airborne module includes
the airborne GPS, an inertial measuring unit (imu), a rapidly pulsing laser and a
highly accurate clock. The ground-based module includes a surveyed ground base
location with differential post-processing corrections (Lillesand and Kiefer 2000).

LiDAR is used widely for the acquisition of digital elevation data. The principles
of LiDAR have been discussed by several authors (for example, Samberg 1997, Lohr
1998, Wehr and Lohr 1999a, Lillesand and Kiefer 2000; see in particular Wehr and
Lohr 1999b with the associated papers). The utility of LiDAR for obtaining digital
elevation data in a variety of conditions has been recognised by many organisations
in the UK and other countries. For example, LiDAR has been used to obtain
between-canopy ground heights in wooded areas (Kraus 1997, Kraus and Pfeifer

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 538

C.D. Lloyd and P.M. Atkinson

1998, Reutebuch et al. 2003). Whatever the application, since LiDAR data are
provided as irregularly distributed points, there is a need to interpolate to a grid if a
DEM is required.

3.2 Data

The data used in this research represent three areas in the UK—data within
Ordnance Survey tile numbers D0000007, D0005628 and D0014180—and all of the
data were supplied by the Environment Agency. The three sample areas, all in the
English midlands, are shown in figure 1. The segment of tile D0000007 represents an
area north west of Barton-Upon-Humber in the county of Humberside; the segment
of tile D0005628 is located south west of Telford in Shropshire and the segment of
tile D0014180 is located south west of Lincoln in Lincolnshire. In the text, the three

Figure 1. Sample locations.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 Ground surface DEMs from LiDAR

539

data sets are referred to as the Humberside, Shropshire and Lincolnshire data sets,
respectively. Summary statistics for the three data sets are given in table 1. The
sample areas were selected as they have varying topography—the range of elevations
differ from location to location and they provide, therefore, suitable contrasts for a
study of this type. DEMs, including above-surface features, of the three regions
derived from LiDAR point data with IDW (30 data neighbourhood with predictions
to a grid with a 2 m spacing) are given in figure 2. For the Humberside data set
(figure 2a), the presence of two linear features, perhaps hedgerows or other field
boundaries, running east to west, as well as one running diagonally north to south, is
apparent. There is also evidence of such features for the Shropshire data set
(figure 2b) and for the Lincolnshire data set (figure 2c).

4. Analysis

In all three cases, examination of the topography in the selected region indicated
that a non-stationary model would be appropriate—in this case, the mean is not
constant across the study region and a model that allows for a locally varying mean
seemed sensible. The raw variograms, with a lag spacing of 5 m, supported this
expectation since they are all concave upwards in form, a common indication that a
long range trend model would provide a good fit to the data (figure 3a–c); power
models were fitted in all cases. The directional variograms were estimated but they
were similar in form (that is, concave upwards) in all directions. This suggests that a
trend model would be appropriate in all directions. For all three data sets, the
variograms estimated using residuals from first- and second-order polynomial
trends fitted globally indicated that a marked trend in the elevation values remained
(figure 4a–c)—local trends in the data remained. One possibility is to use higher
order global
the approach adopted was to estimate the
omnidirectional variograms from locally detrended data.

trend models but

As detailed in section 2, to remove both the local and global trends a second-order
polynomial was fitted to the data on a moving window basis, using a window of
125 m by 125 m, and the variograms were estimated from the residuals. The average
variograms for all local windows are shown in figures 5a–c. It can be seen clearly
is
that the apparent evidence of trend in figures 3a–c, as well as figures 4a–c,

Table 1. Summaries of the three data sets.

No

1

Tile No.
County: name used in

D0000007
Humberside

text
Min X
Max X
Min Y
Max Y
Min Z
Max Z
Mean Z
Std. dev. Z
Skew
Count

500,000
500,500
420,500
421,000
50.90
67.38
59.08
3.02
0.01
139,694

2

D0005628
Shropshire

364,412.41
364,901.63
303,618.64
303,913.47
59.96
98.97
77.14
7.74
0.06
24,038

3

D0014180
Lincolnshire

521,503.24
521,998.22
367,998.34
368,498.18
14.49
24.27
20.02
2.24
20.07
75,994

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 540

C.D. Lloyd and P.M. Atkinson

(a)

(b)

Figure 2. DSMs derived from LiDAR data using IDW with a 30 observation neighbour-
hood for (a) Humberside data set, (b) Shropshire data set and (c) Lincolnshire data set.
Copyright # Environment Agency.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 Ground surface DEMs from LiDAR

541

(c)

Figure 2.

(Continued.)

removed. Spherical models were fitted to the variograms of locally detrended data as
this model provided the best fit of all the models considered in each case.

To assess the accuracy of the three interpolation techniques in predicting elevation

at unsampled locations:

(i)
(ii)

(iii)

sections of the data were removed (figure 6),
the elevations at the locations of the removed observations were predicted
using the remaining data, and
the data removed were used to assess the accuracy of the predictions.

Three sets of features, linear, regular and irregular, were selected to represent
different kinds of above-ground features. Examples for linear, regular and irregular
features in turn are rows of terraced housing (linear), an industrial site (regular) and
isolated forested stands (irregular). The number of observations extracted for the
three different sets of features shown in figure 6 are specified in table 2. The numbers
of extracted data, as well as the total sample sizes, vary between the three data sets
and this is likely to have implications for the results obtained using the three
different approaches.

For IDW, OK and KT, the nearest 30 data were used for prediction initially.
Then, in increments of 30 data, 60 to 210 data were used for prediction with each of
the techniques to explore the impact of increasing the number of data used on the

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 542

C.D. Lloyd and P.M. Atkinson

Figure 3. Experimental variogram with fitted model. Nug. is nugget, Pow. is power. Model
format is nugget + slope6model type(power) for (a) Humberside data set, (b) Shropshire data
set and (c) Lincolnshire data set.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 Ground surface DEMs from LiDAR

543

Figure 4. Experimental variogram estimated from residuals from raw data, first order and
second order polynomial trends. For (a) Humberside data set, (b) Shropshire data set and (c)
Lincolnshire data set.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 544

C.D. Lloyd and P.M. Atkinson

Figure 5. Experimental variogram estimated from residuals from second order polynomial
trends fitted over a 125 m6125 m moving window. Nug. is nugget, Sph. is spherical. Model
format is nugget + sill 6 model type(range). For (a) Humberside data set, (b) Shropshire data
set and (c) Lincolnshire data set.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 Ground surface DEMs from LiDAR

545

Figure 6. Outlines of artificial features removed from the raw LiDAR data and predicted
using the remaining data. In the text, the features are referred to as irregular (top), linear
(middle) and regular (bottom). For (a) Humberside data set, (b) Shropshire data set and (c)
Lincolnshire data set.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 546

C.D. Lloyd and P.M. Atkinson

Figure 6.

(Continued.)

accuracy of predictions. Prediction with gaps formed by linear, regular and irregular
features will be outlined in turn.

Tables 3, 4 and 5 summarise the smallest maximum absolute errors, means closest
to zero and smallest RMSE for each data set and each feature type. The three tables
refer to the Humberside, Shropshire and Lincolnshire data sets, respectively. The
RMSE values for each neighbourhood are given in figures 7 (linear features), 8
(regular) and 9 (irregular). For linear features, the smallest RMSE values were
provided by KT—using 150 nearest neighbours for Humberside, between 120 and
210 nearest neighbours, in steps of 30, for Shropshire and between 90 and 210
nearest neighbours for Lincolnshire. For KT, the RMSE values tended to become
smaller as the number of nearest neighbours was increased. The smallest absolute

Table 2. Extracted data.

Description

Humberside data set

Shropshire data set

Lincolnshire data set

Linear features
Regular features
Irregular features

2627
1544
2535

742
509
736

1380
507
1416

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 Ground surface DEMs from LiDAR

547

Table 3. Smallest maximum absolute prediction errors, mean closest to zero and smallest
maximum RMSE: Humberside data set.

Gap Method Max AE

NN

Mean

RMSE

NN

Lin. IDW
Lin. OK
Lin. KT
Reg. IDW
Reg. OK
Reg. KT
Irr.
Irr. OK
Irr. KT

IDW

0.980
0.920
0.960
0.627
0.453
0.422
1.530
1.485
1.445

30
90
90
210
210
210
30
90,210
150

0.160
20.00286
20.00218
20.0203
20.00583
20.00187
20.0300
20.0132
20.00803

NN

30
30
150
30
30
180
30
210
60

0.104
0.0838
0.0813
0.209
0.123
0.117
0.207
0.196
0.178

90,120
150
150
210
180,210
210
30
210
210

Table 4. Smallest maximum absolute prediction errors, mean closest to zero and smallest
maximum RMSE: Shropshire data set.

Gap Method Max AE

NN

Mean

NN

RMSE

NN

210
90
210
60
120
120
150,180
150
150

20.000680
0.0129
0.0134
0.150
0.0410
0.00643

20.406
20.00215
0.0158

30
180,210
30
30
210
120
30
150
60

0.245
0.211
0.197
0.616
0.255
0.205
0.742
0.138
0.134

60
60,120
120–210
30
210
210
30
120
90

Table 5. Smallest maximum absolute prediction errors, mean closest to zero and smallest
maximum RMSE: Lincolnshire data set.

Gap Method Max AE

NN

Mean

NN

RMSE

NN

Lin. IDW
Lin. OK
Lin. KT
Reg. IDW
Reg. OK
Reg. KT
Irr.
Irr. OK
Irr. KT

IDW

Lin. IDW
Lin. OK
Lin. KT
Reg. IDW
Reg. OK
Reg. KT
Irr.
Irr. OK
Irr. KT

IDW

1.085
1.128
1.218
1.846
0.714
0.648
1.923
0.503
0.442

1.141
1.137
1.076
1.141
0.270
0.240
0.533
0.211
0.227

60
210
90
60
210
90
210
150
210

0.00785
0.00798
0.0113
0.00354
20.00322
20.00102
0.000380

20.0120
20.0144

150
210
180,210
90
210
210
150
210
210

0.109
0.104
0.103
0.142
0.0540
0.0519
0.194
0.0636
0.0666

30,60
30–210
90–210
30
180
90
30,210
150
210

errors were given by OK (90 neighbours, Humberside), IDW (210 neighbours,
Shropshire) and KT (90 neighbours, Lincolnshire). The means closest to zero were
given by KT (150 neighbours, Humberside), IDW (30 neighbours, Shropshire) and
IDW (150 neighbours, Lincolnshire).

For regular features, for all data sets the smallest RMSE values were provided
by KT using 210 nearest neighbours (Humberside), 210 nearest neighbours
(Shropshire) and 90 nearest neighbours (Lincolnshire). For the Humberside and
Shropshire data sets, OK and KT RMSE values tended to become smaller as the

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 548

C.D. Lloyd and P.M. Atkinson

Figure 7. RMSE against number of nearest neighbours for linear features. Data sets are
referred to as numbers 1 (Humberside), 2 (Shropshire) and 3 (Lincolnshire).

number of nearest neighbours increased. The smallest absolute errors were given by
KT (210 neighbours, Humberside), KT (120 neighbours, Shropshire) and KT (90
neighbours, Lincolnshire). The means closest to zero were given by KT in all three
(Humberside), 120 nearest neighbours
cases using 180 nearest neighbours
(Shropshire) and 210 nearest neighbours (Lincolnshire).

For irregular features the smallest RMSE values were provided by KT (210
neighbours, Humberside), KT (90 neighbours, Shropshire) and OK (150 neigh-
bours, Lincolnshire). For the Humberside and Lincolnshire data sets for KT, and,
to a lesser extent OK, RMSE values tended to become smaller as the number of

Figure 8. RMSE against number of nearest neighbours for regular features. Data sets are
referred to as numbers 1 (Humberside), 2 (Shropshire) and 3 (Lincolnshire).

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 Ground surface DEMs from LiDAR

549

Figure 9. RMSE against number of nearest neighbours for irregular features. Data sets are
referred to as numbers 1 (Humberside), 2 (Shropshire) and 3 (Lincolnshire).

nearest neighbours increased. This is likely to be, in part, a function of the fact that
the number of observations extracted from the Humberside data set and the
Lincolnshire data set (2627 and 1380 points, respectively) was much larger than the
number extracted from the Shropshire data set (742). The smallest absolute errors
were given by KT (150 neighbours, Humberside), KT (150 neighbours, Shropshire)
and OK (150 neighbours, Lincolnshire). The means closest to zero were given by KT
(60 neighbours, Humberside), OK (150 neighbours, Shropshire) and IDW (150
neighbours, Lincolnshire).

The mapped prediction errors using a neighbourhood of 30 data are given for the
three data sets in figure 10 (OK) and figure 11 (KT). The mapped prediction errors
for 210 data are given in figures 12 (OK) and 13 (KT). The large prediction errors
made by KT using 30 data are evident in figure 11. All of these maps were generated
using IDW by assigning errors at point locations to cells with a spacing of 1 m, as
the original points were too dense to assess patterns visually. Therefore, the
maximum errors in the maps are smaller than those in the tables. In all of the maps
there are patches representing large prediction errors, which are discussed below.

5. Discussion

Tables 3, 4 and 5 indicate that the smallest RMSEs obtained using IDW are always
larger than the smallest RMSE obtained using OK or KT. This is further indicated
graphically in figures 7, 8 and 9, corresponding to linear, regular and irregular
features, respectively. In some cases the differences are large and the smallest RMSE
values for IDW are sometimes several times larger than those for OK or KT. The
most accurate predictions on the basis of the RMSE are usually provided by KT for
all three types of features removed. The only exception is for the Lincolnshire
data set with irregular gaps. The differences are not large but, combined with the
smaller mean errors and maximum absolute errors usually provided by OK and
KT against IDW and, to a lesser extent, KT against OK, KT appears to be the
most appropriate method of those applied. This is more clearly the case for regular

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 550

C.D. Lloyd and P.M. Atkinson

Figure 10. OK prediction errors, 30 observations. Point values interpolated to a grid with
1 m spacing. For (a) Humberside data set, (b) Shropshire data set and (c) Lincolnshire data
set.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 Ground surface DEMs from LiDAR

551

Figure 10.

(Continued.)

and irregular features than for linear features. A specific advantage of OK and
KT over IDW is that the former two methods can predict outside of the data range
whereas, with IDW, it is only possible to predict values within the range of the
available data and this may have important implications for gap filling where the
true elevations in the area covered by the gap represent a locally low-lying area or a
peak.

A range of factors may affect the accuracy of predictions. As well as the shape of
and area covered by a gap and the amount and distribution of data available for
prediction, the shape of the topography in the region may be important (Doucette
and Beard 2000). In many cases, it may not be possible to remove fully all of a given
feature. For example, removing fully a vegetation feature may be more difficult, in
some cases, than removing a clearly defined building.

For both OK and KT conducted using the 30 nearest observations, there is
evidence of a relationship between errors in predictions and distance from the edges
of the gaps. This is more clearly the case for KT (figure 11 and for the irregular
features in particular) than for OK (figure 10) and this supports the interpretation of
larger errors for KT than for OK where a small data neighbourhood is used. For
OK and KT, where predictions are based on the nearest 210 data (figures 12 and 13,
respectively), distance from the edge of the gap does not appear to affect so

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 552

C.D. Lloyd and P.M. Atkinson

Figure 11. KT prediction errors, 30 observations. Point values interpolated to a grid with
1 m spacing. For (a) Humberside data set, (b) Shropshire data set and (c) Lincolnshire data
set.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 Ground surface DEMs from LiDAR

553

Figure 11.

(Continued.)

markedly the magnitude of the prediction error and the maps in figures 12 and 13
are similar visually and the range of error values are alike. This suggests that the
fitting of a local polynomial trend to the data as part of KT may be problematic
when ‘filling in’ large gaps in the surface. That is, when estimating within the
extracted linear feature, the fitting of the polynomial trend is fairly robust since the
data used for prediction are quite close together and are likely to come from both
sides of the gap. However, when estimating to locations separated by larger
distances, as is the case for the regular and irregular features, the fitting of the
polynomial trend becomes less reliable. Therefore, the less complex OK will be more
robust when data are widely-spaced, and the data may come primarily from one side
of the gap, since there is no requirement to fit a local polynomial as a prior stage to
prediction. So, by increasing the number of data used in prediction the fit of the
polynomial becomes more stable and the results support this hypothesis. If data
were selected from around the ‘gap’, rather than potentially from only one side, KT
should provide results at least comparable with OK. Based on those results, we
recommend that simply using the nearest n data is particularly unsuitable for KT
and it is more appropriate to select data from all around the gap within which
predictions are being made.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 554

C.D. Lloyd and P.M. Atkinson

Figure 12. OK prediction errors, 210 observations. Point values interpolated to a grid with
1 m spacing. For (a) Humberside data set, (b) Shropshire data set and (c) Lincolnshire data
set.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 Ground surface DEMs from LiDAR

555

Figure 12.

(Continued.)

For the Humberside data set, there are large errors for both OK and KT
corresponding to the location of the linear objects captured by LiDAR—noted in
section 3.2 and shown in figure 2a. For the Lincolnshire data set, a linear feature
(perhaps a ditch) visible in the DEM (figure 2c) crosses through the west end of the
‘synthetic’ linear feature, resulting in the large positive prediction errors evident at
the corresponding location in figures 10c, 11c, 12c and 13c. It is not surprising that
predictions of the heights around this feature, and similar features at other locations
and for the other data sets, are inaccurate given that they are based primarily on
neighbouring bare ground heights. There is a need to properly remove above-surface
features, or perhaps fill in hollows or ditches if appropriate, prior to interpolation as
ground surface predictions should be based on data at ground level only—although
this process was conducted using ‘synthetic’ features in the current research and real
above surface features were limited in this case. The patches of (relatively) large
errors within the linear feature for the Shropshire data set may also be due to the
presence of vegetation features.

The ‘true’ ground elevations, predicted from points using IDW for illustrative
purposes, and prediction errors for regular features in the Humberside area, for
prediction using OK and KT with 30 and 210 nearest neighbours, are given in
figure 14. ‘True’ elevations and prediction errors for the largest irregular feature in

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 556

C.D. Lloyd and P.M. Atkinson

Figure 13. KT prediction errors, 210 observations. Point values interpolated to a grid with
1 m spacing. For (a) Humberside data set, (b) Shropshire data set and (c) Lincolnshire data
set.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 Ground surface DEMs from LiDAR

557

Figure 13.

(Continued.)

the Humberside area, again for OK and KT with 30 and 210 nearest neighbours, are
given in figure 15. These allow a more detailed examination of spatial variation in
prediction errors. For the regular features, there are areas in the eastern-most
feature where elevations are under-estimated and smaller patches where values are
over-estimated. The transition from areas where elevations are under-estimated to
those where they are over-estimated is quite smooth. These patterns may be due, as
suggested above, to the presence of above-ground features. Alternatively, where a
structure is located on terrain with a relatively steep slope locally, as is indicated here
in figure 14a, such patches of values that over-estimate or under-estimate true
elevations might be expected. The transition between large and small errors,
whereby errors are largest far from the edge of a feature, is more marked for KT
using 30 neighbours, as shown in figure 14c, than for the other approaches and the
range of errors is largest in that case. This supports the argument elsewhere that
fitting a polynomial using data primarily from one side of the gap is likely to result
in large prediction errors. The range of errors is notably smaller where 210
neighbours are used for prediction as shown in figures 14d and 14e. For the selected
irregular feature, shown in figure 15, there are linear patches where elevations are
under-estimated. These indicate the presence of features such as hedges as also
suggested by figure 15a. As for regular features, the most marked transition between

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 558

C.D. Lloyd and P.M. Atkinson

Figure 14. Humberside data set, regular features: (a) ‘True’ elevations, (b) OK 30 NN, (c)
KT 30NN, (d) OK 210 NN, (e) KT 210 NN.

large and small errors results from application of KT using 30 neighbours as shown
in figure 15c. For both the regular and irregular features, the range of errors for KT
is smaller than that for OK. That is, as the RMSE values suggest, KT provides more
accurate predictions than OK at most locations. Note that figures 14c and 15c,
showing errors for KT using 30 nearest neighbours, appear less ‘noisy’ than the
other error maps. This is due to the larger range of errors in these maps, making
small local errors less clearly visible.

The implications for the kriging variance have not been explored. The magnitude
of the kriging variance can be used as a guide to uncertainty in predictions.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 Ground surface DEMs from LiDAR

559

Figure 15. Humberside data set, irregular feature: (a) ‘True’ elevations, (b) OK 30 NN, (c)
KT 30NN, (d) OK 210 NN, (e) KT 210 NN.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 560

C.D. Lloyd and P.M. Atkinson

The kriging variance for the Lincolnshire data set using OK with the 210 nearest
neighbours is shown as an example in figure 16. That the kriging variance is
larger away from the edges of the gaps is clear. This suggests that the kriging
error and the prediction error are related, but examination of
the corres-
ponding map of prediction errors (figure 12c) suggests that the relationship is
not a simple linear one, particularly where the number of neighbours used in
prediction is large. A more in depth examination of the kriging variance would
be useful in this context.

Although this paper assumes that features have already been removed prior to
geostatistical analysis, geostatistics may have worth in determining which
observations (features) should be removed. For example, Todd et al. (2003) apply
IK to help identify such features. The examination of LiDAR returns may allow

Figure 16. Lincolnshire data set: kriging variance, OK with 210 observations.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 Ground surface DEMs from LiDAR

561

differentiation between primary and secondary returns and this can be used to help
identify and remove vegetation (Campbell 2002). In addition to this in-built
advantage of LiDAR, moving window approaches, as employed here, may be
particularly useful in helping to identify vegetation and built structures. In many
cases, acquisition of data on the ground may be possible to supplement the LiDAR
data and assist in gap fill. For example, if positional data are available on a forest
floor these data can be used to help ascertain local ground heights and to inform
predictions where these are required. Use of such data may have a marked impact
on the accuracy of predictions as they reduce the need to extrapolate altitude values
into gaps.

6. Conclusions

Lloyd and Atkinson (2002a) demonstrated that, even given the marked evidence of
change in the mean across the region of interest, KT was not necessarily beneficial
for the purposes of deriving DEMs from LiDAR data. However, it was shown that
the benefits of KT increased over inverse distance weighting (IDW) and OK as the
sample spacing increased (that is, as the original data were thinned and more
samples were removed). In this paper, the objective was to ‘fill-in’ areas—predict
ground surface elevations—after the removal of above-surface features. Here, both
OK and KT provided more accurate predictions than IDW. However, although KT
provided more accurate predictions than OK in most cases, the absolute differences
in RMSE for OK and KT were not large and, in that respect, the results presented
by Lloyd and Atkinson (2002a) are supported in this analysis. At first sight there
appears to be, therefore,
little justification for employing the more complex
approach of KT in place of OK. From another perspective, KT offers real benefits.
For example, the smallest RMSE for OK for the Shropshire data set with regular
gaps was 0.255 and for KT it was 0.205 m. The latter figure is some 19.6% smaller
than the former and it could thus be argued that KT has helped reduce the
remaining error by a large proportion. Given current wide usage of LiDAR data
and that some method of interpolation must be used to derive a surface it is sensible
to make use of the approach that provides the most accurate results. In this case, the
indications are that KT should be used in such applications, but that use of a
sensible search strategy is crucial. A high accuracy means of acquiring altitude data
(LiDAR) should be accompanied by the interpolation procedure that gives most
accurate results.

Geostatistics provides tools that are appropriate for the derivation of DEMs from
LiDAR point data. To assess more fully the merits of these approaches it will be
necessary to expand the range of data analysed, the range of techniques employed
(for example, variants of thin plate splines could be applied) and to explore the
impact of the usefulness of the kriging standard error as a guide to uncertainty in
predictions.

Acknowledgements
The authors would like to thank Nick Holden of the Environment Agency for
providing the Humberside data set and David Holland of the Ordnance Survey of
Great Britain for making these data available. Paul Nelson of the Environment
Agency is thanked for providing the Shropshire and Lincolnshire data sets. The
Ordnance Survey and the University of Southampton are also thanked for
supporting the research on which this paper builds.

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 562

C.D. Lloyd and P.M. Atkinson

References
ARMSTRONG, M., 1998, Basic Linear Geostatistics (Berlin: Springer).
BECKERS, F. and BOGAERT, P., 1998, Nonstationarity of the mean and unbiased variogram
estimation: extension of the weighted least squares method. Mathematical Geology,
30, pp. 223–240.

CAMPBELL, J.B., 2002, Introduction to Remote Sensing, third edition (London: Taylor &

CHILE` S, J.P. and DELFINER, P., 1999, Geostatistics: Modeling Uncertainty (New York: John

Francis).

Wiley and Sons).

CHRISTENSEN, R., 1993, Quadratic covariance estimation and equivalence of predictions.

Mathematical Geology, 25, pp. 541–558.

CRESSIE, N.A.C., 1991, Statistics for Spatial Data (New York: John Wiley and Sons).
CRESSIE, N.A.C. and ZIMMERMAN, D.L., 1992, On the stability of the geostatistical method.

CURRAN, P.J., 1988, The semivariogram in remote sensing: an introduction. Remote Sensing

Mathematical Geology, 24, pp. 45–59.

of Environment, 24, pp. 493–507.

Physical Geography, 22, pp. 61–78.

CURRAN, P.J. and ATKINSON, P.M., 1998, Geostatistics in remote sensing. Progress in

DEUTSCH, C.V. and JOURNEL, A.G., 1998, GSLIB: Geostatistical Software Library and User’s

Guide, second edition (New York: Oxford University Press).

DOUCETTE, P. and BEARD, K., 2000, Exploring the capability of some GIS surface
interpolators for DEM gap fill. Photogrammetric Engineering and Remote Sensing, 66,
pp. 881–888.

GOOVAERTS, P., 1997, Geostatistics for Natural Resources Evaluation (New York: Oxford

ISAAKS, E.H. and SRIVASTAVA, R.M., 1989, An Introduction to Applied Geostatistics (New

University Press).

York: Oxford University Press).

JAAFAR, J., PRIESTNALL, G., MATHER, P.M. and VIEIRA, C.A., 1999, Construction of DEM
from LiDAR DSM using morphological filtering, conventional statistical approaches
and artificial neural networks. In RSS 99. Earth Observation: From Data to
Information, pp. 299–306 (Nottingham: Remote Sensing Society).

JOHNSTON, K., VER HOEF, J.M., KRIVORUCHKO, K. and LUCAS, N., 2001, Using ArcGISTM

Geostatistical Analyst (Redlands, CA: ESRI).

JOURNEL, A.G. and HUIJBREGTS, C.J., 1978, Mining Geostatistics (London: Academic Press).
KITANIDIS, P.K., 1993, Generalized covariance functions in estimation. Mathematical

Geology, 25, pp. 525–540.

KRAUS, K., 1997, Restitution of airborne laser scanner data in wooded areas. In EARSeL

Advances in Remote Sensing. Yearbook 1997, Vol. 5, pp. 120–127 (Paris: EARSeL).

KRAUS, K. and PFEIFER, N., 1998, Determination of terrain models in wooded areas with
airborne laser scanner data. ISPRS Journal of Photogrammetry and Remote Sensing,
53, pp. 193–202.

LILLESAND, T.M. and KIEFER, R.W., 2000, Remote Sensing and Image Interpretation, fourth

edition (New York: Wiley).

LLOYD, C.D. and ATKINSON, P.M., 2002a, Deriving DSMs from LiDAR data with kriging.

International Journal of Remote Sensing, 23, pp. 2519–2524.

LLOYD, C.D. and ATKINSON, P.M., 2002b, Non-stationary approaches for mapping terrain
and assessing uncertainty in predictions. Transactions in GIS, 6, pp. 17–30.
LOHR, U., 1998, Digital elevation models by laser scanning. Photogrammetric Record, 16, pp.

105–109.

MATHERON, G., 1971, The Theory of Regionalised Variables and its Applications
(Fontainebleau: Centre de Morphologie Mathe´matique de Fontainebleau).
OLEA, R.A., 1975, Optimum Mapping Techniques Using Regionalized Variable Theory, Kansas
University Geological Survey Series on Spatial Analysis No. 2 (Lawrence: University
of Kansas).

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 Ground surface DEMs from LiDAR

563

OLEA, R.A., 1977, Measuring Spatial Dependence with Semivariograms, Kansas University
Geological Survey Series on Spatial Analysis No. 3 (Lawrence: University of Kansas).
PEBESMA, E.J. and WESSELING, C.G., 1998, Gstat, a program for geostatistical modelling,

prediction and simulation. Computers and Geosciences, 24, pp. 17–31.

REUTEBUCH, S.E., MCGAUGHEY, R.J., ANDERSEN, H.-E. and CARSON, W.W., 2003, Accuracy
of a high-resolution LiDAR terrain model under a conifer forest canopy. Canadian
Journal of Remote Sensing, 29, pp. 527–535.

ROSSI, R., DUNGAN, J. and BECK, L.R., 1994, Kriging in the shadows: geostatistical

interpolation for remote sensing. Remote Sensing of Environment, 49, pp. 32–40.

SAMBERG, A., 1997, What laser scanning can do today: current techniques. In EARSeL

Advances in Remote Sensing. Yearbook 1997, Vol. 5, pp. 114–119 (Paris: EARSeL).

TODD, K.W., CSILLAG, F. and ATKINSON, P.M., 2003, Three-dimensional mapping of light
transmittance and foliage distribution using LiDAR. Canadian Journal of Remote
Sensing, 29, pp. 544–555.

WACKERNAGEL, H., 2003, Multivariate Geostatistics. An Introduction with Applications, third

edition (Berlin: Springer).

WEBSTER, R. and BURGESS, T.M., 1980, Optimal interpolation and isarithmic mapping of soil
properties. III. Changing drift and universal Kriging. Journal of Soil Science, 31, pp.
505–524.

WEHR, U. and LOHR, U., 1999a, Airborne laser scanning—an introduction and overview.

ISPRS Journal of Photogrammetry and Remote Sensing, 54, pp. 68–82.

WEHR, U. and LOHR, U., 1999b, Theme issue on airborne laser scanning. ISPRS Journal of

Photogrammetry and Remote Sensing, 54, pp. 61–63.

WISE, S., 2002, GIS Basics (London: Taylor & Francis).

Downloaded by [Eindhoven Technical University] at 13:51 15 February 2015 