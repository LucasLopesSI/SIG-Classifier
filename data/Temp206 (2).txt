This article was downloaded by: [University of Connecticut]
On: 08 October 2014, At: 15:16
Publisher: Taylor & Francis
Informa Ltd Registered in England and Wales Registered Number:
1072954 Registered office: Mortimer House, 37-41 Mortimer Street,
London W1T 3JH, UK

International Journal of
Geographical Information
Science
Publication details, including instructions for
authors and subscription information:
http://www.tandfonline.com/loi/tgis20

A general model of
watershed extraction
and representation using
globally optimal flow paths
and up-slope contributing
areas
Chaojun Liang & D. Scott MaCkay
Published online: 06 Aug 2010.

To cite this article: Chaojun Liang & D. Scott MaCkay (2000) A general model of
watershed extraction and representation using globally optimal flow paths and
up-slope contributing areas, International Journal of Geographical Information
Science, 14:4, 337-358

To link to this article:  http://dx.doi.org/10.1080/13658810050024278

PLEASE SCROLL DOWN FOR ARTICLE

Taylor & Francis makes every effort to ensure the accuracy of all
the information (the “Content”) contained in the publications on our
platform. However, Taylor & Francis, our agents, and our licensors
make no representations or warranties whatsoever as to the accuracy,
completeness, or suitability for any purpose of the Content. Any
opinions and views expressed in this publication are the opinions and
views of the authors, and are not the views of or endorsed by Taylor
& Francis. The accuracy of the Content should not be relied upon and
should be independently verified with primary sources of information.
Taylor and Francis shall not be liable for any losses, actions, claims,

proceedings, demands, costs, expenses, damages, and other liabilities
whatsoever or howsoever caused arising directly or indirectly in
connection with, in relation to or arising out of the use of the Content.

This article may be used for research, teaching, and private study
purposes. Any substantial or systematic reproduction, redistribution,
reselling, loan, sub-licensing, systematic supply, or distribution in any
form to anyone is expressly forbidden. Terms & Conditions of access
and use can be found at http://www.tandfonline.com/page/terms-and-
conditions

Downloaded by [University of Connecticut] at 15:16 08 October 2014 int. j. geographical information science, 2000, vol. 14, no. 4, 337± 358

Research Article

A general model of watershed extraction and representation using
globally optimal (cid:143) ow paths and up-slope contributing areas

CHAOJUN LIANG1 and D. SCOTT MACKAY2
1Environmental Remote Sensing Center, University of Wisconsin—Madison,
1225 W. Dayton Street, Madison, WI, 53715 USA
2Department of Forest Ecology and Management, and Institute for
Environmental Studies, University of Wisconsin—Madison, 1630 Linden Dr.,
Room 120, Madison, WI, 53706 USA.

(Received 13 July 1998; accepted 9 July 1999)

Abstract. Many modern hydrological models require data inputs provided by
automated digital terrain analysis functions incorporated into GIS. These inputs
include (cid:142) elds representing surface (cid:143) ow directions, up-slope contributing areas,
and sub-catchment partitions. Existing raster-based terrain analysis tools, includ-
ing both those in oŒ-the-shelf GIS packages and those in the recent literature,
were designed to work with digital elevation data in mountainous topography.
For highly variable topography, which may include large (cid:143) ood plains, lakes,
wetlands, and other relatively (cid:143) at areas, existing tools cannot accommodate the
variable signal-to-noise in the source elevation data without signi(cid:142) cant human
intervention to handle special cases. A general model for calculating (cid:143) ow direc-
tions, up-slope contributing areas, and sub-catchment partitions that automatic-
ally adapts to the variable information content of grid-based elevation data sets
is presented here. The model uses a combination of breadth-(cid:142) rst search and global
optimization to extract the maximum amount of signal from any location within
the data. The model
is demonstrated to work well in handling topography
dominated by large (cid:143) ood plains, lakes and other (cid:143) at areas without the need for
a large number of empirical rules. An important contribution of the approach is
the handling of explicit hydrologic features, which makes the spatial representation
closely related to hydrological processes. The results have important implications
for developing hydrological models that are tractable in large, heterogeneous
watersheds using moderate resolution data.

1.

Introduction
Many distributed-component s hydrological models rely heavily on GIS tech-
niques to provide them with co-varying (cid:142) elds of topographic (cid:143) ow paths, soil
hydraulic properties, and vegetation. In moderate-to-stee p topography , up-slope
contributing areas, surface (cid:143) ow directions and catchment boundaries are needed in
rainfall-runoŒmodelling, non-point source pollution modelling, and in distributed
models of forest ecosystems. With the widespread availability of grid-based digital
elevation models (DEMs) their use has become ubiquitous and GIS algorithms
designed to extract hydrological properties from them almost routine. However, even
the most recent research algorithms for up-slope area and (cid:143) ow path representation

Internationa l Journal of Geographica l Information Science
ISSN 1365-881 6 print/ISSN 1362-308 7 online © 2000 Taylor & Francis Ltd
http://www.tandf.co.uk/journals

Downloaded by [University of Connecticut] at 15:16 08 October 2014 338

C. L iang and D. Scott Mackay

are limited to working in relatively small, steep catchments on clean DEMs. Although
there have been methods to handle DEM noise, e.g. pits and dams, there is as yet
no general method for handling all hydrologically signi(cid:142) cant features of
large
watersheds, such as wide (cid:143) ood plains, lakes, reservoirs, wetlands, and upland (cid:143) at
areas. The existing body of work on this subject suggests that these features require
speci(cid:142) c, over-parameterized models for their handling, often at the expense of dimin-
ishing the information content of the DEM (Tarboton 1997, Mackay and Band
1998 ). We argue that such feature speci(cid:142) c rules hinder the development of generic,
robust tools for watershed characterization. The need for a large number of para-
meters makes the existing tools prohibitive for modelling large watersheds at moder-
ate resolutions. An alternative approach to terrain analysis is presented here in which
global search techniques and optimization reduce the need for an excessive number
of feature speci(cid:142) c parameters.

This work is motivated by a need for improved integration of GIS and distributed
hydrological modelling. Developments in GIS have lead to more e(cid:141) cient imple-
mentation and application of lumped and distributed simulation models. Numerous
comprehensive reviews (Moore et al. 1993, Wilson 1996, Moore 1996, Paniconi et al.
1999 ) describe how GIS addresses issues of data quality, data model—numerical
model integration, parameter aggregation, and hydrologic system representation.
Our work focuses primarily on this latter issue of representation. By representation
we are in part referring to the common framework within which data are collected and
organized, simulation models are designed, and model results are presented.
Numerous such frameworks exist. Grid-based, contour-based , TIN (triangulated
irregular network)—based, and purely lumped models, are example frameworks
within which simulation model inputs are derived. Examples of grid-based models
integrated within either commercial or custom GIS are DHSVM (Wigmosta et al.
1994 ), RHESSys (Band et al. 1993 ) or other models that use TOPMODEL (Beven
and Kirkby 1979 ), SWAT (Arnold et al. 1993), and Vieux et al. (1996). In the case
of models like RHESSys and SWAT the grid-based data inputs are further organized
into hydrologically signi(cid:142) cant features, or functional units for input to the simula-
tions. Functional units are another part of representation that gets at the underlying
conceptual representation of hydrological systems. Sub-catchments and hydrologic
functional units that have been
response units are the most common types of
extracted from DEMs and represented within GIS.

Hydrologic representation based on only catchments and hydrologic units does
not adapt easily to general watershed representation in which water bodies and wide
(cid:143) ood plains may have to be represented. By forcing the restricted representation on
these areas unrealistic models may result. For example, water bodies are often
represented as wide streams during watershed extraction; they are in turn simulated
as wide streams in hydrologic models. Mackay and Band (1998 ) suggest that this is
increasingly a common problem now that hydrologic models are applied outside of
small, mountainous watersheds. Lakes are common features in the glaciated water-
sheds of the Upper Midwest of the United States and other areas around the Great
Lakes. Reservoirs are important features in large watersheds in mountainous areas,
and so they have to be represented as we scale up hydrologic modelling to a regional
extent. If GIS are to support a wide variety of hydrologic modelling then it is
increasingly important that automated watershed representation be adaptable to a
wide range of feature types.

Downloaded by [University of Connecticut] at 15:16 08 October 2014 General model of watershed extraction and representation

339

2. Prior results

This paper addresses grid-based DEMs, which are widely available and used in
a variety of applications including (cid:143) ow path algorithms that support hydrological
modelling. The (cid:142) rst of these (cid:143) ow path algorithms were the steepest descent, or D8,
algorithms of O’Callaghan and Mark(1984 ) and Marks et al. (1984). D8 has been
widely used to partition watersheds into sub-catchment areas (Band 1986a, Jenson
and Domingue 1988, Tarboton et al. 1991), as well as calculating up-slope contribut-
ing area (Morris and Heerdegen 1988, Jenson and Domigue 1988, Band 1989,
Ehlschlaeger 1989, Lammers and Band 1990, Martz and Garbrecht 1992, Moore
1992, Garbrecht and Martz 1997, Mackay and Band 1998, Wilson and Gallant
1998 ). Fractional, or F8, (cid:143) ow algorithms partition (cid:143) ow from a cell to all of its eight
neighbors by weighting (cid:143) ow according to relative slope (Freeman 1991, Quinn et al.
1991 ). Uncertainty associated with F8 weighting schemes prompted development of
a (cid:143) ow-tube analogy in which (cid:143) ow across a planar surface is resolved for each cell
using both aspect and gradient of the plane (Lea 1992, Costa-Cabral and Burges
1994, Tarboton 1997).

Regardless of how (cid:143) ow is routed all cell-based algorithms attempt to (cid:142) nd surface
(cid:143) ow directions and up-slope areas either during an ascent from concave points on
the DEM or descent from convex points on the DEM. The information gathered by
these algorithms is aŒected by error in the DEM, such as pits or dams. Pits and
dams occur as a result of insu(cid:141) cient or missing data during DEM production. In
small, steep watersheds, pits and dams are usually negligible due to the high local
topographic relief. However, in (cid:143) atter areas of larger watersheds or in lake-dominated
areas, pit depths and dam heights often exceed local true elevation diŒerences.
Figure 1 shows the diŒerent eŒects of DEM errors in steep and (cid:143) at areas, respectively,
and (cid:142) gure 2 shows how these errors propagate to (cid:143) ow path searching algorithms.
The sensitivity of these algorithms to DEM noise results in a number of pathological
drainage conditions, including gaps (Chorowicz et al. 1992, Costas-Cabral and Burges
1994 ) and loops (Band 1989, Smith et al. 1990 ).

A number of simple rules have been devised to overcome gaps and loops,
including pit (cid:142) lling (Marks et al. 1984, Band 1986a, Jenson and Domingue 1988,
Martz and Garbrecht 1992 ), dam breaching (Garbrecht and Martz 1996), and slope
tolerances (Band 1989). During pit (cid:142) lling a surface is formed by (cid:142) lling a pit to some
new pour height. This produces a surface through which (cid:143) ow paths can be inferred
from the surrounding topography (Martz and Garbrecht 1997). Slope tolerances
permit (cid:143) ow connections as long as the slope gradient of a cell is below some threshold
value. They also allow for catchment area spillage over shallow divides and into
adjacent catchments, and so such simple rules should be used with caution.

Bennett and Armstrong (1996) used a bit-mapped classi(cid:142) cation scheme to place
each DEM cell into one of six categories based on the topographic form of its local
and extended neighbourhoods . Cells with similar topographic form were aggregated
into networks that represented stream channels and basin divides. A similar image
processing approach was (cid:142) rst demonstrate d by Toriwaki and Fukumura (1978) and
later extended by Band (1986b) for hydrological applications. Bennett and Armstrong
(1996) further extended this image processing in that the stream and divide networks
are extracted from the DEM and stored in vector-based data structures. To remove
erroneous pits in (cid:143) at areas, a ‘best (cid:142) rst’ (maximum descent/minimum ascent) method
is used to (cid:142) nd down-slope streams. However, human intervention is needed to de(cid:142) ne
an application speci(cid:142) c threshold and to decide whether to make the connection
or not.

Downloaded by [University of Connecticut] at 15:16 08 October 2014 340

C. L iang and D. Scott Mackay

Figure 1. Contrasting signal-to-noise ratios in steep and (cid:143) at areas of a DEM. The magnitude
of errors are identical for the two areas, but dams and pits are formed in (cid:143) at areas.

Figure 2. EŒects of errors in a DEM on the calculation of (cid:143) ow directions and up-slope areas.

Mackay and Band (1998) introduced the concept of a priori identi(cid:142) cation of
lakes and other (cid:143) at features on the DEM, which improved the overall catchment
area and (cid:143) ow path calculations, and guided the selection of appropriate rules for
handling these hydrologically signi(cid:142) cant features. Their approach allows for selective
positioning of diŒerent rules and tolerances within diŒerent areas of the DEM, which
essentially maximizes the gain of information from the data. Liang and Mackay(1997)
re(cid:142) ned this approach by introducing a rule-based heuristic that minimizes the loss
of DEM information content that typically occurs with the introduction of additional

Downloaded by [University of Connecticut] at 15:16 08 October 2014 General model of watershed extraction and representation

341

rules that require human interaction. Here we generalize and extend these results in
order to develop a general tool for acquiring topographically-base d hydrologic
information from a wide range of watershed areas and landscape types.

3. Methods
3.1. Breadth-(cid:142) rst versus depth-(cid:142) rst search

Following Marks et al. (1984) up-slope contributing areas are identi(cid:142) ed by some
form of recursive upward climb from a speci(cid:142) ed outlet cell. From a starting cell an
up-slope cell is found and the algorithms proceed by moving to the up-slope cell
and continuing the search until a divide is encountered. A depth-(cid:142) rst search strategy
is usually used by these algorithms. A depth-(cid:142) rst search path is (cid:142) rst identi(cid:142) ed
completely to its source at a divide before any other paths are followed. Areas are
accumulated on the recursive unwinding. While this is a simple and e(cid:141) cient way to
accumulate contributing areas, it gives correct up-slope contributing areas only if
the underlying (cid:143) ow path is identi(cid:142) ed correctly early in the search. However, it is not
at all eŒective in searching for (cid:143) ow paths in areas of low to moderate local relief.
Unlike steep areas on a DEM (cid:143) ow direction information in more moderate areas is
usually either disrupted by noise or unde(cid:142) ned (i.e., perfectly (cid:143) at), and so prior to
accumulating the up-slope areas the (cid:143) ow paths must be approximated.

An alternative to the depth-(cid:142) rst search algorithm is breadth-(cid:142) rst search. Figure 3
shows the search sequence of depth-(cid:142) rst and breadth-(cid:142) rst search algorithms operating
in a two-dimensional grid-based search space. Depth-(cid:142) rst search exhausts one path
before going to the next, while breadth-(cid:142) rst search visits all immediate neighbors of
one node before proceeding to the next node. In eŒect, the breadth-(cid:142) rst search has
an advancing front line consisting of nodes held either in a queue or a stack. Initially,
the front line only includes the starting nodes. After the nodes in the front line are
all visited, any of their respective unvisited immediate up-slope neighbors are added
to the front line and old nodes in the front line are deleted. The front line continues
to expand until all nodes have been visited.

Although depth-(cid:142) rst and breadth-(cid:142) rst algorithms both visit one node at a time
they diŒer in their search bias. Depth-(cid:142) rst search follows a path based on the (cid:142) rst
node encountered in the immediate neighbourhood . Since the decision to advance
is based solely on a single cell-to-cell connection the depth-(cid:142) rst approach is sensitive
to DEM noise. However, the search pattern of breadth-(cid:142) rst search can be viewed as
giving all nodes in the neighbourhood equal status as members of the advancing
front line. The size of the queue representing the front line grows and shrinks
according to the distance outward the algorithm must search in order to (cid:142) nd a
reasonable (cid:143) ow path. The result of this adaptive neighborhood search is that the
(cid:143) ow paths are not sensitive to noise as long as there is topographic information
somewhere within the front line.

Although the search strategies diŒer they should produce identical (cid:143) ow directions
and up-slope contributing areas in areas of high signal-to-noise, such as steep areas
on DEMs. In (cid:143) at areas the two algorithms may result in dramatically diŒerent (cid:143) ow
paths. Flat areas are de(cid:142) ned as those areas on a DEM where noise disrupts some
or all the relative elevations of neighbouring cells. Three distinct categories of (cid:143) at
areas are identi(cid:142) ed for the purpose of our analysis. First, as a result of DEM scale,
data truncation and noise, (cid:143) at areas in DEMs can be perfectly (cid:143) at, i.e. all the cells
in the (cid:143) at area are at the same elevation. In this case, (cid:143) ow directions are unde(cid:142) ned.
Second, small relative elevations of neighboring cells may be overwhelmed by DEM

Downloaded by [University of Connecticut] at 15:16 08 October 2014 342

C. L iang and D. Scott Mackay

Figure 3. Progression through time of depth-(cid:142) rst search and breadth-(cid:142) rst search algorithms.
Each square represents a node in the search tree and a cell on a grid-based DEM.
Line segments represent connections between cells. The numbers in each cell represent
the order in which the cells are encountered in the search. Depth-(cid:142) rst search tends to
sweep across the search space, while breadth-(cid:142) rst expands outward from a starting
location.

Downloaded by [University of Connecticut] at 15:16 08 October 2014 General model of watershed extraction and representation

343

noise. In this case, the (cid:143) ow directions are meaningless and are also considered
unde(cid:142) ned. In both of the above two cases, arti(cid:142) cial (cid:143) ow paths within (cid:143) at areas have
to be created according the elevation information of the surrounding cells for three
reasons: First, in order to conform to reality as close as possible; second, in order
to preserve continuity of (cid:143) ow paths for use in hydrological models; and last and
most important, (cid:143) at areas occur most often within valley bottoms, and so up-slope
areas would not be fully accumulated for large watersheds if (cid:143) at areas were not fully
marked. We observe that many noisy areas on a DEM occur in the hydrologically
most active areas, such as in (cid:143) ood plains and riparian areas. As such, it is important
that (cid:143) ow paths through these areas be closed using the maximum amount of
topographic information possible. Figure 4 shows the diŒerent (cid:143) ow paths produced
by the two search algorithms on a small piece of a (cid:143) at DEM. Since the cells on a
DEM are connected to one another directly or indirectly, the depth (cid:142) rst search
algorithm tends to traverse all the cells in no more than a couple of entangled paths,
resulting in unrealistic (cid:143) ow paths. The up-slope area image accumulated with this
kind of (cid:143) ow path will show the (cid:143) at areas as unrealistically wide streams where
neighboring cells inside often have opposing (cid:143) ow directions. Since the breadth (cid:142) rst
search algorithm depends less upon making a decision with little or no information
it is not expected to produce the wide streams.

The third category of (cid:143) at objects, which typically accounts for most of the (cid:143) at
areas on DEMs, has low signal-to-noise with a number of cells having erroneous
relative elevations, but a topographic signal exists within a larger neighbourhood .
Depth-(cid:142) rst search often fails to (cid:142) nd this regional topographic signal because it
cannot see more than one point-to-point connection at a time. When it changes (cid:143) ow
direction of a potential ‘noisy’ cell according to this single connection more error
may be introduced. However, the advancing front line of the breadth-(cid:142) rst search is
more tolerant of a potentially noisy cell, and so it preserves more of the original
information in the DEM. The algorithm is as follows:

For each cell i on the front line {
For each neighbour j of i {

If (gradient( j)< (cid:143) at_threshold ) {

If ( j (cid:143) ows to a cell in the front line) {

Do nothing;

}
Else {

}

Force j to (cid:143) ow to i;

}

}

}

The breadth-(cid:142) rst algorithm can leave a noisy cell’s (cid:143) ow direction unchanged as
long as it (cid:143) ows to one of the cells on the front line. Thus, only noisy cells that do
not (cid:143) ow to the front line are considered true noise and are forced to (cid:143) ow to the
front line. Since fewer cells are changed based on the information content of a single
pair of cells, the resulting (cid:143) ow paths are more representative of the information
content of the DEM.

Downloaded by [University of Connecticut] at 15:16 08 October 2014 344

C. L iang and D. Scott Mackay

Figure 4. Behaviour of depth-(cid:142) rst search and breadth-(cid:142) rst search on a small (cid:143) at DEM. Each
small square represents a DEM cell. The numbers in the cells indicate the searching
sequence, and the line segments with arrow heads indicate the resulting (cid:143) ow directions.
Depth-(cid:142) rst search forms long, twisted paths because cell (cid:143) ow directions are modi(cid:142) ed
without considering the (cid:143) ow directions of surrounding cells. Breadth-(cid:142) rst promotes
the formation of parallel (cid:143) ow lines because it forms preferential (cid:143) ow towards the
starting location.

3.2. Globally optimal feature handling

Mackay and Band (1998) represent a watershed as a cascading sequence of
objects, which may be single grid cells or clumps of cells representing hydrologically
distinct features. Each watershed object has methods for incorporating it into a
topologically connected set of (cid:143) ow paths. DiŒerent object methods tune the extrac-
tion of information from the DEM. An optimization algorithm developed by Liang
and Mackay (1997) performs this tuning without human intervention, but fails in
(cid:143) at valley bottom areas and where objects straddle divides. The breadth-(cid:142) rst search
algorithm described in the previous section overcomes the (cid:142) rst problem. The second
problem is that objects that straddle divides must be segmented into two or more
diŒerent subcatchments. A solution to this is presented in this section.

As with previous algorithms (Marks et al. 1984, Band 1986, 1989, Mackay and
Band 1998 ), a slope threshold diŒerentiates between noisy cells and clean cells for
each (cid:143) at area. If a cell has a slope gradient that is below some threshold, it is
considered a noise cell and its (cid:143) ow direction may be modi(cid:142) ed to ensure a connected
set of (cid:143) ow paths. If the slope threshold is at or above the threshold, then the cell’s
drainage direction is de(cid:142) ned as the direction of steepest descent, in the case of D8
(cid:143) ow paths, or in multiple directions with (cid:143) ow fractionated by relative slope, in the
case of F8 (cid:143) ow paths. In steep areas and in perfectly (cid:143) at areas, the slope threshold
is normally set to zero. In other (cid:143) at areas, an optimal slope threshold must lie
somewhere between zero and the maximum gradient of the area. If the threshold is
set to a value below the optimum value, then the resulting (cid:143) ow paths may be
disconnected. However, if the threshold is set too high, then more cells than necessary
will be considered noisy and the drainage path will become over-connected, resulting
in wide streams. We de(cid:142) ne the optimal threshold to be the lowest slope threshold
that allows for contiguous marking of the (cid:143) at object. For all (cid:143) at areas that are not
water bodies we use an optimal slope threshold. We recognize that more sophisticated
methods could be developed to handle (cid:143) at areas, but it is our goal to have a general,
adaptable approach rather than one based on handling special cases.

In order to quickly (cid:142) nd the optimal threshold for each (cid:143) at object, we use a
, and
binary search method. For each (cid:143) at object we de(cid:142) ne (1) a pass threshold, T
(2) a fail threshold, T
. The pass threshold is initially high enough to modify the
(cid:143) ow direction of a given cell, while the fail threshold is low enough that the cell (cid:143) ow

p

f

Downloaded by [University of Connecticut] at 15:16 08 October 2014 General model of watershed extraction and representation

345

Figure 5. DEM for the Turkey Lakes Watershed, in central Ontario.

direction must be de(cid:142) ned using one of D8 or F8 (cid:143) ow. Initially, the fail threshold is
set to zero and the pass threshold is set to a prede(cid:142) ned high value, such as the
highest gradient in the area. A precision parameter, P, allows the optimization
algorithm to halt when the diŒerence between the pass and fail thresholds is small
enough to be considered negligible. Each cell’s gradient is compared against these
thresholds. The gradient values are calculated as

Grad(i, j) 5

((I(i 1 1, j)Õ

(I(i, j 1 1)Õ

I(i, jÕ 1))2

I(iÕ 1, j))2 1
2N

(1)

where Grad(i, j) and I(i, j) are the gradient and elevation values at row i and column j
of the DEM, respectively, and N is the DEM cell size in the same unit as the elevation
values. We normally set the precision to be the smallest gradient obtainabl e along a
cardinal direction. For a DEM with one metre vertical resolution, this gives P5 1/(2N).
The pass threshold T p is used to mark (cid:143) ow paths inside a (cid:143) at object. If the
resulting (cid:143) ow paths allow all cells inside the (cid:143) at object to be reached, then the
diŒerence between T p and T f is checked. If the diŒerence is less than P, then T p is
the optimal threshold. Otherwise, the pass threshold may be too high, in which case
it is adjusted to the half point between the pass and fail thresholds. If T p does not

Downloaded by [University of Connecticut] at 15:16 08 October 2014 Ó
346

C. L iang and D. Scott Mackay

allow for marking all cells inside the (cid:143) at object then it is considered too low, at
which point its value is increased by 2 (T p Õ T f) and the fail threshold is changed
to the previous pass threshold. The above process is repeated until the optimal
threshold is found. The following is the pseudo-code of the binary search for an
optimal threshold of an object:

Use breadth-(cid:142) rst search to mark the object with T p;
If (object all marked )
{

T p 5

(T p 1 T f)/2;

P 5 1/(2N);
T p 5 0.05;
T f 5 0;
while(T p Õ T f > P)
{

}
else
{

}

}

tmp 5 T f;
T f 5 T p;
T p 1

5 2(T p Õ

tmp);

With the above algorithm a single object’s optimal threshold can be determined,
but since we do not know the outlets for an object in advance, it would not be reasonable
to isolate each object and optimize its threshold independently of the other objects.
However, we can try to mark the whole DEM and then adjust the thresholds for all
objects using the above algorithm. We then iterate until all the objects have optimal
thresholds . The following is the pseudo-code of this global optimizing algorithm:

bool bAllOptimal 5
while(!bAllOptimal)
{

false;

Mark the whole DEM, each object with its individual thresholds;
bAllOptimal 5
For each (cid:143) at object Oi,
{

true;

If (T p of Oi is not optimal)
{

Adjust T p and T f of Oi;
bAllOptimal 5

false;

}

}

}

Watershed marking begins along the edge of the DEM. All DEM edge cells are
considered possible outlets and are sorted according to their elevations, following
an approach (cid:142) rst presented by Ehlschlaeger (1989 ). Flow paths are searched from
all of the outlets starting from the lowest unmarked edge cell. Thus, objects are
marked from all possible directions, which allows for their partitioning into multiple
catchments when they straddle divides.

Downloaded by [University of Connecticut] at 15:16 08 October 2014 General model of watershed extraction and representation

347

Figure 6. DEM for the H. J. Andrews watershed, which is located in the Cascades of central
Oregon.

The above global optimization algorithm may produce excessively high slope
thresholds for some objects that straddle divides. A divide straddling object must be
marked simultaneously from all directions to be optimally marked. However, it may
in fact be reached at diŒerent iterations from diŒerent directions if there are diŒerent
numbers of (cid:143) at objects in series within each respective catchment. Objects are
optimized in the order in which they are found during an uphill climb. The divide
straddling object will always be the last object found during a climb, and it will be
reached (cid:142) rst from the direction that has the fewest objects in series. It may then be
optimized from the perspective of one valley outlet while the marking processes from
the other valley outlets are optimizing objects downstream. By the time the divide
straddling object is reached from a second path, its threshold may already have been
erroneously optimized. To solve this problem a second pass is made of all objects.
In this pass each object’s threshold is veri(cid:142) ed from all possible outlets. If the fail
threshold succeeds in marking the whole object, then this object may not have been
optimally marked and its optimization is repeated while holding all other objects’
thresholds unchanged. The second pass over the objects is relatively quick since it
can use the knowledge of (cid:143) ow paths gained in the (cid:142) rst pass.

Downloaded by [University of Connecticut] at 15:16 08 October 2014 348

C. L iang and D. Scott Mackay

Figure 7. The Up-slope area image of Ontario site produced using (a) depth-(cid:142) rst search
without feature optimization, (b) depth-(cid:142) rst search with feature optimization, and (c)
using breadth-(cid:142) rst search with global feature optimization.

Water bodies, such as lakes and wetlands, are extracted using boundary marking
(Mackay and Band 1998) rather than optimization. The boundary of a water body
is marked as an absorbing boundary for all (cid:143) ow it receives. The area draining
into the absorbing boundary is propagated to the outlet cell of the water body.

Downloaded by [University of Connecticut] at 15:16 08 October 2014 General model of watershed extraction and representation

349

Figure 7(b).

When up-slope areas are later used to de(cid:142) ne a stream network and associated
sub-watersheds, a topological connection is made between the outlet stream link
and all incoming stream links to the water body. Topological connections are also
made from surrounding subcatchment areas to the water body. This enables us to
explicitly route water into water bodies, and then move water to the outlet using
any amount of hydrologic sophistication as deemed necessary by speci(cid:142) c applications.
This feature-based approach provides for a more (cid:143) exible representation of the
watershed since it does not explicitly de(cid:142) ne how water moves through the water
body, but it retains the water body as a topologically connected component. It has
been used to clearly separate terrestrial and aquatic components of glaciated water-
sheds for hydrologic modelling (Band et al. 1996) and watershed representation
(Robinson and Mackay 1996).

4. Results

We tested our model of topographic characterization with two DEMs of con-
trasting topographic character. One data set is from a lake-dominated topography

Downloaded by [University of Connecticut] at 15:16 08 October 2014 350

C. L iang and D. Scott Mackay

Figure 7(c).

in the Algoma Highlands of central Ontario, Canada. The area has approximatel y
350 meters of relief, which is exceptional for Great Lakes area watersheds (JeŒries
et al. 1988). Otherwise, it is characteristic of the glaciated upland areas around the
Great Lakes, with a predominance of nested lakes, wetlands, and other (cid:143) at areas.
The DEM ((cid:142) gure 5) for this area was derived from a contour map using TOPOG
(CSIRO 1992), which uses a thin plate spline interpolation algorithm (Hutchinson
1989 ). The second data set is of a 1000 km2 area within the Cascade Range in
Oregon, which has over a 1000 m of relief as well as large valley bottoms and
reservoirs. The data is a mosaic of USGS level 2, 7.5 minute quad DEMs ((cid:142) gure 6).

To test the new algorithms we used three diŒerent approaches:

1. depth-(cid:142) rst search with no global optimization (DF) (Band, 1989);
2. depth-(cid:142) rst with global optimization (DFG) (Liang and Mackay, 1997); and
3. breadth-(cid:142) rst with global optimization (BFG).

The results for the Ontario and Oregon sites are shown, respectively, in (cid:142) gures
7 and 8. Figure 7(a) shows the results for the Ontario DEM generated with the DF
approach. In this image, entangling (cid:143) ow paths in the (cid:143) at areas form wide streams,
which is a characteristic result of depth-(cid:142) rst search. In addition, only part of the
watershed is marked. Although raising the slope threshold will increase the size of

Downloaded by [University of Connecticut] at 15:16 08 October 2014 General model of watershed extraction and representation

351

Figure 8. The up-slope area image of Oregon site produced using (a) depth-(cid:142) rst search, and
(b) breadth-(cid:142) rst search.

the marked region, it will also produce a larger number of wide streams. Figure 7(b)
was generated using DFG. By isolating (cid:143) at areas and optimizing each non-lake (cid:143) at
object’s (cid:143) ow path an improved watershed representation results. The watershed is
completely marked and (cid:143) ow pathways are clean with no erroneous wide streams. It
should be noted that the DFG algorithm did not work well for all (cid:143) at areas. We
had to change the classi(cid:142) cation of the two non-lake (cid:143) at objects near the outlet of
the watershed to lake in order to avoid this problem. This result is due to the fact
that the optimization criteria was designed to eliminate wide streams, which in some
areas may be inconsistent with the requirements of the depth-(cid:142) rst search algorithm
to fully mark a (cid:143) at area. Figure 7(c) was generated using BFG. With no modi(cid:142) cation
to any object type, the breadth-(cid:142) rst search climbs through the non-lake (cid:143) at areas
without forming entangled (cid:143) ow paths. One may note that some (cid:143) ow paths on the
right edge of the main watershed extend over the divide. This is due to the quality
of the DEM, which is derived from a watershed map in which areas outside of the
main watershed were not as carefully mapped as areas within the watershed. As a
result, the up-slope area image contains large holes. This prevents some (cid:143) at areas

Downloaded by [University of Connecticut] at 15:16 08 October 2014 352

C. L iang and D. Scott Mackay

Figure 8(b).

that straddle watershed ridges from being searched from all outlets, and so their
slope thresholds are not fully optimized.

Figure 8 shows the results for the Oregon site. Figure 8(a) was generated using
the DF algorithms. Again the depth-(cid:142) rst search forms entangled (cid:143) ow paths in all
(cid:143) at areas, and most notably in the valley bottom along the south edge of the DEM.
No DFG is shown here, as it did not diŒer from DF and the valley bottoms were
already marked using a slope threshold of zero. Figure 8(b) was generated using
BFG. No global optimization was required for this data set as there were no
signi(cid:142) cant non-lake (cid:143) at objects required. In steep areas the results bear minimal
diŒerence to the DF approach, but in (cid:143) at areas the erroneous wide streams are
eliminated. In the (cid:143) attest areas the BFG does tend to produce near-parallel (cid:143) ow
lines, which is to be expected. In general, convergent (cid:143) ow lines are curvilinear and
bend towards the regional (cid:143) ow direction. These results can be explained by examining
the shape of the advancing front line as the breadth-(cid:142) rst search algorithm moves
through the data. Figure 9 shows snapshots of the front line in the form of a greyscale
image. Lighter areas in the image correspond to earlier stages in the search, while
darker parts of the image correspond to later stages of search. Also shown on this
(cid:142) gure are the positions of the front line at every 12th interval; they may be thought

Downloaded by [University of Connecticut] at 15:16 08 October 2014 General model of watershed extraction and representation

353

of as contours formed around pour points. Concentric search areas are formed
around water bodies, which means that whole water body objects are treated as
single pour points in the topography . The curvilinear (cid:143) ow in the large valleys can
be explained by the shape of these contours, which tend to be semi-circular with
their centroids positioned downstream of the contour.

Once up-slope areas and (cid:143) ow paths are known a number of hydrologically
relevant data sets can be produced e(cid:141) ciently. Figure 10 shows the F8 (Freeman
1991, Quinn et al. 1991 ) (cid:143) ow paths for two selected watershed areas. F8 (cid:143) ow is more
representative of (cid:143) ow in convergent topography . It is commonly used in topography -
based hydrologic indices used in models based on TOPMODEL (Beven and Kirkby
1979 ). Figure 11 shows the same watershed areas partitioned into sub-catchment
areas, which are used to construct databases for hydrological modelling (Band 1989,
Lammers and Band 1990). These data products are primary inputs to many hydro-
logic models, including RHESSys (Band et al. 1993) and SWAT (Arnold et al. 1993 ).

5. Discussion

This paper has addressed some shortcomings of existing grid-based watershed
extraction and representation algorithms for low relief areas by using a combinations
of object-based rule optimization and an adaptive search algorithm that is more
robust than previously described algorithms. Previous image processing approaches
to geomorphological feature extraction from DEMs demonstrate d the potential for
feature-based approaches (Toriwaki and Fukumura 1978, Band 1986b, Bennett and
Armstrong 1996 ). Recent developments in feature-based terrain analysis (Liang and
Mackay 1997, Mackay and Band 1998 ) intelligently select algorithms based on
feature type. However, feature-based approaches alone cannot handle highly variable
topography and the need for a great many input parameters makes them ine(cid:141) cient
in large watersheds. The approach presented here overcomes the need for excessive
parameterization, by addressing the underlying problem of low signal-to-noise in
relatively (cid:143) at areas on DEMs. The breadth-(cid:142) rst search algorithm presented here
provides such an adapting mechanism, but does so without the need for a priori
de(cid:142) nition of object parameters. This new model preserves as much hydrologically
signi(cid:142) cant information as is available in the DEM.

An important diŒerence between depth-(cid:142) rst searching and breadth-(cid:142) rst searching
needs discussion. In convergent topography , wide patches are formed using depth-
(cid:142) rst search, but near parallel (cid:143) ow lines are formed by the breadth-(cid:142) rst search
algorithm. This is consistent with the gradual reduction in signal-to-noise, which
requires the algorithm to follow the trend in (cid:143) ow over a larger area. In wide valley
bottoms this tends to produce near -parallel (cid:143) ow paths that are diŒerentiated by a
weak topographic signal. On a perfectly (cid:143) at surface the breadth-(cid:142) rst search produces
parallel (cid:143) ow lines in the direction in which the search is initiated, as illustrated in
(cid:142) gure 4. In contrast a depth-(cid:142) rst search algorithm will degenerate into a simple
space-(cid:142) lling curve that produces a single path for the whole (cid:143) at surface.

Recently, Garbrecht and Martz (1997) presented an approach to resolving (cid:143) ow
through (cid:143) at areas. Their method is similar to the one presented here in that they
adaptively search outward and look for drainage trends within the DEM. It diŒers
in that they require some criteria to determine when to stop the search outward
within the (cid:143) at area, whereas the breadth-(cid:142) rst search algorithm presented here requires
no such criteria. In addition, the approach here uses a single algorithm for both (cid:143) at

Downloaded by [University of Connecticut] at 15:16 08 October 2014 354

C. L iang and D. Scott Mackay

Figure 9. Animation of the advancing front line of the breadth-(cid:142) rst search. The lighter tones
indicate earlier stages of the search, while darker tones represent later stages of search.
Superimposed in the image are snapshots of the position of the advancing front line
at every 12 iterations. This (cid:142) gure shows that water bodies act as pour points around
which concentric search neighbourhoods are formed. It also shows how preferential
(cid:143) ow is formed in wide valley bottoms, such as near the lower edge of the image. The
front line in these relatively (cid:143) at area tend to be concentric arcs, which form convergent
(cid:143) ow lines in the downstream direction.

and steep areas on the DEM, and so there is less chance of ambiguity in determining
which algorithm to use as the search enters a transitional part of the landscape.

6. Conclusions

With the increased application of GIS in hydrologic modelling there is a growing
need for improved compatibility between the spatial representation provided by GIS
and the process representation provided by models. We argued earlier that the
representation of watersheds within a GIS should more closely follow processes, by
explicitly recognizing hydrologic features. For example, lakes, wetlands, and large
(cid:143) oodplains are typically viewed as problem areas for watershed extraction and
representation, and yet they are salient features of most landscapes in which hydrolo-
gic studies occur. We have shown that useful information can be gained from these

Downloaded by [University of Connecticut] at 15:16 08 October 2014 General model of watershed extraction and representation

355

Figure 10. Fractional (F8) (cid:143) ow paths for two watershed areas at the Oregon site. F8 (cid:142) elds
are a primary input to topographic indices, which are used in many hydrologic models.

areas when a combination of feature-based rules and more robust search algorithms
are combined. The adaptive breadth-(cid:142) rst searching algorithm presented here
improves upon the traditional depth-(cid:142) rst searching algorithms in (cid:142) nding clean,
realistic (cid:143) ow paths in low relief areas of DEMs. When coupled with feature-based
global optimization, it derives (cid:143) ow path and up-slope area (cid:142) elds from DEMs of
various source data types without the need for parameter tuning by an end-user.
This demonstrate s that robust and easily generalizable approaches to watershed
extraction and representation can be incorporated into a GIS framework.

A motivation for improving GIS-based terrain analysis tools is the need for
spatial (cid:142) elds for input to hydrologic models of large spatial large extent, such as
watersheds of order 103 km2 or larger. Tools that require considerable parameter
inputs or modi(cid:142) cation to be adapted to diŒerent parts of the landscape are inappro-
priate for large watershed studies at even moderate resolutions. The tools presented
in this paper are appropriate for handling large watersheds with lakes, reservoirs,
large (cid:143) ood plains, wetlands, and upland (cid:143) at areas. In addition, by treating these
hydrologically unique parts of the landscape as features directly improves the

Downloaded by [University of Connecticut] at 15:16 08 October 2014 356

C. L iang and D. Scott Mackay

Figure 11. Sub-catchment partitions and stream lines for two watershed areas at the Oregon
site. These partitions are primary inputs to many hydrologic model, as they represent
closed hydrologic systems with well-de(cid:142) ned boundaries.

development of databases to support hydrological modelling. An important consid-
eration for future work in this area is to better understand the sensitivity of hydrologic
models to the spatial representation provided by the GIS. More eŒort is needed in
understanding how feature classi(cid:142) cation and (cid:143) ow path algorithm selection within
GIS aŒect model design and implementation.

Acknowledgments

Funding for this research was provided by the Graduate School of the University
of Wisconsin-Madison, and McIntire-Stennis. A contour map of the Turkey Lakes
Watershed, from which the DEM was generated, was generously provided by NWRI,
Environment Canada. The DEM for the H. J. Andrews was provided by the Forest
Science Data Bank, a partnership between the Department of Forest Science, Oregon
State University, and the US Forest Service Northwest Research Station, Corvallis,
Oregon. Signi(cid:142) cant funding for H. J. Andrews data was provided by the National
Science Foundation. We thank two anonymous reviewers whose comments have
improved the manuscript.

Downloaded by [University of Connecticut] at 15:16 08 October 2014 General model of watershed extraction and representation

357

References
Arnold, J. G., Allen, P. M., and Bernhardt, G., 1993, A comprehensive surface-groundwater

(cid:143) ow model. Journal of Hydrology, 142, 47–69.

Band, L. E., 1986a, Analysis and representation of drainage basin structure with digital
elevation data. In Proceedings of the Second International Conference on Spatial Data
Handling (Williamsville, NY: International Geographical Union), pp. 437–450.
Band, L. E., 1986b, Topographic partition of watersheds with digital elevation models. Water

Band, L. E., 1989, A terrain-based watershed information system. Hydrological Processes, 3,

Resources Research, 23, 15–24.

151–162.

Band, L. E., Mackay, D. S., Creed, I. F., Semkin, R., and Jeffries, D., 1996, Ecosystem
processes at the watershed scale: Sensitivity to potential climate change. L imnology
and Oceanography, 41, 928–938.

Band, L. E., Patterson, P., Nemani, R., and Running, S. W., 1993, Forest ecosystem processes
at the watershed scale: incorporating hillslope hydrology. Agricultural and Forest
Meteorology, 63, 93–126.

Bennett, D. A., and Armstrong, M. P., 1996, An inductive knowledge-based approach to
terrain feature extraction. Cartography and Geographic Information Systems, 23, 3–19.
Beven, K. J., and Kirkby, M. J., 1979, A physically based, variable contributing area model

of basin hydrology. Hydrological Sciences-Bulletin, 24, 43–69.

Chorowicz, J., Ichoku, C., Riazanoff, S., Kim, Y-K., and Cervelle, B., 1992, A combined
algorithm for automated drainage network extraction. Water Resources Research, 28,
1293–1302.

Costa-Cabral, M., and Burges, S. J., 1994, Digital elevation model networks (DEMON): a
model of (cid:143) ow over hillslopes for computation of contributing and dispersal areas.
Water Resources Research, 30, 1681–1692.

CSIRO, 1992, T opog User Guide. (4.0) (Canberra: CSIRO Division of Water Resources).
Ehlschlaeger, C., 1989, Using the A* search algorithm to develop hydrologic models from
digital elevation data. In Proceedings of International Geographic Information Systems
(IGISD) Symposium ‘89, Baltimore, MD, 18–19 March 1989, Washington, DC: NASA,
pp. 275–281.

Freeman, T. G., 1991, Calculating catchment area with divergent (cid:143) ow based on a regular

grid. Computers and Geosciences, 17, 413–422.

Garbrecht, J., and Martz, L. W., 1996, Digital landscape parameterization for hydrological
applications. In HydroGIS 96: Applications of Geographic Information Systems in
Hydrology and Water Resources Management (Proceedings of the V ienna Conference,
April 1996 ), IAHS Publication no. 235.

Garbrecht, J., and Martz, L. W., 1997, The assignment of drainage direction over (cid:143) at
surfaces in raster digital elevation models. Journal of Hydrology, 193, 204–213.
Hutchinson, M. F., 1989, A new procedure for gridding elevation and stream line data with

automated removal of spurious pits. Journal of Hydrology, 106, 211–232.

Jeffries, D. S., Kelso, J. R. M., and Morrison, I. K., 1988, Physical, chemical, and biological
characteristics of the Turkey Lakes Watershed, central Ontario, Canada. Canadian
Journal of Fisheries and Aquatic Sciences, 45 (Supplement 1), 3–13.

Jenson, S. K., and Domingue, J. O., 1988, Extracting topographic structure from digital
information system analysis. Photogrammetric

elevation data for geographic
Engineering and Remote Sensing, 54, 1593–1600.

Lammers, R. B., and Band, L. E., 1990, Automating object representation of drainage basins.

Computers & Geosciences, 16, 787–810.

Lea, N. L., 1992, An aspect driven kinematic routing algorithm. In Overland Flow: Hydraulics
and Erosion Mechanics, edited by A. J. Parsons and A. D. Abrahams (New York:
Chapman & Hill ).

Liang, C., and Mackay, D. S., 1997, Feature-based optimization of (cid:143) ow directions and
upslope areas on grid-based digital elevation models. In Proceedings of GIS/L IS’97
(Bethesda, MD: American Society for Photogrammetry and Remote Sensing),
pp. 45–52.

Mackay, D. S., and Band, L. E., 1998. Extraction and representation of nested catchment

Downloaded by [University of Connecticut] at 15:16 08 October 2014 358

General model of watershed extraction and representation

areas from digital elevation models in lake-dominated topography. Water Resources
Research, 34, 897–901.

Marks, D., Dozier, J., and Frew, J., 1984, Automated basin delineation from digital elevation

data. Geo-Processing, 2, 299–311.

Martz, L. W., and Garbrecht, J., 1992, Numerical de(cid:142) nition of drainage network and
subcatchment areas from digital elevation models. Computers & Geosciences, 18,
747–761.

Moore, I. D., 1992, TAPES: Terrain analysis programs for the environmental sciences.

Agricultural Systems and Information T echnology, 4, 37–39.

Moore, I. D., 1996, Hydrologic modelling and GIS, In GIS and Environmental Modelling:
Progress and Research Issues, edited by M. F. Goodchild, L. T. Steyaert, B. O. Parks,
C. Johnston, D. R. Maidment, M. P. Crane and S. Glendinning (Fort Collins, CO:
GIS World Books), pp. 143–148.

Moore, I. D., Turner, A. K., Wilson, J. P., Jenson, S. K., and Band, L. E., 1993, GIS and
land-surface-subsurface process modelling, In Environmental Modelling with GIS, edited
by M. F. Goodchild, B. O. Parks and L. T. Steyaert ( New York: Oxford University
Press), pp. 196–230.

Morris, D. G., and Heerdegen, R. G., 1988, Automatically derived catchment boundaries
and channel networks and their hydrological applications. Geomorphology, 1,
131–141.

O’ Callaghan, J. F., and Mark, D. M., 1984, The extraction of drainage networks from
digital elevation data. Computer V ision, Graphics, and Image Processing, 28, 323–344.
Paniconi, C., Kleinfedt, S., Deckmyn, J., and Giacomelli, A., 1999, Integrating GIS and
data visualization tools for distributed hydrologic modelling. T ransactions in GIS,
3, 97–118.

Quinn, P., Beven, K., Chevalier, P., and Planchon, O., 1991, The prediction of hillslope
terrain models.

(cid:143) ow paths for distributed hydrological modelling using digital
Hydrological Processes, 5, 59–79.

Robinson, V. B., and Mackay, D. S., 1996, Semantic modelling for the integration of geo-
graphic information and regional hydroecological simulation management. Computers,
Environment and Urban Systems, 19, 321–339.

Smith, T. R., Zhan, C., and Gao, P., 1990, A knowledge-based, two-step procedure for
extracting channel networks from noisy DEM data. Computers & Geosciences, 16,
777–786.

Tarboton, D. G., 1997, A new method for the determination of (cid:143) ow directions and upslope
areas in grid digital elevation models. Water Resources Research, 33, 309–319.
Tarboton, D. G., Bras, R. J., and Rodriguez-Iturbe, I., 1991, On the extraction of channel

networks from digital elevation data. Hydrological Processes, 5, 81–100.

Toriwaki, J., and Fukumura, T., 1978, Extraction of structural information from grey pictures.

Computer Graphics and Image Processing, 7, 30–51.

Vieux, B. E., Farajalla, N. S., and Gaur, N., 1996, Integrated GIS and distributed storm
water runoŒmodelling, In GIS and Environmental Modelling: Progress and Research
Issues, edited by M. F. Goodchild, L. T. Stevaert, B. O., Parks, C. Johnston, D. R.
Maidment, M. P. Crane and S. Glendinning (Fort Collins, CO:GIS World Books),
pp. 199–205.

Wigmosta, M. S., Vail, L. W., and Lettenmaier, D. P., 1994, A distributed hydrology-

vegetation model for complex terrain. Water Resources Research, 30, 1665–1679.

Wilson, J. P., 1996, GIS-based land surface/subsurface modelling: New potential for new
models?, In Proceedings of the T hird International Conference Integrating GIS and
Environmental Modelling, Santa Fe, NM, 21–25 January, 1996 (Santa Barbara, CA:
National Center for Geographic Information and Analysis, University of California),
( http://www.ncgia.ucsb.edu).

Wilson, J. P., and Gallant, J. C., 1998, Terrain-based approaches to environmental resource
evaluation, In L andform Monitoring, Modelling and Analysis, edited by S. N. Lane,
K. S. Richards and J. H. Chandler (New York: Wiley), pp. 219–240.

Downloaded by [University of Connecticut] at 15:16 08 October 2014 