This article was downloaded by: [Universitat Politècnica de València]
On: 27 October 2014, At: 03:37
Publisher: Taylor & Francis
Informa Ltd Registered in England and Wales Registered Number:
1072954 Registered office: Mortimer House, 37-41 Mortimer Street,
London W1T 3JH, UK

International Journal of
Geographical Information
Science
Publication details, including instructions for
authors and subscription information:
http://www.tandfonline.com/loi/tgis20

Representing multiple
spatial statistics in
generalized elevation
uncertainty models: moving
beyond the variogram
Charles R. Ehlschlaeger
Published online: 10 Nov 2010.

To cite this article: Charles R. Ehlschlaeger (2002) Representing multiple spatial
statistics in generalized elevation uncertainty models: moving beyond the
variogram, International Journal of Geographical Information Science, 16:3,
259-285, DOI: 10.1080/13658810110099116

To link to this article:  http://dx.doi.org/10.1080/13658810110099116

PLEASE SCROLL DOWN FOR ARTICLE

Taylor & Francis makes every effort to ensure the accuracy of all
the information (the “Content”) contained in the publications on our
platform. However, Taylor & Francis, our agents, and our licensors
make no representations or warranties whatsoever as to the accuracy,
completeness, or suitability for any purpose of the Content. Any opinions
and views expressed in this publication are the opinions and views of
the authors, and are not the views of or endorsed by Taylor & Francis.
The accuracy of the Content should not be relied upon and should be
independently verified with primary sources of information. Taylor and
Francis shall not be liable for any losses, actions, claims, proceedings,

demands, costs, expenses, damages, and other liabilities whatsoever
or howsoever caused arising directly or indirectly in connection with, in
relation to or arising out of the use of the Content.

This article may be used for research, teaching, and private study
purposes. Any substantial or systematic reproduction, redistribution,
reselling, loan, sub-licensing, systematic supply, or distribution in any
form to anyone is expressly forbidden. Terms & Conditions of access
and use can be found at http://www.tandfonline.com/page/terms-and-
conditions

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 int. j. geographical information science, 2002
vol. 16, no. 3, 259± 285

Research Article

Representing multiple spatial statistics in generalized elevation
uncertainty models: moving beyond the variogram

CHARLES R. EHLSCHLAEGER
Department of Geography, Hunter College, 695 Park Avenue,
New York, NY 10021, USA; e-mail: chuck@geo.hunter.cuny.edu

(Received 14 September 2000; accepted 19 February 2001)

Abstract.
Spatial data uncertainty models (SDUM) are necessary tools that
quantify the reliability of results from geographical information system (GIS)
applications. One technique used by SDUM is Monte Carlo simulation, a tech-
nique that quanti(cid:142) es spatial data and application uncertainty by determining the
possible range of application results. A complete Monte Carlo SDUM for general-
ized continuous surfaces typically has three components: an error magnitude
model, a spatial statistical model de(cid:142) ning error shapes, and a heuristic that creates
multiple realizations of error (cid:142) elds added to the generalized elevation map. This
paper introduces a spatial statistical model that represents multiple statistics
simultaneously and weighted against each other. This paper’s case study builds a
SDUM for a digital elevation model (DEM). The case study accounts for relevant
shape patterns in elevation errors by reintroducing speci(cid:142) c topological shapes,
such as ridges and valleys, in appropriate localized positions. The spatial statistical
model also minimizes topological artefacts, such as cells without outward drainage
and inappropriate gradient distributions, which are frequent problems with
random (cid:142) eld-based SDUM. Multiple weighted spatial statistics enable two con-
(cid:143) icting SDUM philosophies to co-exist. The two philosophies are ‘errors are only
measured from higher quality data’ and ‘SDUM need to model reality’. This
article uses an automatic parameter (cid:142) tting random (cid:142) eld model to initialize Monte
Carlo input realizations followed by an inter-map cell-swapping heuristic to adjust
the realizations to (cid:142) t multiple spatial statistics. The inter-map cell-swapping
heuristic allows spatial data uncertainty modelers to choose the appropriate
probability model and weighted multiple spatial statistics which best represent
errors caused by map generalization. This article also presents a lag-based measure
to better represent gradient within a SDUM. This article covers the inter-map
cell-swapping heuristic as well as both probability and spatial statistical models
in detail.

1.

Introduction
Monte Carlo simulation, a technique that generates many versions of possible
application results, is a popular method for representing application uncertainty.
Although many Monte Carlo simulations, for example Nichols and Freshley (1993),
perturb the uncertainties in an application, this paper is concerned with representing
the errors in spatial data as they impact the application. Several researchers explore
the process of representing errors in spatial data within applications, and each refers

Internationa l Journal of Geographica l Informatio n Science
ISSN 1365-881 6 print/ISSN 1362-308 7 online © 2002 Taylor & Francis Ltd
http://www.tandf.co.uk/journals
DOI: 10.1080/13658810110099116

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 260

C. R. Ehlschlaeger

to it by a diŒerent name. It is called an ‘error model’ (Hunter and Goodchild 1995),
‘spatial data uncertainty model’
‘error propagation model’
(Arbia et al. 1998), and ‘uncertainty button’ (Goodchild et al. 1999). Since the mid-
1990s, Santa Barbara researchers at the National Center for Geographic Information
and Analysis have been informally using the term ‘error button’ to indicate an
automated process usable by all GIS users.

(Ehlschlaeger 1998),

Although the uncertainty button technique described by Goodchild et al. (1999 )
is conceptually similar to the error button, this author prefers the term ‘error button’
to ‘uncertainty button’. This paper uses the terms ‘error’ and ‘uncertainty’ in a
manner consistent with Hunter and Goodchild (1995).
‘Uncertainty’ refers to the
fact that any given value is measured imperfectly; a value’s uncertainty is an estimate
of the probable inaccuracy of the measurement. ‘Error’ is a subset of uncertainty. It
includes the eŒect of cartographic generalization, inadequate de(cid:142) nition, and con-
sequent variation between observers. Goodchild et al. (1999) envision models of
spatial data error encapsulated within all data layers based on a statistic determined
by the map developers. The term uncertainty button implies that ‘pushing the button’
will tell the GIS user how uncertain the application results will be. One objection
to an automate d button is its lack of sensitivity to diŒerent statistics. Experienced
error modellers can recommend the statistic or statistics that might be most appro-
priate for a particular application. This potentially provides an estimate of uncer-
tainty. An automated technique, on the other hand, is likely to provide only a
representation of quanti(cid:142) ed map errors. Thus, an automated button would provide
a realization of map errors, but there would be no guarante e that the button would
provide a representation of the uncertainty relevant to a desired application. As a
result, uncertainty models may be possible only for well-understood applications.
Throughout this paper, the term ‘spatial data uncertainty model’ (SDUM) will
appear because the paper attempts to represent application uncertainty caused by
the data, not just the measured errors between diŒerent data sources.

Openshaw (1989), Fisher (1991), Bouoiyour (1992), Veregin (1997), and Huss
and Pumar (1997) all use Monte Carlo simulation to create a SDUM. A Monte
Carlo process-based SDUM requires a set of application input maps each of which
consists of a possible representation of application quality data. The Monte Carlo
process applies each input map to an application and produces a set of application
results, one for each input map. If the application is simple enough, the set of
application results is summarized in a histogram. Complex applications require
animation or other complex cartographi c techniques to represent results (Butten(cid:142) eld
and Beard 1994, Davis and Keller 1997, Ehlschlaeger et al. 1997 ).

This paper focuses on the issues that must be considered to generate a set of
elevation maps that can be used as the inputs for an application uncertainty model.
An overland (cid:143) ow hydrologic model is used as the goal application. This paper is
based on three assumptions about the quality of the available data. First, it is
assumed that the overland (cid:143) ow model must be used even though the only maps
available to run it contain data at a resolution too coarse and elevation values too
inaccurate to be certain of the map’s utility. (Such maps are referred to in this paper
as ‘generalized maps’.) The second assumption is that data samples accurate enough
and with a resolution (cid:142) ne enough to achieve useful application results exist. The
third assumption is that there are no statements of data quality, either quantitative
or qualitative, for either set of data, beyond the understanding that the application
quality data are accurate enough for the desired application. The generalized map

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 Building an SDUM for a DEM

261

and application quality data are combined in a process called con(cid:143) ation (Cobb et al.
1998) or data fusion (Wald 1999). An SDUM is both a potential solution to a classic
uncertainty issue as well as a practical way to understand the impact of unavailable
application quality data.

There are two main techniques that have been proposed to create an SDUM:
Taylor series expansion and Monte Carlo simulation. Taylor series expansion’s main
advantage is that the results are in an analytical form. However, Taylor series
expansion can only approximate results, whereas Monte Carlo simulation can pro-
vide results to any desired level of precision (Heuvelink et al. 1989). Also, Openshaw
et al. (1991) declare that there are some applications, namely complex applications,
that require Monte Carlo simulation. Since the main research goal of this paper is
to develop a DEM SDUM for a complex application, Monte Carlo simulation is
the technique adopted for this research. While this research speci(cid:142) cally analyses
digital elevation models, these techniques are applicable to any continuous surface.
The SDUM presented in this paper has three components: a spatially autocorrel-
ated error magnitude model, a pattern model composed of multiple weighted spatial
statistics representing the elevation surface, and a heuristic that creates multiple
realizations of error (cid:142) elds added to the generalized elevation map (in this case, an
inter-map cell-swapping algorithm) . Although this model is more complex than other
spatial data uncertainty models described in the literature, these components are
necessary to provide realistic input maps for Monte Carlo simulation of speci(cid:142) c
applications.

2. Background theory

The SDUM process, in concept, is straightforward as demonstrate d in the follow-
ing example. A more complete description of this example with least cost path and
viewshed analysis is available in case studies within Ehlschlaeger (1998). Assume
that a generalized map completely covers the study area. In this example, the
generalized map is a 3 arc second Defense Mapping Agency DEM (3² DEM)
resampled to 30 m ((cid:142) gure 1). The resampling is necessary because of an application
requiring 30 m resolution USGS DEM (30 m DEM) quality data for reliable results
((cid:142) gure 2). 30 m USGS DEMs are commonly called 7.5¾ DEMs (7.5¾ refers to the
extent of the data). Although a 30 m DEM is not error free, an analysis of the

Figure 1.

3² DEM: generalized map.

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 262

C. R. Ehlschlaeger

Figure 2.

30 m DEM: application quality map.

application result’s variability will incorporate all the 3² DEM errors as part of
the application uncertainty model. Comparing the two DEMs, the application quality
data clearly has ridges and valleys not present on the 3² DEM. Elevation values
from the application quality data compared to elevation values from the generalized
map are used to determine the spatial statistics of all generated maps. Most SDUM
research including statistics incorporating spatial autocorrelation generates an error
(cid:142) eld by subtracting the application quality map from the generalized map:

Z 5 GÕ A, or Z 5 3² DEMÕ

30 m DEM

(1)

where Z is a map of spatially autocorrelated errors, G is a generalized map ((cid:142) gure 1),
and A is map of application quality data samples ((cid:142) gure 2).

The Monte Carlo simulation process (Essaid and Hess 1993) requires many
possible realizations of application quality maps to be made. There are two popular
methods to create a realization for continuous surfaces: cell-swapping and random
(cid:142) eld generation. Cell swapping is discussed in section 4. The technique of random
(cid:142) eld generation adds the values of a random (cid:142) eld to the generalized map:

Ri 5 3² DEMiÕ

6.571

(23.531 5.06ei)Z¾
i

(2)

where Ri is a generated random (cid:142) eld, ei is a Gaussian random variable, and Z¾
i is a
random (cid:142) eld representing spatially autocorrelate d errors Z with spatial dependence
extending 4600 m. Equation (2) is more complicated than the more traditional R 5
G1 Z¾ because it attempts to account for uncertainty in measuring error magnitude
(Ehlschlaeger and Shortridge 1996). The Gaussian random (cid:142) eld model used in this
paper’s study (equation (3)) guarantees a theoretical mean of 0.0, standard deviation
of 1.0, and spatial dependence extending to the distance D (Ehlschlaeger and
Goodchild 1994). Equation (3)’s other parameters, E and F, are normally used to
(cid:142) t manually the spatial statistics of the random (cid:142) eld to the desired surface. In this
research study, E and F are set to constant values (1.0 and 0.0, respectively) to test

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 Building an SDUM for a DEM

263

the utility of an inter-map cell-swapping heuristic on continuous maps. If the inter-
map cell-swapping heuristic can provide good results with a less than optimal spatial
dependence model, it is likely to be a useful tool under normal circumstances.

Z¾

i,u 5

wu,vev

w2u,v

v

S(cid:158)

v

A1Õ

, wu,v 5 G

1
du,vÕ F
DÕ F B

E

0

:

:

du,v < F

du,v > D

: F <du,v, u5 U, v5 V

(3)

i,u is the value of random (cid:142) eld Z¾

Where Z¾
i at point u, U is the random (cid:142) eld area, V
is all land within the distance of spatial dependence to the random (cid:142) eld area, ev is
an uncorrelated normally distributed random (cid:142) eld with mean 0.0 and standard
deviation of 1.0, and du,v is the distance between points u and v.

Adding the results of equation (3) to the 3² DEM (equation (2)) creates a
realization of the 30 m quality DEM. Overall, the realization shows a general resemb-
lance to the 3² DEM: major ridges and valleys are in similar, but not identical,
locations. However, the realization also contains several minor ridges and valleys
not in the 3² DEM. This, of course, is the goal of simulation.

If the application quality data intersect generalized data, samples of application
quality data can be either in the study area or outside the study area. If application
quality data are inside the study area, the Monte Carlo process is a conditional
simulation, meaning that simulated results must copy or be conditioned by the
higher quality data at the points where it is available. When performing conditional
simulation, there is an assumption that only portions of the study area contain
application quality data, and that the rest of the study area requires stochastic
simulation. Otherwise, the Monte Carlo process is an unconditional simulation.
Intersecting the application quality data and the generalized map allows a con(cid:143) ation
technique to de(cid:142) ne an algorithm that generates the probability model
for any
generalized map cell.

Representing the total distribution of potential application results during the
Monte Carlo process requires three critical components: a distribution model for
the continuous surface, a model of spatial statistics for the continuous surface, and
a technique to generate input maps that satisfy the distribution and spatial statistics

Figure 3. Realization of 30 m quality DEM from 3² DEM1

error model.

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 (cid:158)
264

C. R. Ehlschlaeger

models. The probability and spatial statistics models described in this paper assume
that a generalized continuous map of the study area is available. Samples of continu-
ous information accurate enough and with a resolution (cid:142) ne enough to achieve useful
application results are also required. A con(cid:143) ation technique combining the informa-
tion from the generalized map and samples of application quality data de(cid:142) nes a
probability distribution, whereas the samples of application quality data de(cid:142) ne the
spatial statistics desired in the set of Monte Carlo input maps. This paper presents
a combination of techniques including an inter-map cell-swapping algorithm, a
surface distribution model, and a method to (cid:142) t multiple spatial statistics in the
SDUM. Together, these techniques allow for the generation of random continuous
surfaces for the purpose of representing spatial application uncertainty.

3. Spatially autocorrelate d error magnitude model

The error magnitude component in this paper’s SDUM constructs realizations
of elevation maps in a manner consistent with existing spatial data uncertainty
models: the realizations must replicate an error distribution function (equations (1)
and (2 ) in this case study) with mimicked errors spatially autocorrelated (equation
(3) for this case study). There is no requirement that the error realizations be spatially
autocorrelated if one assumes that the cell-swapping realization heuristic will create
(cid:142) nal realizations matching the goal statistics. However, recent research (Ehlschlaeger
2000) indicates that inter-map cell-swapping heuristic (cid:142) nal results match goal statist-
ics more precisely if the errors are spatially autocorrelated before the cell-swapping
begins.

This paper’s case study uses the error distribution function from Ehlschlaeger
et al. (1997). The parameters from Ehlschlaeger et al. (1997) are manually (cid:142) tted to
build an exact error model. However, instead of using equation (3)’s spatial depend-
ence model parameters from that study to mimic more precisely the spatial autocor-
relation, this study handicaps itself with the parameters: D 5 3210, E 5 1.0, F 5 0.0.
The goal in this study is to automate parameter determination as part of the eventual
goal of building an ‘error button’ process. The parameter D is the minimum distance
when generalized data errors are independent of each other, and it is easy to estimate
from a correlogram (equation 4).

1
N(h)

N(h)

i

r(h) 5

xiyiÕ mÕ h m+h

(4)

hs+h

sÕ
Where r is the correlogram, h is the lag vector, N( h) is the set of all lag vectors, xi
h is the
is the value at the lag vector tail, yi is the value at the lag vector head, mÕ
mean of lag vector tail values, m+h is the mean of lag vector head values, sÕ
h is the
standard deviation of lag vector tail values, and s+h is the standard deviation of lag
vector head values.

The map realization process from equations (1)–(3) need not be exact because
the output maps are the inputs to the inter-map cell-swapping heuristic. Equation
(3) parameters are set to E 5 1.0, F 5 0.0 to ensure that the random errors are as
smooth as possible. The cell-swapping process can more easily reduce elevation
spatial autocorrelation than it can increase elevation spatial autocorrelation. In other
words, cell swapping can more easily roughen the surface than smooth it. This case
study can also build random (cid:142) elds of error more quickly by taking advantag e of the

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 (cid:158)
Building an SDUM for a DEM

265

cell swapping heuristic. Instead of building random (cid:142) elds at the goal DEM’s grid
cell resolution of 30 m, the initial random (cid:142) elds had a cell resolution of 60 m. Grid
cells not explicitly realized are linearly interpolated. The random (cid:142) eld-building
process runs 16 times faster for every doubling of grid cell resolution.

Figures 4–6 illustrate the error magnitude model presented in this section.
Figure 4 shows the initial study area data before the initial noise is added to the
overly generalized data. Figure 5 represents the study area’s application quality data.
Figure 6 represents the overly generalized data with a single realization of initial
noise added to it. In addition to contour lines to demonstrate the overall terrain
characteristics, (cid:142) gures 5 and 6 also contain the locations of arti(cid:142) cial pits (discussed
in the goal statistics section). Note that the distribution of arti(cid:142) cial pits is very
diŒerent in the actual data than it is in the simulated data. In the actual data, most
arti(cid:142) cial pits are located in valley bottoms, whereas most arti(cid:142) cial pits in the

Figure 4. Study area’s 3² DEM resampled to 30 m resolution.

Figure 5. Study area’s 30 m DEM with arti(cid:142) cial pits.

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 266

C. R. Ehlschlaeger

Figure 6. Realization of stochastic simulation and initial noise for inter-map swapping
heuristic.

simulated data are located in regions where the generalized map has shallow gradi-
ents. This problem is even worse when traditional random (cid:142) eld methods that try to
(cid:142) t goal variogram statistics exactly are used. Figures 9 and 10 demonstrate the
diŒerence between various goal statistics and the statistics generated by initial noise
added to the generalized map. In all statistics, adding a correlated error map to the
generalized map does not provide (cid:142) ts close to the statistics of goal statistics.
Kyriakidis et al. (1999) demonstrate a technique to provide a (cid:142) t close to the semi-
variogram statistic. However, that technique does not attempt to (cid:142) t other statistics
desired by a decision maker. The next section discusses a procedure that can attempt
to provide a (cid:142) t to any goal statistic, whereas section 5 discusses the various goal
statistics used for this case study.

4.

Inter-map cell swapping
Cell-swapping heuristics are discussed in the geographical research literature of
the last decade (Goodchild 1990). Cell-swapping heuristics require no parameters to
attempt to (cid:142) t a speci(cid:142) c spatial statistic, or, in the case of this research, cell swapping
requires no parameters to (cid:142) t speci(cid:142) c spatial statistics. When the swapping algorithm
begins, a cell is swapped with another cell whenever the resulting maps have a spatial
statistic more closely matching the goal spatial statistic. If the goal spatial statistic
is a variogram, for example, there is never a need to determine sill, range, and nugget
parameters, as the cell-swapping heuristic attempts to (cid:142) t the values at each variogram
lag directly. However, they consume many computer CPU cycles to complete, and
the resulting solutions may (cid:142) t poorly. Previous cell-swapping research attempted to
(cid:142) t a single map by swapping cells within the map itself. This strategy can only be
applied to maps with homoscedastic error distribution models. However, homosced-
astic error distribution is not a property found for most DEMs (and most other
maps). For example, Ehlschlaeger and Shortridge (1996) discuss the fact that error
magnitude is greater in steep terrain than in terrain with a shallow gradient.

This research, however, swaps cells between diŒerent realization maps. The cells
being swapped are from the same geographical location. Since the distribution of

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 Building an SDUM for a DEM

267

grid cell values at any location remains the same when a swap occurs, heteroscedastic
error magnitude models are not modi(cid:142) ed. Thus, error magnitude models can incorp-
orate higher errors found in steeper terrain and other measurable errors on the
generalized map. This technique, named inter-map cell swapping, is used to develop
an area class map uncertainty model (Ehlschlaeger 2000).

Ehlschlaeger (2000) also introduces the concept of seeding the cell-swapping
algorithm’s initial noise (the random maps at the beginning of the swapping process)
with spatially autocorrelated random (cid:142) elds. That study presents the following results:

1. The area class SDUM (cid:142) tting the goal statistic with uncorrelated random (cid:142) elds
as initial noise reduces error by 99.0 % compared to the initial noise. Using
correlated random (cid:142) elds, errors are 99.95–99.99 % smaller than uncorrelated
initial noise.

2. The area class SDUM constructed correlated random (cid:142) elds as initial noise
in 9.75 h using an automated technique while uncorrelated random (cid:142) elds
require 47 h of swapping time to complete on the same computer (a 200 MHz
Pentiumâ
computer). The initial noise map better (cid:142) ts the goal statistics than
the swapping of uncorrelated initial noise. Thus, the uncorrelated cell-swapping
heuristic is slower and less accurate than a simple uncalibrated random (cid:142) eld
model. Experiments using continuous maps for this article demonstrate the
same results.

3. The area class SDUM swaps cells for 547.5 h before failing to (cid:142) nd a swap that
improves the (cid:142) t to the goal statistic. Half of the successful cell swapping in
the correlated cell-swapping heuristic test occurs in the (cid:142) rst 3 h of processing.
The charts in (cid:142) gure 17 demonstrate the same eŒect in this article’s case study.

The largest potential bene(cid:142) ts to correlated noise inter-map cell swapping are that
any error magnitude model can be used to seed the heuristic, and any (cid:142) tting statistic
provides a (cid:142) t better than the algorithm used to generate the initial noise. Initial
noise, in this context, is the (cid:142) nal product of most random (cid:142) eld models. The overriding
goal of this research is to provide a modular, (cid:143) exible approach to constructing
spatial data uncertainty models. Ideally, diŒerent error magnitude models would be
available for diŒerent combinations of generalized maps and goal maps. DiŒerent
inter-map cell-swapping heuristics would also be available. Finally, diŒerent statistics
should be (cid:142) tted based on the speci(cid:142) cs of the goal application. This study constructs
three error magnitude models, four spatial statistics, and three heuristic realizers
within an object-oriented GIS.1 It designs abstract classes containing a template
describing the necessary methods for a properly functioning component of the
SDUM. All told, there are 135 combinations [3(24Õ
1)3] of components for the
SDUM. Most SDUM combinations generate poor results. The most di(cid:141) cult part
of SDUM construction is likely to be determining the appropriate combination of
goal statistics to (cid:142) t the (cid:142) nal model. The next section discusses goal statistics and
some of the strategies employed by this research.

5. Goal statistics

There is an unlimited number of potential goal statistics available to SDUM
developers. This section discusses the goal application, the statistics used within a

1Research Geographic Information System (RGIS), the object-oriented GIS, is open source
and free for academic purposes. Source code and data for this research are available at
http://www.geo.hunter.cuny.edu/~chuck/ijgis2001/

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 268

C. R. Ehlschlaeger

SDUM for the goal application, and the simultaneous (cid:142) tting of multiple statistics
for the goal application.

The goal application for this case study is a hydrologic overland surface (cid:143) ow
model. Hydrologic (cid:143) ow models come in two forms: models that estimate stream
discharge and models that represent overland (cid:143) ow before water accumulates in
swales or rivers. Overland (cid:143) ow models are typically used to estimate watershed
discharge, which requires an understanding of watershed extent. If the model is
attempting to represent peak discharge for speci(cid:142) c rainfall events, gradient is also
required. Most raster-based geographical information systems contain (cid:143) ow path
algorithms generating a network representing overland surface (cid:143) ow. For example,
GRASS 5.0, Arc/Infoâ 7.X, and ArcViewâ 3.X contain the deterministic-8(D8) (cid:143) ow
path algorithm which assigns each cell an outward (cid:143) ow path in one of the eight
cardinal directions. From this (cid:143) ow network, watershed boundaries can be determined,
assuming that certain conditions are met. The greatest problem facing the D8
algorithm is arti(cid:142) cial ‘pits’ within the DEM. A pit is a grid cell with no outward
drainage, a common phenomenon in USGS 30 m DEMs as shown in (cid:142) gure 5.
Figure 5 contains the USGS 30 m DEM of the study area, showing pits as black
squares. This region in Goleta, California has no actual ‘pits’ or depressions without
outward drainage. If pits exist within a DEM, the D8 algorithm may fail to provide
an accurate representation of watershed extent because cells adjacent to pits have
water (cid:143) ow into the pit, interrupting the overall watershed network if the pit is in a
critical location (Jenson and Dominigue 1988). Arc/Info 7.X and ArcView 3.X allow
the user to average elevation values with a neighbourhood function to reduce pits.
However, the procedure is not always successful, especially in areas of low gradient.
GRASS’s watershed algorithm, r.watershed, guarantee s a complete watershed net-
intelligence technique to determine (cid:143) ow direction
work by using an arti(cid:142) cial
(Ehlschlaeger 1989). Unfortunately, pits in r.watershed input elevation maps still
cause gradient issues because the (cid:143) ow network represents water (cid:143) owing uphill to
get out of pits.

The description of the goal application, a surface overland (cid:143) ow model, provides
an understanding of the statistics most relevant to achieving an accurate representa-
tion of application uncertainty. First, an SDUM should minimize any pits in elevation
realizations. Otherwise, the results contain artefacts not intended by the goal applica-
tion. Second, the distribution of realization cell gradients should be as similar as
possible to the distribution of gradients in the goal DEM. Third, the SDUM should
ensure that the resulting watershed boundaries are located in all possible locations,
(cid:143) uctuating between individual realizations. Finally, SDUM realizations should
contain ridge and valley shapes found in the application quality DEM.

These goals demonstrate techniques that are a blend of two SDUM philosophies.
The (cid:142) rst philosophy is ‘errors are only measured from higher quality data’. The
second philosophy is ‘an SDUM needs to model reality’. If
following the (cid:142) rst
philosophy, researchers are mainly concerned with precisely representing the error
magnitude’s spatial distribution, as with equations (1 )–(4). While equations (1)–(4)
build a representation of hills and valleys not found on the generalized map, the
resulting maps often contain artefacts that would not exist in a DEM attempting to
recreate a model of reality. For example, (cid:142) gure 6 represents a DEM realization
attempting to (cid:142) t the semi-variogram of the error magnitude. The arti(cid:142) cial pits neither
represent reality nor are located where the goal DEM would have arti(cid:142) cial pits. If
following the second philosophy, researchers forsake the error magnitude model

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 Building an SDUM for a DEM

269

speci(cid:142) cally to represent a DEM surface as a model of reality. For example, Wechsler’s
(1999) SDUM of DEM includes an algorithm to increase the elevation of arti(cid:142) cial
pit cells such that all DEM cells have outward drainage. While improving the model
of reality, adding elevation reduces the (cid:142) t of the error magnitude model.

An SDUM that could (cid:142) t multiple statistics simultaneously would allow statistics
de(cid:142) ning ‘errors measured from higher quality data’ to co-exist with statistics de(cid:142) ning
‘a model of reality.’ Fitting multiple statistics simultaneously is a straightforward
process de(cid:142) ned by the following equation:

Dv 5

2

wiADri
DniB

i

(5)

where wi is the weight of statistic i, Dri is the current (cid:142) tness of statistic i, and Dni is
the (cid:142) tness of statistic i for the initial noise maps. Dni allows all statistics to be
normalized to the same standard. wi allows the model developer to rank the impor-
tance of various statistics against each other. Equation (5) and a modular SDUM
allow any set of spatial statistics to be (cid:142) tted without violating the error magnitude
model.

5.1. Properties of a spatial data uncertainty model (cid:142) tting statistic

In order for a statistic to be useful for an SDUM incorporating cell swapping,

three mathematical properties must be de(cid:142) ned:

1. The equation calculating the statistic from a map.
2. The equation calculating the change in a map’s statistic when a single cell

3. The equation calculating the diŒerence between a goal statistic and a statistic

value is replaced by another value.

calculated from a map.

The third criterion is usually the squared diŒerence for statistics with a single
value (for example, fractal dimension), or a weighted sum of squared diŒerences for
statistics with multiple values (for example, semi-variograms or correlograms with
multiple lags, with each lag represented by a separate value).

The second criterion, modifying a map’s statistic based on the change of a single
cell value, discriminates against complex functions (for example, fractal dimension)
or functions containing a normalization process (for example, correlogram) . The
next section discusses a theoretical workaround to functions with a normalization
process. The three subsequent sections discuss the four goal statistics used in this
case study, both as the statistics relative to the goal application, and how the statistics
are described to ful(cid:142) ll the mathematical properties of the SDUM.

All maps ((cid:142) gures 6, 7, 8, 11, 12, 14 and 15) are made from the same initial noise
map before cell swapping and are randomly chosen. The randomly chosen realiza-
tions have been compared to other realizations to ensure that the patterns are typical
of the majority of realizations.

5.2. Correlograms and semi-variogram statistics

The last two application-relate d SDUM goals, distributing watershed boundaries
and recreating potential ridges and valleys not found on the generalized DEM, can
use semi-variogram s or correlograms to represent the (cid:142) nal landscape shapes. The

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 (cid:158)
270

C. R. Ehlschlaeger

Figure 7. Realization after inter-map swapping heuristic (cid:142) tting goal correlogram.

Figure 8. Realization after inter-map swapping heuristic (cid:142) tting goal semi-variogram.

equation for a correlogram was presented earlier in the paper (equation (4)). The
equation for the semi-variogram is:

c(h) 5

1
2N(h)

N(h)

i

(xiÕ

yi)2

(6)

where h is the lag vector, N( h) is the set of all lag vectors, xi is the value at the lag
vector tail, and yi is the value at the lag vector head. Cressie (1993) discusses, in
depth, the advantages and disadvantage s of correlograms versus variograms.

It is worth noting that the semi-variogram and the correlogram discussed in this
section are not used to model the errors of the SDUM, as is done in most SDUM
research, but to model the resulting landscape after the initial errors have been
created. Implementing a SDUM statistic to model the errors is possible by referencing
the generalized map in the statistic equation. There has been no extensive research

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 (cid:158)
Building an SDUM for a DEM

271

to date analysing the bene(cid:142) ts and drawbacks of (cid:142) tting errors versus (cid:142) tting results.
Figure 4 is the study area’s generalized map, before any modi(cid:142) cations. Figure 5
contains the surface conditions desired in the SDUM realizations.

Both spatial statistics, if (cid:142) tted perfectly, can be used to create landscapes that
appear natural in perspective views from within a GIS. In fact, the inter-map cell-
swapping heuristic can (cid:142) t the correlogram to within 0.000062 of the goal correlation
at adjacent lags if the heuristic is only trying to (cid:142) t the correlogram. (The goal
correlogram adjacent lag’s value was 0.997518, and the (cid:142) tted correlogram of all
realizations was 0.997456, while the initial noise correlogram adjacent lag’s value
was 0.998938.) The inter-map cell-swapping heuristic provides similar results with
the semi-variogram. Figure 9 demonstrate s the diŒerences and similarities between
the correlogram of the goal map, the correlogram of the initial noise maps, and the
correlogram of the (cid:142) nal maps, post cell swapping. Figure 10 provides the same
information for the semi-variogram. The lines ‘Correlogram Only’ and ‘Semi-
variogram Only’ are a near perfect (cid:142) t to the goal statistic while the initial noise is
not very close to the goal statistics. Figures 7 and 8 illustrate the results of (cid:142) tting
for a single goal statistic. Notice that both the correlogram and semi-variogram
(cid:142) tting strategies provide poor (cid:142) ts for arti(cid:142) cial pits and gradient measures. There are
too many shallow sloping areas generating too many arti(cid:142) cial pits when using either
spatial statistic alone.

There is one major diŒerence between the correlogram and semi-variogram when
used within the cell-swapping heuristic. The correlogram’s equation is more complex
than the semi-variogram . This complexity creates two issues. The (cid:142) rst is the fact that
a semi-variogram can be calculated twice as fast as a correlogram. Even in this era
of exponentially increasing computer CPUs, this is cited as an (important?) issue in
the research literature. The second and more relevant issue when using an inter-map
cell-swapping heuristic is that the correlogram requires the variance of surface values
before any calculations can be made. Every time a cell may be switched during the
swapping process, the statistic must analyse all cells that may interact with the

Figure 9. Chart comparing (cid:142) t quality of correlogram.

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 272

C. R. Ehlschlaeger

Figure 10. Chart comparing (cid:142) t quality of semi-variogram.

switching cell. When cells are switched, the correlogram must recalculate the variance
of both maps.

An inter-map cell-swapping heuristic has two choices whenever a correlogram
or similar statistic is needed: (1) it can keep track of a multi-realization correlogram,
as was done in this research; or (2) it can require the reading of every cell value
every time a cell is potentially swapped in order to keep track of an individual map’s
correlograms.

When keeping track of the correlogram over all realizations, the statistic needs
to calculate the multi-realization mean value only once. Switching cells does not
change the multi-realization mean value. Whenever a cell is potentially swapped,
this case study needs only to access the values of cells within the maximum lag
distance of the swapping cell to determine the new correlogram. This is identical to
the procedure required of the semi-variogram, only requiring twice the computation
time. The equation for modifying a correlogram while swapping a cell is:

r(h) 5 r(h)1

N(h),xi=c nyi=c

N(h)xi=p nyi=p

xiyiÕ mÕ
hs+h

i

N(h)sÕ

hm+h

i

xiyiÕ mÕ
N(h)sÕ h s+h

hm+h

where p is the original cell value before swapping and c is the cell value after
swapping. The equation for modifying a semi-variogram while swapping a cell is:

c(h) 5

c(h)1

N(h),xi=c nyi=c

N(h),xi=p nyi=p

(xiÕ

yi)2

i

N(h)

(xiÕ

yi)2

i

N (h)

(7)

(8)

The second option for modelling a correlogram in a cell-swapping SDUM
requires the reading of every cell value in the map every time a cell is potentially
swapped in order to keep track of an individual map’s correlograms. Re-reading
every cell in the map, for this small problem (70 by 94 cells, with spatial dependence
extending 107 cells), requires only slightly more computation time. However, simulat-
ing a set of 30 m USGS DEMs (~400 by ~475 cells) with individual correlograms

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 (cid:158)
Õ
(cid:158)
(cid:158)
Õ
(cid:158)
Building an SDUM for a DEM

273

requires (cid:142) ve times the computational load of only calculating the multi-realization
correlogram.

There are two advantage s to modelling the statistics within individual map
realizations. The main advantag e is that each realization is more likely to be (cid:142) t to
the goal statistic. Ehlschlaeger (2000) uses an inter-map cell-swapping heuristic (cid:142) tting
a spatial statistic algorithm that only keeps track of multi-realization statistics. While
many of the realizations result in the desired patterns, several of the realizations
have poor (cid:142) ts. A statistic-(cid:142) tting algorithm for individual maps using a weighted least
squared (cid:142) tting technique reduces the likelihood of some of the maps having poor
(cid:142) tting statistics.

The second advantage of allowing individual maps to be (cid:142) tted is that diŒerent
maps may have diŒerent goal statistics. Any spatial statistic only provides a repres-
entation of the sample data, not the population of all data. In fact, there is no way
of knowing exactly what the goal spatial statistic value(s) should be. Instead of
building an SDUM with all maps (cid:142) tting the same statistics, the SDUM would better
represent all possible variations of goal statistics by building a statistical model
(cid:142) tting diŒerent maps to diŒerent statistical values.

The (cid:142) tting equations for correlograms and semi-variogram s is:

Dr 5

wi(rg(i)Õ rm(i))2, Dc 5

wi(cg(i)Õ

cm(i))2

(9)

r(h)

i

c(h)

i

where wi is the weighting factor for the lag i, rg is the correlogram of the goal
statistic, rm is the correlogram of the map, cg is the semi-variogram of the goal
statistic, cm is the semi-variogram of the map.

5.3. Arti(cid:142) cial pit statistic

As discussed earlier, arti(cid:142) cial pits are DEM cells with no adjacent cells containing
lower elevation values. Although some landscapes have actual small lakes, depres-
sions, or sinkholes that might show up on a DEM, most pits are artefacts of the
DEM creation process. The equation for determining whether a cell Pi is a pit (value
1) or not (value 0) is:

Pi 5 G 0:

wi/W :

0< (cid:158)

adj(i,j)

j G0: EjÕ Ei > 0

1: EjÕ Ei <0, W 5

wi

i

otherwise

where Ei and Ej are elevation values at cells i and j, and adj (i,j) indicates whether
cells i and j are queen’s case adjacent grid cells. The statistic representing the
proportion of pits in a map then is:

i
where wi is the weight placed on a cell if that cell is a pit, and W is the sum of all
weights. Geology should determine weighting value. For example, swampy areas and
Karst topography should have low, or zero weight, whereas areas of high gradient
should have a high relative weighting factor. Since this statistic is represented by a
single value, the (cid:142) tting equation is:

p 5

wiPi
W

Dp 5

( pg Õ

pm)2

(10)

(11)

(12)

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 (cid:158)
(cid:158)
(cid:158)
(cid:158)
274

C. R. Ehlschlaeger

where pg is the pit value of the goal statistic, and pm is the pit value of the map.
Whenever a cell value is swapped with another value, it is possible for the pit status
of the swapping cell to change. Similarly the cells in a three-by-three grid around
the swapping cell may also change. In order to determine the new pit statistic value,
is applied
the following two equations are applied to the map. Equation (13)
before the swapping cell’s value is changed, eliminating the eŒect of all pits within
the three by three grid around the swapping cell. Then, equation (14) is applied after
the swapping cell’s value is changed.

p 5 pÕ

p 5 p1

wk/W :

kG 0:
kG 0:

wk/W :

0< (cid:158)

(Ej <Ek), adj( j, k), adj (i, k) d k 5

i

j

j

otherwise

otherwise

0< (cid:158)

(Ej <Ek), adj( j, k), adj (i, k) d k 5

i

(13)

(14)

5.4. Water gradient measure statistic

As discussed earlier, the downward gradient of the landscape is important for
many hydrologic models. This case study uses a de(cid:142) nition of gradient that will
probably best represent overland surface (cid:143) ow: steepest descent. This measure is
called the ‘maximum downward gradient method’ by Travis et al. (1975). The values
are described in the form: rise over run. The following equation represents the
gradient at single cell:

Si 5 minA(EjÕ Ei)

, adj(i, j)B

di,j
where di,j is the distance between the centres of grid cells i and j. The goal of this
statistic, named water gradient measure, was to provide a description of the distribu-
tion of gradient across the entire map while making it easy to calculate changes in
gradient due to cell swapping. Instead of keeping track of the mean and variance of
all gradient values (Evans 1998), or every gradient value on the entire map, water
gradient measure divides the range of possible gradient values into lags, similar to
a semi-variogram. The statistic keeps track of the number of grid cells within each
lag (equation (17)) as well as the average gradient of all grid cells in the lag
(equation (16 )).

(15)

i GSi:

0:

i G1:

0:

c 5 Si/Sincrement
otherwise
nc

c 5 Si/Sincrement
otherwise

n

SVc 5

SPc 5

(16)

(17)

where SV c is the average water gradient value at lag c, SPc is the proportion of water
gradient values at lag c, and Sincrement is the extent of the gradient lags. For example,

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 (cid:158)
(cid:158)
(cid:158)
(cid:158)
Building an SDUM for a DEM

275

the gradient lag is 0.05 in the water gradient (table 1). The average gradient value,
SPc, is located in the WaterGradient8 column, and the lag proportion value, SV c, is
in the Proportion column. A graphic example of the water gradient statistic can be
found in (cid:142) gure 15.

In a process similar to the pit statistic, the gradient of all cells in the three-by-
three region around the swapping cell must be calculated before the value is swapped.
These gradient values are decremented from the appropriate water gradient measure
lags. Then the swapping cell is given the new cell value before gradient values are
calculated for the three-by-thre e region and incremented in the appropriate gradient
lags. Finally, we can determine the (cid:142) t of water gradient by integrating across the
entire distribution of gradients and a goal gradient distribution.

Ds 5 P

max slope

min slope

(SV gÕ SV m )2

(18)

where SV g is the gradient distribution of the goal statistic, and SV m is the gradient
distribution of the map.

The question, ‘Why is the maximum downward gradient method used instead of
other gradient calculation methods?’ is a valid one. Jones (1998) clearly shows that,
compared with seven other gradient classi(cid:142) ers, the maximum downward gradient
method has the greatest errors when trying to measure the gradient of both a
trigonometrically de(cid:142) ned surface and a DEM with 100 m grid cell resolution. Horn’s
method (Horn 1981) and others are as easy to implement within the SDUM.
However, the author had not read Jones’s (1998) paper when the software was being
created for this study. Also, the author was basing the SDUM on a ‘D8’ hydrologic
model. It is likely that a hydrologic model with only water transport in the eight
cardinal directions should have DEM surfaces (cid:142) tted to gradients along those axes.
Even though maximum downward gradient may not be the most appropriate
method, the SDUM should still be able to (cid:142) t other gradient methods.

This section discussed how to implement various statistics useful in hydrologic

Table 1. Water gradient statistic example.

WaterGradient8

0.0036182565
0.0260708290
0.0776576840
0.1258262420
0.1777640335
0.2241322757
0.2741659761
0.3215567210
0.3719793286
0.4217743496
0.4742574653
0.5203576082
0.5735011110
0.6217517875
0.6707146987
0.7190724834
1.1810718232

Proportion

0.0534686701
0.1197250639
0.0951886189
0.0656170077
0.0625799233
0.0776054987
0.0742487212
0.0712116368
0.0716112532
0.0568254476
0.0392423274
0.0325287724
0.0181425831
0.0161445013
0.0095108696
0.0089514066
0.1273976982

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 Õ
Õ
Õ
Õ
Õ
Õ
Õ
Õ
Õ
Õ
Õ
Õ
Õ
Õ
Õ
Õ
276

C. R. Ehlschlaeger

applications requiring a SDUM. The next section discusses using these statistics in
various combinations and how successful these combinations are.

6. Spatial data uncertainty model goals

The main goal of this paper’s SDUM is to represent how errors propagate
through an application requiring a DEM. The SDUM is composed of three compon-
ents: an error probability distribution function, a statistical model indicating the
patterns or shapes that the resulting DEMs should mimic, and a heuristic capable
of creating the patterns desired in the statistical model. The second goal of this paper
is to present the results of experiments with (cid:142) tting multiple statistics simultaneously.
The next section compares the results of (cid:142) tting each statistic separately to various
combinations of multiple statistics. The (cid:142) nal section discusses the theoretical
implications of this research.

6.1. SDUM model results

Of the 34 experiments using diŒerent combinations of statistics and maps realized,
seven demonstrate various combinations of statistics. These seven experiments all
generate 16 realizations of DEMs attempting to mimic the statistics of 30 m DEMs
using 3² DEM information. The four statistics, correlogram, semi-variogram, pit
count, and water gradient measure, are given equal weight and (cid:142) tted together. The
four statistics are also (cid:142) tted individually. Then the correlogram and semi-variogram
are given equal weight and (cid:142) tted. Finally, pit count and water gradient are given
equal weight and (cid:142) tted together.

6.1.1. Fitting all four statistics

A ‘perfect’ SDUM would allow a GIS user to generate map realizations that (cid:142) t
any and all spatial statistics. Figure 11 illustrates a typical map realization attempting
to (cid:142) t 16 maps to all four equally weighted statistics. Compared to the goal 30 m
DEM ((cid:142) gure 5) (cid:142) tting all four statistics generates a landscape with many of the same
features. In the hilly section of the DEM realization, small swales have been reintro-
duced. However, the shallow gradient section of the DEM realization does not

Figure 11. Realization after inter-map swapping heuristic (cid:142) tting all goal statistics.

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 Building an SDUM for a DEM

277

contain swales in the exact formation pattern in which they are found on the actual
30 m DEM. The arti(cid:142) cial pits are still located mostly in the shallow gradient section
of the DEM. The SDUM that produced the map in (cid:142) gure 11, plus 15 other maps
took over twenty hours to complete. However, running the SDUM overnight, as
demonstrated in (cid:142) gure 13, would have produced virtually the same result.

Comparing the results of (cid:142) tting all four statistics against (cid:142) tting the individual
statistics illustrates another disadvantage . Figure 11 illustrates that the correlogram
and semi-variogram (cid:142) t much worse when trying to (cid:142) t all four statistics than they
do when the statistics are (cid:142) t individually. The pit statistic is the only statistic that
(cid:142) ts better when all four statistics are modeled. See section 6.1.4 for details.

6.1.2. Fitting only the correlogram statistic

Of the four statistics, the closest (cid:142) t occurs when attempting to (cid:142) t only the
correlogram (see (cid:142) gure 9) as demonstrated in (cid:142) gure 9. The correlogram for ‘initial
noise’ demonstrates that the automatic random (cid:142) eld calibration technique ‘success-
fully’ generates an initial surface with more spatial dependence than the goal surface.
The inter-map cell-swapping algorithm is capable of (cid:142) tting the map correlogram to
virtually identical values to lags 10 cells apart. The cell-swapping algorithm is capable
of exactly (cid:142) tting short distance lags of all four statistics maps. However, the algorithm
does not reduce the spatial dependence at the longer distance lags.

Figure 7 illustrates that perfectly (cid:142) tting a correlogram does not generate
landscape patterns approximating those from 30 m data, especially in the shallow
gradient areas. Arti(cid:142) cial pits exist throughout both shallow and steeply sloping
regions while non-intuitive patterns form in the shallow regions. Since the correlo-
gram statistic does not attempt to (cid:142) t individual maps with their own correlogram,
these irregularities exist across all of the realizations.

6.1.3. Fitting only the semi-variogram statistic

Only (cid:142) tting for the semi-variogram produces results similar to those of the
‘correlogram only’, as shown in (cid:142) gure 8. Figure 10 shows the ‘(cid:142) tting semi-variogram
only’ semi-variogram to be virtually identical to the goal semi-variogram. When
(cid:142) tting all four statistics, the semi-variogram has a lower spatial dependence (a.k.a. a
higher moment of inertia) than the goal semi-variogram at short lags. The likely
explanation for this phenomenon is that the correlogram and semi-variogram attempt
to model the same surface diŒerently. The same results are observed when the SDUM
is given only the correlogram and semi-variogram to (cid:142) t. In this SDUM, the correlo-
gram’s short lags have greater spatial dependence than desired while the semi-
variogram’s short lags have lesser spatial dependence than desired: identical to the
results when (cid:142) tting all four statistics.

6.1.4. Fitting only the pit statistic

As (cid:142) gure 12 illustrates, attempting to minimize solely the number of pits results
in a landscape similar to the original 3² DEM with many single grid cell hills. This
experiment gives equal weight to all landscape locations, wi. These hills exist in order
to remove a pit on a diŒerent realization. The 16 initial noise maps have 1564 pits,
which are reduced to 619 pits in this experiment. Ironically, (cid:142) tting all four statistics
reduces the number of pits to 467. This result is not surprising when considering
that solely minimizing pits causes the potential solution space to reach local minima
quickly. When the cell-swapping algorithm is also trying to (cid:142) t correlograms and/or

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 278

C. R. Ehlschlaeger

Figure 12. Realization after inter-map swapping heuristic (cid:142) tting goal pit statistic.

Figure 13. Chart comparing (cid:142) t quality of

individual statistics vs. (cid:142) tting all statistics

simultaneously.

semi-variograms , cells get swapped that do not change the pit statistic value but
provide opportunities for future cell swapping to reduce the number of pits. This
eŒect occurs in simulated annealing, a process used to interpolate surfaces between

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 Building an SDUM for a DEM

279

known data points. This paper refers to this property of cell swapping as the
‘simulated annealing eŒect’.

6.1.5. Fitting only the water gradient measure

The SDUM (cid:142) tting the original 3² DEM to the water gradient measure results
in reduced short lag spatial dependence, mimicking a texture appropriate to the 30 m
DEM (see (cid:142) gure 14 ). Figure 16, a distribution of resulting gradients, demonstrates
that the inter-map cell-swapping heuristic can easily (cid:142) t the water gradient measure
when the initial noise maps are smoother than the goal map.

Figure 16 illustrates the large number of arti(cid:142) cial pits in the typical gradient
(cid:142) tting realization. The resulting quantity of arti(cid:142) cial pits corresponds to the number
of 30 m DEM pits. One strategy to remove this eŒect is to assume that a minimum
gradient exists in the real world landscape, adjusting the goal gradient so that all

Figure 14. Realization after inter-map swapping heuristic (cid:142) tting goal water gradient statistic.

Figure 15. Realization after inter-map swapping heuristic (cid:142) tting goal pit & water gradient
statistics.

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 280

C. R. Ehlschlaeger

Figure 16. Chart comparing (cid:142) t quality of water gradient measure.

gradients less than the minimum are given the minimum gradient value. Another
strategy is simultaneously to (cid:142) t gradient along with the goal of zero pits, as is done
in section 6.1.6.

6.1.6. Fitting the water gradient measure and pit measure

The last experiment in this paper involves (cid:142) tting both the pit and gradient

measure statistics, without (cid:142) tting for either the semi-variogram or correlogram.

Because the gradient measure has several positive gradient values within its
distribution, a perfectly (cid:142) tted gradient measure would guarantee arti(cid:142) cial pits in the
(cid:142) nal maps. Since the pit goal and gradient goal are contradictory, one assumption
is that both goals would (cid:142) t worse together than separately. This assumption is
veri(cid:142) ed in this experiment, but only barely. The (cid:142) t of gradient alone is 0.107, while
(cid:142) tting both gradient and pit is slightly worse with 0.109. Fitting all four statistics
has the gradient measure at 0.491. A similar (cid:142) tting result occurs for the pit measure.
The 16 (cid:142) nal maps contain 624 pits when (cid:142) tting both gradient and pits. There are
only 619 pits when gradient is ignored, and 467 pits when gradient, pits, semi-
variogram, and correlogram are (cid:142) tted simultaneously.

The question, ‘Why do the pits (cid:142) t signi(cid:142) cantly better with all four statistics but
slightly worse when (cid:142) tted with only the gradient measure?’ is an interesting one. The
author speculates that the nature of the various statistics is the cause. The three-by-
three grid around each centre cell determines the values of both the water gradient
measure and the pit measure. Both the water gradient measure and pit measure can
have cell values change in the three-by-three grid without changing the status of the
centre cell. There will be cases in which swapping a cell will not modify either the
water gradient measure or the pit measure. The ‘simulated annealing eŒect’ of cell
swapping might not be large enough for the pit measure when paired with a statistic
that does not change value with every cell swap. It is also possible that modifying
non-adjacent cells, which change the values of longer lags of the semi-variogram and
correlogram statistics, will create the ‘simulated annealing eŒect’ necessary to (cid:142) t the
pit measure better.

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 Building an SDUM for a DEM

281

6.1.7. Model conclusions

There are three conclusions to be drawn from this study. (1) One statistic may
not provide a good representation of surfaces required by a speci(cid:142) c application.
(2) Some statistics complement other statistics in a cell-swapping heuristic and
should be used whenever the other statistic is needed to improve the overall (cid:142) t of
the desired statistics. (3) While non-complementar y statistic pairs, such as the water
gradient measure and pit measure combination, only slightly reduce the quality of
(cid:142) t, spatial data uncertainty modellers should (cid:142) t only those statistics that will best
represent the surface for the goal application. Increasing the number of non-
complementary statistic pairs is likely to reduce (cid:142) t quality even further. If a modeller
attempts to (cid:142) t all conceivable statistics, the SDUM will provide a poorer understand-
ing of the uncertainty associated with using a particular data source and a goal
application.

6.2. T heoretical implications and directions for future research

This paper introduces a correlated noise inter-map cell-swapping heuristic to
generate a set of equally probable DEMs as the input maps for a spatial data
uncertainty Monte Carlo model. This SDUM uses any error magnitude model to
seed the heuristic, and any (cid:142) tting statistic or set of (cid:142) tting statistics as its parameters.
The research demonstrates that if the error magnitude model generates spatially
autocorrelated initial maps (the (cid:142) nal product of most random (cid:142) eld models), the
SDUM will provide a (cid:142) t better than the algorithm used to generate the initial noise.
The worst case, in this study, is a 60 % improvement of (cid:142) t using the inter-map cell-
swapping heuristic.

Section 6.1 demonstrates examples in which various combinations of spatial
statistics (cid:142) t simultaneously. Sometimes combinations of statistics improve the quality
of (cid:142) t for a particular statistic while other combinations reduce the quality of (cid:142) t. It
is beyond the scope of this article to compare and contrast all combinations of
statistics that may be considered relevant
for diŒerent applications. Without
attempting to make an exhaustive survey of statistics, it is obvious that plan and
pro(cid:142) le convexity, diŒerent gradient measures, slope measures, and fractal dimension
(Evans 1998) all provide the opportunity to measure the pattern of a surface. The
author can imagine future research identifying all commonly used surface statistics,
building SDUM capable statistic objects and (cid:142) nding which statistic pairs improve
or degrade the quality of (cid:142) t. If done, there will be literally thousands of statistic
pairs with a measure of how well they complement each other. (We do not want
even to think about how complex measuring and understanding statistic triplets
would be.)

6.2.1. Error (or uncertainty) buttons

In the Introduction, this article claimed that the ultimate goal of spatial data
uncertainty modelling research is an ‘error button’ that can be pressed by casual
GIS users whenever they want to see the impacts of spatial data error on their
applications. There are two potential theoretical models for the error button:
producer-speci(cid:142) ed and application-driven.

A producer-speci(cid:142) ed SDUM, as argued by Goodchild et al. (1999), would require
data producers to encapsulate the error magnitude model and spatial statistics in
the data model. An application-drive n SDUM, on the other hand, assumes that
diŒerent applications are sensitive to diŒerent characteristics of a surface. An overland

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 282

C. R. Ehlschlaeger

is sensitive to statistics diŒerent from those to which a
(cid:143) ow hydrologic model
viewshed model,
is sensitive. An application-driven SDUM would
require determining the appropriate spatial statistics (and probably an appropriate
error magnitude model ) for a particular application.

for example,

From the perspective of designing an error button, the producer-speci(cid:142) ed SDUM
can be built much more quickly than an automated application-drive n SDUM. A
producer-speci(cid:142) ed SDUM would require the producers to determine a set of spatial
statistics that work well together and assume that all applications will get adequate
results from the SDUM. An automated application-drive n SDUM would require a
heuristic to determine automatically which error magnitude model and spatial statist-
ics are best for the application. This would require a complex and probably very
interesting arti(cid:142) cial intelligence heuristic.

However, if the goal is to build the most accurate SDUM, an experienced error
modeller can probably determine which statistics are not necessary for a particular
GIS application. If any of the unnecessary statistics belong to non-complimentary
statistic pairs, the expert-modi(cid:142) ed application-drive n SDUM will generate more
accurate results than the general purpose producer-speci (cid:142) ed SDUM, assuming both
models have access to the same statistics, error models, and samples of higher
quality data.

6.2.2. Issues not addressed in this research

This article attempts to demonstrate that a random (cid:142) eld model combined with
a cell-swapping heuristic can provide an extremely (cid:143) exible and potentially very
accurate DEM uncertainty model. The SDUM is by no means a (cid:142) nal product. There
are three obvious potential improvements to the model:

1. The error magnitude model is critical to generating overall surface character-
istics. The cell swapping is likely to provide only small lag texture improve-
ments. A more accurate spatial dependence model will probably make better
swale representations and provide more accurate sensitivity assessment for
viewshed analyses and similar applications.

2. Much research is necessary to determine which statistics will best represent
the errors for particular applications. Since many statistics can have para-
meters, diŒerent applications should have the appropriate combination of
statistics, with the best parameters de(cid:142) ned to generate the most accurate
Monte Carlo realizations. For example, the water gradient measure allows
positive gradient values to in(cid:143) uence its distribution. A parameter to specify a
maximum water gradient while calculating the goal map’s distribution would
allow that measure to generate distributions better resembling the actual
surface.

3. The inter-map cell-swapping heuristic is a simple heuristic that is likely never
to achieve an optimal result from a set of input maps. (Increasing the number
of
input maps will improve the quality of the overall (cid:142) t but there is no
guarantee that the results will be optimal.) Consider the following example:
two adjacent cells should both be swapped to improve the overall statistics of
two maps. However, if either cell is swapped alone, the overall statistics will
drop. This ‘local minima’ in the solution space cannot be resolved by swapping
individual cells. A simple modi(cid:142) cation to the heuristic would be to simultan-
eously attempt to swap multiple cells. While this will add considerable time

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 Building an SDUM for a DEM

283

Figure 17. Chart comparing (cid:142) t quality based on number of swapping maps.

to the swapping process for very little improvement, a producer-generate d
SDUM should attempt to build Monte Carlo input maps as accurately as
possible.

6.2.3. Rede(cid:142) ning interpolation

The greatest bene(cid:142) t of the inter-map cell-swapping heuristic is that any potential
surface may be modelled, if the surface pattern can be represented. The interpolation
process has the goal of generating a surface between known data points. The inter-
map cell-swapping heuristic could be used to build extremely precise representations
of the real landscape using the following procedure. (1) Build sample DEMs at 1.0
and 0.1 m horizontal resolution for small representative areas within a larger DEM,
a typical 30 m DEM, for example. The representative areas would include ridgelines,
swales, rock outcropping, and human modi(cid:142) ed terrain in the proportion of actual
landscape features in that ecoregion. (2) A kriging process (Englund 1993, Kyriakidis
et al. 1999) could be used to generate an error magnitude model between sampled
points. (3) Multiple statistics relevant to a particular application would be chosen
to generate potential realizations of the landscape at very small resolutions.

This set of potential realizations would be far more useful to soil scientists and
hydrologists than a surface smoothed between data points 30 m (or 10 m) apart. Of
course, any particular swale or ridgeline on a realization will not exist in the real
world. Nevertheless, the results of most soil erosion studies or surface overland (cid:143) ows
models are aggregations over larger regions. Precise simulated landscapes would
allow geomorphologist s the ability to design models according to the physics of their
discipline without having to account for the overly smoothed DEMs that are
currently available. And since the geomorphologist will be given a set of precise
simulated landscapes,
they can perform sensitivity analysis via Monte Carlo
simulation.

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 284

C. R. Ehlschlaeger

7. Conclusion

This article presents a modular, extendable framework for representing errors of
continuous surfaces for speci(cid:142) c applications. With very fast computers, the technique
is practical and can potentially allow spatial data errors to be modelled for applica-
tions not anticipated by the original data producers. Using an inter-map cell-
swapping algorithm with multiple weighted statistics proportional to speci(cid:142) c applica-
tion goals (equation (5)), an error modeller can understand the implications of using
data more generalized than desired. While simple in concept, the technique of
multiple weighted statistics provides the opportunity to tailor (cid:142) t spatial data for any
complex application. This article’s experiments clearly show that SDUM (cid:142) tting
variograms misrepresent landscape texture, especially arti(cid:142) cial pits. This article also
presents a lag-based measure to better represent gradient, demonstrating the utility
of lag-based measures over mean and variance. Finally, these experiments open a
theoretical debate about the merits of producer-speci(cid:142) ed versus application-drive n
SDUM.

Hopefully, research will soon determine how much to weigh individual spatial
statistics for any desired application, thus allowing all users of geographic information
for any application, not just error modellers or those using well-de(cid:142) ned applications,
to move beyond the most popular statistic.

References
Arbia, G., Haining, R., and Griffith, D., 1998, Error propagation modelling in GIS overlay

operations. International Journal of Geographical Information Systems, 12, 145–167.

Bouoiyour, J., 1992, Monte Carlo sampling procedure and Bayesian encompassing tests.

Economic L etters, 38, 127–132.

Buttenfield, B. P., and Beard, M. K., 1994, Graphical and Geographical Components of
Data Quality. In V isualization in Geographical Information Systems, edited by H. M.
Hearnshaw and D. J. Unwin (New York: John Wiley & Sons), pp. 150–157.
Cobb, M. A., Chung, M. J., Foley III, H., Petry, F. E., and Shaw, K. B., 1998, A rule-
based approach for the con(cid:143) ation of attributed vector data. GeoInformatica, 2, 7–35.
Cressie, N. A., 1993, Statistics for Spatial Data, revised edn (New York: John Wiley & Sons).
Davis, J. D., and Keller, C. P., 1997, Modeling and visualizing multiple spatial uncertainties.

Computers and Geosciences, 23, 397–408.

Ehlschlaeger, C. R., 1989, Using the AT search algorithm to develop hydrologic models
from digital elevation data. Proceedings of the International Geographic Information
System (IGIS) Symposium (Spring(cid:142) eld, VA: E. H. Pechan and Associates), pp. 275–281.
http://www.geo.hunter.cuny.edu/~chuck/IGIS/paper.html

Ehlschlaeger, C. R., 1998, The stochastic simulation approach: tools for representing spatial
application uncertainty, unpublished PhD Dissertation, University of California, Santa
Barbara.
http://www.geo.hunter.cuny.edu/~chuck/dissertation/fullDissertation.html

Ehlschlaeger, C. R., 2000, Representing uncertainty of area class maps with a correlated
inter-map cell swapping heuristic. Computers, Environment and Urban Systems, 24,
451–469. http://www.geo.hunter.cuny.edu/~chuck/urban/urban.html

Ehlschlaeger, C. R., and Goodchild, M. F., 1994, Uncertainty in spatial data: de(cid:142) ning,
visualizing, and managing data errors. In Proceedings of GIS/L IS 1994 (Phoenix, AZ:
American Society for Photogrammetry and Remote Sensing), pp. 246–253,
http://www.geo.hunter.cuny.edu/~chuck/gislis/gislis.html

Ehlschlaeger, C. R., and Shortridge, A. M., 1996, Modelling elevation uncertainty in
geographical analysis. In Proceedings of the 7th International Symposium on Spatial
Data Handling, Vol. II, 9B, pp. 15–25. http://www.geo.hunter.cuny.edu /~chuck/
SDH96/paper.html

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 Building an SDUM for a DEM

285

Ehlschlaeger, C. R., Shortridge, A. M., and Goodchild, M. F., 1997, Visualizing
spatial data uncertainty using animations. Computers & Geosciences, 23, 387–395,
http://www.elsevier.nl/locate/cgvis/

Englund, E. J., 1993, Spatial simulation: environmental applications. In Environmental
Modeling with GIS, edited by M. F. Goodchild, B. O. Parks and L. T. Steyaert (New
York: Oxford University Press), pp. 432–437.

Essaid, H. I., and Hess, K. M., 1993, Monte Carlo simulations of multiphase (cid:143) ow incorporat-

ing spatial variability of hydraulic properties. Ground Water, 31, 123–134.

Evans, I. S., 1998, What do terrain statistics really mean? L andform Monitoring, Modelling
and Analysis, edited by S. N. Lane, K. S. Richards and J. H. Chandler (New York:
John Wiley & Sons Ltd), pp. 119–138.

Fisher, P. F., 1991, First experiments in viewshed uncertainty: simulating the fuzzy viewshed.

Photogrammetric Engineering & Remote Sensing, 57, 1321–1327.

Goodchild, M. F., 1990, Algorithm 9: simulation of autocorrelation for aggregate data.

Environment and Planning A, 12, 1073–1081.

Goodchild, M. F., Shortridge, A. M., and Fohl, P., 1999, Encapsulating Simulation
Models with Geospatial Data Sets. Spatial Accuracy Assessment: L and Information
Uncertainty in Natural Resources (Chelsea, Michigan: Ann Arbor Press), http://
www.ncgia.ucsb.edu/~ashton/demos/propagate.html

Heuvelink, G. B. M., Burrough, P. A., and Stein, A., 1989, Propagation of errors in spatial
modelling with GIS. International Journal of Geographical Information Systems, 3,
303–322.

Horn, B. K. P., 1981, Hill shading and the re(cid:143) ectance map. Proceedings of the IEEE, 69, 14–47.
Hunter, G. J., and Goodchild, M. F., 1995, Dealing with errors in spatial databases: a

simple case study. Photogrammetric Engineering & Remote Sensing, 61, 529–537.
Huss, R. E., and Pumar, M. A., 1997, EŒect of database errors on intervisibility estimation.

Photogrammetric Engineering & Remote Sensing, 63, 415–424.

Jenson, S., and Dominique, J., 1988, Extracting topographic structure from digital elevation
data for geographic information system analysis. Photogrammetric Engineering &
Remote Sensing, 54, 1593–1600.

Jones, K. H., 1998, A comparison of algorithms used to compute hill slope as a property of

the DEM. Computers & Geosciences, 24, 315–323.

Kyriakidis, P. C., Shortridge, A. M., and Goodchild, M. F., 1999, Geostatistics for
con(cid:143) ation and accuracy assessment of digital elevation models. International Journal
Geographical Information Science, 13, 677–707.

Nichols, W. E., and Freshley, M. D., 1993, Uncertainty analyses of unsaturated zone travel

time at Yucca Mountain. Ground Water, 31, 293–301.

Openshaw, S., 1989, A methodology for using models for planning purposes. Environment and

Planning, 11, 879–896.

Travis, M. R., Elsner, G. H., Iverson, W. D., and Johnson, C. G., 1975, VIEWIT computa-
tion of seen areas, slope and aspect for land-use planning. US Department of agriculture
forest service general technical report PSW 11/1975 (Paci(cid:142) c Southwest Forest and
Range Experimental Station: Berkeley, CA).

Veregin, H., 1997, The eŒects of vertical error in digital elevation models on the determination

of (cid:143) ow-path direction. Cartography and Geographic Information Systems, 24, 67–79.

Wald, L., 1999, Some terms of reference in data fusion. IEEE T ransactions on Geoscience

and Remote Sensing, 37, 1190–1193.

Wechsler, S. P., 1999, EŒect of DEM uncertainty on topographic parameters, DEM scales,
and terrain evaluation, unpublished Ph.D. Dissertation. State University of New York,
Syracuse. http://www.csulb.edu/~wechsler/.

Downloaded by [Universitat Politècnica de València] at 03:37 27 October 2014 