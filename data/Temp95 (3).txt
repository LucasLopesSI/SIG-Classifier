Transactions in GIS, 1999, 3(3): 221–237

Research Article

Stephen Wise
Department of Geography
University of Sheffield

Extracting raster GIS data from scanned
thematic maps

Abstract
One of the problems which continues to trouble practical applications of GIS is the
time and cost of capturing data from paper maps. Even where the data are required
in raster form the complexity of most maps means that the data are first digitised
in vector form, and then rasterised, a slow and error-prone process. This paper
describes an alternative approach based upon readily available hardware and
software in which the map is scanned using Spot Colour Scanning, and then
processed using a specially designed majority filter and editing with a painting
package. Tests on a small scale soil map produce results which are about 80% as
accurate as digitising, but take far less time to produce. An analysis of the sources
of error indicates that many of these are due to the difficulty of scanning such a
complex document as a map, and suggests that more sophisticated image
processing algorithms may be needed to classify the original scanned image before
the application of the filter algorithm.

1 Introduction

One of the most persistent technical problems in the use of Geographical Information
Systems (GIS) is that of data capture. Despite considerable advances in hardware and
software since the earliest days of GIS development, data capture remains one of the
most time-consuming and hence costly parts of any GIS project with figures of 80% of
project costs being commonly quoted (Jackson and Woodsford 1991).

The commonest method for capturing data from paper maps, such as the soil map
shown in Plate 3 (see plate section) is still manual digitising, even when the final data is
required in raster form. Digitising the polygons on such a map is time consuming for
two reasons:

Address for correspondence: Stephen Wise, Department of Geography, University of Sheffield,
Sheffield S10 2TN, UK. Email: S.Wise@sheffield.ac.uk

(cid:223) 1999 Blackwell Publishers, 108 Cowley Road, Oxford OX4 1JF, UK and
350 Main Street, Malden, MA 02148, USA.

222

Stephen Wise

1. The initial digitising of the boundaries is a slow process.
2.

In most vector GIS systems, the polygons can only be rasterised if they are
topologically correct and each contains a label point. This normally requires some
editing of the digitised data to correct errors such as undershoots and overshoots,
and to add missing labels.

For raster data, scanning is an obvious alternative to digitising, especially given the
availability and quality of desk-top scanners (Carstensen and Campbell 1991).
However if what is wanted is not simply an image of the map (plate 3 – see plate
section), but a raster layer containing the data from the map, then the complexity of the
map becomes a problem. There are two distinct problems, both illustrated by Plate 3.
Firstly, although the categories are represented by different colours, the visual
impression of a single colour has been produced using a mixture of different colours
and shading patterns. When viewed by an observer these give the impression of single
colours but when scanned at high resolution they are resolved into individual hues. The
result is that each category on the map will be represented by a number of RGB values
in the scanned image rather than a single, unique one. For example in Plate 3, 143
different ‘colours’ (i.e. RGB combinations) have been identified by the scanner.
Secondly, there are normally two other types of information on most thematic maps in
addition to the data:

1. Base Map : in Plate 3 the Ordnance Survey 1:250000 topographic sheet is used as

the base providing locational information to assist in using the map.

2. Annotation : a range of additional information is printed on top of the soils such as
the codes indicating exactly which soil association is mapped in each polygon, and
the 10km lines of the British National Grid.

These layers of information are usually compiled separately and combined in the
printing process (Keates 1989). This means that it is sometimes possible to obtain the
map separate containing just the thematic data, which can then be scanned directly
(Peuquet and Boyle 1984). Unfortunately the map separates will not always be
available. For old map series they may no longer exist, and where they do exist time or
expense may make it impractical to use them. It is therefore important to try and
develop methods for extracting the data from the composite map document.

In order to capture the data from the map two tasks must be accomplished:

1. The structure of the image must be analysed, to identify which parts represent
data, and which represent the other elements of the map – text, linework, etc. In
the terminology of image processing or signal processing these latter elements can
be thought of as ‘noise’ and this term will be used in this paper.

2. The different elements will have to be processed in an appropriate manner. Pixels
representing data will need to be classified while those that represent noise will
need to be replaced with some estimate of the data class at that point.

Work on this problem has largely been aimed at producing automated methods,
which means that software solutions to both tasks must be found. In practice this has
meant that the techniques sometimes use complex AI-based methods, or rely on some
special characteristic of the map being processed. An example of the latter is the work
of Ansoult et al (1990) who took advantage of the fact that much of the noise on their
map was printed in black. This could therefore be extracted by converting the scanned

(cid:223) Blackwell Publishers Ltd. 1999

Extracting Raster GIS Data from Scanned Maps

223

image to HLS colour space, and thresholding the lightness channel. This information
was then processed using the techniques of mathematical morphology, to separate the
pixels representing the soil polygon borders from other areas of noise such as text.
Once this was done, the original image could be segmented which greatly simplifies the
process of classifying the range of RGB values representing each thematic category on
the map.

Ebi et al (1994) also extracted the structure of the map first, but in this case by
attempting to invert the printing process. They were working with a map which had
been produced using the four primary colours normally used in colour printing – Cyan,
Magenta, Yellow and Black. Overprinting these colours will effectively produce a
mixed pixel, and so by using a mixture modelling technique it was possible to
determine which colours were present in each pixel in the image. This produced a
number of layers representing the main ‘colours’ used in the map (not actually the four
primaries, but Blue, Green, Brown and Black) which could then be analysed seperately.
As a simple example, the black layer contained the text and linework as with the map
of Ansoult et al (1990). The success of the method will depend to some extent on how
the map has been printed, and the extracted colour layers still require a good deal of
processing to extract the thematic data values.

Yan and Wu (1994) used a neural network classifier, which in addition to the RGB
values for each pixel was supplied with information on the variation of RGB values near
each pixel, and measures derived from edge detectors, to allow the classification to
distinguish pixels within uniform regions from those lying near boundaries on the map.
An alternative and potentially simpler approach to the problem is to exploit the
ability of a human operator to understand the structure of the map document, and
provide tools which can speed up the process of extracting the information from it.
This semi-automated approach has been used to good effect in developing methods for
capturing vector data from large scale maps (Devereux and Mayo 1992) and tools such
as line following software are becoming available in commercial GIS systems such as
ARC/INFO (ESRI 1996). In the case of raster data, the tools would have to assist the
operator in taking the potentially large number of RGB combinations in the scanned
map, and classifying them into a series of data categories. An essential first stage is
therefore some automated classification of the RGB values into a smaller number of
classes which can be assigned to the approapriate thematic data class by image editing
techniques.

The number of colours in the original image can be reduced by using a desktop
photo editing package, and in fact the image in Plate 3 can be reduced to 16 separate
colours with very little effect on the visible appearance. The problem is that the colours
which make up any particular thematic class are not unique to that class, and are not
spectrally similar to one another. As an example, soil type 541, which is a buff colour
on the map, is represented by a mixture of pixels of white, yellow, red and magenta.
Purely spectral classification methods will therefore be of limited value and what is
needed is a contextual classifier (Gurney and Townsend 1983) which rather than
treating each pixel separately, assumes that neighbouring pixels are likely to belong to
the same class even if their RGB values differ.

The method which has been used in these initial tests in fact uses an algorithm
which is supplied with the particular desktop scanner that was used (a Hewlett Packard
II) designed for scanning documents produced using spot colour printing. Such
documents are printed using areas of uniform colour, but due to slight variations in the

(cid:223) Blackwell Publishers Ltd. 1999

224

Stephen Wise

paper and the density of ink, will contain slight variations in hue. The Spot Colour
Scanning option on the Hewlett Packard is designed to make allowance for these
variations, and identify areas of uniform ‘colour’ and is therefore a form of contextual
classifier. The advantages of using this software are its availability and the fact that it is
designed to deal with printed documents. The disadvantages are that the details of the
algorithm are proprietary commercial information, and therefore not published, and of
course the method is only applicable if you have the right model of scanner. However,
its use makes it possible to make an initial assessment of the merits of this general
approach.

The Spot Colour Scanning produces an image which has already been classified,
normally into about 18 to 20 classes. The next step is for an operator to determine
which of these classes represent data and which noise. Once this is done, some means is
needed for replacing the noise pixels with an estimate of the data class at that point.
Given that noise areas tend to be small in relation to data areas on the map, one
estimate is to use the most commonly occuring data value in the immediate
neighbourhood of the candidate noise pixel, which requires a form of majority filter.
In a normal majority filter, the central pixel is replaced by the most commonly
occurring value in the immediately neighbouring pixels (Mather 1987). In this case, this
operation should only be applied to noise pixels – pixels which have already been
successfully classified as data should not be processed. An earlier paper (Wise 1994)
gave details of such a modified majority filter, which has been written by the author as
an extra module called CLEAN, for the IDRISI GIS (Eastman 1992). The other feature
of CLEAN which is different from a standard majority filter is that it has an option for
performing multiple passes through the image, until no more changes can be made.
This is required because in some cases areas of noise will be larger than 3 pixels square,
and a single pass will leave the central pixels unchanged. At the end of the iterations,
there will be cases where there is a tie for the majority value (typically where a pixel has
four neighbours of one value and four of another). These can either be left unchanged,
or set to one of the values selected at random according to a user option.

Initial tests of this method on the soil map shown in Plate 3 indicated that an
accuracy of over 80% could be achieved (Wise 1994) but that there were some
problems with the ability of the scanner to pick up all the soil types represented on the
map. This paper will present a more detailed description of the method, and an
assessment of its accuracy. A series of experiments are described to determine whether
varying factors such as the scanning resolution, or other scanner settings such as
brightness and contrast, improve the accuracy of the method. The paper concludes
with some thoughts on further developments.

2 Extraction of raster data using CLEAN

The map used for the test was part of the 1:250,000 soil sheet published by the Soil
Survey (Soil Survey of England and Wales 1983, Ragg et al 1984). The sheet covers the
Midlands and Northern England, but for the initial tests an area equivalent to a 10km
square on the ground was selected, as shown in Plate 3. This contains a reasonable
range of soils, and a variety of detail from large areas of relatively uniform soil, to
small patches, and areas where the underlying topographic map contains a good deal of
detail (e.g. the area around Bakewell).

(cid:223) Blackwell Publishers Ltd. 1999

Extracting Raster GIS Data from Scanned Maps

225

The soils are classified in a three level hierarchical system which assign each soil on
the map an alphanumeric symbol of three digits and a letter (e.g. 541a) and colour as
follows:

2.

1. Major Soil Groups – these represent the broadest level of the classification and
divide soils into the major categories such as Brown Earths, Podzols, Surface
Water Gleys, etc. These categories are distinguished by colour (e.g. Brown Earths
are printed in brownish shades) and given a classification number which differ in
their first digit (Brown Earths are in the range 500–599).
Soil Groups – within each major soil group, soils are further classified according
to details of drainage, parent material and texture. Each of these soil groups is
distinguished by a different colour within the general hue for the major soil
group, although in some cases the differences between these colours is slight.
Examples are Typical brown earths (code 541), Stagnogleyic brown earths (code
542).
Soil Associations – the finest level of classification which the Soil Survey uses
identifies individual soil series, but that would be too detailed for a map at this
scale. Therefore within each soil group, major associations of series are identified
within each of the soil groups. These are not distinguished by colour at all, but by
the addition of a letter to the three digit code for the group – hence 541g represents
the Rivington 2 association of typical brown earths.

3.

It will be clear from this that individual Soil Associations cannot be identified on
the basis of colour, and if this level of detail is required digitising would be the only
option. For the initial testing the major soil groups were captured, and these are
identified in the text by their three digit codes, which are also shown on the map
extract in Plate 3.

As explained above, the impression of uniform colours on this map is strongest
when it is viewed at ‘normal’ viewing distances rather than close up. In effect this is
equivalent to viewing at low resolution, and so the map was initially scanned at a
relatively low resolution to assist the Spot Colour Process in identifying areas of
uniform colour. The actual resolution of 75 dpi was chosen since it produces pixels
whose ground resolution of 83m is just less than the pixel size of 100m which was
planned for the final data layer. The resulting image is shown in Plate 4 (see plate
section). The value for each pixel represents the category to which it has been assigned
by the Spot Colour Scanning process – each category is also assigned a colour which is
saved as a palette within the TIFF file. This TIFF file is then converted to an IDRISI
raster dataset using the IDRISI TIFIDRIS command (Eastman 1992) which also saves
the palette which can be used when displaying the layer in IDRISI.

The next step is to identify which pixel values on the scanned image represent data
values and which represent noise. The scanner had originally identified 20 separate
values and visual inspection of the image showed that these could be interpreted as
shown in Table 1.

These results reveal a number of points about the original scanning:

1.
2.

In some cases the same soil is represented by more than one value.
Some values represent more than one thing – for example 19 represents not only
soil type 712, but also those areas where soil type 713 is printed over roads on the
underlying OS map.

(cid:223) Blackwell Publishers Ltd. 1999

226

Stephen Wise

Table 1
values.

Interpretation of pixel values in the scanned image and initial reclassification

Original Value

Interpretation

Reclassified Value

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20

Not used by scanner
Soil 541
Soil 541
Black text
Noise
Soil 631
Soil 631+OS map
Text/Lines
Soil 713
Soil 713
Soil 713
Noise
Soil 721
Soil 631
Noise
Soil 561
Linework
Soil 561
Soil 712+Soil 713 over OS map
Urban+Noise

N/A
2
2
0
0
5
5
0
7
7
7
0
8
5
0
4
0
4
6
9

3. Two soil types – 311 and 542, are not represented by separately identifiable values

at all.

All these points will be discussed further below.

The original scanned image was reclassed to the set of values which would be used
for the final GIS dataset (shown in Table 2), with noise pixels set to a value of 0,
resulting in the image shown in Plate 5 (see plate section). It is not strictly necessary to
set all noise pixels to a single value – CLEAN can handle multiple values representing
noise (Wise 1994) but experience has shown that it is useful for two reasons:

1. As a visual check that the separation into data and noise values has been

2. To make it easier to track the progress of the various stages in cleaning up the map

accomplished correctly.

described below.

The next step was to apply the CLEAN program to the image in Plate 5 and this
produced the result shown in Plate 6 (see plate section). This reveals that the broad
pattern of the original soil map has been captured reasonably well. Three problems
remain at this stage:

1)

Some soils are represented by two values and some values represent more than one
thing. A good case is value 6 (Dark Green) which represents parts of soil 712 in the
top left corner, but also part of 713 running along the river valleys.

(cid:223) Blackwell Publishers Ltd. 1999

Extracting Raster GIS Data from Scanned Maps

227

Table 2

Pixel values used for final GIS layer.

Value

Soil Map Symbol

Soil classification

1
2
3
4
5
6
7
8
9

311
541
542
561
631
712
713
721
U

Humic rankers
Typical brown earths
Stagnogleyic brown earths
Typical brown alluvial soils
Humo-ferric podzols
Pelo-stagnogley soils
Cambic stagnogley soils
Cambic stagnohumic gley soils
Urban

2) There is a certain amount of ’clutter’ in the form of areas of noise which had the
same value as one of the soils and have therefore not been cleaned away. An
example is the horizontal line at the bottom of the map derived from one of the OS
grid lines.

3) A number of individual noise pixels have been left unchanged by CLEAN because
there was no clear candidate value to set them to – they are shown as the white
’specks’ on Plate 6. In this case the option has been chosen to leave these as noise
pixels.

The solution adopted to the first two problems was to edit the image by hand. The
image was first converted back to TIFF format from IDRISI and then imported into a
pixel editor (PhotoFinish). At this stage the only editing which was performed was to
change the value of blocks of pixels – for example the dark grey bar at the bottom of
the picture was changed from 7 to 1 using a flood fill operation. No attempt was made
to alter the boundaries between different soil types even in areas where the initial
scanning had clearly gone wrong.

The remaining noise pixels were not altered at this stage, although it had originally
been intended that this should happen. Many of the ambiguities which lead to these
pixels being left by CLEAN were in fact resolved by the editing process – many of the
white pixels in Plate 6 lie on the border between two different colours which should in
fact be the same. Once they have been edited to be the same, the initial ambiguity is
resolved and a further run of CLEAN will reset the one remaining pixel. It was also
realised that the number of these pixels was very small compared with the total map –
in the initial run of CLEAN only 47 out of the 15500 pixels were left unresolved and so
setting the remaining values to one of the candidate values from the neighbours at
random is a reasonable way of resolving the tie.

Once edited, the image was read back into IDRISI, and CLEAN run once more. In
order to complete the process and produce a useable GIS data layer, it is necessary to
register the image to the National Grid. To do this it is necessary to know the true
National Grid reference of a number of points on the image. The obvious candidates
here are points at the intersection of the OS grid lines on the original map. These do
not appear very clearly on the spot colour version of the scanned image, but by
scanning the map in full colour at the same resolution (and at the same time as the
original scan) it was possible to discover which pixel positions represented the grid

(cid:223) Blackwell Publishers Ltd. 1999

228

Stephen Wise

intersections. This information was used to resample the cleaned up image producing a
final GIS dataset with 100m pixels, correctly registered to the National Grid and
clipped to an area of 10kmx10km, which is shown as Plate 7b (see plate section).

3 Analysis of accuracy

In order to assess the accuracy of the process it was necessary to have a correct version
of the data for comparison. This was produced by digitising the initial soil map, and
then rasterising this vector version to produce the layer shown as Plate 7a (see plate
section).

A crude estimate of the accuracy of the scanned map is a count of what percentage
of pixels have been correctly identified compared with the digitised version. This can
be accomplished within the raster GIS by subtracting one image from the other – all
pixels which yield a value of zero are the same on both images and hence correctly
classified. Of the 10000 pixels in the final image 8241 are correctly classified, 1759
incorrectly classified, giving an accuracy of 82.4%. This is quite an acceptable figure
and compares well with the sort of accuracies achieved by remote sensing methods for
example. The Kappa index (Rosenfeld and Fitzpatrick-Lins 1986) which measures
accuracy but makes allowance for the possibility of correctly classifying pixels by
chance alone, is 73.8%.

However, although these accuracy figures are encouraging, it is also instructive to
analyse the errors both in terms of type and spatial distribution. Throughout this
discussion, results will be expressed as absolute pixel counts or simple percent correct
rather than using the Kappa index, since this makes it easier to assess the contribution
of different factors to the degree of accuracy achieved.

The first major difference between the scanned and digitised versions of the map is
the soil types which have been missed by the scanning process. As noted above, soils
311 and 542 do not appear at all on the scanned map, both having been confused with
soil 541. In the case of 542, the difference between the colours on the original sheet is
slight (see Plate 3). Both appear to consist of the same underlying light brown and differ
only in the colour of cross-hatching which is laid on top. In the case of 311 (see Plate 3)
the actual printed colour is quite different from that of 541, being a light yellow, but
the regions occupied by this soil are narrow, and being along valley floors tend also to
be areas where there are roads and/or rivers on the underlying OS map – the
combination of pale yellow over grey obviously gives rise to a colour which is similar in
spectral response to the brown used for 541.

To see what proportion of the error arises from this problem, the digitised map
was reclassified so that categories 311, 541 and 542 were combined and the comparison
repeated revealing that now 9074 pixels are correct, an improvement of approximately
8%.

To look at the reasons for the remaining errors, it is useful to plot a map of where
the errors occur. Figure 1a shows the results of the image subtraction process described
above indicating areas of agreement and disagreement between the scanned and
digitised maps. It is clear from this that a large proportion of errors are clustered along
the boundaries between the soil polygons – the boundaries are plotted in Figure 1a to
illustrate this. This is perhaps not surprising and is inherent in any attempt to rasterise
the boundary between two areas on a map. Whatever technique is used, pixels falling

(cid:223) Blackwell Publishers Ltd. 1999

Extracting Raster GIS Data from Scanned Maps

229

Figure 1(a)

Figure 1(b)

Figure 1
errors after allowing for missed soils.

Spatial pattern of classification errors showing (a) the original errors, and (b) the

(cid:223) Blackwell Publishers Ltd. 1999

Table 3 Relative importance of different sources of error.

230

Stephen Wise

Category

Correct
Not identified by scanner
On boundary
Other

Pixels

8241
833
532
394

Percentage of error

47.4
30.2
22.4

across the boundary (mixture pixels in Remote Sensing terminology) will have to be
assigned to one or other of the two classes, and if this is done independently by two
different techniques then differences are bound to arise.

The total length of boundary line in this section of map is 867mm, which at an
average line width of 0.25mm gives an area of 216.8 mm2 or 13.5% of the map area. In
fact the rasterisation process exacerbates this since with pixels which are 100m on the
ground, 24.9% of pixels have a soil boundary passing through them, and are therefore
potentially likely to be misclassified. This misclassification can arise with both
digitising and scanning. In the case of the vector data, the original boundary line is
approximated during digitising, and so slight variations will occur depending on the
degree of approximation (Dunn et al 1990). With the scanning method the problem will
be worse at low scanning resolutions, since proportionally more pixels will fall across
boundaries, and so this source of error may be reduced by using a higher scanning
resolution.

By rasterising the digitised boundary, and overlaying this with the error image, it is
possible to calculate how many of the incorrectly classified pixels lie along a boundary.
Combining this information with the error due to the missed soil types, it is possible to
see what proportion of the errors are due to each source as shown in Table 3 and
Figure 2.

Table 3 shows that the failure of the scanner to identify two soil types accounts for
about half the error. The problem associated with the boundaries directly accounts for
about 30%, but inspection of Figure 2 reveals that many of the errors so far
unaccounted for also lie close to soil boundaries. These probably arise in part because
of the difference in the way boundaries are identified using digitising and the cleaning
process, and partly because the colours on the original map often change subtly close to
the soil boundaries, which will cause problems with the original scanning process.

Before considering whether altering the scanning technique can improve matters, it
is also useful to consider the relative roles of the automatic operation of CLEAN and
the manual editing of the image.

3.1 Relative contribution of cleaning and editing

It is worth considering just how much improvement there has been between the
original scanned image (Plate 4) and the final cleaned data (Plate 7) and how much of
this can be attributed to the manual editing operations rather than to the CLEAN
program.

In order to assess this it was necessary to convert the images at all the various
stages of the process to a common geographical framework so that they can be
compared. Since the ’correct’ version of the data had 100m pixels registered to the

(cid:223) Blackwell Publishers Ltd. 1999

Extracting Raster GIS Data from Scanned Maps

231

Figure 2 Classification of error types.

British National Grid it was necessary to convert all the other images to this coordinate
system. This was not done in the original processing, because any resampling process
will alter the pixel values and is best left until all other processing has been completed.
This resampling will undoubtedly have introduced extra differences between the
images, so the figures below for the change in accuracy at the various stages will only
be approximate.

The images produced as a result of the initial reclassification, the initial cleaning
and the manual editing were all corrected to the National Grid, and compared with the
digitised version to assess their accuracy. (The major error of the scanner failing to
recognise two soil types was removed from consideration by reclassifying these missing
types to value 2 on the digitised version of the data). Table 4 shows the results in terms
of the number of pixels correctly classified at each stage of the process

It is clear from this that although the cleaning algorithm makes the majority of the
improvement, the manual editing process makes a substantial contribution. This does
suggest that in some cases manual editing alone might be a reasonable technique for

(cid:223) Blackwell Publishers Ltd. 1999

232

Stephen Wise

Table 4 Contribution of different stages of method to clean up of scanned image.

Stage

% correct

% change

Reclassification of scanned image
Initial Clean
Editing
Final Clean

64.2
81.9
90.5
90.7

17.7
8.6
0.2

converting scanned maps to useful data. However, practical experience with CLEAN
has shown that as well as contributing directly to the data conversion process, it makes
manual editing much easier by removing much of the visual clutter which is apparent
on Plate 4.

4 Altering scanner parameters to improve accuracy

It is clear that many of the inaccuracies in the method arise from the original scanning
process rather than from the cleaning algorithm. The initial work was performed by
using Spot Colour Scaning scanning at the default resolution of 75 dots per inch, and
using the default settings of brightness and contrast on the scanner. The next stage was
therefore to experiment with different settings of these various parameters to see if this
would improve the initial image classification.

The scanner used comes with a Microsoft Windows interface package, which gives
the user great flexibility in how a document is to be scanned. The software will deal
will three types of document – drawings, half-tone pictures and photographs, each in
monochrome or colour and with various sub-categories (for example six different types
of half-toning can be dealt with). In addition it is possible to adjust the brightness and
contrast and to sharpen images.

4.1 Scanning resolution

The default resolution of 75 dpi is relatively coarse by modern standards – the scanner
used was only an A4 desktop scanner (a Hewlett Packard DeskScan II) but it is capable
of up to 400 dpi. The map was scanned at resolutions of 150 and 300 dpi and the whole
process of cleaning, editing and registering the image as described above for the 75 dpi
image repeated in each case. Plate 8 (see plate section) shows the map scanned at 75 dpi
and 300 dpi for comparison (both scaled to the same size to facilitate comparison). It
can be seen that although the higher resolution does lead to a sharper delineation of
some features such as text and lines, it is no more successful at distinguishing the
problem colours. Indeed in some repsects the higher resolution makes matters worse,
because there are more features to cause confusion – variations which are ignored at
lower resolutions become sources of confusion at higher ones.

It is therefore no great surprise that the statistics for accuracy are very similar for
the three resolutions – in Table 5 percentages are given separately for total error and
for errors ignoring the missing soils.

A further point to note here is that the final data might not be required at the
higher resolution – if 100m pixels were required in the final output, then scanning at

(cid:223) Blackwell Publishers Ltd. 1999

Extracting Raster GIS Data from Scanned Maps

233

Table 5

Effect of scanning resolution on accuracy.

% correct
% correct ignoring missing soil

75 dpi

150 dpi

300 dpi

82.4
90.7

81.7
90.3

84.0
92.6

300 dpi would require a final resampling to convert the 25m pixels to 100m ones thus
averaging out 16 pixels to each final one. Given that the higher resolution is not
inherently more accurate, but does involve greater effort, since there are more details to
tidy up at the editing stage, the conclusion is that it is best to scan at a resolution just
greater than that required to achieve the final pixel size needed in the output data.

The scanning resolution needed to achieve a given pixel size will depend on the

scale of the map, and can be calculated from the following formula:

r (cid:136)

s
40 (cid:2) p

(cid:133)1(cid:134)

where
r = scanning resolution in dots per inch
s = denominator of map scale (e.g. for a 1:50000 scale map, s=50000)
p = pixel size required – metres on the ground.

So to scan a 1:50000 scale map to get 10m pixels, you would need a scanning resolution
of 125 dots per inch

4.2 Brightness and Contrast Settings

The initial experiments were conducted using the default brightness and contrast
settings for Spot Colour scanning. Altering the settings for these parameters has a
significant effect on the colours displayed on the screen, but what was important here
was whether it improved the ability of the scanner to distinguish between similar
colours on the map. In order to test this, the map was scanned at four different contrast
settings ranging from low to the maximum possible. These images were saved, and
then all plotted using the same palette (based on scanning at the default contrast) so
that they could be directly compared. This showed that although there were differences
between the four images, they were not systematic, and all four show the same sort of
problems identified above.

One interesting point to emerge from this is that repeating the scanning process at
different times using the same parameters can produce different results – for instance
the areas of soil 311 which were missed on the original scan were distinguished in some
places on these scans.

4.3 Image Type

So far discussion has centred on scanning the map as either a colour photograph or a
spot colour drawing. However the scanner software also has an option for detailed
drawings, intended for images containing fine linework. Since part of the problem is in

(cid:223) Blackwell Publishers Ltd. 1999

234

Stephen Wise

those areas where the map contains a lot of detail it was decided to try this option for
comparison with spot colour scanning.

The map was therefore scanned at 100 dpi as a spot colour drawing and a detailed
drawing, in both monochrome and colour and all four images are shown in Plate 9
with the spot colour images on the right.

Both monochrome images have successfully distinguished between areas of soil
and the somewhat darker areas of noise. This is not without its problems – the light
coloured grid lines are missed, but the dark green of soil 721 is confused with noise and
comes out black. The area of soil 631 (pink on the original map) is characterised by
quite dark cross-hatching, and this also is identified as black. However it certainly
seemed possible that the detailed drawing monochrome image (top left) might be used
as a first approximation of noise areas to be removed in an initial run of CLEAN,
before further editing.

The detailed colour drawing is less successful, since it picks up more of the
variation within the soil areas than the spot colour drawing option. In particular the
large areas of relatively uniform brown representing soil 541, which the spot colour
option handles fairly successfully, is recognised far less well in the case of the detailed
drawing option.

5 Discussion

From the above analysis it can be seen that there is little to be gained from altering the
scanner parameters. There is also little to be gained from scanning at high resolution
when using such a simple clean-up technique as this.

The method has been shown to produce reasonable results on a single portion of a
map, but is it of more general use, and does it provide any appreciable saving in time
compared with digitising? The answer to both these questions is likely to depend to a
large part on the complexity of the map. The success of the raster editing method will
depend on how many distinct colours there are on the map, how spectrally distinct they
are and how much information is printed in addition to the thematic data. The saving
in time will depend on the speed of the raster editing process compared with the speed
of digitising the same map, both of which will depend on the number of polygons per
unit area of the map and the complexity of their outlines (Goodchild and Rizzo 1987).
A full test of these questions would require a comprehensive classification of map
complexity and a set of trials using a range of maps of differing complexity and is
beyond the scope of the present paper. However it is possible to present the result of
some tests carried out on a selection of other maps. Eight further 10km squares were
selected from the 1:250000 soil map, subjectively chosen to span the range of
complexity found on this map. A series of 26 10km squares were selected from a sheet
of the 1:50000 Agricultural Land Classification (ALC) map which is rather less complex
than the soil map, containing only seven classes (five grades of agricultural land plus
Urban and Waste) identified by areas of uniform colour. A series of geological map
sheets at a range of scales were also scanned. However, these all had so much
annotation, in the form of fault lines, labels etc, that the Spot Colour Scanning process
did not produce an image which was worth editing.

All the selected squares were digitised, and also processed using CLEAN, and the

kappa statistics for the comparison between the two are presented in Figure 3.

(cid:223) Blackwell Publishers Ltd. 1999

Extracting Raster GIS Data from Scanned Maps

235

Figure 3 Kappa values for a section of areas from two maps: 1 is a 1:250000 scale soil
map, and 2 is a 1:50000 scale Agricultural Land Classification Map.

It can be seen that the means and standard deviations are rather similar for the two
maps (0.86 and 0.05 for the soil map, 0.85 and 0.08 for the ALC map) although the
ALC map has a much greater range. This is a little surprising, and suggests that even
with suitable maps, the limitations of the Spot Colour Scanning algorithm will restrict
the accuracy of this technique to just below 90%.

As a test of the time difference between digitising and scanning, a larger region of
the soil map, equivalent to 50km x 50km on the ground was used. This took two days
to digitize compared with about half a day for processing the scanned images. An
interesting point is that when the two sets of data were compared, a number of
discrepancies were found which were actually due to errors in the digitising process
(polygons missed or mislabelled).

6 Conclusions

This paper has described a technique for capturing raster data from thematic maps,
which produces reasonably accurate results in much less time than the normal
technique of digitising and rasterising. Initial tests of the method have shown that
accuracies of the order of 70–90% are possible, and in its current form it may have
application for other users with requirements for the rapid capture of raster data. The
CLEAN module for IDRISI is available from the author from the World Wide Web site
given below.

An analysis of the technique, albeit on a single map, has shown that many of the
errors derive from the difficulty of scanning thematic maps, rather than from
weaknesses in the later processing of the scanned data. The initial image classification
is curently performed by the software which comes with the deskjet scanner, but this
limits the method to those with access to this brand of scanner. One topic for future
work is the development of a generally available contextual classification algorithm
suitable for use with scanned maps. An alternative approach is to develop a much
wider range of image processing tools which could be selectively applied to different
parts of a map scanned in full detail. For example algorithms have been developed in
the field of image processing for following boundaries between classses or identifying
homeogeneous areas (Rosenfeld and Kak 1982). Such a suite of tools would need to
combine functionality normally associated with GIS, such as the reclassification of

(cid:223) Blackwell Publishers Ltd. 1999

pixel values, with that normally associated with painting packages, such as flood fill
operations, but could provide a useful method for the rapid and accurate capture of
raster data from scanned maps.

236

Stephen Wise

Acknowledgements

I am very grateful to the Soil Survey and Land Research Centre for granting permission
to use their 1:25000 soil map in this research and to reproduce copyrighted material in the
illustrations. The tests of CLEAN on different maps were undertaken by Simon Kirby,
while he was on a work placement in the Department of Geography and thanks go to him
for all his hard work and enthusiasm. Thanks to Dr Chris Clark and two anonymous
referees who made a number of useful comments on earlier versions of this paper.

Appendix: Accessing and using CLEAN

CLEAN is freely available for non-commercial use. It may be downloaded from the
author’s homepage (http://www.shef.ac.uk/~g/staff/smw/smw.html). Although designed
for use with the DOS version of IDRISI it can be used with the Windows version by adding
it as a user defined application (instructions for doing this are contained in the
documentation which comes with the module).

From the tests presented in this paper, the following would seem the best way to

use CLEAN:

1.

Scan the document using Spot Colour Scanning, at a resolution which gives pixels
just smaller than needed in the final GIS data layer. Other scanner parameters can
be left to default.

2. At the same time (i.e. without moving the document) scan the document as a 256
colour photo, because this can be used to locate geographical reference points for
rectifying the image more accurately. It may also be worth scanning as a
monochrome, detailed drawing, to see whether this will pick out some of the noise
automatically.
Inspect the images using a pixel editor, or IDRISI, and identify which pixel values
represent each of the following categories:
• Data – these will be recoded to their final value.
• Noise – these will be recoded to 0.
• Areas of ambiguity – these will be recoded to a unique value which is not in use

3.

for real data.

4. Recode the image as described and inspect once more to check that it makes sense.
It might be useful to edit at this stage, to correct any areas which are likely to cause
problems when CLEAN is run. Examples might be large areas of 0 which can be
easily edited by hand but which might produce nonsense if simply put through
CLEAN.

5. Run CLEAN. At this stage elect to have any ambiguous 0 pixels left as 0.
6.

Inspect the output from CLEAN once more. The image will now be far easier to
edit because there will be fewer colours, and much of the clutter will have been
removed.

(cid:223) Blackwell Publishers Ltd. 1999

Extracting Raster GIS Data from Scanned Maps

237

7. Do a final run of CLEAN, this time electing to have ambiguous pixels simply set to

any neighbouring data value.
If all is well, rectify the image to the correct coordinate system.

8.

References

Ansoult M M, Soille P J, and Loodts J A 1990 Mathematical morphology: A tool for automated
GIS data acquisition from scanned thematic maps. Photogrammetric Engineering and
Remote Sensing 56,1263–271

Carstensen L W. and Campbell J B, 1991 Desk-top scanning for cartographic digitization and

spatial analysis. Photogrammetric Engineering and Remote Sensing 57: 1437–46

Devereux B and Mayo T 1992 Task oriented tools for catographic data capture. In Proceedings

of AGI’92, London, Westrade Fairs Ltd: 2.14.1–7

Dunn R, Harrison A R and White J C 1990 Positional accuracy and measurement error in digital

databases. International Journal of Geographical Information Systems 4: 385–98

Ebi N, Lauterbach B and Anheier W 1994 An image analysis system for automatic data
acquisition from coloured scanned map. Machine Vision and Applications 7: 148–64

Eastman J R 1992 IDRISI User’s Guide. Worcester, MA, Clark University
ESRI 1996 ARC/INFO online documentation. Redlands, CA, Environmental Systems Research

Goodchild M F and Rizzo B R 1987 Performance evaluation and work-load estimation for

geographic information systems. International Journal of Gepgraphical Systems 1: 67–76

Gurney C M and Townsend J R G 1983 The use of contextual information in the classification of

remotely sensed data. Photogrammetric Engineering and Remote Sensing 49: 55–64

Jackson M J and Woodsford P A 1991 GIS Data Capture Hardware and Software. In Maguire D
J, Goodchild M F, and Rhind D W (eds) Geographical Information Systems. Harlow,
Longman: 239–49

Keates J S 1989 Cartographic Design and Production (2nd edition). Harlow, Longman
Mather P M 1987 Computer Processing of Remotely-sensed Images. Chichester, John Wiley and

Institute

Sons

Peuquet D J and Boyle A R 1984 Raster Scanning Processing and Plotting of Cartographic

Documents. New York, NY, SPAD Systems

Ragg J M, Beard G R, George H, Heaven F W, Hollis J M, Jones R J A, Plamer R C, Reeve M J,
Robson J D, and Whitfield W A D 1984 Soils and Their Use in Midland and Western
England. Harpenden, Soil Survey of England and Wales

Rosenfeld A and Kak A C 1982 Digital Picture Processing (2nd edition). London, Academic Press
Rosenfeld G H and Fitzpatrick-Lins K 1986 A coefficient of agreement as a measure of thematic
classification accuracy. Photogrammetric Engineering and Remote Sensing 52: 223–7
Soil Survey of England and Wales 1983 Soils of Midland and Western England. Southampton,

Ordnance Survey, Sheet 3 of 1:250,000 Soil Map Series

Wise S M (1994) Scanning thematic maps for input to Geographic Information Systems.

Computers and Geosciences 21: 7–29

Yan H and Wu J (1994) Character and line extraction from color map images using a multi-layer

neural network. Pattern Recognition Letters 15: 97–103

(cid:223) Blackwell Publishers Ltd. 1999

