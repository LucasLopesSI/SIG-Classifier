Transactions in GIS, 2010, 14(4): 497–531

Research Article

Digital Urban Morphometrics: Automatic
Extraction and Assessment of
Morphological Properties of Buildingstgis_1218 497..532

Cláudio Carneiro
Geographical Information Systems
Laboratory
Ecole Polytechnique Fédérale de
Lausanne

Thomas Voegtle
Institute of Photogrammetry and
Remote Sensing
University of Karlsruhe

Eugenio Morello
Laboratorio di Simulazione Urbana
DIAP
Politecnico di Milano

François Golay
Geographical Information Systems
Laboratory
Ecole Polytechnique Fédérale de
Lausanne

Abstract
The aim of this article is to present a method to calculate the morphological
properties of the built environment using LiDAR (light detection and ranging) data,
geographic information systems (GIS) data and three-dimensional (3D) models of
cities as a source of information. A hybrid approach that takes into account different
types of inputs and consequently evaluates the accuracy of each type of used data is
presented. This work is intended to give a ﬁrst response to the lack of a compre-
hensive and accurate procedure that uses LiDAR data in order to automatically
derive precise morphological properties, such as volumes and surfaces (façades and
roofs) of buildings. The method was tested on two case-study areas in the Geneva
region with different characteristics, one in the old town along the Rhone River and
the other on the CERN campus. A statistical analysis that compares the results of the
computation with the 3D model of the built environment was used to validate the
results, complemented by signiﬁcance statistical tests. Outcomes showed that the
proposed method to derive morphological properties can reach high levels of accu-
racy, thus enhancing the potential uses of LiDAR data for numerous applications,
typically for the assessment of the urban environmental quality (UEQ) at the city and

Address for correspondence: Cláudio Carneiro, EPFL–LASIG, Station 18, Bâtiment GC, CH-1015,
Lausanne, Switzerland. E-mail: claudio.carneiro@epﬂ.ch

© 2010 Blackwell Publishing Ltd
doi: 10.1111/j.1467-9671.2010.01218.x

498

C Carneiro, E Morello, T Voegtle and F Golay

district scale, such as the estimation of the potential deployment of renewable
energies in the built environment and the determination and monitoring of several
urban indicators.

1 Introduction

The aim of this work was to propose a method to calculate the morphological properties
of the built environment using light detection and ranging (LiDAR), geographic infor-
mation systems (GIS) data, and three-dimensional (3D) vectorial city models through
segmentation and image processing techniques. In particular, we explored different
methods suitable for the computation of volumes and surfaces (areas of façades and areas
of roofs) of buildings. Whereas image processing techniques offer widely tested methods
for the calculation of volumes, computation of surfaces is still an open topic when raster
images are used as the source information. Our hypothesis was that an automated
method (from raw LiDAR data through the reconstruction of a precise urban model to
the computation of morphological indicators) could dramatically increase the use of
LiDAR data, because it would accelerate the process of analysis with no need for
expensive 3D models.

Spatial data quality (SDQ) is an important subject in many decisions and analyses.
For centuries geographers and cartographers have been concerned with the collection,
storage, analysis, and visualization of two-dimensional (2D) spatial data. Since the
1960s, with the emergence of GIS, there has been a rising availability, exchange, and use
of 2D spatial data. Moreover, in the past decade, new types of 3D spatial data have
arisen, such as LiDAR, increasing considerably the number of sources available and
potential applications, for example, as presented in this article, for the extraction of
morphological properties of buildings.

According to Aalders (2002) and Devillers et al. (2005), SDQ can be described using
5–11 elements. One of them is the description of spatial/positional accuracy of a given
dataset, which will be the main focus of this article in relation with SDQ. Thus, for each
of the three morphological properties of buildings (volume, area of roofs, and area of
façades) under analysis, the set of data derived from LiDAR data from which the
spatial/positional accuracy has to be calculated is called the test data set, and the set of
data calculated from a real 3D vectorial city model is called the reference dataset. Section
5 of this article assesses the performed calculations by applying a statistical analysis and
signiﬁcance tests between the different methods and data used.

Nowadays, airborne LiDAR sensors allow scanning large urban areas with an
increased resolution. Therefore, the increased accuracy of remote sensing detection
technologies, the better availability, and the decreasing price for acquiring this type of
data, render it very attractive for local scale applications, such as the urban environment.
Therefore, the need to implement procedures to make LiDAR data useful for urban
studies is a topic that was investigated in the past decade, but precise methods that can
analyse these data are still lacking. For instance, applications are very promising in urban
studies, where there is an increasing awareness of the use of 3D digital information for
the analysis and the description of the properties of the built environment.

Researchers in urban studies are more and more concerned about the improvement
of the quality of life in our cities, where more than half of the world’s population resides.
Towards a better understanding of the urban environmental quality (UEQ), several

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

499

indicators and measurements were proposed in past years to analyse and compare
built-up areas worldwide, involving cross-disciplinary competencies in urban design and
planning, health, ecology and transportation, among others. One set of those indicators
deals directly with the measurement of the urban form, aiming at quantifying the role of
the built fabric in assessing the environmental performance of cities and revealing
structural features of different built-up areas. For instance, we refer to the term “urban
morphometrics,” which was deliberately transferred from other disciplines. In fact,
morphometrics studies the variation and change in the form of objects, and is widely used
in biology, zoology, and medicine, whereby different methods to extract data from shapes
are investigated.

2 The Calculation of Morphological Indicators: Related Work

This work combined two research streams that developed during the past 15 years: the
use of digital image processing (DIP) techniques to process raster images of cities and
extract useful information, and the techniques that apply LiDAR data in urban studies
from a 3D GIS viewpoint.

Pioneers in the use of image processing techniques for the analysis of environmental
indicators and morphology of digital urban models were a group of researchers at the
Martin Centre, University of Cambridge (Ratti and Richens 2004). This research was
further improved at the Senseable City Lab at the Massachusetts Institute of Technology,
who proposed applications for assessing the solar admittance of the urban fabric through
solar envelopes (Morello and Ratti 2009a) and the visual perception of urban open
spaces through the use of 2D and 3D isovists (Morello and Ratti 2009b).

Until now some authors have introduced the applicability of LiDAR data in urban
studies, but did not delve deeply into the calculation and validation of morphological
indicators (Carneiro et al. 2008, 2009a, b). In this study we introduce a novel method for
the automatic extraction and assessment of morphological properties of buildings using
different data sources, as presented in the next sections of this article.

Previous literature on interpolation of LiDAR point clouds is vast. The advantages
and disadvantages of several interpolation methods, such as triangle-based linear inter-
polation, nearest neighborhood interpolation, and kriging interpolation were presented
by Zinger et al. (2002). The most accurate surfaces are created using a grid with a
sampling size that relates as close as possible to the LiDAR point density during the
acquisition phase (Behan 2000). A method for constructing a 2.5D urban surface model
(2.5-DUSM) incorporating the geographical relief, based on LiDAR and GIS buildings
data, was proposed by Osaragi and Otani (2007).

Many authors have studied the segmentation procedure for LiDAR data. For
example, Vosselmann and Dijkman (2001) used 3D Hough transform to detect planes in
LiDAR data and Hofmann et al. (2003) made a comparison between 2D and 3D Hough
transform for detecting building planes in LiDAR data. An algorithm for the automated
delineation of roof planes from LiDAR data was proposed by Rottensteiner et al. (2005).
A 3D urban GIS including the reconstruction of buildings from laser altimeter and
2D map data was proposed by Haala et al. (1998). The advantages related to the
integration of these two types of data sources were analyzed by Vosselmann (2002).

A ﬁrst method that allows the derivation of morphological properties of city blocks
using an urban landscape model, constructed from a large LiDAR dataset, was presented

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

500

C Carneiro, E Morello, T Voegtle and F Golay

by Yoshida and Omae (2005). Using different topographical data, Koomen and Bação
(2005) presented a new methodology that describes the density of urban systems and
allows the quantiﬁcation of the urban volume.

3 Method

3.1 Dataﬂow Process

The process for structuring the proposed method was based on four major steps, as
represented in the dataﬂow of Figure 1: (1) the classiﬁcation and segmentation procedure
for laser scanning data; (2) the construction of the normalized 2.5 Digital Urban Surface
Model (n2.5-DUSM) of buildings and the n2.5-DUSM of roofs; (3) the creation of the
different grid masks used; (4) the programming of scripts, using segmentation and DIP
techniques, allowing calculation of the output results. All these steps will be further
detailed and analyzed in the next three sections of this article.

The n2.5-DUSM of buildings and the n2.5-DUSM of roofs are image-based georef-
erenced information. They were constructed using a hybrid approach that integrates raw
LiDAR data and 2D vector digital maps, such as in steps 1 and 2 of Figure 1.

3.2 Data Sources Used

To test the method, two case-study areas are referred to. The ﬁrst site (Figure 2, left-hand
image) is a selection of 18 buildings inside the campus of the European Organization for
Nuclear Research (CERN), more precisely the eastern area within the Swiss boundary.
Most of the buildings are characterized by simple geometry, but present different heights
and footprints; only some of them require particular attention in the computation
because they present very complex shapes, having multiple faces. The second site selected
for the analysis is a square near the Rhone River and the old town of Geneva, in
Switzerland, presented in Figure 2 (right-hand image): 45 different buildings with an
average height of 18.5 m are located at this site. The urban fabric is quite compact and
densely built. Buildings present many superstructures on roofs, are sufﬁciently separated
from each other, and do not present particular problems caused by the presence of
vegetation (for example trees touching the façades or roofs).

The following data were used:

1. 2D GIS building outlines. For both case-study areas presented here the 2-D GIS
database of the Canton of Geneva was used to extract vectorial information about
building outlines, which were used to construct a more accurate n2.5-DUSM of
buildings, as introduced in Section 3.3.

2. 2D projection of 3D roof lines. For both case-study areas presented here, the 2D
projection of 3D roof lines was used to extract vectorial information about building
roofs that was also used to construct a more accurate n2.5-DUSM of roofs, as
reported in Section 3.3.

3. LiDAR data. The LiDAR used for the construction of both normalized n2.5-DUSM
of buildings and n2.5-DUSM of roofs has a density of 4 points/m2, a planimetric
accuracy of 20 cm and an altimetric accuracy of 15 cm. Due to the high accuracy of
LiDAR data, the use of detailed vectorial building outlines and vectorial roof lines

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

501

3D model of buildings

Raw LIDAR data

2D digital (vectorial) maps 
of building outlines(external facades 
of 3D model)

2D digital (vectorial) 
maps of roof prints

Raw LIDAR points 
segmentation

Spatial Overlay:
Case 2

Roof 
slopes 

INPUTS

Step 1
Model 
Recon-
struction

Step 2
Creation 
of 2.5-
DUSM

Step 3
Creation
of masks

Step 4
Image 
enhancement
through 
DIP

Spatial Overlay:
Case 2

Spatial Overlay:
Cases 1 and 3

Classification of
ground points

Classification of
buildings points

Generation
of DTM

Generation of DSM of
buildings and DSM of roofs

Image
smoothening

Image
smoothening

Creation of grid masks:
1 –n2.5-DUSM of roofs
2 –Roof slopes based 
on n2.5-DUSM of roofs 
3 –Roof slopes based on 
segmentation procedure
4 –Pixel area (0.25 m 2) 
grid based on n2.5-DUSM
of roofs

Creation of grid 
masks:
5 –n2.5-DUSM 
of buildings

Scripts programming

Areas of roofs 
calculation

Volumes of 
buildings 
calculation

Homogeneous 
segmented roof 
slopes

Generation of n2.5-DUSM of buildings (2.5-DUSM of buildings 
-DTM) and n2.5-DUSM of roofs (2.5-DUSM of roofs -DTM)

Transfer heights (aggregation 
of pixel areas of each roof 
overlaying the corresponding 
2D vectorial roof area)

Transfer heights (aggregation of 
pixel volumes of each building
overlaying the corresponding 2D 
vectorial building area)

OUTPUTS

Output results for 
areas of roofs 
calculation

Output results for 
areas of facades 
calculation

Output results for 
volumes of buildings 
calculation

Figure 1 The dataﬂow process describing the method implemented to produce and
analyze the n2.5-DUSM of buildings and the n2.5-DUSM of roofs

for classifying LiDAR points on buildings is crucial for the improvement of the
n2.5-DUSM interpolation and construction, as introduced in Section 3.3.

4. 3-D city model. An accurate 20–25 cm 3D vectorial city model of both case-study
areas was used to extract information about the volume, areas of façades, and areas
of roofs. It was reconstructed by combining: (1) a 2D vectorial information of the
cadastral survey for the deﬁnition of the 3D building footprints; (2) a 3D stereo-
scopical model based on aerial images with a resolution of 16 cm, taken with a

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

502

C Carneiro, E Morello, T Voegtle and F Golay

North

500 meters

200 meters

Figure 2 The orthophotos of the two case-study areas. Left-hand image: the CERN
campus; right-hand image: the site in the old town of Geneva, close to the Rhone River

Vexcel camera, for the semi-automatic digitalization of vectorial 3D building out-
lines. This information was used for assessment of the automatic extraction of
morphological properties of buildings, as presented in Section 5.

3.3 Reconstruction of the Normalized 2.5-D Urban Surface Model of Buildings
and the Normalized 2.5-D Urban Surface Model of Roofs

An n2.5-DUSM interpolated and reconstructed only from LiDAR data will have low
geometrical accuracy for the analysis and extraction of indicators related to the mor-
phology of buildings, primarily along its boundaries and zones of discontinuity. Thus,
there should be great potential for the improvement of a building’s geometry through:

• The integration of other data sources, such as 2D GIS cadastral data for the calcu-
lation of volumes and areas of façades of buildings1 and, if available, 2D projection
of 3D roof lines for the calculation of areas of roofs.

• The use of non-direct interpolation techniques, undertaken independently of the

terrain for each building.

A scheme that describes the structure of the procedure is shown in Figure 3, based
on the method of Carneiro et al. (2009b). The method related to the construction of the
n2.5-DUSM of roofs was similar to the one presented for the n2.5-DUSM of buildings.
The n2.5-DUSM of buildings of the case-study area in the center of Geneva is represented
in Figure 4.

3.4 Calculation of Morphological Properties of Buildings using Segmentation and
Image Processing Techniques

3.4.1 Overview

Once the model had been reconstructed, image processing operations were used in the
MATLAB environment on a pixel basis to enable the calculation of morphological

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

503

Figure 3 Data used and general structure for the construction of the n2.5-DUSM of
buildings and the n2.5-DUSM of roofs

Figure 4 The n2.5-DUSM of the case-study area at the center of Geneva

i.e. a 2D
indicators. For instance, each building was imported as a single image,
array where the intensity value of each pixel corresponded to the height of the pixel in
meters. On each pixel belonging to the edges of the object a series of morphological
operations was performed and the results of those operations compared to the 3D
model.

In order to compute the areas of the vertical surfaces of the object, ﬁrst the edges of
the object must be detected; second, two separate procedures are required to establish the
height and length of each pixel, as shown in Figure 5. Both procedures require the
application of ﬁlters with the double aim of detecting the edges of the object and
assigning the proper values to them. Different types of morphological operations were
used in this work as follows: contraction and dilation operations on the external edges
of the object; the Canny ﬁlter2 (Canny 1986) and other operations to average the value
of the pixels considering various types of structuring elements.3

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

504

C Carneiro, E Morello, T Voegtle and F Golay

2A.
Compute the
height of the
pixels

2B.
Compute the
length of the
pixels

DUSM

1.
Edge
detection

enhanced
DUSM

3.
Area of Vertical Surfaces =
height of the pixels * length of the pixels

Figure 5 Structure of the procedure related to the calculation of vertical areas of
façades

3.4.2 The enhancement of the normalized 2.5-DUSM of buildings and the
normalized 2.5-DUSM of roofs

The ﬁrst set of operations to detect the edges of the object was performed in order to
reduce the noise on the DUSM. In particular, the morphological operations to enhance
the model were performed in three steps presented below.

1. The enhancement of both the original n2.5-DUSM of buildings and n2.5-DUSM of
roofs was obtained by combining operations of contraction and dilation on the
perimeter of the object alone. In this routine a 3 by 3 pixel neighborhood with a
diamond shape was applied for both operations of contraction and dilation. For
instance, the contraction of the last contour of pixels on the perimeter of the object
allowed the reduction of the noise on the borders of buildings caused by the
interpolation of raw LiDAR data. The second step was the dilation of the new
boundary (emerging from the operation of contraction). This action averaged the
values on the pixels of the perimeter on their original location (refer to Figure 6).
Both the original n2.5-DUSM of buildings and n2.5-DUSM of roofs and the respec-
tive enhanced models were used for the computation of morphological indicators. A
comparison of results is presented in Section 4.

2. The second set of morphological operations aimed to reﬁne the boundaries of the
object and was performed applying again a contraction and dilation of the external
boundaries of the object through different ﬂat structural elements of different size
and shape. The Canny ﬁlter was applied on these latter detected external edges of the
object.

3. A new enhancement with diamond ﬁlters on the enhanced model could be performed
as presented in point 1. This step was necessary to also detect internal vertical
surfaces, as opposed to step 2 where only external ones are marked.

3.4.3 Segmentation of planar roof areas

The segmentation of roof planes could, in principle, be performed directly on the laser
point cloud, but the point cloud was rasterized (in this case onto a grid size of 0.5 m) in
a ﬁrst step by a region growing algorithm for easier and faster determination.

This starts at the so-called seed area, a local neighborhood of a point (e.g. 3 by 3
pixels) where the laser points fulﬁll user deﬁned conditions. In this case all points of the

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

505

Figure 6 Enhancement of a portion of a DUSM obtained by applying a set of image
processing morphological operations (contraction and dilation on the edges of the
object). Left-hand images: the original DUSM represented as an isometric view (above)
and as a top view (below); right-hand images: the enhanced object is characterized by
sharper edges

seed area must lie in the same plane (initial plane) with only small acceptable deviations
(e.g. due to data noise), i.e. the point coordinates must fulﬁll the mathematical equation
of a plane.

After determination of the initial plane the region growing algorithm iteratively
analyses the adjacent points. A point is added to this plane if it fulﬁlls a so-called
homogeneity condition, by means of the orthogonal distance of the point to the current
plane. The point is accepted and integrated if this distance is small enough to fulﬁll a
probability condition and the plane parameters are recalculated by an adjustment pro-
cedure. If no new adjacent points can be found the region growing stops, the plane area
(and its parameters) are stored and subsequently masked out. Then the algorithm will
search for a new seed area and start segmenting a new plane until no new planes can be
found in the dataset.

This procedure was initially described by Quint and Landes (1996) and later
enhanced for application on LiDAR data by Vögtle and Steinle (2000). As proposed by
Lemp and Weidner (2005) the algorithm has also been applied using only last pulse laser
data, but results were not satisfying, especially along roof edges.

Figure 7 shows the result of the segmentation of roof planes for an area of the CERN

campus using all laser scanning pulse data.

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

506

C Carneiro, E Morello, T Voegtle and F Golay

Figure 7 Segmentation of planar roof areas in the CERN test area (subset)

Figure 8 Extraction of the volume of a building using the n2.5-DUSM of buildings
(enhanced and unenhanced models)

3.4.4 The calculation of the morphological indicators: volume of buildings, area
of roofs, and area of façades

Volume of buildings

The n2.5-DUSM of buildings was used for the calculation of each building’s volume. The
volume was built from each pixel within a grid size of 0.5 m and was obtained by
multiplying the unit square of the pixel itself by the height derived from the correspond-
ing intensity value on the n2.5-DUSM of buildings, as presented in Figure 8. Thus, in
order to derive the volume of each building, pixel volumes4 overlaying the corresponding
2D digital (vectorial) building area were aggregated and summed.

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

507

Figure 9 An example of an analyzed object and the detection of edges with eight
variations on the procedure

Area of façades and area of roofs

Out of this basic procedure eight different variations were created, as shown in Figure 9
and explained in Table 1. Several morphological operations on pixels were scrutinized
and it was decided to proceed with the fastest techniques, applying small changes in the
parameters used. In fact, slight changes in the deﬁnition of the parameters of the
morphological operations (size and shape of the neighbourhood, ﬁlters used in the edge
detection) can dramatically affect the results (refer to Figure 10 for some examples of
structuring elements used); the use of more sensitive edge detectors allows the identiﬁ-
cation of the edges of internal surfaces in the case of complex geometries, as presented in
Section 4. For instance, the main issue with morphological indicators is related to the
variation of the vertical section of the object. As an example, refer to Figure 11, where
the tower does not correspond to the footprint of the basement. These complex shapes

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

508

C Carneiro, E Morello, T Voegtle and F Golay

n
o
i
t
c
e
t
e
D

l
a
n
r
e
t
n

i

f
o

s
e
g
d
e

x
e
l
p
m
o
c

f
i
(

)
y
r
t
e
m
o
e
g

o
N

o
n

f
o
n
o
i
t
p
i
r
c
s
e
d
t
r
o
h
S

e
r
u
d
e
c
o
r
p
e
h
t

d
o
o
h
r
o
b
h
g
i
e
n
d
e
i
l

p
p
a

e
h
t

f
o
n
o
i
t
p
i
r
c
s
e
D

d
o
o
h
r
o
b
h
g
i
e
n
d
e
i
l

p
p
a

e
h
t

f
o
n
o
i
t
p
i
r
c
s
e
D

t
n
e
m
e
c
n
a
h
n
1 E

l
a
n
i
g
i
r
o
e
h
t
n
o

s
r
o
b
h
g
i
e
n
f
o
#

e
p
a
h
S

e
z
i
S

s
r
o
b
h
g
i
e
n
f
o
#

e
p
a
h
S

e
z
i
S

M
S
U
D

D

I

e
s
a
C

l

l
a
c
i
g
o
o
h
p
r
o
3 M

t
c
e
t
e
d
o
t

)
1

i

t
n
o
p
(

l
e
d
o
m
d
e
c
n
a
h
n
e

r
e
t
l
ﬁ
d
n
o
m
a
i
d
a

g
n
i
y
l
p
p
a

s
e
g
d
e

r
e
t
l
ﬁ
y
n
n
a
C
e
h
t

f
o
n
o
i
t
a
c
i
l

p
p
+ a

e
h
t
n
o
n
o
i
t
a
r
e
p
o

t
c
e
j
b
o
e
h
t

f
o
r
e
t
e
m

i
r
e
p
e
h
t

e
t
a
l
i

d
d
n
a

t
c
a
r
t
n
o
c
o
t
n
o
i
t
a
r
e
p
o

l

l
a
c
i
g
o
o
h
p
r
o
2 M

s
e
c
a
f
r
u
s

l
a
c
i
t
r
e
v

f
o
s
e
g
d
e

e
h
t

e
c
n
a
h
n
e
o
t
d
e
s
u
s
n
o
i
t
a
r
e
p
o

l

l
a
c
i
g
o
o
h
p
r
o
m
e
h
t
n
o
s
n
o
i
t
a
i
r
a
v

t
h
g
i
E

1
e
l
b
a
T

5

d
n
o
m
a
i
D

3
¥
3

o
N

3
1

d
n
o
m
a
i
D

5
¥
5

o
N

s
e
Y

5

d
n
o
m
a
i
D

3
¥
3

3
1

d
n
o
m
a
i
D

5
¥
5

s
e
Y

1

2

3

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

509

d
n
a

2

e
s
a
c
m
o
r
f

s
e
g
d
e

l
a
n
r
e
t
x
e

s
e
n
o

l
a
n
r
e
t
n

i

3

e
s
a
c
m
o
r
f

d
e
t
c
e
t
e
d
g
n
i
t
c
e
l
e
S

s
e
Y

d
n
a

2

e
s
a
c
m
o
r
f

s
e
g
d
e

l
a
n
r
e
t
x
e

s
e
n
o

l
a
n
r
e
t
n

i

5

e
s
a
c
m
o
r
f

d
e
t
c
e
t
e
d
g
n
i
t
c
e
l
e
S

s
e
Y

d
n
a

2

e
s
a
c
m
o
r
f

s
e
g
d
e

l
a
n
r
e
t
x
e

s
e
n
o

l
a
n
r
e
t
n

i

7

e
s
a
c
m
o
r
f

d
e
t
c
e
t
e
d
g
n
i
t
c
e
l
e
S

s
e
Y

s
e
Y

9

e
r
a
u
q
S

3
¥
3

3
1

d
n
o
m
a
i
D

5
¥
5

s
e
Y

s
e
Y

3
1

d
n
o
m
a
i
D

5
¥
5

3
1

d
n
o
m
a
i
D

5
¥
5

s
e
Y

l
a
n
r
e
t
n

i

r
o
f

y
l
n
O

s
e
d
a
c
a
f

l
a
n
r
e
t
n

i

r
o
f

y
l
n
O

s
e
d
a
c
a
f

l
a
n
r
e
t
n

i

r
o
f

y
l
n
O

s
e
d
a
c
a
f

4

5

6

7

8

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

510

C Carneiro, E Morello, T Voegtle and F Golay

Figure 10 Details of structuring elements used to enhance the model

Figure 11 From simple (left) to complex (right) geometry: the tower on a basement

are difﬁcult to analyze, because the external perimeter does not include the edges of the
tower. Hence, many edge detectors do not recognize the internal perimeters.

Concerning the proposed eight variations in particular, the external edges of objects
can be detected using different neighborhoods for the variations numbered 1 and 2. In
addition, the use of more sensitive edge detectors allows the identiﬁcation of the bound-
aries of internal surfaces in the case of complex geometries (variations 3, 5, and 7).
Finally, three optimized variations are proposed (variations 4, 6, and 8) where the
computation of external edges of case 2 are combined with the computation of internal
edges of cases 3, 5, and 7.

Once the external and internal edges were detected, the height of the pixel could be
derived. Concerning the determination of the length of pixels, it is important to precisely
locate those pixels belonging to diagonal segments on the perimeter and assign a longer
linear extension. It is not an easy task to deﬁne the correct method to calculate the
perimeter of an object based on a pixel structure. In order to reduce the error during the
computation, it was decided to distinguish only between two lengths to assign to each
edge pixel: pixels of value 1*u and “diagonal” pixels with value √2*u (where u repre-
sents the original unit of the pixel-grid deﬁned on the DUSM). This method is a good
compromise for a quick and accurate computation; for instance, methods that use more
ﬁne-grained pixel-lengths require the application of larger neighborhoods to detect the

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

511

Figure 12 A detail of the edge of an object showing the lengths assigned to each pixel.
The unit u of the grid is 0.5 m: pixels have values of 1*u and √2*u

inclination of the pixel, and this operation often leads to computational mistakes. Hence,
it was decided to apply an analysis performed on the sequence of the perimeter segment
and simply to assign the √2*u value every time the pixels in the series were only
8-connected but not 4-connected5 (refer to Figure 12). Finally, by multiplying the height
of each pixel by its length the area of each façade segment could be obtained.

A slightly different procedure can be applied to calculate the areas of roofs. In that
case, the surface of the pixel can be calculated once the slope of each pixel is known. For
instance, the areas of pixels can vary depending on their inclination. The surface of the
pixels can easily be calculated by applying trigonometric formulae. In this work six
classes of slopes were distinguished (each class was characterized in steps of 15 degrees,
from 0 to 75 degrees). Next the slopes of the pixels were reclassiﬁed in order to eliminate
those parts that can represent the contours of buildings, i.e. the vertical surfaces. In
Figure 13 the reclassiﬁcation of the slopes on a pixel basis is shown: on the left, the slopes
are represented on a pixel basis, whereas on the right slopes higher than 60 degrees are
set to 0. Moreover, slopes higher than 45° or 60° were also reclassiﬁed using different
structuring elements (3 by 3 pixels or 13 diamond pixel ﬁlter sizes). The segmentation
procedure for laser scanning data was independently implemented to search for planar
faces in order to deﬁne the slope of each roof section more accurately, when compared
to slope automatically calculated using the n2.5-DUSM. Finally, in order to derive the
area of each roof, pixel areas6 overlaying the corresponding 2D projection of 3D digital
(vectorial) roof areas were aggregated and summed.

The analyses are grouped in two parts, corresponding to the two case-study areas (refer
to Table 2). For each site the same three computations were performed, based on the use

4 Performed Calculations

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

512

C Carneiro, E Morello, T Voegtle and F Golay

Figure 13 The reclassiﬁcation of the slopes of the roof pixels. Left, the slopes on a pixel
basis, right the slopes higher than 60 degrees are set to 0. In fact, brighter pixels on the
edges of the object and features do not appear on the image on the right

Table 2 The sets of analyses conducted on the two case-study areas using different
source information

Number of
analyzed buildings

1 Case study at CERN

1A: Analysis of normalized 2.5-D DUSM derived from building

10

outlines and LiDAR data for volume calculation

1B: Analysis of the 2.5-D nDUSM derived from the 2D

projection of the 3D model of roof lines and LiDAR data
for areas of roofs calculation

1C: Analysis of the 2.5-D nDUSM derived from building

outlines (also external façades of the 3D model of
buildings) and LiDAR data for areas of façades calculation

2 Case study in the center of Geneva

2A: Analysis of the 2.5-D DUSM derived from building outlines

34

and LiDAR data for volume calculation

2B: Analysis of the 2.5-D nDUSM derived from the 2D

projection of the 3D model of roof lines and LiDAR data
for areas of roofs calculation

2C: Analysis of the 2.5-D nDUSM derived from building

outlines (also external façades of the 3D model of
buildings) and LiDAR data for areas of façades calculation

10

18

17

44

of different source information, as follows: (1) building outlines and LiDAR data; (2) 2D
projection of the 3D model of roof lines; and (3) LiDAR data.

In order to organize the statistical analysis, three possible geometric primitives that
describe both roofs and façades are referred to. These categories, represented in
Figure 14, are mainly:

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

513

Figure 14 Different primitives considered for façades and roofs

1. The ﬂat roofs and the simple façades: both are deﬁned by ﬂat planes without

interruptions (e.g. ﬂat roofs).

2. The classic roofs and the intermediate façades: these are deﬁned by multiple surfaces
but do not include jumps among its faces (typically continuous pitched roofs).
3. The complex roofs and the multifaceted façades, whereby different planes determine
discontinuities among the surfaces (typically shaded roofs or façades in terraced
buildings).

5 Assessment of the Performed Calculations

5.1 Presentation

The statistical analysis was performed to validate the method. The computed morpho-
logical properties (volumes, areas of façades, and areas of roofs) through the different
local morphological operations on the n2.5-DUSM of buildings and the n2.5-DUSM of
roofs (see Section 4) were compared to the outputs directly calculated using the 3D
vectorial city model.

Results summarized in the Appendix (Tables A1–A10) are grouped by morphologi-
cal property, distinguishing between: (1) the global (all buildings) and the building by

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

514

C Carneiro, E Morello, T Voegtle and F Golay

Table 3 Hypothesis related to the signiﬁcance tests conducted in this study

Test 1
For volumes, areas
of roofs and
areas of façades

Test 2
Only for areas of

façades

Test 3
Only for areas
of roofs

Signiﬁcance statistical analysis
(t test; level of signiﬁcance: 0.05)

Null Hypothesis (H0)

Hypothesis 1 (H1)

No signiﬁcant improvement
between the use of the
unenhanced and the
enhanced models for the
calculation of volumes, areas
of roofs and areas of façades

No signiﬁcant improvement
between the use of the
unenhanced and the
optimized models for the
calculation of areas of
façades

No signiﬁcant improvement
between the use of the
unenhanced model and the
segmentation technique for
the calculation of areas of
roofs

Signiﬁcant improvement

between the use of the
unenhanced and the
enhanced models for the
calculation of volumes, areas
of roofs and areas of façades

Signiﬁcant improvement

between the use of the
unenhanced and the
optimized models for the
calculation of areas of
façades

Signiﬁcant improvement

between the use of the
unenhanced model and the
segmentation technique for
the calculation of areas of
roofs

building analysis; (2) the use of the unenhanced, enhanced, and optimized models and the
segmentation procedure; (3) the level of complexity of building and roof types (see
Figure 14).

In particular, the “global deviation error” is deﬁned as the relation of the global (all
buildings) calculated morphological indicator derived from LiDAR data and the theo-
retical known value, whereas the “absolute building deviation error” for each building
represents the absolute relation of the calculated morphological indicator derived from
LiDAR data and the theoretical known value.

Moreover, a two-tailed “t-test” signiﬁcance statistical analysis was applied to each of
the morphological properties of buildings calculated using the unenhanced,
the
enhanced, and the optimized 2.5-DUSM models and the segmentation procedure. This
test allows the interpretation of the probability related to the decreasing of the absolute
deviation error between each pair of buildings of the following cases: (1) the unenhanced
and the enhanced models; (2) the unenhanced model and the segmentation procedure; (3)
the unenhanced and the optimized models.

The reason to have applied a two-tailed “t-test” and not a simpler one-tailed “t-test”
is that differences between each pair of buildings can be positive or negative, guaranteeing
a more strict signiﬁcance statistical test. Thus, for each of the three morphological
properties of the evaluated buildings, the null hypothesis H0 was tested as shown in
Table 3.

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

515

Table 4 Signiﬁcance statistical analysis on volumes to test the improvement of the
proposed calculation, referring to different types of considered buildings in the
enhanced and unenhanced models

CERN + Centre of Geneva
Volumes of roofs
Signiﬁcance statistical analysis (t test; level of signiﬁcance: 0.05)

Volumes of 44 buildings
(complex, classic and
ﬂat roofs)

Unenhanced Model

Volumes of 10 buildings

(complex only)

Test 1
Enhanced Model

0.14
Signiﬁcance of

improvement: No

Test 1
Enhanced Model

0.49
Signiﬁcance of

improvement: No

Volumes of 21

buildings (classic
only)

Test 1
Enhanced Model

Unenhanced Model 0.13

Volumes of 13
buildings
(ﬂat only)

Signiﬁcance of

improvement: No

Test 1
Enhanced Model

Signiﬁcance of

improvement: No

Unenhanced Model

Unenhanced Model 0.59

The signiﬁcance level (a) was set to 0.05, which means that H0 was rejected in favor
of H1 when a was lower than 0.05. For more details about the signiﬁcance tests
calculated for each of the morphological properties of buildings under analysis please
consult Tables 4–6.

5.2 Output Results for Volumes and Discussion

In general, as was stated at the beginning of this article, it is easy to derive volumes using
DIP techniques and this work does not propose signiﬁcant improvements to the tradi-
tional pixel based computation.

In particular, the analysis summarized in Tables A1 and A2 of the Appendix shows
that no major improvement can be reached using the enhanced model to reduce the
global deviation error, even if at the building’s scale (Table A2) some minor, non-
signiﬁcant improvement is noticed for the absolute building deviation error. This happens
because in the process of enhancement on the perimeter the distribution of intensity
values inside the neighborhood is averaged, thus reducing the effects of LiDAR interpo-
lation and obtaining more deﬁned edges. This enhancement does not really affect the
overall volume calculation, but it has a signiﬁcant effect on the calculation of the façade
areas. Moreover, results of deviation show that volumes are always slightly overesti-
mated for both the enhanced and the unenhanced models.

The signiﬁcance statistical analysis that tests the improvement of using the unen-
hanced model versus the enhanced model for the calculation of volumes is shown in
Table 4, conﬁrming that no signiﬁcant improvements were achieved for the different
types of considered buildings.

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

516

C Carneiro, E Morello, T Voegtle and F Golay

Table 5 Signiﬁcance statistical analysis on the areas of façades to test the improvement
of the proposed calculation, referring to different types of considered buildings in the
enhanced (case 7) and optimized models (case 8)

CERN + Centre of Geneva
Areas of facades
Signiﬁcance statistical analysis (t test; level of signiﬁcance: 0.05)

Areas of facades of 62

buildings (multifaceted,
intermediate and simple
buildings)

Unenhanced Model

(case 1)

Areas of facades of 18

multifaceted buildings

Unenhanced Model

(case 1)

Areas of facades of 30

intermediate buildings

Unenhanced Model

(case 1)

Areas of facades of 14 simple

buildings

Unenhanced Model

(case 1)

Test 1
Enhanced Model
(case 7)

Test 2
Optimized Model
(case 8)

0.095
Signiﬁcance of improvement:
No
Test 1
Enhanced Model
(case 7)
3E-04
Signiﬁcance of improvement:
Yes
Test 1
Enhanced Model
(case 7)
0.14
Signiﬁcance of improvement:
No
Test 1
Enhanced Model
(case 7)
0.54
Signiﬁcance of improvement:
No

1E-3
Signiﬁcance of improvement:
Yes
Test 2
Optimized Model
(case 8)
1E-3
Signiﬁcance of improvement:
Yes
Test 2
Optimized Model
(case 8)
0.47
Signiﬁcance of improvement:
No
Test 2
Optimized Model
(case 8)
0.25
Signiﬁcance of improvement:
No

5.3 Output Results for the Areas of Façades and Discussion

In this analysis (Tables A3 and A4 of the Appendix) the accuracy of the eight proposed
variations (see, for instance, Table 1) for the calculation of the areas of façades was
assessed.

Referring to the validation of the computation of the areas of façades, it can be seen
that among the proposed variations of the procedure to enhance the model (refer to
Section 3.4.4) the variation number 7 gives the best results at a global level. If the
precision at the building level is analyzed, variation number 8 performs better. The
reason is that for these particular routines larger neighborhoods were used to enhance the
edges of the object, thus enabling the detection of more internal vertical surfaces. This
makes the difference, mainly in the case of multifaceted buildings, such as towers on the
basement, as shown in Figure 11.

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

517

Table 6 Signiﬁcance statistical analysis on roof areas to test the improvement of the
proposed calculation, referring to different types of considered buildings in the
enhanced and unenhanced models and the segmentation procedure

CERN + Centre of Geneva
Areas of roofs
Signiﬁcance statistical analysis (t test; level of signiﬁcance: 0.05)

Areas of all roofs
(27 buildings)

Test 1
Enhanced Model

Test 1
Enhanced Model

Test 3
Segmentation
procedure

(reclassiﬁcation of
slopes > 45° to 0°)

(reclassiﬁcation of
slopes > 45°) by
applying a 13 size
diamond mask

Unenhanced Model
(not reclassiﬁed)

1E-05
Signiﬁcance of

1E-05
Signiﬁcance of

2E-05
Signiﬁcance of

improvement: Yes

improvement: Yes

improvement: Yes

Areas of complex roofs

(15 buildings)

Test 1
Enhanced Model

Test 1
Enhanced Model

Test 3
Segmentation
procedure

(reclassiﬁcation of
slopes > 45° to 0°)

(reclassiﬁcation of
slopes > 45°) by
applying a 13 size
diamond mask

Unenhanced Model
(not reclassiﬁed)

1E-03
Signiﬁcance of

1E-03
Signiﬁcance of

9E-04
Signiﬁcance of

improvement: Yes

improvement: Yes

improvement: Yes

Areas of classic roofs

(6 buildings)

Test 1
Enhanced Model

Test 1
Enhanced Model

Test 3
Segmentation
procedure

(reclassiﬁcation of
slopes > 45° to 0°)

(reclassiﬁcation of
slopes > 45°) by
applying a 13 size
diamond mask

Unenhanced Model
(not reclassiﬁed)

0.041
Signiﬁcance of

0.045
Signiﬁcance of

0.040
Signiﬁcance of

improvement: Yes

improvement: Yes

improvement: Yes

Areas of ﬂat roofs
(6 buildings)

Test 1
Enhanced Model

Test 1
Enhanced Model

Test 3
Segmentation
procedure

(reclassiﬁcation of
slopes > 45° to 0°)

(reclassiﬁcation of
slopes > 45°) by
applying a 13 size
diamond mask

Unenhanced Model
(not reclassiﬁed)

0.037
Signiﬁcance of

0.039
Signiﬁcance of

0.034
Signiﬁcance of

improvement: Yes

improvement: Yes

improvement: Yes

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

518

C Carneiro, E Morello, T Voegtle and F Golay

The signiﬁcance statistical analysis that tests the improvement of using the unen-
hanced model versus the enhanced model (case 7) and the unenhanced model versus the
optimized model (case 8) shows a signiﬁcant improvement for the calculation of areas of
façades of multifaceted buildings in both cases. Moreover, the signiﬁcance statistical
analysis shows that the optimized model (case 8) also presents a signiﬁcant improvement
when evaluating all three types of buildings in a single dataset. For more details please
consult Table 5.

5.4 Output Results for the Areas of Roofs and Discussion

In this set of analyses (Tables A5 to A10 of the Appendix), both methods (DIP techniques
and segmentation of planar areas) were processed on the unenhanced and enhanced
models.

Concerning the segmentation procedure applied for areas of façades calculation, it
was noticed that many superstructures on roofs – especially in the Geneva city center
case-study area – were not easy to detect. For instance, buildings with classic and
complex geometries having many superstructures on roofs caused lower accuracies and
higher standard deviations. The reclassiﬁcation (for more details refer to Section 3.4.4)
with DIP techniques of those pixels having slopes higher than 45 or 60 degrees proved
to be a good alternative for the segmentation procedure. In fact, this is particularly
important in the case where 3D roof prints are not available, even if the 2D outlines of
building footprints do not always represent the outline of the building roof.

The signiﬁcance statistical analysis that tests the improvement of using: (1) the
unenhanced model versus the enhanced model by reclassifying slopes > 45° to 0°; (2) the
unenhanced model versus the enhanced model with reclassiﬁcation of slopes > 45° by
applying a 13 size diamond mask; and (3) the unenhanced model versus the segmentation
procedure, shows a signiﬁcant improvement for all cases, as presented in Table 6.

5.5 General Remarks on the Results

The results shown in the tables of the Appendix, complemented by the signiﬁcance
statistical analysis presented in Sections 5.2–5.4, demonstrate that the methods proposed
here can reach higher levels of accuracy by reducing the global and absolute building
deviation errors to the real 3D vectorial city model. The best results achieved from all the
techniques and models used are summarized in Table 7.

Finally, some general remarks are presented concerning the results achieved consid-

ering the signiﬁcance statistical analysis:

• For the analysis of volumes, the use of the enhanced model is not justiﬁed. In fact, the
global analysis with the unenhanced model performs better, since the procedure of
enhancement tends to overweight the intensity values of pixels.

• The enhanced model is particularly suitable to improve results for the calculation of

façade and roof areas.

• The segmentation procedure performs better for the analysis of roof areas, even if the
use of DIP for reclassiﬁcation of slopes higher of 45° by applying a 13 diamond ﬁlter
is a good alternative when the segmentation procedure is not applied to raw LiDAR
data.

• The optimized model is a good option for the calculation of façade areas, especially

for zones characterized by low density built-up areas with simple buildings.

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Table 7 Review of best results achieved by applying the proposed methods

Digital Urban Morphometrics

519

CERN + Centre of Geneva
Volumes

Global Analysis
(Unenhanced Model)

Building by Building analysis
(Enhanced Model)

Type of building

Global deviation error

Standard deviation

Absolute building
deviation error

Total
Simple
Intermediate
Multifaceted

2.30%
3.82%
0.99%
0.90%

4.09%
4.15%
4.25%
5.49%

3.26%
3.30%
2.93%
4.40%

CERN + Centre of Geneva
Areas of facades

Global Analysis
(Enhanced Model:
case 7)

Building by Building analysis
(Optimized Model: case 8)

Type of building

Global deviation error

Standard deviation

Absolute building
deviation error

Total
Simple
Intermediate
Multifaceted

-3.45%
-5.03%
3.53%
-9.78%

6.78%
5.04%
4.07%
10.92%

6.77%
2.80%
4.15%
7.32%

CERN + Centre of Geneva
Areas of roofs

Global Analysis
(Segmentation
Technique)

Building by building analysis
(Segmentation Technique)

Absolute building
deviation error

Type of building

Global deviation error

Standard deviation

Total
Simple
Intermediate
Multifaceted

1.19%
-1.57%
-0.95%
1.74%

3.47%
1.19%
2.79%
4.45%

4.09%
0.59%
3.43%
4.71%

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

520

C Carneiro, E Morello, T Voegtle and F Golay

6 Conclusions and Future Work

This work presents a method to calculate the morphological properties of the built
environment using LiDAR data, GIS data and 3D models of cities through segmentation
and image processing techniques. The developed procedure is intended to ﬁll the gap in
this sector, thus enabling the use of LiDAR data for numerous applications at the level of
the urban fabric. Using different techniques to reconstruct and analyze the model, we
calculated morphological properties of the built fabric. Afterwards, the outputs were
then validated through a comparison to the 3D vectorial city model. The conducted
analysis on two case-study areas, characterized by very different geometries of buildings,
allows the conclusion that the methods can be extended to other cases. For instance, the
calculation procedure should be chosen according on the complexity of the urban fabric.
Once the areas of the surfaces and the built volumes are assessed, other minor

indicators can be easily derived with DIP techniques (pixel analysis):

• General morphological indicators: the total built ﬂoor area considering all storeys
(mean storey height is assumed to be 3 m); the mean height of buildings on the site.
• Derived indicators of density: urban density, as follows: the built volume on the
considered urban area (m3/m2); the ground occupation index, i.e. the covered area to
the urban area ratio (m2/m2); the ﬂoor area ratio (FAR) (m2/m2).

This short list of derived indicators demonstrates how signiﬁcant it is to accurately
compute the urban surfaces, if we want to use this type of information for helpful
applications in urban studies, in particular in the ﬁeld of UEQ and the assessment of
energy consumption of the built fabric. In fact, as presented above in Section 2, calcu-
lations of solar radiation exchange, energy demand, and visibility analysis require a
reliable dimensioning of the urban surfaces.

For instance, the proposed n2.5-DUSMs derived from LiDAR data include all the
features, like roof superstructures, that are crucial in the estimation of solar radiation and
are generally ignored by most of the existing 3D models. Moreover, n2.5-DUSMs derived
from LiDAR surveys could also take vegetation into account, thus providing a quanti-
ﬁcation of natural elements (vegetation density).

Future work will focus on the following aspects to improve the method:

• To automate the process to directly calculate the morphological properties from the
raw LiDAR data. This step requires the implementation of new software that includes
the potential of all software that was used in this work.

• To improve some minor issues concerning complex buildings, for example reﬁning

the computation of superstructures on roofs.

• To consider carefully those parts of the built environment that are strongly limited by
vegetation (e.g. big portions of trees covering the roofs) during the phase of recon-
struction of the model.

• To test the robustness of the methods presented here by evaluating their sensitivity to
the variation of grid size and to the discrepancy of sampling density of raw LiDAR
point datasets.

Finally, taking into account the technologies that are currently under rapid development,
it is very plausible that in the near future the extraction of morphological properties of
buildings could also happen through computer vision oriented photogrammetry that is
yielding innovative approaches for the automatic reconstruction and interpretation of

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

521

building façades. In any case, since the aim of this work is to provide a fast but accurate
computation at the district and urban level, the prospect of including photogrammetry
into the proposed method still seems to be remote, due to the heavy data analysis
involved.

Endnotes

1 For both case-study areas, external facades (outlines) of buildings were deﬁned using the
existing 2D GIS cadastral information, which means that n2.5-DUSM of buildings can also be
also applied for the calculation of areas of facades, as presented in Section 3.4.4.

2 The Canny ﬁlter is considered the most powerful edge detection method. It identiﬁes strong and
weak edges and its peculiarity is that it takes weak edges only into consideration when they are
connected to strong ones. This allows a reduction in noise in the image.

3 Flat structuring elements can vary according to their size (neighborhood) and their shape. The
neighborhood is a matrix containing 1s (the so-called neighbors) and 0s. The location of the 1s
deﬁnes the neighborhood for the morphological operation. In the routine the neighborhood is
centered on those pixels on which image enhancement is to be applied (in this case the pixels on
the perimeter of the object). Beside the deﬁnition of the neighborhood as the size of the ﬁlter, the
shape of the ﬁlter itself has also to be established, in other words where the 1s are disposed
inside the neighborhood.

4 The total volume built for each building comes straightforwardly by adding the elementary

volumes of its pixels.

5 The term “adjacency” is used in image processing to deﬁne “connected components,” also
referred to as “objects.” Pixels can be primarily 4-connected or 8-connected, depending on the
deﬁnition of adjacency. Generally, 4-connected pixels do not count diagonal neighbors, whereas
8-connected do (Gonzalez et al. 2009).

6 The total area of each roof comes straightforwardly by adding the elementary areas of its pixels.

References

Aalders H 2002 The registration of quality in a GIS. In Shi W, Fisher P F, and Goodchild M F (eds)

Spatial Data Quality. London, Taylor and Francis: 186–99

Behan A 2000 On the matching accuracy of rasterised scanning laser altimeter data. International
Archives of Photogrammetry, Remote Sensing and Spatial Information Sciences 33(B2):
75–82

Canny J 1986 A computational approach to edge detection. IEEE Transactions Pattern Analysis

and Machine Intelligence 8: 679–714

Carneiro C, Morello E, and Desthieux G 2009a Assessment of solar irradiance on the urban fabric
for the production of renewable energy using LIDAR data and image processing techniques. In
Sester M, Bernard L, and Paelke V (eds) Advances in Giscience. Berlin, Springer Lecture Notes
in Geoinformation and Cartography: 83–110

Carneiro C, Morello E, Ratti C, and Golay F 2008 Solar radiation over the urban texture: LIDAR
data and image processing techniques for environmental analysis at city scale. In Lee J and
Zlatanova S (eds) 3-D Geo-Information Sciences. Berlin, Springer Lecture Notes in Geoinfor-
mation and Cartography: 319–40

Carneiro C, Silva V, and Golay F 2009b Incorporation of morphological properties of buildings’
descriptors computed from GIS and LIDAR data on an urban multiagent vector based
geosimulator. In Gervasi O, Taniar D, Murgante B, Lagama A, Mun Y, and Gavrilova M L
(eds) Computational Science and Its Applications: ICCSA 2009, Part I. Berlin, Springer
Lecture Notes in Computer Science Vol. 5992: 205–20

Devillers R, Bedard Y, and Jeansoulin R 2005 Multidimensional management of geospatial data
quality information for its dynamic use within GIS. Photogrammetric Engineering and Remote
Sensing 71: 205–15

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

522

C Carneiro, E Morello, T Voegtle and F Golay

Gonzalez R C, Woods R E, and Eddins S L 2009 Digital Image Processing Using Matlab. Knoxville,

TN, Gatesmark Publishing

Haala N, Brenner C, and Anders K-H 1998 3D urban GIS from laser altimeter and 2D map data.
International Archives of Photogrammetry, Remote Sensing and Spatial Information Sciences
32(3/1): 339–46

Hofmann A, Maas H-G, and Streilein A 2003 Derivation of roof types by cluster analysis in
parameter spaces of airborne laserscanner point clouds. International Archives of Photogram-
metry, Remote Sensing and Spatial Information Sciences 34(3/W13): 112–17

Koomen E and Bação F 2005 Searching for the polycentric city: a spatio-temporal analysis of
Dutch urban morphology. In Proceedings of the Eightth AGILE Conference on GIS, Lisbon,
Portugal

Lemp D and Weidner U 2005 Improvements of roof surface classiﬁcation using hyperspectral and
laser scanning data. International Archives of Photogrammetry, Remote Sensing and Spatial
Information Sciences 36(8/W27): CD-ROM

Morello E and Ratti C 2009a SunScapes: “solar envelopes” and the analysis of urban DEMs.

Computers, Environment and Urban Systems 33: 26–34

Morello E and Ratti C 2009b A digital image of the city: 3-D isovists in Lynch’s Urban Analysis.

Environment and Planning B 36: 837–53

Osaragi T and Otani I 2007 Effects of ground surface relief in 3-D spatial analysis on residential
environment. In Fabrikant S and Wachowicz M (eds) The European Information Society:
Leading the Way with Geo-information. Berlin, Springer Lecture Notes in Geoinformation
and Cartography: 171–86

Quint F and Landes S 1996 Colour aerial image segmentation using a Bayesian homogeneity
predicate and map knowledge. International Archives of Photogrammetry, Remote Sensing
and Spatial Information Sciences 31(B3): 663–8

Ratti C and Richens P 2004 Raster analysis of urban form. Environment and Planning B 31:

297–309

Rottensteiner F, Trinder J, Clode S, and Kubik K 2005 Automated delineation of roof planes from
LIDAR data. In Proceedings of the ISPRS Workshop Laser Scanning 2005, Enschede, The
Netherlands: 221–26

Vögtle T and Steinle E 2000 3-D modelling of buildings using laser scanning and spectral infor-
mation. International Archives of Photogrammetry, Remote Sensing and Spatial Information
Sciences 33(B3): 927–34

Vosselmann G 2002 Fusion of laser scanning data, maps and aerial photographs for building
reconstruction. In Proceedings of the International Geoscience and Remote Sensing Sympo-
sium, Toronto, Canada: 85–8

Vosselmann G and Dijkman S 2001 3-D building model reconstruction from point clouds and
ground plans. International Archives of Photogrammetry, Remote Sensing and Spatial Infor-
mation Sciences 34(3/W4): 37–44

Yoshida H and Omae M 2005 An approach for analysis of urban morphology: Methods to derive
morphological properties of city blocks by using an urban landscape model and their inter-
pretations. Computers, Environment and Urban Systems 29: 223–47

Zinger S, Nikolova M, Roux M, and Maître H 2002 3D resampling for airborne laser data of urban
areas. International Archives of Photogrammetry, Remote Sensing and Spatial Information
Sciences 34(3B): 55–61

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

523

n
o
i
t
a
i
v
e
d

l
a
b
o
G

l

r
o
r
r
e

%
6
3
.
2

%
9
4
.
3

%
7
9
.
0

%
6
9
.
1

D
-
3

e
m
u
o
V

l

]
3

m

[

l
e
d
o
m

6
8
.
4
1
1
,
8
3
3

2
2
.
3
0
6
,
8
5
1

2
4
.
9
8
6
,
7
0
1

2
2
.
2
2
8
,
1
7

P
I
D
e
m
u
o
V

l

n
o
i
t
a
i
v
e
d

l
e
d
o
m
D
-
3

e
m
u
o
V

l

]
3

m

[

i

s
e
u
q
n
h
c
e
t

g
n
d

i

l
i

u
b
f
o
e
p
y
T

r
o
r
r
e

]
3

m

[

]
3

m

[

g
n
d

i

l
i

u
b
f
o
e
p
y
T

l
a
b
o
G

l

P
I
D
e
m
u
o
V

l

i

s
e
u
q
n
h
c
e
t

8
4
.
5
0
1
,
6
4
3

3
2
.
4
4
1
,
4
6
1

0
8
.
4
3
7
,
8
0
1

4
4
.
6
2
2
,
3
7

e
t
a
i
d
e
m
r
e
t
n
I

d
e
t
e
c
a
f
i
t
l
u
M

e
l
p
m
i
S

l
a
t
o
T

%
0
3
.
2

%
2
8
.
3

%
9
9
.
0

%
0
9
.
0

6
8
.

4
1
1

,

8
3
3

2
2
.
3
0
6
8
5
1

,

2
4
.

9
8
6

,

7
0
1

2
2
.
2
2
8
1
7

,

0
5

.

7
8
8

,

5
4
3

.

8
7
6
6
6
4
6
1

,

.

6
3
4
5
7
8
0
1

,

.

5
3
6
6
4
2
7

,

e
t
a
i
d
e
m
r
e
t
n
I

d
e
t
e
c
a
f
i
t
l
u
M

e
l
p
m
i
S

l
a
t
o
T

M
S
U
D
-
5
.
2
n
d
e
c
n
a
h
n
e

s
i
s
y
l
a
n
a

e
m
u
o
v

l

l
a
b
o
G

l

.

M
S
U
D
-
5
2
n
d
e
c
n
a
h
n
e
n
u
s
i
s
y
l
a
n
a

e
m
u
o
v

l

l
a
b
o
G

l

l
e
d
o
m
d
e
c
n
a
h
n
e

:

e
d
i
s
d
n
a
h
-
t
h
g
i
r

;
l
e
d
o
m
d
e
c
n
a
h
n
e
n
u

:

e
d
i
s
d
n
a
h
-
t
f
e
L

i

.
s
e
u
q
n
h
c
e
t

P
I
D
g
n
i
s
u
s
e
m
u
o
v

l

f
o
s
i
s
y
l
a
n
a

l
a
b
o
G

l

1
A
e
l
b
a
T

a
v
e
n
e
G

f
o
r
e
t
n
e
C
+
N
R
E
C

x
i
d
n
e
p
p
A

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

524

C Carneiro, E Morello, T Voegtle and F Golay

d
e
c
n
a
h
n
e

:

e
d
i
s

d
n
a
h
-
t
h
g
i
r

;
l
e
d
o
m
d
e
c
n
a
h
n
e
n
u

:

e
d
i
s

d
n
a
h
-
t
f
e
L

i

.
s
e
u
q
n
h
c
e
t

P
I
D
g
n
i
s
u

s
e
m
u
o
v

l

f
o

s
i
s
y
l
a
n
a

g
n
d

i

l
i

u
b

y
b

g
n
d

i

l
i

u
B

2
A
e
l
b
a
T

a
v
e
n
e
G

f
o
r
e
t
n
e
C
+
N
R
E
C

l
e
d
o
m

]
3

m

[

e
m
u
o
V

l

d
r
a
d
n
a
t
S

n
o
i
t
a
i
v
e
d

%
6
2
.
3

%
0
3
.
3

%
3
9
.
2

%
0
4
.
4

g
n
d

i

l
i

u
b
e
t
u
o
s
b
A

l

]
3

m

[

e
m
u
o
V

l

g
n
d

i

l
i

u
b
e
t
u
o
s
b
A

l

]
3

m

[

e
m
u
o
V

l

r
o
r
r
e
n
o
i
t
a
i
v
e
d

g
n
d

i

l
i

u
b
f
o
e
p
y
T

r
o
r
r
e
n
o
i
t
a
i
v
e
d

g
n
d

i

l
i

u
b
f
o
e
p
y
T

%
9
0
.
4

%
5
1
.
4

%
5
2
.
4

%
9
4
.
5

e
t
a
i
d
e
m
r
e
t
n
I

d
e
t
e
c
a
f
i
t
l
u
M

e
l
p
m
i
S

l
a
t
o
T

%
1
6
4

.

%
5
5

.

3

%
2
8

.

4

%
5
1
6

.

e
t
a
i
d
e
m
r
e
t
n
I

d
e
t
e
c
a
f
i
t
l
u
M

e
l
p
m
i
S

l
a
t
o
T

]
3

m

[

e
m
u
o
V

l

d
r
a
d
n
a
t
S

n
o
i
t
a
i
v
e
d

%
6
1
.
3

%
3
0
.
2

%
4
7
.
3

%
6
9
.
2

M
S
U
D
-
5
.
2
n
d
e
c
n
a
h
n
e

s
i
s
y
l
a
n
a

g
n
d

i

l
i

u
b
y
b
g
n
d

i

l
i

u
B

.

M
S
U
D
-
5
2
n
d
e
c
n
a
h
n
e
n
u
s
i
s
y
l
a
n
a

g
n
d

i

l
i

u
b
y
b
g
n
d

i

l
i

u
B

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

525

)
3
1
e
s

,

M
O

(

)
3
1
e
s

,

M
E
(

)
9
e
s

,

M
O

(

)
9
e
s

,

M
E
(

]
2

m

[

]
2

m

[

]
2

m

[

]
2

m

[

8

e
s
a
c

a
e
r
A

7

e
s
a
c

a
e
r
A

6

e
s
a
c

a
e
r
A

5

e
s
a
c

a
e
r
A

4

e
s
a
c

)

M
O

(

a
e
r
A

]
2

m

[

3

e
s
a
c

a
e
r
A

)

M
E
(

]
2

m

[

2

e
s
a
c

a
e
r
A

)
2
e
s
(

]
2

m

[

1

e
s
a
c

a
e
r
A

)
1
e
s
(

]
2

m

[

D
-
3

a
e
r
A

l
e
d
o
m

]
2

m

[

%
4
0
.
6
-

%
0
0
.
7
-

%
2
7
.
1

%
3
2
.
3
1
-

%
5
4
.
3
-

%
3
0
.
5
-

%
3
5
.
3

%
8
7
.
9
-

%
8
3
.
7
-

%
6
6
.
7
-

%
0
3
.
1

%
4
7
.
5
-

%
9
7
.
6
-

%
5
3
.
2

%
2
1
.
8
-

%
1
0
.
8
-

%
7
1
.
1

%
9
9
.
7
-

%
5
7
.
7
-

%
5
9
.
0

%
8
5
.
8
-

%
0
6
.
8
-

%
6
9
.
0

%
8
5
.
5
1
-

%
2
1
.
3
1
-

%
6
9
.
6
1
-

%
8
6
.
6
1
-

%
4
5
.
7
1
-

%
8
2
1
1
-

.

%
1
8
0
1
-

.

%
7
5
1
-

.

%
0
6
0
2
-

.

–

–

–

–

8
9
.
1
7
7
,
5
9

6
0
.
4
4
3
,
3
2

2
4
.
3
3
1
,
2
3

0
1
.
4
5
2
,
9
3

5
2
.
2
1
4
,
8
9

7
1
.
9
3
8
,
3
2

8
5
.
6
0
7
,
2
3

0
5
.
5
1
8
,
0
4

6
1
.
4
1
4
,
4
9

8
9
.
8
7
1
,
3
2

2
0
.
2
0
0
,
2
3

6
7
.
2
9
1
,
8
3

9
5
.
9
7
0
,
6
9

1
9
.
7
9
3
,
3
2

9
7
.
3
3
3
,
2
3

9
3
.
3
0
3
,
9
3

6
7
.
8
5
6
,
3
9

2
3
.
2
9
0
,
3
2

2
8
.
0
6
9
,
1
3

2
2
.
5
6
5
,
7
3

9
3
.
3
8
7
,
3
9

9
6
.
7
5
1
,
3
2

7
4
.
0
9
8
,
1
3

3
9
.
4
9
6
,
7
3

6
0
.
2
8
1
,
3
9

2
9
.
3
4
9
,
2
2

2
5
.
3
9
8
,
1
3

2
2
.
4
0
3
,
7
3

.

4
4
7
8
3
2
2

,

8
9

.

1
0
1

,

5
2

9
5

.

5
9
0

,

1
3

.

2
7
0
9
5
1
3

,

.

6
5
8
1
9
5
3

,

.

2
0
0
4
2
5
4

,

.

9
0
1
3
4
0
9

,

.

2
7
2
3
9
1
0
1

,

a
v
e
n
e
G

f
o
r
e
t
n
e
C
+
N
R
E
C

s
i
s
y
l
a
n
a

a
e
r
a

l
a
b
o
G

l

g
n
d

i

l
i

u
b
f
o
e
p
y
T

r
o
r
r
e
n
o
i
t
a
i
v
e
d

l
a
b
o
G

l

e
t
a
i
d
e
m
r
e
t
n
I

d
e
t
e
c
a
f
i
t
l
u
M

e
l
p
m
i
S

l
a
t
o
T

e
t
a
i
d
e
m
r
e
t
n
I

d
e
t
e
c
a
f
i
t
l
u
M

e
l
p
m
i
S

l
a
t
o
T

l
e
d
o
m
d
e
z
i
m

i
t
p
o

,

M
O

;
l
e
d
o
m
d
e
c
n
a
h
n
e

,

M
E

;
t
n
e
m
e
l
e

l
a
r
u
t
c
u
r
t
s

,

e
s

i

;
s
e
u
q
n
h
c
e
t

P
I
D
g
n
i
s
u
s
a
e
r
a

e
d
a
ç
a
f

f
o
s
i
s
y
l
a
n
a

l
a
b
o
G

l

3
A
e
l
b
a
T

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

526

C Carneiro, E Morello, T Voegtle and F Golay

d
e
z
i
m

i
t
p
o

,

M
O

;
l
e
d
o
m
d
e
c
n
a
h
n
e

,

M
E

;
t
n
e
m
e
l
e
l
a
r
u
t
c
u
r
t
s

,

e
s

i

;
s
e
u
q
n
h
c
e
t
P
I
D
g
n
i
s
u
s
a
e
r
a
e
d
a
ç
a
f

f
o
s
i
s
y
l
a
n
a
g
n
d

i

l
i

u
b
y
b
g
n
d

i

l
i

u
B

4
A
e
l
b
a
T

%
8
7
.
6

%
4
0
.
5

%
7
0
.
4

%
2
9
.
0
1

%
7
7
.
6

%
0
8
.
2

%
5
1
.
4

%
2
3
.
7

%
6
6
.
7

%
2
1
.
5

%
0
9
.
5

%
5
8
.
0
1

%
2
8
.
6

%
0
1
.
4

%
7
6
.
5

%
5
0
.
6

%
8
3
.
7

%
9
3
.
5

%
6
0
.
4

%
2
3
.
2
1

%
6
7
.
7

%
9
2
.
3

%
1
1
.
4

%
6
8
.
7

8

e
s
a
c

a
e
r
a

]
2

m

[

7

e
s
a
c

a
e
r
a

]
2

m

[

6

e
s
a
c

a
e
r
a

]
2

m

[

)
3
1
e
s

,

M
O

(

)
3
1
e
s

,

M
E
(

)
9
e
s

,

M
O

(

)
9
e
s

,

M
E
(

5

e
s
a
c

a
e
r
a

]
2

m

[

%
2
1
.
8

%
8
7
.
5

%
7
3
.
5

%
6
3
.
2
1

%
3
5
.
7

%
3
6
.
3

%
6
1
.
5

%
4
1
.
6

4

e
s
a
c

)

M
O

(

]
2

m

[

a
e
r
a

%
1
0
.
8

%
3
6
.
5

%
8
0
.
4

%
2
0
.
4
1

%
0
7
.
8

%
2
6
.
3

%
7
0
.
4

%
8
5
.
8

3

e
s
a
c

a
e
r
a

)

M
E
(

]
2

m

[

%
5
8
.
8

%
5
1
.
6

%
3
5
.
4

%
2
6
.
5
1

%
3
3
.
9

%
5
6
.
3

%
7
6
.
4

%
8
5
.
8

2

e
s
a
c

a
e
r
a

)
2
e
s
(

]
2

m

[

%
8
3
8

.

%
0
0
6

.

%
6
0
4

.

%
8
8
4
1

.

%
4
1
9

.

%
1
5
4

.

%
1
0
4

.

%
2
4
8

.

1

e
s
a
c

a
e
r
a

)
1
e
s
(

]
2

m

[

%
6
4
9

.

%
6
4
6

.

%
2
5
4

.

%
4
2
7
1

.

%
5
9
9

.

%
3
5
5

.

%
8
2
3

.

%
6
9
8

.

g
n
d

i

l
i

u
b
f
o
e
p
y
T

e
t
a
i
d
e
m
r
e
t
n
I

d
e
t
e
c
a
f
i
t
l
u
M

e
l
p
m
i
S

l
a
t
o
T

e
t
a
i
d
e
m
r
e
t
n
I

d
e
t
e
c
a
f
i
t
l
u
M

e
l
p
m
i
S

l
a
t
o
T

r
o
r
r
e
n
o
i
t
a
i
v
e
d
g
n
d

i

l
i

u
b
e
t
u
o
s
b
a

l

:
s
i
s
y
l
a
n
a

g
n
d

i

l
i

u
b
y
b
g
n
d

i

l
i

u
B

n
o
i
t
a
i
v
e
d
d
r
a
d
n
a
t
s

:
s
i
s
y
l
a
n
a

g
n
d

i

l
i

u
b
y
b
g
n
d

i

l
i

u
B

a
v
e
n
e
G

f
o
r
e
t
n
e
C
+
N
R
E
C

l
e
d
o
m

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

527

°
5
7
>
s
e
p
o
l
s

a
e
r
A

°
0
o
t

t
e
s

]
2

m

[

°
0
6
>
s
e
p
o
l
s

a
e
r
A

°
0
o
t

t
e
s

]
2

m

[

°
5
4
>
s
e
p
o
l
s

a
e
r
A

°
0
o
t

t
e
s

]
2

m

[

°
0
3
>
s
e
p
o
l
s

a
e
r
A

°
0
o
t

t
e
s

]
2

m

[

°
5
1
>
s
e
p
o
l
s

a
e
r
A

°
0
o
t

t
e
s

]
2

m

[

2
2
.
8
5
3
,
4

4
9
.
7
8
7
,
2

0
2
.
9
8
0
,
1
4

5
0
.
3
4
9
,
3
3

0
6
.
1
2
9
,
3

1
0
.
0
8
6
,
2

3
4
.
0
1
4
,
7
3

1
8
.
8
0
8
,
0
3

2
2
.
3
4
8
,
3

1
6
.
6
6
6
,
2

5
2
.
4
7
7
,
6
3

2
4
.
4
6
2
,
0
3

1
5
.
5
5
7
,
3

2
9
.
2
9
5
,
2

9
3
.
0
7
2
,
5
3

6
9
.
1
2
9
,
8
2

5
1
.
2
3
7
,
3

8
1
.
7
5
4
,
2

3
7
.
2
4
8
,
4
3

1
4
.
3
5
6
,
8
2

%
9
1
.
4
1

%
3
8
.
8
1

%
9
8
.
6

%
6
2
.
4
1

%
7
9
.
3

%
3
9
.
6

%
5
7
.
2

%
1
7
.
3

%
0
2
.
2

%
9
7
.
4

%
4
2
.
2

%
8
8
.
1

%
8
9
.
1
-

%
0
4
.
2

%
9
5
.
0
-

%
4
6
.
2
-

%
7
1
.
3
-

%
6
7
.
1

%
9
7
.
5
-

%
5
5
.
3
-

%
0
8
7
3

.

%
5
8
2
6

.

%
2
3
2
2

.

%
7
0
6
3

.

l
l
a

a
e
r
A

s
e
p
o
l
s

]
2

m

[

.

5
7
2
7
9
5

,

.

0
4
0
9
1

,

3

.

2
4
4
8
5

,

9
4

.

7
2
1
2
4
0
4

,

D
-
3

a
e
r
A

l
e
d
o
m

]
2

m

[

.

8
5
7
6
6
3

,

7
2

.

8
0
6

,

2

4
5

.

2
8
9

,

5
3

.

9
6
6
0
7
9
2

,

–

–

–

–

s
i
s
y
l
a
n
a

a
e
r
a

l
a
b
o
G

l

f
o
o
r

f
o
e
p
y
T

r
o
r
r
e
n
o
i
t
a
i
v
e
d

l
a
b
o
G

l

x
e
l
p
m
o
C

c
i
s
s
a
l
C

l
a
t
o
T

t
a
l
F

x
e
l
p
m
o
C

c
i
s
s
a
l
C

l
a
t
o
T

t
a
l
F

l
e
d
o
m
d
e
c
n
a
h
n
e
n
u
e
h
t
n
o
s
e
u
q
n
h
c
e
t

i

P
I
D
g
n
i
s
u
s
a
e
r
a

f
o
o
r

f
o
s
i
s
y
l
a
n
a

l
a
b
o
G

l

5
A
e
l
b
a
T

M
S
U
D
-
5
.
2
n
d
e
c
n
a
h
n
e
n
u
e
h
t
n
o

l
e
x
i
p
e
g
a
m

i

f
o
n
o
i
t
a
c
ﬁ
i
s
s
a
l
c
e
r

:

i

e
u
q
n
h
c
e
t

P
I
D

a
v
e
n
e
G

f
o
r
e
t
n
e
C
+
N
R
E
C

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

528

C Carneiro, E Morello, T Voegtle and F Golay

°
0
6
>
s
e
p
o
l
s

°
0
6
>
s
e
p
o
l
s

°
5
4
>
s
e
p
o
l
s

°
5
4
>
s
e
p
o
l
s

a
e
r
A

a
e
r
A

a
e
r
A

a
e
r
A

a
e
r
A

a
e
r
A

a
e
r
A

a
e
r
A

a
e
r
A

3
1
d
n
o
m
a
i
d

9
d
n
o
m
a
i
d

3
1
d
n
o
m
a
i
d

9
d
n
o
m
a
i
d

°
0
o
t

t
e
s

°
0
o
t

t
e
s

°
0
o
t

t
e
s

°
0
o
t

t
e
s

°
0
o
t

t
e
s

l
e
d
o
m

e
s

a

g
n
i
s
u

e
s

a

g
n
i
s
u

e
s

a

g
n
i
s
u

e
s

a

g
n
i
s
u

°
5
7
>
s
e
p
o
l
s

°
0
6
>
s
e
p
o
l
s

°
5
4
>
s
e
p
o
l
s

°
0
3
>
s
e
p
o
l
s

°
5
1
>
s
e
p
o
l
s

l
l
a

a
e
r
A

D
-
3

a
e
r
A

]
2

m

[

]
2

m

[

]
2

m

[

]
2

m

[

]
2

m

[

]
2

m

[

]
2

m

[

]
2

m

[

]
2

m

[

]
2

m

[

f
o
o
r

f
o
e
p
y
T

s
e
p
o
l
s

]
2

m

[

%
9
5

.

3

%
0
1
8

.

%
0
6
0

.

%
9
2

.

3

%
6
1

.

4

%
6
8
8

.

%
3
8
0

.

%
7
8

.

3

%
3
0

.

1

%
6
6
4

.

%
3
0
0

.

%
7
6

.

0

%
1
3
.
1

%
3
9
.
4

%
0
1
.
0

%
7
9
.
0

%
6
5
.
7

%
5
9
.
3
1

%
3
2
.
1

%
3
3
.
7

%
8
5
.
2

%
6
7
.
6

%
6
2
.
0

%
7
2
.
2

%
6
1
.
0
-

%
8
6
.
3

%
4
6
.
0
-

%
9
5
.
0
-

%
7
0
.
2
-

%
6
2
.
2

%
0
5
.
1
-

%
5
6
.
2
-

%
9
1
.
3
-

%
4
7
.
1

%
5
9
.
5
-

%
6
5
.
3
-

%
1
7
.
7
1

%
7
5
.
2
2

%
0
0
.
4
1

%
3
4
.
7
1

.

7
7
4
6
9
3

,

.

1
0
4
2
6
2

,

5
5

.

2
9
9
3

,

5
9

.

9
2
6
2

,

8
4

.

8
3
8
,
3

6
0

.

9
0
6
,
2

5
2
.
8
4
8
,
3

9
7
.
0
1
6
,
2

1
2
.
9
7
1
,
4

7
4
.
0
4
6
,
2

5
6
.
5
1
9
,
3

1
0
.
5
1
6
,
2

7
4
.
2
0
8
,
3

9
4
.
1
9
5
,
2

3
4
.
0
5
7
,
3

8
1
.
9
6
5
,
2

3
5
.
1
3
7
,
3

6
0
.
3
5
4
,
2

5
2
.
5
9
4
,
4

6
3
.
3
7
9
,
2

8
5
.
7
6
6

,

3

7
2
.
8
0
6
2

,

7
5

.

3
7
2

,

7
3

.

3
1
0
8
4
7
3

,

.

5
1
4
5
3
,
6
3

5
8
.
2
5
4
,
6
3

5
2
.
4
0
7
,
8
3

9
0
.
1
1
9
,
6
3

7
2
.
6
2
9
,
5
3

9
5
.
8
3
2
,
5
3

7
9
.
4
3
8
,
4
3

9
3
.
3
5
3
,
2
4

4
5
.
2
8
9

,

5
3

c
i
s
s
a
l
C

l
a
t
o
T

t
a
l
F

9
7

.

4
8
6

,

0
3

.

3
6
7
5
8
0
3

,

1
6

.

6
0
9
,
9
2

1
8
.
3
9
9
,
9
2

7
5
.
4
8
8
,
1
3

3
4
.
0
8
3
,
0
3

2
3
.
2
3
5
,
9
2

8
9
.
8
1
9
,
8
2

9
3
.
0
5
6
,
8
2

8
7
.
4
8
8
,
4
3

9
6
.
6
0
7
9
2

,

l

x
e
p
m
o
C

l
e
d
o
m
d
e
c
n
a
h
n
e

e
h
t
n
o
s
e
u
q
n
h
c
e
t

i

P
I
D
g
n
i
s
u
s
a
e
r
a

f
o
o
r

f
o
s
i
s
y
l
a
n
a

l
a
b
o
G

l

6
A
e
l
b
a
T

M
S
U
D
-
5
.
2
n
d
e
c
n
a
h
n
e

e
h
t
n
o

l
e
x
i
p
e
g
a
m

i

f
o
n
o
i
t
a
c
ﬁ
i
s
s
a
l
c
e
r

:

i

e
u
q
n
h
c
e
t

P
I
D

a
v
e
n
e
G

f
o
r
e
t
n
e
C
+
N
R
E
C

s
i
s
y
l
a
n
a

a
e
r
a

l
a
b
o
G

l

r
o
r
r
e
n
o
i
t
a
i
v
e
d

l
a
b
o
G

l

–

–

–

–

l

x
e
p
m
o
C

c
i
s
s
a
l
C

l
a
t
o
T

t
a
l
F

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

529

Table A7 Global analysis of roof areas using the segmentation procedure

CERN + Center of Geneva Segmentation procedure Global area analysis

Type of roof

Total
Flat
Classic
Complex

Area image
segmentation
technique [m2]

35,533.95
3,725.94
2,633.29
29,174.72

Area 3D model
[m2]

Global
deviation error

35,957.52
3,667.58
2,608.27
29,681.67

1.19%
-1.57%
-0.95%
1.74%

Table A8 Building by building analysis of roof areas using DIP techniques on the unen-
hanced model

CERN + Center of Geneva
DIP technique: reclassiﬁcation of image pixel on the unenhanced n2.5-DUSM

Area
slopes
> 15°
set to 0°
[m2]

Area
slopes
> 30°
set to 0°
[m2]

Area
slopes
> 45°
set to 0°
[m2]

Area
slopes
> 60°
set to 0°
[m2]

Area
slopes
> 75°
set to 0°
[m2]

Area all
slopes
[m2]

Type of roof

Building by Building analysis: absolute building deviation error
7.51%
2.27%
5.95%
9.89%
7.80%
0.81%
2.31%
9.46%

Total
Flat
Classic
Complex
Total
Flat
Classic
Complex

38.84%
38.92%
21.76%
45.65%
32.32%
34.26%
24.59%
33.75%

6.12%
2.93%
1.27%
9.13%
7.82%
0.92%
1.82%
9.19%

6.20%
8.30%
2.26%
7.08%
6.38%
5.97%
1.46%
7.27%

6.26%
9.20%
2.92%
6.62%
4.74%
5.51%
1.42%
4.77%

13.16%
17.71%
6.72%
14.22%
9.84%
4.99%
4.89%
11.44%

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

530

C Carneiro, E Morello, T Voegtle and F Golay

s
e
p
o
l
s

a
e
r
A

°
5
7
>

°
0
o
t

]
2

m

[

%
2
3
.
7

%
8
0
.
9

%
9
8
.
2

%
1
6
.
8

%
5
9
.
6

%
8
2
.
7

%
1
3
.
5

%
5
1
.
7

°
0
6
>
s
e
p
o
l
s

°
0
6
>
s
e
p
o
l
s

°
5
4
>
s
e
p
o
l
s

°
5
4
>
s
e
p
o
l
s

a
e
r
A

a
e
r
A

a
e
r
A

a
e
r
A

e
s

a

g
n
i
s
u

e
s

a

g
n
i
s
u

e
s

a

g
n
i
s
u

e
s

a

g
n
i
s
u

t
e
s

a
e
r
A

a
e
r
A

a
e
r
A

a
e
r
A

°
0
6
>
s
e
p
o
l
s

°
5
4
>
s
e
p
o
l
s

°
0
3
>
s
e
p
o
l
s

°
5
1
>
s
e
p
o
l
s

l
l
a

a
e
r
A

3
1
d
n
o
m
a
i
d

9
d
n
o
m
a
i
d

3
1
d
n
o
m
a
i
d

9
d
n
o
m
a
i
d

°
0
o
t

t
e
s

°
0
o
t

t
e
s

°
0
o
t

t
e
s

°
0
o
t

t
e
s

s
e
p
o
l
s

]
2

m

[

]
2

m

[

]
2

m

[

]
2

m

[

]
2

m

[

]
2

m

[

]
2

m

[

]
2

m

[

]
2

m

[

f
o
o
r

f
o
e
p
y
T

%
3
6
.
5

%
7
0
.
6

%
4
2
.
2

%
6
8
.
6

%
2
3
.
4

%
5
2
.
3

%
9
6
.
2

%
8
4
.
4

%
6
8
.
5

%
6
4
.
6

%
6
2
.
2

%
4
1
.
7

%
5
6
.
4

%
2
7
.
3

%
3
9
.
2

%
8
7
.
4

%
0
8
.
4

%
0
0
.
4

%
8
7
.
0

%
6
4
.
6

%
5
6
.
4

%
6
0
.
1

%
5
8
.
0

%
1
3
.
5

%
5
8
.
4

%
6
1
.
4

%
7
9
.
0

%
2
5
.
6

%
5
4
.
4

%
3
2
.
1

%
9
8
.
0

%
5
9
.
4

%
9
4
.
5

%
0
9
.
4

%
5
3
.
1

%
2
2
.
7

%
0
5
.
4

%
8
8
.
2

%
7
1
.
2

%
8
6
.
4

r
o
r
r
e
n
o
i
t
a
i
v
e
d
g
n
d

i

l
i

u
b
e
t
u
o
s
b
a

l

:
s
i
s
y
l
a
n
a

g
n
d

i

l
i

u
B
y
b
g
n
d

i

l
i

u
B

%
4
8
.
4

%
8
9
.
2

%
1
4
.
0

%
0
9
.
6

%
6
9
.
5

%
7
9
.
0

%
7
1
.
0

%
2
0
.
7

%
4
1
6

.

%
3
1

.

2

%
8
7
1

.

%
0
0

.

9

%
7
5
7

.

%
5
6

.

0

%
4
1
2

.

%
6
7

.

8

%
4
4
7

.

%
0
8

.

1

%
8
0
7

.

%
1
7

.

9

%
7
6
7

.

%
0
7

.

0

%
6
1
1

.

%
4
1

.

9

%
0
3
0
2

.

%
7
1

.

4
1

%
0
0
5
1

.

%
9
1
4
2

.

%
3
7
2
2

.

%
4
8

.

3
1

%
4
0
4
2

.

%
3
7
4
2

.

x
e
l
p
m
o
C

c
i
s
s
a
l
C

l
a
t
o
T

t
a
l
F

x
e
l
p
m
o
C

c
i
s
s
a
l
C

l
a
t
o
T

t
a
l
F

n
o
i
t
a
i
v
e
d
d
r
a
d
n
a
t
s

:
s
i
s
y
l
a
n
a

g
n
d

i

l
i

u
B
y
b
g
n
d

i

l
i

u
B

l
e
d
o
m
d
e
c
n
a
h
n
e

e
h
t
n
o
s
e
u
q
n
h
c
e
t

i

P
I
D
g
n
i
s
u
s
a
e
r
a

f
o
o
r

f
o
s
i
s
y
l
a
n
a

g
n
d

i

l
i

u
b
y
b
g
n
d

i

l
i

u
B

9
A
e
l
b
a
T

M
S
U
D
-
5
.
2
n
d
e
c
n
a
h
n
e

e
h
t
n
o

l
e
x
i
p
e
g
a
m

i

f
o
n
o
i
t
a
c
ﬁ
i
s
s
a
l
c
e
r

:

i

e
u
q
n
h
c
e
t

P
I
D

a
v
e
n
e
G

f
o
r
e
t
n
e
C
+
N
R
E
C

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

Digital Urban Morphometrics

531

Table A10 Building by building analysis of roof areas
using the segmentation procedure

CERN + Center of Geneva
Segmentation procedure Building by building analysis

Type of roof

Total
Flat
Classic
Complex

Type of roof

Total
Flat
Classic
Complex

Area [m2]
Absolute building
deviation error

Area [m2]
Standard deviation

3.47%
1.19%
2.79%
4.45%

4.09%
0.59%
3.43%
4.71%

© 2010 Blackwell Publishing Ltd
Transactions in GIS, 2010, 14(4)

