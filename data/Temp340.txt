International Journal of Geographical Information
Science

ISSN: 1365-8816 (Print) 1362-3087 (Online) Journal homepage: http://www.tandfonline.com/loi/tgis20

Multi-level temporal autoregressive modelling of
daily activity satisfaction using GPS-integrated
activity diary data

Guanpeng Dong, Jing Ma, Mei-Po Kwan, Yiming Wang & Yanwei Chai

To cite this article: Guanpeng Dong, Jing Ma, Mei-Po Kwan, Yiming Wang & Yanwei Chai (2018)
Multi-level temporal autoregressive modelling of daily activity satisfaction using GPS-integrated
activity diary data, International Journal of Geographical Information Science, 32:11, 2189-2208,
DOI: 10.1080/13658816.2018.1504219

To link to this article:  https://doi.org/10.1080/13658816.2018.1504219

© 2018 Informa UK Limited, trading as
Taylor & Francis Group

Published online: 03 Sep 2018.

Submit your article to this journal 

Article views: 169

View Crossmark data

Full Terms & Conditions of access and use can be found at
http://www.tandfonline.com/action/journalInformation?journalCode=tgis20

INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE
2018, VOL. 32, NO. 11, 2189–2208
https://doi.org/10.1080/13658816.2018.1504219

RESEARCH ARTICLE

Multi-level temporal autoregressive modelling of daily
activity satisfaction using GPS-integrated activity diary data

Guanpeng Donga, Jing Mab, Mei-Po Kwan c, Yiming Wangd and Yanwei Chaie

aDepartment of Geography and Planning, University of Liverpool, Liverpool, UK; bBeijing Key Laboratory
for Remote Sensing of Environment and Digital Cities, Faculty of Geographical Science, Beijing Normal
University, Beijing, China; cDepartment of Geography & Geographic Information Science, University of
Illinois at Urbana-Champaign, Urbana, USA; dSchool of Policy Studies, University of Bristol, Bristol, UK;
eCollege of Urban and Environmental Sciences, Peking University, Beijing, China

ARTICLE HISTORY
Received 13 February 2018
Accepted 21 July 2018

KEYWORDS
Multi-level modelling;
spatial econometrics; GPS
data; subjective well-being;
semantic trajectories

ABSTRACT
In this research, we match web-based activity diary data with daily
mobility information recorded by GPS trackers for a sample of 709
residents in a 7-day survey in Beijing in 2012 to investigate activity
satisfaction. Given the complications arising from the irregular
time intervals of GPS-integrated diary data and the associated
complex dependency structure, a direct application of standard
(spatial) panel data econometric approaches is inappropriate. This
study develops a multi-level temporal autoregressive modelling
approach to analyse such data, which conceptualises time as
continuous and examines sequential correlations via a time or
space-time weights matrix. Moreover, we manage to simulta-
neously model individual heterogeneity through the inclusion of
individual random eﬀects, which can be treated ﬂexibly either as
independent or dependent. Bayesian Markov chain Monte Carlo
(MCMC) algorithms are developed for model
implementation.
Positive sequential correlations and individual heterogeneity
eﬀects are both found to be statistically signiﬁcant. Geographical
contextual characteristics of sites where activities take place are
signiﬁcantly associated with daily activity satisfaction, controlling
for a range of situational characteristics and individual socio-
demographic attributes. Apart from the conceivable urban plan-
ning and development implications of our study, we demonstrate
a novel statistical methodology for analysing semantic GPS trajec-
tory data in general.

1. Introduction

The study of human mobility has increasingly resorted to high spatio-temporal
resolution data such as GPS trajectories with the fast development of
location
tracking technologies. Exploiting the ﬁne granular representation of individual daily
mobility oﬀered by such data, recent research has involved integrating trajectories
with additional contextual data – information beyond geo-coordinates and time
stamps of movement – to create semantic trajectories (Spaccapietra et al. 2008,
Yan et al. 2013, Kwan et al. 2014).

CONTACT Jing Ma
© 2018 Informa UK Limited, trading as Taylor & Francis Group

jing.ma@bnu.edu.cn

2190

G. DONG ET AL.

A plethora of methods have been proposed for trajectory semantic enrichment
processes, usually depending on application contexts and data availability (Parent
et al. 2013). For instance, Grinberger and Shoval (2015) detailed a process to construct
semantic trajectories by coupling raw GPS traces with residents’ digital activity diaries,
whereby trajectory segments were characterised by activity information. They also
demonstrated the usefulness of such semantic trajectories in producing high-level
knowledge on urban dynamics and spatial structure. Siła-Nowicka et al. (2016) augmen-
ted GPS trajectories with urban point of interest (POI) data to identify residents’ daily
activities and travel modes, and to explore the eﬀects of residential location on daily
travel mode choices. Whilst methodological advances revolve around new techniques of
annotating and segmenting GPS trajectories with external data (Grinberger and Shoval
2015), innovative spatio-temporal visualisation tools (eg Demšar and Virrantaus 2010),
and improved data mining approaches (eg Dodge et al. 2012, Yang and Gidófalvi 2017),
the development of generic statistical models to properly analyse semantic GPS trajec-
tories is rather under-researched. Nonetheless, the importance of statistical models in
discovering and drawing inferences on relationships between human activity and con-
textual factors is beyond doubt.

Treatment of time and scale has been well-recognised as great challenges in the
quantitative analysis of GPS trajectory or movement data (eg Long and Nelson 2013,
Kwan and Neutens 2014, Purves et al. 2014). From the statistical modelling perspective,
trajectory segments – homogeneous sub-trajectories deﬁned by certain criteria such as
activities or travels in residents’ daily mobility (eg Grinberger and Shoval 2015, Siła-
Nowicka et al. 2016) – are irregularly spaced on the time axis with unequal time intervals,
and the number of segments per trajectory usually diﬀer. In contrast, standard panel
data and spatial panel data techniques (eg Elhorst 2014, Hsiao 2014) are developed
based on data with structured, regularly-spaced and discrete time units, and thus it
would be problematic to use them to model sequential or temporal correlations
between trajectory segments. The scale issue refers to the choice of analysis units at
diﬀerent levels of aggregation inﬂuencing data analysis results and statistical inferences
(eg Dungan et al. 2002, Haining 2003). For instance, semantic GPS trajectory data can be
analysed at scales of trajectories and trajectory segments. However, as well-established
in the statistics literature, a separate modelling of data with a multi-level (or multi-scale)
structure could lead to unreliable estimates of the relationships under interest and
incorrect inferences (Raudenbush and Bryk 2002, Goldstein 2011). Therefore, we need
a proper methodology to deal with the multiple-scale nature of trajectory data.

This study extends the statistical analysis tools for investigating semantic trajectories
by proposing a novel Bayesian multi-level temporal autoregressive model that deals
with the issues of time and scale. The methodology simultaneously investigates various
attributes of trajectory segments and trajectories under an extended multi-level model-
ling framework.
In addition, time is conceptualised as continuous in our proposal,
respecting the ﬁne temporal granularity of GPS trajectory data, and more importantly,
enabling a simple way to characterise the sequential correlations between trajectory
segments via a temporal weights matrix (detailed below). A continuous time statistical
modelling approach has been applied to longitudinal data analysis when measures of an
outcome variable are irregularly spaced over time and the number of measurement
varies between subjects or individuals (eg Taylor et al. 1994, Diggle 2002). Linear or

INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

2191

generalised linear mixed models are commonly adopted for such data, in which the
temporal or sequential correlation among measurements or outcomes is speciﬁed
through a structured residual correlation matrix (eg Diggle 2002, Goldstein 2011).
Correlations among residuals of each individual are formulated usually based on tem-
poral distances separating measurements and a time decay function such as an expo-
nential or Gaussian kernel (eg Steele 2008). Advanced stochastic process approaches,
such as an integrated Ornstein-Uhlenbeck process derived from a stochastic diﬀerential
equation, have also been devised to form the temporal correlation structure of model
residuals (Taylor et al. 1994, Diggle et al. 2014, Asar et al. 2016, Hughes et al. 2017).
Despite the ﬂexibility and mathematical rigour oﬀered by these approaches, a key
concern is that the temporal correlation among measurements or outcomes are cap-
tured through model residuals, which makes them inappropriate to explore substantive
interactions among outcomes, ie the impacts of precedent outcomes on the current
one. Such inquiries, however, appeal to social science researchers. The methodology
developed in this study treats temporal correlations among outcomes substantively and
produces estimates on the strength of how precedent outcomes aﬀect the current one.
Moreover, it allows for potential interactions among individuals, which is not modelled
in the above studies. Lastly, space or spatial displacement can also be taken into account
when analysing temporal correlations in our methodology.

The motivation of such methodological development lies in our research interest in
understanding residents’ subjectively experienced well-being associated with their daily
activities. Subjective well-being can be understood as the levels of pleasure individuals
experienced from their daily activities and measured by activity satisfaction
(eg Kahneman et al. 2004, Schwanen and Wang 2014). Characterising urban residents’
satisfaction trajectories associated with daily activities and understanding the role of
geographical contexts where activities are conducted in shaping experiences of activ-
ities has great potential for beneﬁting urban planning and management policies aiming
to improve individuals’ quality of life. We utilise a unique GPS-integrated activity diary
dataset, in which both GPS trajectories of each participant and detailed information on
each activity conducted were recorded for a period of seven days, to provide insight into
the nexus between activity participation, geographical context and well-being. Similar to
the trajectory enrichment process outlined in Grinberger and Shoval
(2015), daily
trajectories of participants were annotated and segmented by using additional activity
diary data. The resulting trajectory segments represent diﬀerent activities, and drawing
on the locational information of trajectory segments, a range of urban form character-
istics of the place or context where activities took place are extracted. To deal with the
scale issue discussed above, the data is analysed simultaneously at two scales or levels:
the individual scale (ie a participant’s whole activity sequences) and the activity scale (or
trajectory segments).

Three types of structural eﬀects are highlighted speciﬁcally for our daily activity
satisfaction study. The ﬁrst relates to the sequential correlations between activities.
The satisfaction level of the current activity might be inﬂuenced by that of the precedent
activities, with the intensity of inﬂuence attenuated by time and space. In other words,
satisfaction or pleasure experienced from an earlier activity might be carried over to
subsequent activities. Second, individual heterogeneity eﬀects on activity satisfaction are
expected due to diﬀerences between individuals in terms of socio-demographic and

2192

G. DONG ET AL.

biological characteristics. Third, there might be interaction eﬀects on activity satisfaction
between family members, as the arrangement of certain activities (eg shopping) is often
implemented by members of a household together. The developed Bayesian multi-level
temporal autoregressive model allows for an examination of these eﬀects simulta-
neously. Bayesian Markov chain Monte Carlo (MCMC) algorithms for implementing the
methodology are developed and the computer codes are made available for potential
users via the Supplementary online Materials of the paper.

The contributions of this paper lie in two aspects. Foremost, we oﬀer a novel
statistical tool to model trajectory data (eg attributes of trajectory segments), taking
into account sequential correlations within a trajectory and heterogeneities between
trajectories simultaneously. It beneﬁts studies that aim to explore and draw statistical
inferences on the inﬂuences of geographical contexts on human mobility behaviours or
outcomes. Second, we contribute to the substantive subjective well-being literature by
examining situational variabilities in daily activity satisfaction and providing insights into
how geographical context aﬀects individuals’ experiences of daily activities. The remain-
der of this paper is organised as follows. Section 2 describes the proposed multi-level
temporal autoregressive model and the estimation strategy.
In Section 3, data and
variables are described. Section 4 reports and interprets model estimation results.
Finally, we conclude with a summary of ﬁndings and discussions on potential limitations
of the paper as well as future development.

2. Methodology

2.1. Modelling sequential correlation and individual heterogeneity

We ﬁrst propose a two-level autoregressive model with independent individual random
eﬀects to capture the sequential correlation and individual heterogeneity eﬀects on daily
activity satisfaction. Denote yki as the reported satisfaction level of k-th activity for indivi-
dual i, and tk as the time when k-th activity takes place. Time is treated as continuous, and
thus it is convenient to characterise temporal decay in the correlations between activities k
and k0 via an exponential function (eg Steele 2008, Browne and Goldstein 2010),

ck;k0 ¼ expð(cid:2)Δtk;k0 =toÞ; Δtk;k0 ¼ tstart

k (cid:2) tend
k0

; k0 ¼ 1; . . . ; k (cid:2) 1:

(1)

where tstart
k0-th activity. to is a temporal threshold parameter, which will be discussed later.

represent the starting time of k-th activity and the ending time of

and tend

k0

k

Equation (1) is employed to form elements of a temporal weights matrix T specifying
how activities are correlated over time, which can be considered as a temporal analogue
of a spatial weights matrix. For individual i, Ti has the following form,

0

B
B
B
B
B
@

0
c2;1
c3;1
.
..
cNi;1

0
0
c3;2
.
..
cNi;2

0
0
0
.
..
. . .

. . .
. . .
. . .
.
. .
cNi;Ni(cid:2)1

1

C
C
C
C
C
A

0
0
0
.
..
0

Ti ¼

(2)

which is a lower-triangular square matrix of order Ni where Ni is the number of activities
conducted by individual i and varies between individuals. In a general setting where the

INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

2193

analysis units are trajectory segments that nest into individual trajectories, Ti measures
the temporal correlation structure among sequential segments. With a row-normalised
Ti and yi ¼ ½y1;i; . . . ; yNi;i(cid:3), the impacts on satisfaction of the current activity from pre-
ceding activities are measured by Tiyi, which can be understood as a continuous time
lag operator similar to the spatial lag operator in spatial econometrics models (Anselin
1988, LeSage and Pace 2009). A further concern rises when the temporal separation
(Δtk;k0) between activities k and k0 also results in a spatial displacement. This is the case
when activities take place in diﬀerent locations, ie people might need to travel some
distances to conduct the next activity. It is not unreasonable to assume that the spatial
distance between two activity sites might attenuate the temporal correlation of the two
activities. To address this issue, the temporal correlation between activities k and k0 is
further weighted by the associated spatial distance. More speciﬁcally, an exponential
decay function is used to calculate inﬂuences of spatial distances on the temporal
correlations of activities: sk;k0 ¼ expð(cid:2)dk;k0=di
is the spatial distance
between activities k and k0 and di
max is the maximum distance among activities con-
ducted by individual i. Thus, the modiﬁed temporal correlation between activities k and
k0 is c(cid:4)
i . Similar approach
has been employed to deal with correlations between observations from diﬀerent
domains such as space, time, and geographical context (eg Huang et al. 2010, Harris
et al. 2013). Denoting Si as the spatial weights matrix based on sk;k0 , we have T(cid:4)
i ¼
Ti (cid:6) Si where (cid:6) represents an element-wise matrix multiplication operation (Searle and
Khuri 2017). For notational simplicity, Ti is used hereafter.

k;k0 ¼ ck;k0 (cid:5) sk;k0, which further forms elements of the updated T(cid:4)

maxÞ where dk;k0

A multi-level temporal autoregressive model with independent individual heteroge-

neity eﬀects is speciﬁed as,

yki ¼ ρTi

kyi þ xkiβ þ ziγ þ ui þ (cid:2)ki;

k ¼ 1; . . . ; ni; i ¼ 1; . . . ; n:

(3)

k is the k-th row of Ti; xki denotes activity-level independent variables
In Equation (3), Ti
such as situational activity characteristics (eg duration and companionship); zi denotes
individual-level covariates. β and γ are two vectors of regression coeﬃcients to estimate.
ρ measures the strength of sequential correlations between activities and is referred to
as a temporal autoregressive parameter for simplicity. Individual heterogeneity is mod-
elled via the term ui, which is assumed to follow a Normal distribution Nð0; σ2
It
(cid:3) Þ.
captures eﬀects on activity satisfaction from unobserved individual characteristics and
levels up (or down) the average satisfaction of individual i for positive (or negative) ui.
The independence assumption on ui might be restrictive and will be relaxed later.

Re-writing Equation (3) in a succinct matrix form gives,

yi ¼ ρTiyi þ xβ þ zγ þ iui þ (cid:2)i;

i ¼ 1; . . . ; n

or

Y ¼ ρTY þ Xβ þ Zγ þ Δu þ (cid:2);

P
n
i¼1 Ni with Ti forming each block; i is a
where T is a block-diagonal matrix of order N ¼
column vector of ones; Δ is a random eﬀect matrix of order N (cid:5) n, linking individual
random eﬀects on activity satisfaction and bridging the two data scales. To illustrate
sequential correlation and individual heterogeneity eﬀects on activity satisfaction

(4)

(5)

2194

G. DONG ET AL.

implied by the model, we consider a hypothetical
individual with four sequential
activities. Rearranging Equation (4) and replacing xβ þ zγ with a linear predictor η (the
sum of eﬀects of observed independent variables) give,

yi ¼ ðI4 (cid:2) ρTiÞ(cid:2)1η

i þ ðI4 (cid:2) ρTiÞ(cid:2)1(cid:4)4ui þ ðI4 (cid:2) ρTiÞ(cid:2)1(cid:2)i:

Specifying Ti as in Equation (2), ðI4 (cid:2) ρTiÞ(cid:2)1 is obtained as,

0

B
B
@

0
0
1
ρc41 þ ρ2ðc31c43 þ c21c42Þ þ ρ3c21c32c43 ρc42 þ ρ2c32c43 ρc43

1
ρc21
ρc31 þ ρ2c21c32

0
1
ρc32

1

C
C
A:

0
0
0
1

(6)

(7)

i1 and η

A few features implied by the model are worth mentioning. First, the satisfaction of the
current activity is linked to the satisfaction levels of the preceding activities via both
linear predictors and individual random eﬀects. The linear predictors of the preceding
activities aﬀect the current activity satisfaction in a way that decreases with increasing
powers of the temporal autoregressive parameter (ρ) and the time (or space and time)
gaps separating them. That said, η
i2 both directly aﬀect yi3 weighted by ρ
i1 also indirectly aﬀects yi3 through its direct impact on yi2 and the
respectively, while η
i2 on yi3 weighted by ρ2. This correlation structure diﬀers from the ﬁrst-
direct impact of η
order autoregressive model of (spatial) panel data where direct impacts of observations
separated by two or more temporal units are assumed to be zero (eg Parent and LeSage
2012, Elhorst 2014, Hsiao 2014). We note that direct impacts between activities sepa-
rated by a large time interval could approach zero, as indicated in Equation (1). Second,
Equation (7) also determines the interpretation of regression coeﬃcients. Consider a
variable xp and its coeﬃcient β
is
ðI4 (cid:2) ρTiÞ(cid:2)1I4β
p. From Equation (7), it is clear that the a one unit increase in xp for each
activity will lead to a diﬀerent total eﬀect (row-wise summing of ðI4 (cid:2) ρTiÞ(cid:2)1β
p). If a
scalar summary on marginal total eﬀects was desirable, one could calculate the average
of observation-wise marginal total eﬀects (LeSage and Pace 2009, Elhorst 2010). The
diagonal entries of the matrix are all equal to β
p, which can be thought of as the
marginal direct eﬀect of a one unit change in xp.

p in Equation (6). The marginal eﬀect of xp on yi

2.2. Modelling the dependency of individual random eﬀects

In the multi-level modelling literature, discussions on the dependency of higher-level
random eﬀects are rather limited (eg Browne and Goldstein 2010, Dong and Harris
2015). An interesting feature of our data is the collection of all adults’ GPS trajectories
and daily activities for a proportion of the families that participated in the study, which
allows for exploring potential interaction or correlation eﬀects between family members.
We treat random eﬀects ui and uj of participants i and j as dependent if they are from a
family, and independent, otherwise. Dependencies in the individual random eﬀects are
speciﬁed via an individual-scale n (cid:5) n connection matrix W (wij ¼ 1 if individuals i and j
are from a family; wij ¼ 0, otherwise). Following the convention of the spatial econo-
metrics literature (Anselin 1988, LeSage and Pace 2009), individual random eﬀects u are
postulated to be an autoregressive model,

INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

2195

u ¼ ϕWu þ (cid:3);

(cid:3),Nð0; Inσ2

(cid:3) Þ:

The parameter ϕ measures the extent to which individual-level random eﬀects are
(cid:3) ðA0AÞ(cid:2)1 where
correlated within a family. The resulting covariance matrix for u is σ2
A ¼ In (cid:2) ϕW. Re-arranging Equation (8) and inserting it into Equation (5) lead to our ﬁnal
model,

Y ¼ ρTY þ Xβ þ Zγ þ ΔðIn (cid:2) ϕWÞ(cid:2)1(cid:3) þ (cid:2):

(8)

(9)

2.3. Model estimation

Bayesian Markov chain Monte Carlo (MCMC) method is employed for model estimation.
Quasi-maximum likelihood estimation (QML) approaches have often been used for
spatial and spatio-temporal econometric models (eg Lee and Yu 2010, Elhorst 2014).
However, the issue of local optima in maximising the concentrated log-likelihood func-
tion might seriously impact model parameter estimation, which could be avoided in the
MCMC approach by directly sampling from posterior distributions of parameters (LeSage
and Pace 2009, Parent and LeSage 2012).

Bayesian MCMC approach is based on the joint posterior distribution of all model
parameters, which is the product of data likelihood, denoted by f ðYj:Þ, and prior
densities for model parameters, denoted by pð:Þ in Equation (10),

pðδ; u; ρ; ϕ; σ2

(cid:3) ; σ2

e YÞ / fðY
j

jδ; u; ρ; ϕ; σ2

(cid:3) ; σ2

eÞpðujϕ; σ2
(cid:3) Þ

pðδÞpðρÞpðϕÞpðσ2

eÞpðσ2
(cid:3) Þ

(10)

where δ ¼ ½β; γ(cid:3) and the formed new model design matrix ~X ¼ ½X; Z(cid:3). The prior distribu-
; σ2
tions for unknown parameters (δ; ρ; ϕ; σ2
(cid:3) ) are assumed to be independent. More
e
speciﬁcally, pðδÞ follows a multivariate Normal distribution with mean M0 and variance
matrix T0, NðM0; T0Þ. Uniform prior distributions are assigned for the two autoregressive
e and σ2
parameters ρ and ϕ over (−1, 1). Inverse gamma (IG) distributions are used for σ2
(cid:3) :
pðσ2
(2014), the density
function of a non-normalised IG with the shape parameter a and scale parameter β
is pðxÞ / x(cid:2)a(cid:2)1expð(cid:2)β=xÞ.

(cid:3) Þ,IGða0; b0Þ. Following Gelman et al.

eÞ,IGðc0; d0Þ and pðσ2

The likelihood function for the two models proposed (Equations (5) and (9)) is

expressed as,

LðYjδ; u; ρ; ϕ; σ2

(cid:3) ; σ2

eÞ ¼ ð2πσ2

n
eÞ(cid:2)N=2exp ð(cid:2)2σ2
eÞ

(cid:2)1

ðBY (cid:2) ~Xδ (cid:2) ΔuÞ0ðBY (cid:2) ~Xδ (cid:2) ΔuÞ

o

;

(11)

where B ¼ IN (cid:2) ρT. We note that the determinant of B is equal to one because it is a
lower-triangular matrix with diagonal entries of ones. Based on the likelihood function
and prior distributions, we can derive the posterior distribution for each model para-
meter. The posterior distribution for regression coeﬃcients pðδjY; u; ρ; ϕ; σ2
eÞ is also a
multivariate Normal distribution, NðMδ; (cid:2)δÞ with

(cid:3) ; σ2

2196

G. DONG ET AL.

(13)

(14)

(15)

Mδ ¼ (cid:2)δ½ðσ2

eÞ(cid:2)1~X0ðBY (cid:2) ΔuÞ þ T (cid:2)1

0 M0(cid:3); (cid:2)δ ¼ ½ðσ2

eÞ(cid:2)1~X0~X þ T (cid:2)1

0 (cid:3)(cid:2)1:

(12)

The posterior distribution for individual random eﬀects u is a multivariate Normal
distribution, NðMu; (cid:2)uÞ with

Mu ¼ (cid:2)u½ðσ2

eÞ(cid:2)1Δ0ðBY (cid:2) ~XδÞ(cid:3); (cid:2)u ¼ ½ðσ2
(cid:3) and σ2

The posterior distributions for σ2

e are IGða(cid:3); b(cid:3)Þ and IGðce; deÞ where

eÞ(cid:2)1Δ0Δ þ ðσ2

(cid:3) Þ(cid:2)1A0A(cid:3)(cid:2)1:

a(cid:3) ¼ n=2 þ a0;

b(cid:3) ¼ u0A0Au=2 þ b0

and

ce ¼ N=2 þ c0;

de ¼ ðBY (cid:2) ~Xδ (cid:2) ΔuÞ0ðBY (cid:2) ~Xδ (cid:2) ΔuÞ=2 þ d0:

The posterior distribution for the temporal autoregressive parameter (ρ) is a Normal
distribution, NðMρ; σ2

ρÞ with

Mρ ¼ ðY0T0TYÞ(cid:2)1ðY (cid:2) ~Xδ (cid:2) ΔuÞ0ðY (cid:2) ~Xδ (cid:2) ΔuÞ;

ρ ¼ ðY0T0TYÞ(cid:2)1σ2
σ2
e

:

(16)

Unlike parameters ðδ; u; σ2
; ρÞ, the conditional posterior distribution of ϕ is not a
standard density function, thus Gibbs samplers cannot be directly applied Gelman et al.
(2014). The posterior conditional distribution of ϕ is expressed as,

(cid:3) ; σ2
e

pðϕjY; δ; u; ρ; σ2

(cid:3) ; σ2

eÞ / In (cid:2) ϕW
j

n
jexp (cid:2)ð2σ2
(cid:3) Þ

o

(cid:2)1

u0A0Au

:

(17)

The Metropolis-Hastings (M-H) sampling method could be selected for updating ϕ.
However, the M-H algorithm might not be eﬃcient as it requires a large number of
MCMC iterations and a careful choice of
tuning parameters, especially in the
instead, use an inversion sampling algorithm to
presence of large data sets. We,
update ϕ. The same approach has been widely used in Bayesian spatial econo-
metric models (eg LeSage and Pace 2009, Dong and Harris 2015, Dong et al. 2016).
In short, there are two steps involved in this sampling approach. In the ﬁrst step,
the log-posterior density function of ϕ,
is empirically evaluated using
(cid:3) ÞðkÞÞ in the k-th MCMC iteration. logf ðϕÞ
eÞðkÞ; ðσ2
updated values of ðδðkÞ; uðkÞ; ρðkÞ; ðσ2
is expressed as,

logf ðϕÞ,

logf ðϕÞ ¼ log In (cid:2) ϕW

j

j þ

ðu0ðkÞuðkÞ (cid:2) 2ϕu0ðkÞWuðkÞ þ ϕ2u0ðkÞW0WuðkÞÞ=2ðσ2

(cid:3) ÞðkÞ þ C:

(18)

where C is a constant. In the second step, we numerically integrate logf ðϕÞ on ϕ over
the range of (−1, 1), calculate the empirical cumulative distribution, and update ϕðkÞ.
Note, the updating of ϕ is not needed for the ﬁrst type of multilevel temporal auto-
regressive model with independent individual random eﬀects.

The above MCMC samplers are coded by using the R language and available in the
Supplementary online Materials of the paper. Two computational aspects are worth
mentioning. First, as ðIN (cid:2) ρTÞ and ðIn (cid:2) ϕWÞ are sparse matrices with majority entries
of zero, the use of sparse matrix operation routines oﬀered in the R Matrix package
(Bates and Maechler, 2017) greatly reduces computational cost. Second, pre-calculating

INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

2197

the log-determinant of ðIn (cid:2) ϕWÞ for ϕ over the feasible range of (−1, 1) before starting
the MCMC iterations is also important for saving computing time.

3. Data and variables

Our main data sources consist of daily GPS trajectories and activity diaries of urban
residents living or working in the Shangdi-Qinghe area (Jiedao) of Beijing. As shown in
Figure 1, the study area is located adjacent to the ﬁfth ring road of Beijing in the north,
about 16 km away from the city centre. Using a stratiﬁed random sampling approach,
709 respondents living or working in 23 neighbourhoods located in the study area were
selected to participate in a seven-day survey from October to December in 2012 via
eight waves (Ta et al. 2016). GPS tracking devices with a positional accuracy of about
15 m were used to record participants’ movement every 30 s for seven consecutive days.
An interactive survey website consisting of two main components was developed: an
activity diary component to collect detailed information on participants’ daily activities,
and a questionnaire to collect socio-demographic and economic characteristics of
participants.

In this study, we work with complete daily trajectories, which is deﬁned by using
the criterion that the time gaps between any two sequential location records are all
less than or equal to 10 min unless a participant is at home (information available
from the diary data). Missing locations in a time period less than 10 min are assumed
to be equally spaced between the start and end points of that period for simplicity.
Based on a spatial threshold of 50 m and a temporal threshold of 10 min (time to
conduct a meaningful activity), each participant’s daily movement trajectory was
characterised as a sequence of consecutive stop and movement episodes, similar to
the concept of syntactic trajectories in Grinberger and Shoval (2015). These trajectory
episodes were then displayed on the website when a participant was ﬁlling in the
activity diary at the end of each day to reduce recall bias (Kahneman et al. 2004).
Both trajectory and activity diary data were passed on to a server and stored. As a
quality control measure, we checked the completeness of the ﬁlled activity diary of

Figure 1. The study area and key road networks in Beijing.

2198

G. DONG ET AL.

each participant on the following day, and if an activity diary was incomplete, a text
message would be sent to notify the participant of the issue. The stop episodes of
trajectories were then matched with the reported activities and annotated with the
attributes of matched activities and the socio-demographics of the corresponding
participant. A match is achieved if the discrepancies in the start and end times
between a stop episode and a reported activity period are both less than ﬁve
minutes. In some cases when more than one activities are conducted in the same
place (eg most often at home), a stop episode is further divided into a few episodes
based on reported activity periods and annotated accordingly. Only matched activity
episodes with complete information on key socio-demographic variables are included
in the analysis. We further exclude respondents who are full-time students or unem-
ployed as their daily activity arrangement could diﬀer substantively from that of other
groups of people (Shen et al. 2013). The ﬁnal data includes 19,358 activities con-
ducted by 494 participants in two to seven consecutive days (with a mode of ﬁve
days). About 36% of the participants are dual earners of a family.

Our dependent variable is activity satisfaction, which is measured on a ﬁve-point
Likert scale from being very dissatisﬁed (1) to being very satisﬁed (5). The mean activity
satisfaction level is 3.77 with a standard deviation of 1.09 in our data (Table 1). The
independent variables are broadly divided into several categories: situational activity
characteristics, geographical context or activity space attributes, and individual-level
socio-demographics. Although the impacts on general
life satisfaction of individual
socio-demographics have been extensively discussed (eg Diener et al. 1999, Kahneman
et al. 2004, Ma et al. 2017), few studies have examined the potential link between activity
satisfaction and characteristics of real-time geographical contexts where activities take
place (Schwanen and Wang 2014).

To address this gap in the subjective well-being literature, the focus of our empirical
investigation is on extending understandings of how situational urban environment,
measured by ﬁne spatial resolution urban form characteristics, aﬀects activity satisfac-
tion. More speciﬁcally, urban form was measured in three dimensions: land-use mix,
density, and dominant function (Cervero and Kockelman 1997). These land-use charac-
teristics were measured at the land parcel scale (an average size of about 0.03), which is
the ﬁnest resolution land-use data publicly available in Beijing. Geographical extents of
land parcels were delineated based on road networks by Beijing Institute of City
Planning. Land-use mix and function are extracted based on points of interest (POI)
data. In short, the function of a land parcel is inferred based on the dominant POI
category in that parcel while land-use mix represents the diversity of POI categories,
calculated by an entropy measure. Density is measured by the total ﬂoor areas in each
land parcel. We refer to Liu and Long (2016) for a detailed description of the develop-
ment of land-use characteristic variables. A standard GIS overlay operation was applied
to the annotated trajectory episodes data and the spatial polygon land-use data to
extract real-time urban environment characteristics of residents’ daily activities. Based on
the upper and lower quantiles of land-use density and mix variables, a set of binary
variables were generated to represent high, medium and low levels of density and mix.
This is useful to explore potential non-linear land-use density and mix impacts on
activity satisfaction, and to alleviate potential correlations between the two variables if
treated as continuous. Our activity-scale measurement of urban environment takes into

INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

2199

Table 1. Variable description and summary statistics.

Activity situational characteristics

Activity satisfaction scores

Description

Mean or
proportions

3.77 (1.09)

Variable names
Dependent variable
Satisfaction

Activity type
Maintenance
Working
Social and leisure
Others
Duration
Companion
Travel time

Travel mode
Walking or cycling
Car
Public transport
Other modes

Density
High
Medium
Low
Land-use mix
High
Medium
Low
Urban function
Green space
Residential
Commercial
Other functions

Activity space characteristics

Maintenance activity
Working or subsistence activity
Social and leisure activities
Other activities
Log of the lasting time of current activity (minutes)
An activity conducted with companions
Log of travel time from the preceding activity to the current

62.8%
5.15%
17.5%
14.6%
148.1 (153.2)
53.3%
43.9 (42.2)

activity (minutes)
Travel mode choices
Travel by walking or cycling
Travel by private car or taxi
Travel by bus or subway
Other travel modes used as baseline category

Total ﬂoor areas in each land parcel
High land-use density
Baseline category
Low land-use density
The extent of land-use mix in each land parcel
High land-use mix
Baseline category
Low land-use mix
Dominating urban function of each land parcel
Green space function
Residential function
Commercial function
Other urban functions used as baseline category

< 2,000
2,000–3,999
4,000–5,999
6,000–9,999
10,000 +
Without local household registration
Household with child or children under six years old

29.1%
29.7%
31.3%
9.9%

21.8%

34.3%

21.8%

34.4%

9.0%
29.4%
4.8%

10.9%
42.9%
24.3%
15.8%
6.1%
32.6%
12.3%

Individual-scale socio-demographic variables

Age
Monthly income (RMBa)

Age of the participant

33.6(8.22)

Migrants
Child presence
aRMB = renminbi, oﬃcial Chinese currency.

account participants’ daily mobility and thus tackling the uncertain geographic context
problem (Kwan 2012) in the estimates of geographical contextual eﬀects on subjective
well-being.

The second set of independent variables is about activity situational characteristics
such as type, duration and companionship. Respondents’ daily activities were originally
coded into 19 speciﬁc categories in the web diary. To achieve a concise model speciﬁca-
tion, daily activities are divided into four broad categories: working or subsistence,
maintenance, social and leisure, and others (eg Krizek 2003), as shown in Table 1. For
instance, maintenance activities include sleeping, preparing food, eating, grocery shop-
ping, and family obligation activities such as child care and shopping; social and leisure
activities include socialising, social networking, exercising, while others include posting,
banking, hospital visits and so on. Activity duration is the time that an activity lasts,

2200

G. DONG ET AL.

which is treated as a continuous variable and diﬀers greatly between activities (Table 1).
Activity companionship is deﬁned as a binary variable – whether an activity is conducted
alone or with companions. To explore potential travel impacts on activity satisfaction,
travel time from a preceding activity to the current activity and mode choices for the
journey are included in the model.

The ﬁnal set of independent variables are key individual socio-demographics. The
linear and quadratic terms of age are included in the model to capture possible non-
linear age impacts on activity satisfaction. Income was added to the model via a series of
dummy variables (Table 1). Migrants (residents without Beijing hukou status) have been
shown to be associated with lower global life satisfaction than local residents of Beijing
(Dong et al. 2016, Ma et al. 2017). It is interesting to test whether migrants also tend to
report lower satisfaction with daily activities. Family structure, represented by the
variable child presence, was also incorporated in our model following previous studies
(eg Ma et al. 2018). Descriptive statistics of each variable included in our analysis are
provided in Table 1. The dependent variable was transformed to a standard Normal
distribution while the independent variables including activity duration and travel time
were log-transformed.

4. Model estimation results

As discussed above, the time threshold (or bandwidth) parameter to is required when
forming the temporal weights matrix Ti or the spatially adjusted weights matrix T(cid:4)
(a
i
space-time weights matrix for simplicity). Usually it was speciﬁed a priori or, in few cases,
estimated along with other model parameters. Appealing as it sounds to calibrate to
from data, issues exist including additional computational cost and, more critically, great
diﬃculties in distinguishing the estimation of to and the temporal autoregressive para-
meter ρ (eg Banerjee et al. 2014). The study adopts an alternative approach: selecting
the value of to that yields the best model ﬁt from a ﬁnite set of possible values. Deviance
information criterion (DIC, Spiegelhalter et al. 2002), the common model ﬁt index in
Bayesian inference that penalises model complexity, was used for model comparison
and selection of to. Smaller values of DIC indicate better model ﬁts.

Twelve discrete values of to over a range of ½0:5; 6(cid:3) were selected. Four models,
treating individual random eﬀects either as independent or dependent and with a
time weights matrix Ti or a space-time weights matrix T(cid:4)
i , were estimated using the
above MCMC samplers for each value of to. Statistical inferences were based on two
MCMC chains, each of which consisted of 10,000 iterations with a burn-in period of
inspection of trace plots of
5,000. Convergence of samplers was checked by visual
parameters and the Brooks-Gelman-Rubin scale reduction statistics (Brooks and
Gelman 1998). The relationship between DIC and to is illustrated in Figure 2. A clear
result is the superior model ﬁt oﬀered by the model treating individual random eﬀects
as dependent (ie family interaction or correlation eﬀects considered) and with a space-
time weights matrix. For this preferred model speciﬁcation, the optimal to is 2.5 h. It is
also noticeable that optimal values of to are slightly diﬀerent between model speciﬁca-
tions. Moreover, it appears that models with a space-time weights matrix perform better
than do models with a pure time weights matrix. This highlights the importance of

INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

2201

Figure 2. Exploring the optimal time threshold parameter to.

taking into account both temporal and spatial distances between daily activities when
exploring residents’ subjective experiences of activities.

Regression coeﬃcient estimates and the associated 95% credible intervals from the
multi-level temporal autoregressive models with dependent individual random eﬀects
and a space-time weights matrix are reported in Table 2. As a comparison, estimation
results from a multi-level temporal autoregressive models with a time weights matrix are
also reported. Before proceeding to interpreting covariate eﬀects on activity satisfaction,
we discuss the estimates on structural model parameters. First, positive sequential or
temporal correlations between activity satisfactions were found, indicated by the statis-
tical signiﬁcance of the temporal autoregressive parameter ρ in both models. Putting the
magnitude of temporal autocorrelation in perspective, for two activities separated by
one hour, about 10.4% (0:256 (cid:5) exp (cid:2)1=2:5
g) of the satisfaction level of
an activity would be carried over to the following activity, on average. Second, family
correlation eﬀects on activity satisfaction were identiﬁed, as indicated by the statistical
signiﬁcance of the autoregressive parameter ϕ at the 95% credible interval. A plausible
explanation of the within-family correlations of daily activity satisfactions is the interact-
ing decision process between family members in terms of daily activity arrangement.
Third, σ2
(cid:3) is related to the magnitude of unobservable individual heterogeneity eﬀect on
activity satisfaction.
In a standard multi-level model, the importance of individual
heterogeneity eﬀects can be quantiﬁed by the variance partitioning coeﬃcient
(σ2
eÞ, Goldstein 2011). This is not valid any more in our models with sequential
correlations and dependent individual random eﬀects, a similar issue found in the multi-
level spatial econometric models (Dong and Harris 2015, Dong et al. 2015, Ma et al.
2017). To approximate the variance partitioning coeﬃcient, we calculated marginal

g (cid:5) exp (cid:2)0:5
f

(cid:3) þ σ2

(cid:3) =ðσ2

f

Model with space-time weights

Model with time weights

Estimates

2.5%

Estimates

Median

2.5%

2202

G. DONG ET AL.

Table 2. Model estimation results.

Activity situational characteristics

Variables

Maintenance
Social and leisure
Others
Duration
Duration squared
Companion
Travel time
Travel mode
Walking or cycling
Car
Public transport

Land-use density
High
Low
Land-use mix
High
Low
Urban function
Green space
Residential
Commercial

Activity space characteristics

Median

0.128*
0.151*
0.151*
0.022
−0.056*
0.057*
−0.005*

0.02
0.006
0.032

−0.021
0.005

0.029
−0.038*

0.141*
0.075*
−0.04

−0.13*
−0.082

0.095
0.118
0.111
−0.016
−0.098
0.04
−0.01

−0.015
−0.033
−0.009

−0.062
−0.033

−0.013
−0.07

0.083
0.036
−0.105

−0.214
−0.26

97.5%

0.161
0.184
0.19
0.058
−0.018
0.075
−0.001

0.054
0.045
0.074

0.02
0.043

0.071
−0.005

0.198
0.115
0.024

−0.032
0.103

0.129*
0.152*
0.152*
0.023
−0.058*
0.057*
−0.005*

0.021
0.006
0.032

−0.021
0.005

0.03
−0.038*

0.142*
0.075*
−0.041

−0.132*
−0.071

Individual-scale socio-demographic variable

Age
Age squared
Monthly income (RMB)

< 2,000
2,000–3,999
6,000–9,999
10,000 +
Migrants
Child presence
ρ
ϕ
σ2
e
σ2
(cid:3)
DIC
N
Note: The symbol * indicates statistical signiﬁcance at the 95% credible interval. .

−0.049
0.022
0.005
0.033
−0.121*
−0.036
0.256*
0.385*
0.175
0.119
15,250
19,358

−0.157
−0.051
−0.088
−0.125
−0.198
−0.142
0.237
0.29
0.171
0.103

0.067
0.109
0.105
0.189
−0.04
0.057
0.276
0.475
0.179
0.138

−0.047
0.029
0.01
0.028
−0.12*
−0.041
0.253*
0.382*
0.175
0.121
15,265
19,358

97.5%

0.164
0.187
0.192
0.06
−0.019
0.074
−0.001

0.054
0.045
0.073

0.019
0.043

0.071
−0.005

0.197
0.115
0.027

−0.039
0.112

0.064
0.111
0.121
0.192
−0.037
0.067
0.273
0.47
0.179
0.14

0.096
0.119
0.113
−0.014
−0.097
0.039
−0.01

−0.014
−0.034
−0.009

−0.06
−0.032

−0.012
−0.071

0.085
0.035
−0.104

−0.218
−0.244

−0.174
−0.061
−0.099
−0.132
−0.194
−0.157
0.233
0.286
0.171
0.104

variances of the posterior residuals at the activity and individual scales. This yields an
estimate on the variance partitioning coeﬃcient of 0.44, indicating that about 44% of
unexplained variances of activity satisfaction is due to unobservable individual hetero-
geneity eﬀects. Overall, estimates on model structure parameters demonstrate complex
dependencies in residents’ daily activity satisfaction, arising from both sequential corre-
lations and individual heterogeneity eﬀects.

Turning to the estimates on regression coeﬃcients, we note that they represent the
direct eﬀects of independent variables on activity satisfaction. If a scalar summary of the
total marginal eﬀect of a variable Xk was desired, one could calculate the average of
row-sums of the matrix ðIN (cid:2) ρTÞ(cid:2)1INδk by plugging in respective parameter estimates.
Table 2 shows that most situational activity characteristics and geographical contextual
variables are statistically signiﬁcantly associated with activity satisfaction. In terms of

INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

2203

activity type, working is the least enjoyable activity comparing to other three activity
types, ceteris paribus, which corroborates previous ﬁndings (Kahneman et al. 2004).
Activity duration appears to be associated with satisfaction in a non-linear way as the
coeﬃcient of the quadratic duration term is statistically signiﬁcant at the 5% signiﬁcance
level. Activity companionship makes a diﬀerence on satisfaction – activities conducted
with companions tend to be more enjoyable than those conducted alone, holding other
variables constant.

In terms of geographical contextual or activity space characteristics, land-use mix
and urban function are statistically signiﬁcantly associated with activity satisfaction.
More speciﬁcally, conducting daily activities in places with low land-use mix tends to
lower activity satisfaction, ceteris paribus. The diﬀerence in experiences of activities
conducted in places with high or medium levels of land-use mix is, however, insig-
niﬁcant controlling for other variables. Urban functions of places where residents
arrange activities also matter. Activities taking place in green space or residential
areas are associated with higher levels of satisfaction comparing to those conducted
in places with other urban functions, everything else being equal. Overall, these
results suggest that characteristics of geographical contexts where activities take
place are associated with residents’ subjective well-being of activities. This is in
contrast with the ﬁndings in Schwanen and Wang (2014) that show no statistically
signiﬁcant relationships between activity space characteristics and satisfaction. A
plausible explanation is that the relatively coarse-scale measurement of activity
space attributes in Schwanen and Wang (2014) might not be able to characterise
sites of activities accurately. In addition, the temporal autocorrelation in subjective
well-being and individual heterogeneity eﬀects are not properly captured in their
model. Longer time spent on travel to conduct an activity is associated with lower
activity satisfaction, holding other variables constant. However, travel mode choices
Implications on urban
do not appear to be correlated with activity satisfaction.
planning would involve the promotion of mixed land uses to reduce travelling eﬀorts
in residents’ daily lives.

With respect to individual-scale variables, the linear term of age is statistically
associated with activity satisfaction while the quadratic term is not. This, to some
extent, departs from previous ﬁndings that age tends to be correlated with global
life satisfaction non-linearly (eg Diener et al. 1999, Ma et al. 2017). The association
between income and activity satisfaction was not statistically signiﬁcant after con-
trolling for the activity-level covariate eﬀects on satisfaction. The lack of associations
between the two key individual socio-demographic variables and daily activity satis-
faction corroborates the argument that momentary satisfaction or aﬀection relies
more on situational circumstances and individual biological characteristics (part of
the unobservable individual-scale eﬀects) than life circumstance variables (Kahneman
and Deaton 2010). Migrants, residents living in the city but without Beijing house-
hold registration (hukou), tend to report lower daily activity satisfaction than local
residents. This might reﬂect the relatively limited space-time accessibility to quality
opportunities for migrants due to them being subject to institutional constraints on
access to aﬀordable housing and social welfare systems such as education (eg Kwan
1999, Ma et al. 2017).

2204

G. DONG ET AL.

5. Conclusions

GPS trajectory or movement data have been increasingly explored to understand human
mobility at ﬁne spatio-temporal granularity. Integrating trajectory data with external
data sources such as urban built environment and activity diaries to form semantic
trajectories has been demonstrated to be of great value to promote knowledge on
human activity and environment interactions (Grinberger and Shoval 2015, Siła-Nowicka
et al. 2016). Nonetheless, dealing with the issues of time and scale for (semantic) GPS
trajectory or movement data in a uniﬁed statistical model poses great challenges. This
paper has proposed a novel multi-level temporal autoregressive model that deals with
the two issues. In the model, time was conceptualised as continuous, allowing for a
simple and intuitive way (ie a temporal weights matrix) to model sequential or temporal
correlations between trajectory segments (daily activities in this study). Space is also
introduced into the model, adjusting the temporal weights matrix on the basis of spatial
distances between locations of activities. The scale issue is tackled by a simultaneous
analysis of GPS trajectory data at diﬀerent scales via a multi-level modelling approach.
The developed methodology is demonstrated by an empirical examination of residents’
daily activity satisfaction in Beijing, with a particular focus on how geographical contexts
aﬀect experiences of daily activities. Daily GPS trajectories of residents are annotated by
using reported diary data, enabling rich characteristics to be extracted for trajectory
episodes (activities in the study) and insights into relationships between activity satisfac-
tion and situational urban environment at ﬁne spatial resolution to be generated. A few key
ﬁndings and the associated implications are worth highlighting. First, signiﬁcant temporal
or sequential correlations in daily activity satisfaction are found in models with a time or
space-time weights matrix. It implies that treating activities or trajectory segments as
independent in statistical models will be inappropriate. Individual heterogeneity eﬀects
account for a relatively large proportion of the variability in residents’ daily activity
satisfaction, signifying the importance of individual heterogeneity in subjective well-
being studies. Second, geographical contextual characteristics of sites where activities
take place make a diﬀerence in experiences of activities – activities conducted in places
with the higher land-use mix, lower density, and in green space tend to be associated with
higher satisfaction levels. This, however, does not indicates that causal geographical
contextual eﬀects on activity satisfaction can be drawn due to the possible selection eﬀect,
ie people might intentionally choose sites with desirable characteristics for certain activities
to pursue high levels of satisfaction. A pursuit of causal geographical contextual eﬀect
identiﬁcation would require a simultaneous modelling of residents’ activity site choices and
activity satisfaction (eg Steele 2008, Goldstein 2011), which is left for future research. Third,
activity situational characteristics including types, duration and companionship are statis-
tically signiﬁcantly associated with satisfaction levels. Lastly, most of individual life circum-
stance variables are not signiﬁcant correlates of daily activity satisfaction, with the
exception of the migrant status.

Despite illustrated by examining residents’ activity satisfaction, the developed multi-
level temporal autoregressive model is suitable to explore other characteristics of activities
or trajectory segments. It also supplements the spatio-temporal statistics or econometrics
literature (eg Elhorst 2014) by oﬀering a useful tool to deal with data with irregular time
intervals. Nevertheless, there are some limitations associated with the methodology. The

INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

2205

ﬁrst concerns the assumption that the temporal autoregressive parameter (ρ) is equal
among individuals. This equal constraint is made for practical computational concerns, but
it might be violated as it is possible that the strength of sequential correlations in daily
activity satisfaction varies between individuals with distinct characteristics such as person-
alities. The second limitation regards the treatment of activity satisfaction as a continuous
outcome variable. Activity satisfaction is, however, measured on a Likert scale, thus being
an ordinal variable in nature (eg Dong et al. 2018). Ideally, it would be modelled as an
ordinal response variable. These two extensions to the developed methodology are our
next step of research. Thirdly, socio-demographic characteristics of activity space were not
directly captured in our empirical satisfaction models due to the lack of data at ﬁne-
resolution spatial scale in the study area. However, as suggested in the spatial econo-
metrics literature (LeSage and Pace 2009), the inclusion of a lagged dependent variable in
our equation might capture the eﬀect of these variables. Lastly, the formalisation of spatio-
temporal relationships is based on distances between activities, but it would be extended
to also consider movement speed in our future development such that the potential eﬀect
of travel congestion can be captured.

Acknowledgments

The authors are much grateful for the comments of the reviewers and the editor, which have
greatly improved the content of the article. We also thanks Dr Xingjian Liu and Dr Ying Long for
their great eﬀorts of making the ﬁne-resolution land use data in Beijing publicly available.

Disclosure statement

No potential conﬂict of interest was reported by the authors.

This work was supported by the National Natural Science Foundation of China under Grants
No.41601148 and No.41529101; Economic and Social Research Council [ES/P009301/1].

Funding

Notes on contributors

Guanpeng Dong is a lecturer in Geographic Data Science at the Department of Geography and
Planning, University of Liverpool. His core research interests include spatial/spatiotemporal statis-
tics and multi-level modeling methodological development and the application in urban studies.
E-mail: guanpeng.dong@liverpool.ac.uk.

Jing Ma is an associate professor of Human Geography in Faculty of Geographical Science, Beijing
Normal University. Her main research interests include activity-travel behaviour, subjective well-
being, environmental justice and health. E-mail: jing.ma@bnu.edu.cn or majingbnu@163.com.

Mei-Po Kwan is a professor at the Department of Geography and Geographic Information Science,
University of Illinois at Urbana-Champaign. Her research addresses health, transport, environmen-
tal, and social issues through the application of innovative geographic information system (GIS)
methods.

2206

G. DONG ET AL.

Yiming Wang is a senior lecturer at the School for Policy Studies, University of Bristol. His research
involves analysing economic and social policies through the application of both quantitative and
qualitative methods.

Yanwei Chai is a professor at the College of Urban and Environmental Sciences, Peking University.
His research interests include behavioural geography and time geography.

Mei-Po Kwan

http://orcid.org/0000-0001-8602-9258

ORCID

References

Publishers.

Anselin, L., 1988. Spatial econometrics: methods and models. Dorddrecht: Kluwer Academic

Asar, Ö., et al. 2016. Short-term and long-term eﬀects of acute kidney injury in chronic kidney
disease patients: A longitudinal analysis. Biometrical Journal, 58 (6), 1552–1566. doi:10.1002/
bimj.201500156

Banerjee, S., Carlin, B.P., and Gelfand, A.E., 2014. Hierarchical modeling and analysis for spatial data.

Boca Raton: CRC Press.

Bates, D. and Maechler, M., 2017. Matrix: sparse and dense matrix classes and methods. R package

version 1.2-12. Available from: http://cran. r-project. org/package=Matrix

Brooks, S.P. and Gelman, A., 1998. General methods for monitoring convergence of iterative

simulations. Journal of Computational and Graphical Statistics, 7 (4), 434–455.

Browne, W. and Goldstein, H., 2010. Mcmc sampling for a multilevel model with nonindependent
residuals within and between cluster units. Journal of Educational and Behavioral Statistics, 35
(4), 453–473. doi:10.3102/1076998609359788

Cervero, R. and Kockelman, K., 1997. Travel demand and the 3ds: density, diversity, and design.
Transportation Research Part D: Transport and Environment, 2 (3), 199–219. doi:10.1016/S1361-
9209(97)00009-6

Demšar, U. and Virrantaus, K., 2010. Space–time density of trajectories: exploring spatio-temporal
patterns in movement data. International Journal of Geographical Information Science, 24 (10),
1527–1542. doi:10.1080/13658816.2010.511223

Diener, E., et al., 1999. Subjective well-being: three decades of progress. Psychological Bulletin, 125

(2), 276. doi:10.1037/0033-2909.125.2.276

Diggle, P., 2002. Analysis of longitudinal data. Oxford: Oxford University Press.
Diggle, P.J., Sousa, I., and Asar, Ö., 2014. Real-time monitoring of progression towards renal failure

in primary care patients. Biostatistics, 16 (3), 522–536. doi:10.1093/biostatistics/kxu053

Dodge, S., Laube, P., and Weibel, R., 2012. Movement similarity assessment using symbolic
representation of trajectories. International Journal of Geographical Information Science, 26 (9),
1563–1588. doi:10.1080/13658816.2011.630003

Dong, G. and Harris, R., 2015. Spatial autoregressive models for geographically hierarchical data

structures. Geographical Analysis, 47 (2), 173–191. doi:10.1111/gean.2015.47.issue-2

Dong, G., et al., 2015. Multilevel modelling with spatial interaction eﬀects with application to an
emerging land market in beijing, china. PloS One, 10 (6), e0130761. doi:10.1371/journal.
pone.0130761

Dong, G., et al., 2016. Spatial random slope multilevel modeling using multivariate conditional
autoregressive models: A case study of subjective travel satisfaction in beijing. Annals of the
American Association of Geographers, 106 (1), 19–35. doi:10.1080/00045608.2015.1094388

Dong, G., Nakaya, T., and Brunsdon, C., 2018. Geographically weighted regression models for ordinal
categorical response variables: an application to geo-referenced life satisfaction data. Computers,
Environment and Urban Systems, 70, 35–42. doi:10.1016/j.compenvurbsys.2018.01.012

INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

2207

Dungan, J.L., et al., 2002. A balanced view of scale in spatial statistical analysis. Ecography, 25 (5),

626–640. doi:10.1034/j.1600-0587.2002.250510.x

Elhorst, J.P., 2010. Applied spatial econometrics: raising the bar. Spatial Economic Analysis, 5 (1), 9–

28. doi:10.1080/17421770903541772

Elhorst, J.P., 2014. Spatial econometrics: from cross-sectional data to spatial panels. Heidelberg:

Gelman, A., et al., 2014. Bayesian data analysis. FL: CRC press Boca Raton.
Goldstein, H., 2011. Multilevel statistical models. Chichester: John Wiley & Sons.
Grinberger, A.Y. and Shoval, N., 2015. A temporal-contextual analysis of urban dynamics using
location-based data. International Journal of Geographical Information Science, 29 (11), 1969–
1987. doi:10.1080/13658816.2015.1049951

Haining, R.P., 2003. Spatial data analysis: theory and practice. Cambridge: Cambridge University

Springer.

Press.

Harris, R., Dong, G., and Zhang, W., 2013. Using contextualized geographically weighted regression
to model the spatial heterogeneity of land prices in beijing, china. Transactions in GIS, 17 (6),
901–919. doi:10.1111/tgis.2013.17.issue-6

Hsiao, C., 2014. Analysis of panel data. Cambridge: Cambridge university press.
Huang, B., Wu, B., and Barry, M., 2010. Geographically and temporally weighted regression for
International Journal of Geographical

modeling spatio-temporal variation in house prices.
Information Science, 24 (3), 383–401. doi:10.1080/13658810802672469

Hughes, R.A., et al., 2017. Estimation of the linear mixed integrated ornstein–uhlenbeck model.
Statistical Computation and Simulation, 87 (8), 1541–1558. doi:10.1080/

Journal of
00949655.2016.1277425

Kahneman, D., et al. 2004. A survey method for characterizing daily life experience: the day
reconstruction method. Science, 306 (5702), 1776–1780. doi:10.1126/science.306.5698.956a
Kahneman, D. and Deaton, A., 2010. High income improves evaluation of life but not emotional
well-being. Proceedings of the National Academy of Sciences, 107 (38), 16489–16493. doi:10.1073/
pnas.1011492107

Krizek, K.J., 2003. Neighborhood services, trip purpose, and tour-based travel. Transportation, 30

(4), 387–410. doi:10.1023/A:1024768007730

Kwan, M.P., 1999. Gender and individual access to urban opportunities: a study using space–time

measures. The Professional Geographer, 51 (2), 210–227. doi:10.1111/0033-0124.00158

Kwan, M.P., 2012. The uncertain geographic context problem. Annals of the American Association of

Geographers, 102 (5), 958–968. doi:10.1080/00045608.2012.687349
Kwan, M.P. and Neutens, T., 2014. Space-time research in giscience.

International Journal of

Geographical Information Science, 28 (5), 851–854. doi:10.1080/13658816.2014.889300

Kwan, M.P., Xiao, N., and Ding, G., 2014. Assessing activity pattern similarity with multidimensional
sequence alignment based on a multiobjective optimization evolutionary algorithm.
Geographical Analysis, 46 (3), 297–320. doi:10.1111/gean.12040

Lee, L.F. and Yu, J., 2010. Some recent developments in spatial panel data models. Regional Science

and Urban Economics, 40 (5), 255–271. doi:10.1016/j.regsciurbeco.2009.09.002

LeSage, J. and Pace, R.K., 2009. Introduction to spatial econometrics. Boca Raton: CRC Press.
Liu, X. and Long, Y., 2016. Automated identiﬁcation and characterization of parcels with open-
streetmap and points of interest. Environment and Planning B: Planning and Design, 43 (2), 341–
360. doi:10.1177/0265813515604767

Long, J.A. and Nelson, T.A., 2013. A review of quantitative methods for movement data.
Information Science, 27 (2), 292–318. doi:10.1080/

Journal of Geographical

International
13658816.2012.682578

Ma, J., et al., 2018. Does satisfactory neighbourhood environment lead to a satisfying life? an
investigation of the association between neighbourhood environment and life satisfaction in
beijing. Cities, 74, 229–239. doi:10.1016/j.cities.2017.12.008

Ma, J., et al., 2017. Inequality in beijing: A spatial multilevel analysis of perceived environmental
hazard and self-rated health. Annals of the American Association of Geographers, 107 (1), 109–
129. doi:10.1080/24694452.2016.1224636

2208

G. DONG ET AL.

Parent, C., et al., 2013. Semantic trajectories modeling and analysis. ACM Computing Surveys (CSUR),

45 (4), 1–32. doi:10.1145/2501654

Parent, O. and LeSage, J.P., 2012. Spatial dynamic panel data models with random eﬀects. Regional

Science and Urban Economics, 42 (4), 727–738. doi:10.1016/j.regsciurbeco.2012.04.008

Purves, R.S., et al., 2014. Moving beyond the point: an agenda for research in movement analysis
with real data. Computers, Environment and Urban Systems, 47, 1–4. doi:10.1016/j.
compenvurbsys.2014.06.003

Raudenbush, S.W. and Bryk, A.S., 2002. Hierarchical linear models: applications and data analysis

methods. Thousand Oaks, CA: Sage.

Schwanen, T. and Wang, D., 2014. Well-being, context, and everyday activities in space and time.
the Association of American Geographers, 104 (4), 833–851. doi:10.1080/

Annals of
00045608.2014.912549

Searle, S.R. and Khuri, A.I., 2017. Matrix algebra useful for statistics. New Jersey: John Wiley & Sons.
Shen, Y., Kwan, M.P., and Chai, Y., 2013. Investigating commuting ﬂexibility with gps data and 3d
geovisualization: a case study of beijing, china. Journal of Transport Geography, 32, 1–11.
doi:10.1016/j.jtrangeo.2013.07.007

Siła-Nowicka, K., et al., 2016. Analysis of human mobility patterns from gps trajectories and
contextual information. International Journal of Geographical Information Science, 30 (5), 881–
906. doi:10.1080/13658816.2015.1100731

Spaccapietra, S., et al., 2008. A conceptual view on trajectories. Data & Knowledge Engineering, 65

(1), 126–146. doi:10.1016/j.datak.2007.10.008

Spiegelhalter, D.J., et al., 2002. Bayesian measures of model complexity and ﬁt. Journal of the Royal
Statistical Society: Series B (Statistical Methodology), 64 (4), 583–639. doi:10.1111/rssb.2002.64.
issue-4

Steele, F., 2008. Multilevel models for longitudinal data. Journal of the Royal Statistical Society:

Series A (Statistics in Society), 171 (1), 5–19.

Ta, N., Kwan, M.P., and Chai, Y., 2016. Urban form, car ownership and activity space in inner
suburbs: A comparison between beijing (china) and chicago (united states). Urban Studies, 53
(9), 1784–1802. doi:10.1177/0042098015581123

Taylor, J.M., Cumberland, W., and Sy, J., 1994. A stochastic model for analysis of longitudinal aids
the American Statistical Association, 89 (427), 727–736. doi:10.1080/

data.
Journal of
01621459.1994.10476806

Yan, Z., et al., 2013. Semantic trajectories: mobility data computation and annotation. ACM

Transactions on Intelligent Systems and Technology, 4 (3), 1–34. doi:10.1145/2483669

Yang, C. and Gidófalvi, G., 2017. Mining and visual exploration of closed contiguous sequential
patterns in trajectories. International Journal of Geographical Information Science.doi:10.1080/
13658816.2017.1393542

