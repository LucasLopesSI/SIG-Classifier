This article was downloaded by: [Duke University Libraries]
On: 11 October 2014, At: 09:46
Publisher: Taylor & Francis
Informa Ltd Registered in England and Wales Registered Number:
1072954 Registered office: Mortimer House, 37-41 Mortimer Street,
London W1T 3JH, UK

International Journal of
Geographical Information
Science
Publication details, including instructions for
authors and subscription information:
http://www.tandfonline.com/loi/tgis20

Uncertain topological
relations between imprecise
regions
Stephan Winter a
a Department of Geoinformation, Technical
University Vienna, Gusshausstr. 27-29, 1040
Vienna, Austria
Published online: 06 Aug 2010.

To cite this article: Stephan Winter (2000) Uncertain topological relations
between imprecise regions, International Journal of Geographical Information
Science, 14:5, 411-430, DOI: 10.1080/13658810050057579

To link to this article:  http://dx.doi.org/10.1080/13658810050057579

PLEASE SCROLL DOWN FOR ARTICLE

Taylor & Francis makes every effort to ensure the accuracy of all
the information (the “Content”) contained in the publications on our
platform. However, Taylor & Francis, our agents, and our licensors
make no representations or warranties whatsoever as to the accuracy,
completeness, or suitability for any purpose of the Content. Any
opinions and views expressed in this publication are the opinions and
views of the authors, and are not the views of or endorsed by Taylor
& Francis. The accuracy of the Content should not be relied upon and
should be independently verified with primary sources of information.
Taylor and Francis shall not be liable for any losses, actions, claims,
proceedings, demands, costs, expenses, damages, and other liabilities

whatsoever or howsoever caused arising directly or indirectly in
connection with, in relation to or arising out of the use of the Content.

This article may be used for research, teaching, and private study
purposes. Any substantial or systematic reproduction, redistribution,
reselling, loan, sub-licensing, systematic supply, or distribution in any
form to anyone is expressly forbidden. Terms & Conditions of access
and use can be found at http://www.tandfonline.com/page/terms-and-
conditions

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 int. j. geographical information science, 2000, vol. 14, no. 5, 411± 430

Research Article

Uncertain topological relations between imprecise regions

STEPHAN WINTER
Department of Geoinformation, Technical University Vienna,
Gusshausstr. 27-29, 1040 Vienna, Austria
E-mail: winter@geoinfo.tuwien.ac.at

(Received 28 September 1998; accepted 14 October 1999)

Abstract. Spatial databases are repositories of representations of the real world.
The represented entities have to be observed in the real world and mapped to
the database. An observation is interpreted here as a two-level process, consisting
of the abstraction of the observed object to a concept and a measurement of the
realized concept. Due to the nature of observations, regions representing the
location of objects are always imprecise, the explication of a concept succeeds
only incompletely, and the measurement is limited in precision.

In this paper, the uncertainty in abstraction as well as the imprecision of
measurement are modelled statistically. This allows the introduction of the uncer-
tainty of observation into qualitative spatial reasoning. The example used in this
paper is the determination of topological relations. The topological relation
between two regions becomes uncertain if the regions are imprecise in their
location. Hence, the decision about a topological relation is made by maximum
likelihood classi(cid:142) cation. The classi(cid:142) cation allows a quantitative assessment of the
decision by its probability, and by the probability of the alternative relations. The
method is useful in data set comparison, data matching, and modelling data
quality descriptions.

1.

Introduction
Uncertainty is an inherent property of all observations. Abstracting the real
world to conceptual objects is a step of generalization (simpli(cid:142) cation), and the
measurement taking place on abstracted objects propagates this uncertainty, adding
systematic, gross and random errors. Each spatial analysis is infected by these sources
of uncertainty, depending on the context of the observations and on measurement
methods and conditions. Hence, it is necessary to introduce the propagation of
uncertainty in spatial analysis to allow an assessment of the results. The aim of this
paper is to combine the process of observation with a mathematical model of
qualitative spatial relations, modelling the randomness of the observations. A method
is presented for probability-base d decisions about spatial relations.

When determining spatial relations form locally uncertain objects, it is necessary
to distinguish between quantitative relations, which become imprecise, and qualitative
relations, which become uncertain. Topological relations are qualitative. In the pres-
ence of location uncertainty, the topological relation between two explications of the
related regions can be wrong for other explications. For example, if an overlay of

Internationa l Journal of Geographica l Information Science
ISSN 1365-881 6 print/ISSN 1362-308 7 online © 2000 Taylor & Francis Ltd
http://www.tandf.co.uk/journals

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 412

S. W inter

two independent objects indicates a very small overlap, it has to be determined
whether the two objects also could be neighbours in reality. Comparing the degree
of overlap to the size of location, uncertainty will permit a decision, and quantitative
assessment of this decision.

This paper describes the inference from locally imprecise objects to observations
characterizing topological relations. These observations are morphological distances,
based on the skeleton between the objects. They allow a representation of topological
relations equivalently to Egenhofer’s intersection set model, but in addition they
yield quantitative geometric information. The inference from this representation to
the uncertainty of the topological relations is treated with a statistical classi(cid:142) cation
approach. Based on the evidence of the observations, probabilities of each single
relation are determined, and the relation with maximum probability is chosen.

For the (cid:142) rst time the imprecision of measurement and the uncertainty of abstrac-
tion are described by using probability densities. They determine probabilities of the
signs of the observed distance values. It is shown that it is su(cid:141) cient to only use the
minimum and maximum distance to characterize the topological relation. Minimum
and maximum distances are classi(cid:142) ed as smaller than, equal to or greater than zero.
These two distance classi(cid:142) cations allow a decision about the topological relation of
the two objects.

Other approaches to handling uncertainty are discrete, using error bands, or
fuzzy, with the problem of weaker semantics of the results. With strong connection
to observation processes we suggest a more valuable decision method, with prob-
abilities as objective and interpretable results, and enabling the assessment and
uncertainty propagation in spatial reasoning processes.

The next section provides an overview of related as well as of fundamental work.
In §3, the usual representation schema of topological relations, the intersection model
proposed by Egenhofer, will be replaced by a distance function to derive quantitative,
position dependent measures. In §4, for the observed distances a statistical model of
observation is applied, which allows classi(cid:142) cation of distances for their signs. Further
(in §5), this classi(cid:142) cation can be generalized to determine the topological relation of
the objects. §6 demonstrate s the practical use of this method. Finally, in §7 the results
are summarized and evaluated.

2. Related and fundamental work

This section reviews work related to the topic of uncertainty and spatial reasoning
as well as work in modelling topological relations, especially the Egenhofer model,
which is based on the intersection of sets.

2.1. Uncertainty of regions and relations

There are a few suggestions as to how to handle location uncertainty of regions
in Geographic Information Systems (GIS), mainly by bands or by fuzzy sets. The
modelling of spatial relations under locational uncertainty has also been based on
these concepts.

Bands are used as a discrete two-dimensional representation of (local ) uncertain
boundaries of regions. The simplest band model is the e-band with a constant width
e (Perkal 1956, Chrisman 1982). Nearer to a theoretical model of a probability
distribution is the so-called error-band that may have a variable width. The error
band for linear segments is modelled stochastically of hyperbolic shape (Wolf 1975,
Caspary and Scheuring 1992 ). For regions with an arbitrary band, Cohn and Gotts

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 Uncertain topological relations between imprecise regions

413

(1996) coined the term egg-yolk regions. Even more general are vague regions
(Worboys 1998), represented by parts that belong to the region for sure, and parts
which may belong to the region.

In Euclidean topology a boundary is de(cid:142) ned by the set of centres of in(cid:142) nitesimal
balls containing the exterior as well as interior of a region. Hence, band-bounde d
regions violate models of topological relations that are based on Euclidean topology,
such as Egenhofer’s intersection model (§2.2 ). For band-bounde d regions, the applica-
tion of the intersection model leads to additional, (cid:142) ctive sub-relations of the relations
in Euclidean space (Clementini and Di Felice 1996). In the (logic-based) region
connection calculus (Randell et al. 1992), egg-yolk regions lead to a similar number
of possible topological relations (Cohn and Gotts 1996). In a (cid:142) rst instance the
additional relations allow diŒerentiation of topological relations for their uncertainty.
But the interpretability of a sub-relation is poor, and a quantitative assessment of
the uncertainty cannot be given. For that reason, Winter and Bittner (1999) proposed
handling vague regions by determining the set of possible Egenhofer relations.

Another way of modelling uncertainty is the interpretation of regions as two-
dimensional fuzzy sets (Zadeh 1965, Altman 1994). Based on this idea, Molenaar
(1998) developed a determination of fuzzy topological relations. There the problem
arises how to determine the fuzzy membership values of the regions, and how to
interpret the fuzzy membership value for a topological relation.

In contrast to fuzzy sets, a probability distribution can be interpreted by specifying
an experiment that follows this distribution (Baarda 1967). With the advantage of
being objective, here a statistical model of uncertainty is developed. Statistical models
are often neglected in GIS, which is a consequence of their complexity: while the
location uncertainty of a point (in 2D) can be described by a 2Ö 2-covariance matrix,
objects of higher dimensionality —curves, or regions—need additional eŒorts in
modelling correlations and superpositions of distributions. A diŒerent statistical
approach being suggested is simulation with perturbed realizations of objects (Fisher
1993, Hunter and Goodchild 1996). One could think of creating a number of
realizations of two given regions, determining their topological relation, and con-
sidering the auto-correlation of the events for a (cid:142) nal decision. It seems that this idea
has not been pursued, but the approach taken here is signi(cid:142) cantly diŒerent.

2.2. Representation of topological relations

In this paper extensive use is made of Egenhofer’s intersection model, a speci(cid:142) c
representation for binary topological relations (Egenhofer 1989, Egenhofer and
Franzosa 1991, Egenhofer and Herring 1991). This section gives a short summary
of the relevant principles.

The content of the four intersection sets,

, between the interiors (ß )
and the boundaries (‚ ) of two regions A and B characterize their topological relation.
The sets can be ordered in a 2Ö 2 schema, the 4-intersection.

or \

m

Aß
‚ A

Bß

, \
, \

{Æ
{Æ

‚ B

} {Æ
} {Æ

, \
, \

}
}

For two singular connected and regular closed (called simple in the remainder)
regions in R
2 (Worboys and Bofakos 1993) a set of eight relations can be distinguished
(table 1). Regions with other topological properties require the additional observa-

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 Æ
Æ
Æ
Æ
Æ
Æ
414

S. W inter

Table 1. The eight topological relations that can be distinguished by the intersection model
between simple regions.

Disjoint

Touch

Overlap

Equal

Covers

Covered by

Contains

Contained by

tion of the intersection sets with the exteriors (9-intersection) and diŒer in the number
of possible topological relations.

Then the set of topological relations VR consists of:

VR 5 {Disjoint, Touch, Overlap, Equal,

Covers, CoveredBy, Contains, ContainedBy}

(1)

This set can be arranged in a planar graph, the conceptual neighbourhoo d graph,
based on concepts like topological neighbourhood or topological distance (Egenhofer
and Al-Taha 1992): two relations are neighboured (connected) if they are sequential
states in continuous motion or deformation. Additionally it is possible to direct the
edges of the graph, using the concept of dominance (Galton 1994).

De(cid:142) nition 1: We call a relation dominating against its neighbouring relations if it

holds in some continuous motion or deformation only at a point of time.

Let us de(cid:142) ne the edge directions from the dominating relation to the dominated
relation. Then (cid:142) gure 1 (p. 415) shows the conceptual neighbourhood graph for the
relations of simple regions. This (cid:142) gure also contains a distinction between weak and
strong overlap, which is introduced in §3.

The intersection model is based on topological invariants. In its pure form it
is not suited for quanti(cid:142) cation (but see Egenhofer (1993 )). For this reason the

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 Uncertain topological relations between imprecise regions

415

Figure 1. The

conceptual neighbourhood graph, partitioned into clusters of
neighbourhood of Touch and the neighbourhood of Equal.

the

intersection sets will be replaced in the following section by a quantifyable distance
between the regions. The distances are sensitive to location uncertainty.

3. Observations for topological relations

In this section an alternative representation to the intersection model is developed.
The alternative representation is based on the distance between two regions. It is
shown that categorizing the distances yields a representation equivalent to the
intersection model.

3.1. Reasonable assumptions for regions

In the remainder of this paper we limit ourselves to simple regions, in order to
separate spatial complexity in a (cid:142) rst instance from the development of a new
representation method. The topological relation between two simple regions is gained
by observing their mutual location, and working with the uncertainty introduced by
that observation. The quality and quantity of the uncertainty determine the type of
problem to evaluate the topological relation. In extreme situations no statements
can be made: assume, for example, a crisp region, and another region that is totally
undetermined in its location ( but exists). In this case, no evidence is given for any
topological relation, but such situations are practically irrelevant. Therefore, it seems
reasonable to restrict the size of the uncertainty of regions. We assume that:

(1) The uncertainty about the location of each region has to be small compared
to the size of the region. In surveying it is a rule of thumb to measure one
magnitude more precisely than required. For example, in cadastral surveying
object dimensions are in decametres while precision is in centimetres, and
in topographic mapping object dimensions are in hectometres while prec-
ision is in metres. We conclude that the restriction is ful(cid:142) lled for objects in
geographical space.

(2) The question whether a point is inside a region must be related (in practice)

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 416

S. W inter

to one segment of the boundary at the most. This is a restriction for the
shape of the regions. If a region has a bottle-neck, the uncertainty must not
allow geometric realizations of the region with crossing boundaries.

These restrictions need to be de(cid:142) ned formally. Assume that the location of
uncertainty of a region X can be su(cid:141) ciently represented in a discrete band of radius r.
The band is realized by the morphological operations (Serra 1982) of dilation (C)
and erosion (D) with a circle Kr. Then the region has to satisfy the compactness
condition that XCKr as well as XDKr preserves the topological properties of X: its
connectedness and its degree of connectedness. Furthermore we require that
(XCKr)@
) have to
be parallel approximatel y (i.e. their distance may vary in a given interval). Finally,
Æ where r is the maximum uncertainty of
the uncertainty shall satisfy XDK2r 5
two considered regions. This last condition exceeds the informal restrictions in so
far as we exclude cases where a very large region (with large uncertainty) is related
to a very small region (with small uncertainty) . Such cases may occur in praxis, but
they are sometimes not decidable.

(XDKr) forms a band, i.e. the curves ‚ (XCKx

) and ‚ (XDKx

3.2. Relation clusters

The geometric restrictions justify splitting the conceptual neighbourhood graph
into two connected sub-graphs ((cid:142) gure 1), or respectively, to split VR (equation 1)
into two relation clusters C1, C2.

De(cid:142) nition 2: We call the set of relations which consist of Touch and similar relations

the cluster C1:

the cluster C2:

C1 5 {Disjoint, Touch, WeakOverlap}

We call the set of relations which consist of Equal and similar relations

C2 5 {StrongOverlap, Equal,

Covers, CoveredBy, Contains, ContainedBy}

This splitting cuts the central relation Overlap into a WeakOverlap and a
StrongOverlap. The idea behind splitting Overlap is the fact that a situation with
a small overlap between two considered regions could in reality be Touch or
Disjoint with some probability, but (practically) never another relation (out of C2).
Vice versa, in a situation with a large overlap between two considered regions, the
other relations of C2 become probable to some degree, but the relations of
C1 become improbable. This behaviour can be proved using the last geometrical
restriction to the size of the uncertainty.

Proof of the hypothesis: Each realization of two uncertain regions A and B, where
the relations Covers,
Touch(A,B) holds at
least once, realizes never one of
CoveredBy, or Equal. Assume a realization Touch (ADKr, BDKr), which allows
maximum overlap with dilated versions. Because it is presupposed that ADK2r 5

and BDK2r 5

, the HausdorŒdistance (Serra 1982 ) between ADKr and
is necessarily bigger than 2r. Then neither Covers(ACKr, BDKr) nor
BDKr
Covers(BCKr, ADKr) can be true. The conclusion holds the more for all other
starting realizations. The inversion of the proof for a starting realization of Covers
works respectively.

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 \
\
Æ
\
Æ
(2)

(3)

(4)

Uncertain topological relations between imprecise regions

417

Classi(cid:142) cation of the relation Overlap can be made by weighting; the weight of
Overlap is based on an overlap factor OF:

For two overlapping regions WeakOverlap and StrongOverlap can be de(cid:142) ned
thus:

OF 5

| Aß mBß

|
|, | Bß

|)

min(| Aß

OF< 0.5 : Rel 5 WeakOverlap

OF> 0.5 : Rel 5 StrongOverlap

3.3. Zonal skeletons

The clusters C1, C2 can be characterized by certain intersection sets that can be
uncertain. For the cluster C1, the local uncertainty of regions A and B is linked (at
most) with uncertainty about the emptiness of Aß mBß and ‚ Am‚ B. For the clusters
C2, uncertainty is (at most) about the emptiness of Aß mBc, AcmBß , and ‚ Am‚ B. The
other intersection sets may vary in their size, but they will not disappear, or appear
respectively. Consequently, the relations inside a cluster diŒer only in the state of
the uncertain relations.

Hence, interest focuses on the existence and diameter of the uncertain intersection
sets. To observe the diameter, a skeleton through the uncertain intersection sets is
introduced. Let us denote the two certain zones of each cluster by P and Q, and the
remainder by O:

Rel ×C1:

Rel ×C2:

O 5 R 2c P,Q
P 5 Aß mBc
Q 5 AcmBß

O 5 R 2c P,Q
P 5 AcmBc
Q 5 Aß mBß

G
G

In (cid:142) gure 2 it is easy to verify that for both clusters the uncertain sets are part of O.
All zones are open sets.

We call now the skeleton on O the zonal skeleton (Lantuejoul 1978). Generally,
a skeleton S(X ) is the set of centres of the maximal discs which are completely in a
closed set X (Serra 1982 ). To apply this concept, the union of P and Q is considered
as foreground F, and the closure of O as background Fc. Then the zonal skeleton
becomes an exoskeleton of the foreground, S(Fc), and shall be limited to a subset of
the exoskeleton.

De(cid:142) nition 3: A zonal skeleton is the subset of an exoskeleton on disjoint zones P and

Q, where the maximal discs touch both P and Q.

This de(cid:142) nition provides a skeleton that follows the centre line(s) of uncertain
intersection sets. A zonal skeleton is a (cid:142) nite union of simple lines (Lantuejoul 1978 ),
but it needs not to be connected. The zonal skeletons of the two clusters are denoted

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 418

S. W inter

Figure 2. Two circles that overlap weakly ( left) or strongly (right), and their skeleton between
the certain zones P and Q.

by S1 (Rel ×C1) and S2 (Rel ×C2), with the two diŒerent initializations of P and
Q following equation (4).

3.4. Morphological distance functions

Zonal skeletons will be used now to observe the diameter of the uncertain
intersection sets. For that reason we introduce a distance function along the skeletons
that exploits the diameter d of the maximal discs at each point s of the skeleton Si,
i ×{1,2}. The domain of the function is Si, qAB :Si (cid:129) R , whereas Si itself depends on
RÖ R, R being the set of regions.
De(cid:142) nition 4: Let the relation between A and B be in Ci, let s ×Si, and let d be the
diameter of the maximal discs at the point s. Then the morphological distance
between A and B at s is the real number qAB(s), de(cid:142) ned by:

d

0

Õ d

if s ×Ac
if s ×Aß
if s ×‚ A

qAB (s) 5 G

Note that the morphological distance is signed and not symmetrical; therefore it is
not a metric. The name and sign of the morphological distance follows from the
morphological operations of dilation (C ) or erosion (D ), which have to be applied
on A to reach the skeleton. In the following the morphological distance is written
qAB for short. It is easy to show that the morphological distance is symmetric along
S1 (qAB 5 qBA ), and antisymmetric along S2 (qAB 5

With the morphological distance we get quantitative information that is sensitive
to location uncertainty. We show next that the abstraction of the distance to qualitat-
ive range classes allows topological distinctions equivalent to the Egenhofer model.
The range classes simply depend on the sign of the distance:

Õ qBA).

De(cid:142) nition 5: We de(cid:142) ne the following classes for a morphological distance:

Vq 5 {vÕ

, v

0

, v+ } withG

qAB (cid:129) vÕ
qAB (cid:129) v
0
qAB (cid:129) v+

if qAB < 0
if qAB 5 0
if qAB > 0

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 Uncertain topological relations between imprecise regions

419

Consider the minimum distance qmin 5 min(qAB) and the maximum distance qmax 5
max(qAB) along the skeleton Si. Applying the classi(cid:142) cation, we (cid:142) nd two distance
classes vmin and vmax. If these classes of extreme distances are combined with the
relation cluster Ci, they represent perfectly the eight Egenhofer relations, with the
addition of a weighted overlap ((cid:142) gure 2):

{Ci, vmin, vmax} 5 4-intersection(A,B)

(5)

The variations of the triple in table 2 are complete, due to the completeness of
the eight relations of the 4-intersection, and to the interdependency of empty/non-
empty intersection sets and their diameter. So far, the intersection model is replaced
by another qualitative representation that oŒers quantitative information addition-
ally. In the next section the classi(cid:142) cation of minimum and maximum distances is
treated considering the uncertainty of the regions.

4. Modelling the observation uncertainty

The morphological distance represents observations in zones of uncertainty. These

observations are modelled statistically here.

4.1. Observation and uncertainty

Let us begin with a justi(cid:142) cation of stochastic methods in the context of spatial
reasoning. Knowledge about space and its content, the real world, is based on
observations. Mainly two steps can be distinguished: the abstraction of the continuous
real world to concepts, and the physical measurement of the concepts, cf. (cid:142) gure 3
(David, Herrewegen and Salge` 1996 ).

Usually an observation is a single abstraction and measurement, and so far a
single outcome of a random process. It is possible to describe the observation
statistically, however, based on the assumption that the observation could be repeated
(Baarda 1967). Then information about the context of the observation allows the
assignment of distribution to the random process. In the case of selecting regions
from spatial data sets, the context of observation is equal to the context of the data

Table 2. The triple {Ci, vmin, vmax } distinguishes the same relations as the intersection model,
with the re(cid:142) nement in Overlap.

Relation

Disjoint
Touch
WeakOverlap

StrongOverlap
Covers
CoveredBy
Contains
ContainedBy
Equal

C

C1
C1
C1

C2
C2
C2
C2
C2
C2

vmin

vmax

v+
v
0
vÕ
vÕ
vÕ
v
vÕ
v+
v
0

0

v+
v+
v+
v+
v
0
v+
vÕ
v+
v
0

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 420

S. W inter

Figure 3. Observation is a process of abstracting a complex world to generalized concepts,
and to measure these concepts physically.

set. Statistical parameters, describing the locational uncertainty of the regions, are
either stored in the data set or can be derived from the scope of the data set.
Regarding (cid:142) gure 3, a statistical model of the fuzziness of abstraction is required as
well as a statistical model of the imprecision of measurement. These notions are used
as speci(cid:142) cations of a general concept of uncertainty:

De(cid:142) nition 6: We call the diŒerence between a continuous world and a generalized

abstraction of that world the fuzziness of the concepts.

De(cid:142) nition 7: We call a characterization of the deviation of a continuous random

variable from a mean value the imprecision of the variable.

The notions can be applied as well to the observation of morphological distances

between two regions from diŒerent data sets.

4.2. Fuzziness of abstraction

In this section a stochastic model of the fuzziness of abstraction is designed. The
main argument is the repeatability of creating an abstraction, leading to a width of
concepts.

0

Up to now distance classes are assigned by a mathematical de(cid:142) nition (De(cid:142) nition 5).
stands for qAB 5 0, but the probability that a continuous random
For example, v
variable like q matches 0 exactly is zero: P(qAB 5 0) 5 0. What is needed for observed
values, is a fuzzy class qAB # 0. This remark coincides with the fact that human
concepts of IsZero always have a natural width. The width depends merely on the
context of an observation: consider, for example, a cadastral dataset with two points
nearer than, let us say, 5 cm. Then one has strong support for the assumption that
both entries refer to the same point in the real world. For that reason, in GIS the
snapping function was implemented.

We propose to model the fuzziness of a concept by asking experts. Let us collect
a large number of responses from independent experts. Then the function which
describes the number of agreements with the concept for all values of R yields a
probability density function ((cid:142) gure 4). Let us further describe this function by two

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 Uncertain topological relations between imprecise regions

421

parameters: a mean width b, and a smoothness of the concept, given by sb. Then a
density function can be given by the convolution of a constant distribution, Db, and
a Gaussian Gsb

:

p(m 5 mq|v0) 5 Db*Gsb

(6)

where the Gaussian, Gs, is de(cid:142) ned as:

and the convolution * is de(cid:142) ned as:

Gs 5 1/Ó 2ps2 expAÕ

1
2

(x/s)2B

2

f (x)*h(x) 5 P

Õ 2

f ( y) h(xÕ y) dy

Such a model remains consistent with the mathematical concept of ‘ 5 0’: in the
case of b 5 0 and sb 5 0 the density function degenerates to the ‚ -function. Density
functions with vÕ
and v+ can be set up analogously, because both intervals are
limited in practice, either by the region diameters or at least by a minimum bounding
rectangle containing the regions A and B, which can always be speci(cid:142) ed.

4.3. Imprecision of measurement

In this section a stochastical model of the imprecision of measurements is
designed. Measurements introduce gross, systematic and random errors into observa-
tions. We only deal with random errors, because gross and systematic errors are
avoidable in principle.

The measured variables of

(polygonal) regions in spatial data sets are their
boundary points. In a simple approach it is assumed that random errors in location
may be described by sA and sB for two regions A and B, characterizing the standard
deviation of the boundary points. Dealing with imprecise regions, the morphological
distance becomes uncertain, too. Let us simplify the morphological distance to a

Figure 4. Results of an inquiry for experts’ concept of IsZero.

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 422

S. W inter

functional diŒerence ‚ AÕ
by s‚ :

‚ B. Then the uncertainty of measuring ‚ AB can be described

5 s2A 1 s2B
The standard deviation of the morphological distance, s‚ , characterizes a Gaussian
density function pe of a random measurement error e:

s2‚

(7)

pe 5 Gs‚
This measurement error e is de(cid:142) ned as the deviation of the measured value ‚ AB from
a value m‚ which was expected from abstraction: e 5

‚ AB Õ m‚ .

(8)

4.4. Combined observation uncertainty

Now the fuzziness of abstraction and the imprecision of measurements are
combined. For this purpose, let us assume independence between abstraction and
measurement; that means (stochastical variables are underlined):

e| mq, vi 5
With that, we can separate the measurement error, e, from abstraction: the evidence
q is the outcome of an experiment that, if vi is true, then m 5 mq with a certain
probability, and overlays that m with the measurement error e:

(9)

e

q| vi 5

(qÕ mq) | vi 1 mq| vi
e 1 mq|vi

Now, the probability density of the sum of the two independent variables e and mq
is the convolution of their individual densities:

pq| v(q) 5
These densities are already known:
equation (8).

) (q)

(pe*pm| vi
for pm| vi

see equation (6) and for pe see

5. Classi(cid:142) cation of topological relations

Observation uncertainty needs to replace the straight assignment of morpholo-
gical distance classes. We do that by a likelihood-based decision. This classi(cid:142) cation
will be generalized to a classi(cid:142) cation of the topological relation.

5.1. Classi(cid:142) cation of distances

With the given observation uncertainty (§4.4) it is possible to classify an observed
(extreme) morphological distance into one of the classe of Vq. This classi(cid:142) cation will
be made by the decision rule of maximum likelihood:

q(cid:129) vÃ

i

if P(vi| q)> P(vj| q)

for all j Þ

i; vi, vj ×{vÕ

, v

, v+ }

-

(12)

which means that the conditional probability P needs to be determined for each of
the three classes vÕ
, and v+ . These probabilities are determined by using Bayes’
, v
theorem (Koch 1987):

0

(10)

(11)

(13)

P(vi |q) 5

P(q | vi) P(vi)

P(q |vj) P(vj)

vj × Vq

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 5
(cid:158)
Á
Uncertain topological relations between imprecise regions

423

For determining the probability that the continuous variable q equals a certain

value, let us de(cid:142) ne for a small Dq:

P(q 5 q)

! P(q< q < q 1 Dq)

F(q 1 Dq)Õ F(q)

! pq(q) Dq for small Dq

(F is the distribution function). This de(cid:142) nition keeps a dependency of P(q 5 q) with
Dq, which will be canceled later. With such a de(cid:142) nition, and referring to equation
(11), we can write that the probability of the evidence q:

P(q 5 q| vi) 5 pq| v (q) Dq
( pe*pm| vi

)(q) Dq

(14)

In this equation, the convolution requires integration. Setting the proposed density
functions (equations (6) and (8)) in equation (14), one (cid:142) nds after some transforma-
tions (Winter 1996 ) that the convoluted densities can be replaced by two error
functions (Papoulis 1991 ) that can be integrated (Koch 1987). An error function erf
is de(cid:142) ned as:

x

erfs(x) 5 P

Gs(t) dt

Õ 2
Putting equation (14) into equation (13) allows elimination of the factor Dq, which
appears in numerator and denominator in each product.

The remaining task is to determine the a-priori probability of vi. In Vq, the
intervals can be set to (cid:142) nite lengths for good reasons: the considered regions are
(cid:142) nite, the area to calculate skeletonization is chosen to be (cid:142) nite, and thus the
observed morphological distances have to be (cid:142) nite. Then the ratio of the length of
vi and the total length of Vq is one practical a-priori probability of a class vi. The
results are a low probability of v
0

, and high probabilities for vÕ

Now equation (13) can be solved as soon as b, sb, sA, and sB are given and q
is calculated. The equation must be solved for each distance class for both qmin and
qmax. Then both extreme distances can be assigned to their most likely distance class
(equation 12).

and v+ .

5.2. Classi(cid:142) cation of the topological relation

Finally, we show how the transition works from classi(cid:142) ed distances to a classi(cid:142) -
cation of the relation. Any observed triple {Ci, qmin, qmax} can be classi(cid:142) ed to
{Ci, vmin, vmax} by applying equation (12). With P(C 5 Ci) 5 1, a consequence of
the discussion in §3.2, we (cid:142) nd (assuming that qmin and qmax are stochastically
independent):

P(Ci, vmin, vmax |Ci, qmin, qmax 5 P(vmin| qmin)P(vmax | qmax)
i.e., the probability of the topological relation between A and B, taken from table 2,
is simply the product of the probabilities of the two distance classi(cid:142) cations.
Probabilities of alternative classi(cid:142) cations can be calculated additionally, using the
alternative probabilities from equation (13). This allows a quantitative assessment
of the decision.

(15)

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 5
5
5
5
424

6. Examples

S. W inter

The use of the proposed method will be demonstrate d with the following
examples. The (cid:142) rst example is worked out in detail to show the single modelling
steps; the second example leads to a discussion of the interpretation of the results.

Both examples use real data sets. The data sets contain buildings in 2D of the
same area. The data sets are captured independently, and they represent diŒerent
timeslices. One data set (A) contains buildings extracted from a high-resolution
digital elevation model (Weidner and Fo¨rstner 1995 ), another data set (B) contains
buildings captured by a model-supported, semi-automati c digitization procedure
(Gu¨ lch 1997), and a third data set (C) contains buildings captured by traditional
stereo plotting. The central question in the following investigations is to classify
diŒerences between the data sets. DiŒerences can be caused by diŒerent precision of
the capturing methods, by diŒerent concepts of the operators/operations, and by
change in the real world. For the following examples, matching regions are tested
for their topological relation, expecting evidence to be equal.

6.1. A detailed example

Here, an arbitrary building A from data set A ((cid:142) gure 5, left) and its best matching
partner B from data set B ((cid:142) gure 5, centre) is chosen to determine whether their
topological relation will be classi(cid:142) ed as equal. The visual comparison of the two
regions shows that A has weaker shape constraints than B ((cid:142) gure 5, right).

Taking into account the meta-information of the two data sets yields the

following values:

A

B

Ground resolution
sA, sB

0.5 m pel Õ 1
3 pel

0.5 m pel Õ 1
1 pel

With the standard deviation of A and B follows the standard deviation of the
morphological distance with 3 pel (equation 7). The width of a concept IsZero is
determined by estimation of an expert:

Concept width of IsZero
Standard deviation of concept IsZero
Upper limits of distance

b
sb
bmin, bmax

1 pel
1 pel
[Õ 20 pel, 20 pel]

Figure 5. Two data sets containing a building (A left, and B centre), and their overlay (right).

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 Uncertain topological relations between imprecise regions

425

The two regions overlap with 98%, i.e., the skeleton is calculated for C 5 C2 ((cid:142) gure 6,
left). A distance transform yields the distances along the skeleton ((cid:142) gure 6, right).

The resulting morphological distances (in pel ) along the skeleton yield the triple:

{C2, qmin 5

Õ 4, qmax 5 2}

Now one (cid:142) nds:

the a priori probability of the distance classes:

the distributions for abstraction and measurement of qmin and qmax (equation
14);
(cid:142) nally, the classi(cid:142) cation probabilities for qmin and qmax (equation 13):

0.06

P(vi) 5 A0.47
0.47B

0.11

P(vi| qmin) 5 A 0.83
0.06B
P(vi |qmax) 5 A0.17
0.62B

0.21

Choosing the maximum likelihoods, the extremal distances are classi(cid:142) ed to qmin (cid:129) vÕ
and qmax (cid:129) v+ . These decisions refer to the topological relation StrongOverlap
(table 2). With the classi(cid:142) cation probabilities one can calculate easily all probabilities

Figure 6. The skeleton S2 ( left), and the distance image (right).

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 E
E
E
426

S. W inter

of topological relations from equation (15) and table 2, which has to be normed
additionally because of the limited relation set of C2:

per de(cid:142) nitionem

per de(cid:142) nitionem

per de(cid:142) nitionem

P(vR|e) 5

Disjoint:
Touch:
WeakOverlap:
StrongOverlap:
Covers:
CoveredBy:
Contains:
ContainedBy:
Equal:

0.00

0.00

0.00

0.54

0.18

0.07

0.15

0.04

0.02

The relation is classi(cid:142) ed to StrongOverlap (A,B) with the probability of 54%.
Probable alternatives are Covers or Contains; and Equal seems to be unlikely
(which is a consequence of its sensitivity).

6.2. A use case example

Again the regions of both data sets refer to the same real-world objects, buildings.
With the a priori hypothesis of the relation Equal, the resulting probabilities for
each relation can be used for database comparison, for database updates, or for
database quality evaluation. That idea was applied to a set of buildings from data
sets B and C, where C is assumed to be of higher reliability (Ragia and Winter
1998 ). In (cid:142) gure 7 ( left), two representations of buildings are extracted from independ-
ent data sets and overlaid. They do not match exactly because of the uncertainty of
observations in both capturing methods. Distance values are in the interval of
[Õ 4...6] pixels (one pixel in the image refers here to 10 cm in the real world).
Considering the intended use of the two data sets (to determine b) and the
two capturing methods (to determine s), one (cid:142) nds with the described test that

Figure 7. Overlay of two buildings from independent data sets ( left) and the related histogram
of distances (right).

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 Uncertain topological relations between imprecise regions

427

both representations are most probably Equal. The probability could be useful in
determining the quality of the data set B.

The second pair of buildings ((cid:142) gure 8 ), does not match exactly not only because
of uncertainty, but also because of an annex of the building contained in only
one data set. With the same parametrization both representations most probably
have a StrongOverlap. Such a classi(cid:142) cation could be useful
in determining
incompleteness of data sets.

7. Discussion

A morphological distance function has been presented to determine the topolo-
gical relation between two regions. It was shown that the representation with classi-
(cid:142) ed extremal distances is equivalent to the representation by intersection sets.
Considering two regions as (locally) uncertain, the observation of the distances could
be modelled statistically. With this model the uncertainty of observed distances is
propagated to the uncertainty of topological relations. An application of a statistical
decision rule yields probabilities for a decision as well as for its alternatives, thus,
allowing an assessment among these alternatives.
This approach has the following new aspects:

E a combined statistical model of observation uncertainty and relation

uncertainty;

E a statistical model of the lack of de(cid:142) nition in spatial abstraction;
E a new view of the conceptual-neighbourhood-graph , which was used up to
now in the context of motion or deformation, and is now adapted to location
uncertainty;

E a partitioning of the conceptual-neighbourhood-grap h into two clusters, based

on weighting the central relation Overlap;

Figure 8. Overlay of another pair of buildings from independent data sets ( left) and the
related histogram of distances (right).

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 428

S. W inter

the use of morphological distances, which keep metric information about the
magnitude of intersection sets, instead of empty or non-empty intersection sets.

The proposed method is relevant to all aspects of GIS use:

Input. In data import, data homogenization requires techniques to support
decisions for the elimination of slivers between data layers. The decision can
be supported by the presented method; the related problem of determining
new common boundaries is not touched. In a special application of the
presented method, Ragia and Winter (1998) apply a classi(cid:142) cation of being
equal to a comparison of two data sets. This comparison is made for change
detection between two versions of a database.

Management. Usually the topological structure of a data layer is the basis of a
data model, and location information is only attached to points. Data models
storing information about uncertainty and imprecision are missing up to now.
Consequently, the ability of the systems to deal with such information is poor.
In the case of topological reasoning with locational uncertainty, certain data
models need to be developed that allow a system to cope with probabilities
of decisions, and with storing alternative relations and their probabilities, too.
Analysis. Up to now it has been a problem of boolean logic to infer from a set
of given topological relations to missing ones. Now the propagation of probab-
ilities can be introduced in this reasoning process. Furthermore, the reasoning
deals with the existence of alternative relations, and with their probabilities.
As soon as alternative relations are included in a network of topological
relations, problems arise concerning the consistency of a network. Queries
involving only single data layers are not treated by the presented method,
because they follow semantic constraints in their topological structure, mainly
by representing a spatial partition.

Presentation. Visualising uncertainty is an active topic of research, put in the
context of topological relations, or more generally in the context of qualitative
spatial relations visualising uncertainty seems to be a completely new question.

The ideas presented are worked out for simple regions under the condition of
small locational uncertainty. Further work is needed to extend these ideas to complex
objects. In the (cid:142) rst place application of the method to generalised regions needs to
be established (Egenhofer et al. 1994). Whether the method works with simple,
1D-objects in R 1, or with simple 3D-objects in R 3. Also whether the conservative
geometric limitations can be extended should be explained. For example, some
relations can have sure explications even though the uncertainty of the regions
exceeds the limits. An interesting question is whether the basic statistical models can
be used for other qualitative spatial relations.

Another direction of further research regards the sources of uncertainty. Spatial
data underlies, e.g., cartographic generalization, which is not considered here in
detail. Spatial uncertainty is also interrelated with the uncertainty in the extension
of a spatial phenomenon, e.g., a soil type. Thus, (cid:142) nally, whether the geometric
assumptions in this paper limit the use of the method to certain (cid:142) elds of applications
should be investigated.

Acknowledgments

Lemonia Ragia, University of Bonn, produced the case example for this paper,
based on a data set of DeTeMobil, Bonn. We acknowledge the permission to use

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 E
Uncertain topological relations between imprecise regions

429

this data set. The author would like to thank two anonymous reviewers for their
valuable comments. This work would have never been possible without the long
discussions with Wolfgang Fo¨ rster, University of Bonn. He taught me to think
scienti(cid:142) cally.

References
Altman, D., 1994, Fuzzy set theoretic approaches for handling imprecision in spatial analysis.

International Journal of Geographical Information Systems, 8, 271–289.

Baarda, W., 1967, Statistical Concepts in Geology, Vol. 2 (Delft: Netherlands Geodetic

Commission).

Caspary, W., and Scheuring, R., 1992, Error-bands as measures of geometrical accuracy. In

Proceedings of ‘EGIS 92’ (Utrecht: EGIS Foundations), pp. 226–233.

Chrisman, N. R., 1982, A theory of cartographic error and its measurement in digital databases.
In Proceedings of Auto-Carto 5 (Falls Church, Va: American Congress of Surveying
and Mapping), pp. 159–168.

Clementini, E., and Di Felice, P., 1996, An algebraic model for spatial objects with indeterm-
inate boundaries. In Geographic Objects with Indeterminate Boundaries, edited by
P. A. Burrough and A. U. Frank (London: Taylor & Francis), pp. 155–169.
Cohn, A. G., and Gotts, N. M., 1996, The ‘egg-yolk’ representation of regions with indetermin-
ate boundaries. In Geographic Objects with Indeterminate Boundaries, edited by
P. A. Burrough and A. U. Frank (London: Taylor & Francis), pp. 171–187.
David, B., Herrewegen, M. V. D., and Salge`, F., 1996, Conceptual models for geometry
and quality of geographic information. In Geographic Objects with Indeterminate
Boundaries, edited by P. A. Burrough and A. U. Frank, ‘European Science Foundation’
(London: Taylor & Francis), pp. 193–206.

Egenhofer, M. J., 1989, Spatial Query Languages, Ph.D. thesis, University of Maine.
Egenhofer, M. J., 1993, A model for detailed binary topological relationships. Geomatica,

47, 261–273.

Egenhofer, M. J., and Al-Taha, K. K., 1992, Reasoning about gradual changes of topological
relationships. In ‘T heories and Models of Spatio-T emporal Reasoning in Geographic
Space’, edited by A. U. Frank, I. Campari and U. Formentini, L ecture Notes in
Computer Science 639 (Berlin: Springer-Verlag), pp. 196–219.

Egenhofer, M. J., and Franzosa, R. D., 1991, Point-set topological spatial relations.

International Journal of Geographical Information Systems, 5, 161–174.

Egenhofer, M. J., and Herring, J. R., 1991, Categorizing binary topological relationships
between regions, lines, and points in geographic databases, Department of Surveying
Engineering, University of Maine, Orono, ME.

Egenhofer, M. J., Clementini, E., and Di Felice, P., 1994, Topological relations between
regions with holes. International Journal of Geographical Information Systems, 8,
129–142.

Fisher, P., 1993, Algorithm and implementation uncertainty in viewshed analysis. International

Journal of Geographical Information Systems, 7, 331–347.

Galton, A., 1994, Perturbation and dominance in the qualitative representation of continuous
state-spaces, Technical Report 270, Department of Computer Science, University of
Exeter, Exeter.

Gu¨ lch, E., 1997, Application of semi-automatic building acquisition. In Automatic Extraction
of Man-Made Objects f rom Aerial and Space Images, edited by A. Gru¨ n (Basel:
Birkha¨user), pp. 129–138.

Hunter, G. J., and Goodchild, M. F., 1996, A new model for handling vector data uncertainty
in GIS. Journal of the Urban and Regional Information Systems Association, 8, 51–57.

Koch, K. R., 1987, Parameterscha¨tzung und Hypothesentests, 2 edn (Bonn: Du¨mmler).
Lantuejoul, C., 1978, La squelettisation et son application aux mesures topologiques des
mosaiques polycristallines, Ph.D. thesis, Ecole National Superieure des Mine de Paris.
Molenaar, M., 1998, An Introduction to the T heory of Spatial Object Modelling for GIS

Papoulis, A., 1991, Probability, Random Variables, and Stochastic Processes, 3rd edition (New

(London: Taylor & Francis).

York: McGraw-Hill ).

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 430

Uncertain topological relations between imprecise regions

Perkal, J., 1956, On epsilon length. Bulletin de l’Academie Polonaise des Sciences, 4, 399–403.
Ragia, L., and Winter, S., 1998, Contributions to a quality description of areal objects in
spatial data sets. International Archives of Photogrammetry and Remote Sensing, 32,
479–486.

Randell, D. A., Cui, Z., and Cohn, A., 1992, A spatial logic based on regions and connection.
In T hird International Conference on the Principles of Knowledge Representation and
Reasoning, edited by R. Brachmann, H. Levesque and R. Reiter (Los Altos, CA:
Morgan-Kaufmann), pp. 165–176.

Serra, J., editor, 1982, Image Analysis and Mathematical Morphology, Vol. 1 (London:

Academic Press).

Weidner, U., and Fo¨ rstner, W., 1995, Towards automatic building extraction from high-
resolution digital elevation models. ISPRS Journal of Photogrammetry and Remote
Sensing, 50, 38–49.

Winter, S., 1996, Unsichere topologische Beziehungen zwischen ungenauen Fla¨chen, Ph.D.
thesis, Landwirtschaftliche Fakulta¨t der Rheinischen Friedrich-Wilhelms-Universita¨t
Bonn.

Winter, S., and Bittner, T., 1999, Hierarchical topological reasoning with vague regions. In
Proceedings of the International Symposium on Spatial Data Quality, edited by W. Shi,
M. F. Goodchild and P. F. Fisher (Hong Kong: Department of Land Surveying and
Geo-Informatics, The Hong Kong Polytechnic University), pp. 555–565.

Wolf, H., 1975, Ausgleichungsrechnung (Bonn: Du¨ mmler).
Worboys, M., 1998, Imprecision in (cid:142) nite resolution spatial data. GeoInformatica, 2, 257–279.
Worboys, M. F., and Bofakos, P., 1993, A canonical model for a class of areal spatial objects.
In Advances in Spatial Databases, edited by D. Abel and B. C. Ooi (Berlin: Springer-
Verlag), Lecture Notes in Computer Science 692, pp. 36–52.
Zadeh, L. A., 1965, Fuzzy sets, Information and Control, 8, 338–353.

Downloaded by [Duke University Libraries] at 09:46 11 October 2014 