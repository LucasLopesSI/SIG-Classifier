This article was downloaded by: [Pennsylvania State University]
On: 18 August 2012, At: 06:00
Publisher: Taylor & Francis
Informa Ltd Registered in England and Wales Registered Number:
1072954 Registered office: Mortimer House, 37-41 Mortimer Street,
London W1T 3JH, UK

International Journal of
Geographical Information
Science
Publication details, including instructions for
authors and subscription information:
http://www.tandfonline.com/loi/tgis20

Geometric probability and
GIS: some applications for
the statistics of intersections
Ashton M. Shortridge & Michael F. Goodchild

Version of record first published: 10 Nov 2010

To cite this article: Ashton M. Shortridge & Michael F. Goodchild (2002):
Geometric probability and GIS: some applications for the statistics of
intersections, International Journal of Geographical Information Science, 16:3,
227-243

To link to this article:  http://dx.doi.org/10.1080/13658810110099099

PLEASE SCROLL DOWN FOR ARTICLE

Full terms and conditions of use: http://www.tandfonline.com/page/
terms-and-conditions

This article may be used for research, teaching, and private study
purposes. Any substantial or systematic reproduction, redistribution,
reselling, loan, sub-licensing, systematic supply, or distribution in any
form to anyone is expressly forbidden.

The publisher does not give any warranty express or implied or make
any representation that the contents will be complete or accurate or
up to date. The accuracy of any instructions, formulae, and drug doses
should be independently verified with primary sources. The publisher
shall not be liable for any loss, actions, claims, proceedings, demand, or

costs or damages whatsoever or howsoever caused arising directly or
indirectly in connection with or arising out of the use of this material.

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 int. j. geographical information science, 2002
vol. 16, no. 3, 227± 243

Research Article

Geometric probability and GIS: some applications for the statistics of
intersections

ASHTON M. SHORTRIDGE
Department of Geography, Michigan State University, East Lansing,
MI 48824-1115, USA
e-mail: ashton@msu.edu

and MICHAEL F. GOODCHILD
National Center for Geographic Information and Analysis, Department of
Geography, University of California, Santa Barbara, CA 93106, USA

(Received 16 July 1999; accepted 2 August 2001)

Abstract. This paper identi(cid:142) es analytical and empirical methods for determining
the probability that lines and areas intersect tiles in a regular tessellation. Such
intersections are common in geographical information systems (GIS) applications.
Knowledge of intersection probabilities is valuable in many instances, including
estimating complexity and time required to process a distance or viewshed opera-
tion, developing optimal tiling schemes for national georeferencing systems, precal-
culating the number of map sheets a spatial feature may occupy, and identifying
appropriate cell resolutions for vector-to-raster conversions. BuŒon’s Needle-type
solutions from the (cid:142) eld of geometric probability provide the framework for
deriving probabilities for lines. Probabilities for simple areas like rectangles and
circles are derived using geometric techniques and illustrated using hypothetical
examples. Employing such probabilities in spatial analysis may yield more rigor-
ous and theoretically informed results from GIS analysis,
leading to better
decisions and greater insight into spatial phenomena.

1.

Introduction
Mapping is a divide-and-conque r activity. Establishing the region to be mapped,
identifying the spatial resolution at which phenomena will be measured, and eŒec-
tively storing and retrieving information all involve partitioning space. Most spatially
referenced information is measured or stored in tiles of some regular tessellation
covering a projected portion of the Earth’s surface (Boots 1999). These tiles might
be quadrats in an ecological study region, square cells in a raster map, rectangular
sheets in a map series, spatial partitions of a large geographical database, or zones
in a georeferencing system. National grid systems like that used in the UK have
been proposed for the USA, and non-rectangula r global tessellations have also been
developed (Goodchild 1989).

The intersection of one spatial feature with another is a fundamental geographical
operation. A particular, though still quite general, instance of intersection occurs

Internationa l Journal of Geographica l Informatio n Science
ISSN 1365-881 6 print/ISSN 1362-308 7 online © 2002 Taylor & Francis Ltd
http://www.tandf.co.uk/journals
DOI: 10.1080/13658810110099099

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 228

A. M. Shortridge and M. F. Goodchild

when one of the features is a tile in a regular tessellation, and the other is a straight
line or area. Examples include: calculation of distance between two points referenced
on the UK National Grid; determination of the number of US Geological Survey
7.5’ quadrangle map sheets required to cover a speci(cid:142) c watershed; and rasterization
of a vector landcover map. In such instances, the probability that a feature will
extend beyond a single tile in the tessellation is of interest. This paper develops a
general framework for determining this probability for straight lines and areas.

Linear features may be short or long relative to the rectangular tiles upon which
they are overlain. For short lines, the probability of intersecting a single tile boundary
is useful. For long lines, the expected number of tiles intersected, along with the
standard deviation, is useful. In the case of tile-area intersection, either the probability
of boundary intersection or the probability of overlapping the central point of a tile
may be important. Probabilities for lines are dependent on line length relative to tile
size, while probabilities for areas are dependent upon both feature size and shape
relative to tile size. To illustrate the relevance of such probabilities to GIS applica-
tions, consider two example problems. The (cid:142) rst involves distance calculation on the
UK National Grid, and the second involves conversion of vector landcover maps
to raster grids.

The Ordnance Survey’s National Grid, 100 km on a side, overlies a map of the
UK, projected in UTM (Maling 1980, pp. 20–23, 223–224 for more on the UK
National Grid ). Each zone in the grid employs a Cartesian reference system (units
essentially in metres) with its own local origin. A reasonable operation on data
stored in this system is the calculation of distance between two points. Ignoring
projection distortion, this is trivial when the locations are in the same zone. However,
the calculation becomes more complex when the points are located in diŒerent zones.
In other instances, when the zones have diŒerent projections (e.g. the UTM system),
the task of calculating between-zone distances may be even more onerous. For such
problems, it is useful to determine the probability that two locations separated by a
distance d are located in the same zone. This probability, as a function of d, may be
practically employed to calculate the expected time to compute the distance opera-
tion. When the number of operations to be performed is very large, as is frequently
the case for real-world implementations, such an estimate is valuable.

A common GIS application is the conversion of vector landcover maps to a
raster database. A variety of potential encoding rules exist; here the encoding rule
chooses the class occupying the central point of each raster cell. There is of course
a tradeoŒbetween precision and data volume; coarse cell resolution leads to smaller
and more tractable datasets at the cost of information loss. To what degree can this
loss be estimated in advance of the procedure? For example, what is the probability
that a landcover patch of a speci(cid:142) c size is captured by raster encoding at a speci(cid:142) c
cell resolution? This is a speci(cid:142) c case of a more general problem: the probability
that a spatial feature will intersect at least one central point of a tile in a regular
tessellation. Foreknowledge of such probabilities may be employed to identify ideal
cell sizes for the application.

Solutions for these sorts of problems appear to be under-reported in recent GIS
literature, though their mathematical underpinnings are identi(cid:142) able in texts on
geometric probability and computational geometry (Solomon 1978, Klain and Rota
1997). This is unfortunate, given the power of such solutions to characterize the
complexity of GIS algorithms (e.g. the UK Grid distance calculation example
described earlier) and thereby estimate their e(cid:141) ciency. Several works have employed

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 Geometric probability and GIS

229

BuŒon’s Needle framework to models of migration and travel distances. Rogerson
(1990) developed intraregional migration distance models; the probability that a
move of a given distance will not cross a regional boundary was estimated under
several scenarios. Kirby (1997) considered trip surveys and the probability of
undercounting trips that did not cross survey boundaries.

Several works in previous decades have looked at related problems in vector-
raster conversion. Switzer (1975) determined the probability that a randomly chosen
point within a cell was misclassi(cid:142) ed as a function of its distance from the centre
point. He showed that this probability is a product of the complexity of the vector
polygons and the density of the sampling network. Goodchild (1980) summarized
and extended research on area estimation accuracy and adjusted the parameters of
the Switzer model based on a fractal model of boundary complexity. This approach
was primarily concerned with the relationship between grid resolution and map
boundary complexity, which is beyond the scope of the present work. An alternative
to the Switzer and Goodchild approaches was presented by Bregt et al. (1991). This
method rasterizes the vector map both at a very (cid:142) ne resolution and at a set of
coarser resolutions, and models the diŒerence as a function of the boundary index
(a measure of linear complexity). Bregt et al. reported very strong linear relationships
between rasterizing error and the boundary index, indicating that the boundary
index could be used to calculate rasterizing error. A summary of this research appears
in Burrough and McDonnell (1998). Rasterizing error is a speci(cid:142) c application area
for intersection probability, and the third section of this paper will focus on vector
to raster issues.

Research has also focused on geometric and statistical models of line length and
area calculation. Ahuja and Schachter (1982) explored mathematical models for
characterizing images. They presented BuŒon’s Needle-type solutions to derive inter-
section probabilities for each of the three regular tessellations (squares, hexagons,
and equilateral triangles) . They also demonstrated the utility of needle drops to
estimate auto- and cross-correlation statistics for binary images. Maling (1989)
reported on several applications of geometric probability for manual calculation of
line length and area measurement in cartometry. Maling’s extensive treatment of
area estimation via point-counting methods is of particular relevance here. In general
this paper extends the relevance of intersection probabilities to a variety of GIS
primitives, and illustrates their utility for a range of spatial applications.

The next section presents solutions for the intersection of straight lines on tiles
in a tessellation. These lines could be actual features or could represent the relation-
ship between two points. Section 3 covers intersection probabilities for areas.
Probabilities of simple areas to intersect tile boundaries are presented (cid:142) rst. Then,
probabilities for simple areas to intersect tile central points are covered. Section 4
discusses the utility of such solutions for GIS, proposes extensions, and draws
conclusions.

2.

Intersection probabilities for linear features
Geometric probability is a branch of mathematics that is concerned with the
probabilities associated with geometric con(cid:142) gurations of objects. Among the most
famous of these applications is the BuŒon’s Needle problem. The eighteenth-century
French naturalist BuŒon conceived of the problem while considering a popular game
of chance in which a stick was thrown upon a tile (cid:143) oor. The problem continues to
appeal to students of mathematics for its variety of elegant solutions.

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 230

A. M. Shortridge and M. F. Goodchild

The classic BuŒon’s Needle problem and its solution are as follows. Parallel,
equidistant lines are spaced s units apart in the plane. A straight needle of length l,
where l<s, is dropped onto this plane at random. The probability that the needle
will intersect one of the lines is:

P 5

2l
p s

(1)

Many clever proofs for this solution and for extensions to the classic problem
have been developed over the years and may be found in several sources, including
Uspensky (1937), Solomon (1978), and Klain and Rota (1997).

A variation of the classic BuŒon’s Needle problem is of particular interest. In
this variation, the parallel lines of the original problem are replaced by a rectangular
matrix of square cells s units on a side. The ‘needle’, a straight line segment of length
l, may also be regarded as two point locations separated by distance l. Two distinct
problems exist. In the (cid:142) rst, l<
s, and the probability of the points lying in diŒerent
cells is desired. In the second, l >s 2, and here the expected number of cells inter-
sected by a straight segment of length l is desired. The next paragraphs describe the
solution to the (cid:142) rst problem, while the second is treated in section 2.2.

2.1. T he ‘short needle’

When the distance between two points is smaller than the grid cell resolution,
and the grid is oriented independently of the location of the points, the case is known
as the Laplace extension of the BuŒon problem (Solomon 1978). Figure 1 presents
this case. The position of the needle is determined by the two coordinates x, y of its
midpoint within a grid cell and its angle h relative to the vertical axis of the grid.
The domain comprises all possible values of x, y, and h is a parallelepiped volume
with sides:

0<x<

s;

0<y<

s;

0<h< p

The volume V of this domain is ps2 . The volume of the domain representing

needle positions entirely within the grid cell is:

p/2

v 5 2P

0

(sÕ

lcosh)(sÕ

lsinh ) dh

(2)

Figure 1. Geometric representation of the short needle (l<s) problem.

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 Geometric probability and GIS

231

Integrating and dividing by the domain volume V gives the probability 1Õ P of

both points falling in the same cell:

(3)

(4)

(5)

(6)

1Õ P 5 1Õ

4lsÕ

l 2

p s2

P 5

4lsÕ

l2

p s2

P 5

3
p

P 5

l 2

2l(a1

b)Õ
p ab

So the probability of the points falling in separate cells is:

Note that, when s 5

l, the probability of intersection simpli(cid:142) es to:

The solution for the more general case of a rectangular tiling with sides a and b,

provided in detail in Uspensky (1937), is:

where P is the probability of a needle of length l (l<a< b) intersecting a tile boundary.
It is straightforward to prove that, for a rectangular tessellation of any constant tile
area, the optimal ratio a:b to minimize P is 1:1; that is, tiles should be square.

Equations 4–6 are of relevance for geographical problems that involve the overlay
of grids or rasters on point and line data. In some instances it may be desirable to
maximize the number of intersections between lines and tiles. These problems include
developing quadrat grids for plant species surveys, trip length studies (Kirby 1997),
point interpolation to raster grids, and any spatial modelling eŒort using GIS
operations to convolve raster and vector data. In such cases, a primary concern is
that point to point interactions are missed owing to the coarseness of the quadrat
coverage. Kirby (1997) investigated the speci(cid:142) c application of this case to transporta-
tion surveys, but the problem is more general.

In other instances, the primary concern may be that the line does not cross a tile
boundary. Consider for example the Ordnance Survey’s National Grid for the UK.
The UK, projected in Transverse Mercator, is overlain with tiles 100 km on a side
to enable quick reference of feature locations. Calculation of the distance between
an origin and destination is trivial
if both are in the same tile. However, the
calculation becomes more complex if boundaries must be crossed (Ordnance Survey
1998). Figure 2 plots trip distance against the probability that the trip crosses a tile
boundary. From this graph it can be seen for example that the probability of crossing
a grid boundary increases beyond 0.5 when distance is 45 km. This (cid:142) gure also
illustrates another use for equations 4–6: in the development of appropriate grid or
cell resolutions for speci(cid:142) c geographical applications. For example, raster cell size
can be chosen so that on average 95 % of point pairs separated by some distance l
fall in the same cell.

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 232

A. M. Shortridge and M. F. Goodchild

Figure 2. Probability of two points a given distance apart falling in diŒerent UK National
Grid zones.

Equations 4–6 may also be employed to estimate computing time for determining
distance, if time is linear. Let t1 equal computational time when both points are in
>t1) equal computational time when the points are
the same cell, and t2 (where t2
in diŒerent cells. Then:

t* 5 E[time to solve the problem]

t1 3 P[both points are in the same cell ]
t2 3 P[points are in different cells]

Knowledge of t* is useful when the spatial application involves a very large
number of point to point distance calculations within a dataset partitioned into tiles.
In such cases the estimate may simply be employed to calculate completion time, or
it may indicate whether additional resources or operations are required to accom-
plish the operation more rapidly (e.g. allocation of additional processors or data
reprojection to a common format).

2.2. T he ‘long needle’

When l>

s 2, the probability that the needle intersects a tile boundary is 1. Of
interest is the expected number of tiles intersected by the needle. The number of
intersected tiles depends on the orientation of the needle relative to the grid (angle h,
ranging from 0 to p) and the position of one endpoint within its tile. The following
discussion ignores eŒects arising from variation in the position of the endpoint.
Mantel (1953) notes that this will have no eŒect on the expected number of tiles
intersected, but will increase the standard deviation slightly, particularly for small l.
For any particular angle h, the long needle intersects l · |sin h | vertical tiles and
l · |cos h| horizontal tiles (Mantel 1953). If the angle is allowed to vary from 0 to p,
the expected number of tile intersections is:

(7)

(8)

E(i ) 5

p/2

2

pP

0

lsin h
s

lcos h
s

dh

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 5
1
1
233

(9)

(10)

(11)

(12)

(13)

Geometric probability and GIS

The integration is solved:

E(i ) 5

4l
p s

s(i )2 5 E(i 2 )Õ E(i)2

Also of interest is the standard deviation for E(i ). The variance s(i )2 may be

calculated (Mantel 1953):

where:

E(i 2 ) 5

(sinh1

cos h)2 dh 5

p/2

2

pP

0

l 2
s2

l 2

s2A11

2

pB

E(i )2 5

16l 2
p2 s2

Therefore the standard deviation s(i ) is:

s(i) 5 Sl 2
s2A11

2
p

16

p2B

Equations 9 and 13 are useful for estimating the number of intervening cells
between two points located l units apart in a random direction. They have application
for visibility calculation on raster digital elevation models. The problem of determin-
ing visibility on raster data models is well known; a number of papers pay particular
attention to the eŒect of the data model on the operation (Yoeli 1985, Fisher 1993,
Sorensen and Lanter 1993). Both binary and partial visibility algorithms test each
intervening cell between the observation and the target. The larger the number of
tests, the greater is the chance that the target is partially or completely obscured,
subject of course to the con(cid:142) guration and variability of the terrain. The ‘long needle’
solution presented in this section provides a way to assess the expected number and
standard deviation of checks prior to processing the digital elevation model itself.
This is useful for estimating time and resources required to complete the visibility
operation.

3.

Intersection probabilities for area features
Two diŒerent classes of intersection probability problems for areas are discussed
in this section: probabilities of intersecting boundaries and probabilities of inter-
secting gridded points. Section 3.1 covers boundary intersection probabilities for
rectangles and circles. Boundary intersection probabilities may be used to estimate
the number of map sheets a feature of a given size is likely to occupy. Alternatively,
the probabilities could be employed to identify an optimal tile size for a spatial
domain of interest.

We derive point intersection probabilities for simple polygons in section 3.2. A
diŒerent set of probabilities can be identi(cid:142) ed for the intersection of rectangles and
circles with regularly gridded points. Such probabilities are of particular application
in vector-to-raste r conversion operations. If cell classi(cid:142) cation is based on the central
point rule, the equations derived here report the probability of ‘missing’ a polygon
and thereby misreporting area. They have potential for identifying appropriate cell
size for conversion and of estimating the impact of positional uncertainty on the
classi(cid:142) cation process.

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 Õ
234

A. M. Shortridge and M. F. Goodchild

3.1. Boundary intersection probabilities for rectangles and circles

A certain ‘law of geography’ states that everything of geographic interest lies on
the border of two or four map sheets (Clarke 1995). This truism is all too familiar
to anyone who has used multiple map sheets or images to identify a lake, watershed,
or other area of interest. In fact, given the dimensions of a rectangular tile in a
regular tessellation, the probability that a rectangular or circular feature will intersect
a tile boundary is straightforward to calculate. This simple feature might be the area
of interest itself, or it might represent a bounding box, radius about the area’s central
point, or an inscribed circle of a polygon. The probability of intersecting exactly
two, three, or four separate tiles may also be derived.

First consider a rectangular tiling of the plane with tile dimensions a and b.
Positioned within this plane is a rectangular area with sides w and h oriented to the
tile, where 0<w< h<a< b. It is clear that position of the rectangular area is solely
a function of the placement of the centre of the rectangle within a single tile.

The shaded area in (cid:142) gure 3 represents that portion of the tile that the rectangle
centre must fall in for it to intersect a tile boundary. The probability for this to
occur is equal to the ratio of the area of the shaded region to the total area of the
tile, that is:

It is also possible to calculate the probability that the rectangle intersects exactly
four tiles. For this to occur, the centre point of the rectangle must fall in the darkest
shaded region of (cid:142) gure 3. The probability P4 is equal to the ratio of the area of this
dark region to the total tile area:

For the rectangle to intersect exactly two tiles, its centre must lie in the lightly
is equal to the ratio of the area of the

shaded region in (cid:142) gure 3. The probability P2
lighter grey region to the total tile area:

ah1

P 5

bwÕ wh
ab

P4 5

wh
ab

P2 5

ah1

2wh

bwÕ
ab

(14)

(15)

(16)

Figure 3.

If the centre of a rectangle wh falls in the darkest zone it intersects four tiles. If it
falls in the lighter grey zone it intersects two tiles. Probabilities for these events are
given in section 5.1.

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 Geometric probability and GIS

235

Now we turn to similar problems for a circular area instead of a rectangle.
Consider the ‘small’ circle case, in which the circle (cid:142) ts entirely within a single tile
with sides 0<a< b. As with the rectangle, the circle’s location is determined solely
by the location of its centre, which must fall within a single tile. The probability of
intersection is a function of tile size and the radius of the circle. Figure 4 portrays
this case.

Consider (cid:142) rst the probability that a ‘small’ circle with radius r, r< a intersects at
least two tiles. The shaded region of (cid:142) gure 4(a) represents that portion of the tile
within which the circle centre must fall for it to intersect more than a single tile. The
proportion of this shaded area to the total area of the tile total is:

where a and b are the sides of the tile.

The probabilities of

intersecting exactly two, three, or four tiles for a small

circle are:

P 5

2r(a1

2r)

bÕ
ab

P2 5

2r(a1

4r)

bÕ
ab

P3 5

r2 (4Õ p)
ab

P4 5

p r2
ab

(17)

(18)

(19)

(20)

respectively. The numerator in each case represents the corresponding shaded area
of the tile in (cid:142) gure 4(a).

Now the same probabilities are considered for a ‘big’ circle. Figure 4(b) shows
diŒerently shaded regions in which the centre of a large circle may fall for it to

Figure 4. Two cases for a circle with radius r intersecting tile boundaries. If the centre of the
circle falls in the darkest grey zone it will intersect four tiles. If it falls in the lighter
grey zone it will intersect three tiles. If it falls in the lightest grey zone it will intersect
two tiles. If it falls in the white zone it lies within the tile. Probabilities for these events
are given in section 3.1.

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 236

A. M. Shortridge and M. F. Goodchild

intersect exactly two, three, or four tiles. P(i2), the ratio of the lightest area to the
total area of the tile, is straightforward to calculate:

P(i2) 5 2Õ

2r(2a1

2r)

bÕ
ab

Finding P (i3), the probability of intersecting three tiles, is more di(cid:141) cult. The
area in which the circle centre may fall consists of a rectangle in the centre and four
complex shapes represented as X in (cid:142) gure 4(c). From (cid:142) gure 4(c), it is clear that the
polygon X is a portion of the area of a square with side length r outside of the
quarter circle with radius r and centre at the corner of the square. This area is:

A portion of this area is not part of Y , however. This is the darkly shaded area
r), but not including the region W in (cid:142) gure 4(c).

X in a rectangle with sides r, rÕ
From the (cid:142) gure it is apparent that angle h in degrees is:

(aÕ

The total area of the wedge Aw with angle h is therefore:

The portion of this wedge within aÕ

r of the corner is a triangle with area At:

and so the area W beyond aÕ

r is:

and the area Y is:

The area X of the rectangle with sides r, rÕ

r) not inside the circle is therefore:

r2Õ

pr2
4

h 5 arccos

aÕ

r

r

Aw 5

h
360

* pr2

rsinh*(aÕ

r)

At 5

2

W 5 AwÕ At
(aÕ

X 5

(2r2 Õ

ar)Õ W

Y 5 Ar2 Õ

pr2

4 BÕ X

The probability that the circle falls in exactly three tiles, P(i3), is equal to the

area of the central rectangle plus 4Y over the total area of the tile, that is:

(2rÕ

a)(bÕ

2r)1

P(i3) 5

4CAr2 Õ

ab

pr2

4 BÕ XD

Finally, the probability P(i4) that the circle will intersect four tiles is equal to:

P(i4) 5 1Õ

(P(i2)1 P(i3))

These equations can be used to calculate the probability that a particular feature
will overlap two, three, or four map sheets, without the location of the feature relative

(21)

(22)

(23)

(24)

(25)

(26)

(27)

(28)

(29)

(30)

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 Geometric probability and GIS

237

to the tile being known. The equations could also be employed to develop spatial
data tiling schemes with known probabilities of capturing features of a speci(cid:142) c size
within a single tile. In some instances the feature location may be known, while the
tile position is not. The feature is a rectangular or circular region of interest, while
the tiles are irregularly distributed remotely sensed images such as aerial photographs
or other data from airborne sensors, stored in an archive. In such a case it may be
useful to develop a probabilistic notion of the number of tiles intersecting the feature
to calculate the cost of obtaining the necessary scenes and the eŒort involved in
merging and processing the images.

Suppose instead we are interested in data from a very large spatial database that
is partitioned into tiles to facilitate information retrieval and processing. Consider
the global elevation dataset GTOPO30 (USGS 1996). Elevations are stored on a
rectangular grid with 30 arc second spacing, essentially as a Plate Care´e projection.
The data are partitioned into 33 tiles, 27 of which cover the Earth from 60ß South
to the North Pole. These 27 tiles each cover 40ß of longitude and 50ß of latitude.
The tile covering Greenland, eastern Canada and the northeastern USA, for example,
is a 15-megabyt e compressed tar (cid:142) le.

Data for regional applications may occupy one or more tiles of this data set.
From a regional user’s perspective, the fewer tiles required the better, since they are
large and place signi(cid:142) cant processing demands on a typical GIS. For example, the
3 4ß rectangles in Plate Care´e; imagine
states of Wyoming and Colorado are both 7ß
we are interested in constructing a GTOPO30-based DEM for either one of these
states. Colorado intersects a tile boundary, so developing its DEM would require
more resources and eŒort. Disregarding the problem of characterizing tiles and areas
in degrees, one can characterize the probability that a randomly placed rectangular
or circular region of any particular size intersects more than one GTOPO30
tile. Figure 5 graphically represents the case for a square region intersecting the

Figure 5. Dark line is the probability a square tile will intersect more than one tile in the
GTOPO30 tesselation. Light line is the probability it intersects four tiles.

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 238

A. M. Shortridge and M. F. Goodchild

GTOPO30 tesselation North of 60ß South. The probability of intersecting two tiles
increases rapidly as the square side increases; at about 13ß
this probability reaches
50 %. The probability of intersecting four tiles is 50 % for a square side of just
under 32ß .

3.2. Gridpoint intersection probabilities for rectangles and circles

When converting vector class data to raster, a classi(cid:142) cation rule must be used to
assign a class value to each raster cell. One possibility is to use the class of the
polygon occupied by the central point of the cell, a point-counting method of area
measurement (Maling 1989). A concern with such an approach is that small polygons
may ‘disappear’ in the conversion process because they fail to overlap any cell centre
point. The probability that a polygon is missed during conversion to raster is clearly
a function of raster cell size and polygon shape and area; this is a subset of the
mixed pixel problem, in which multiple classes occupy single grid cells (Burrough
1998). This probability can be calculated for simple polygon forms like rectangles
and circles.

Consider a raster comprised of rectangular cells with sides a and b. These cells
will be classi(cid:142) ed via polygon overlay according to the central point rule described
above. If we regard only the central points of all the cells, they form a mesh of
gridpoints with spacing a and b between points. A randomly positioned rectangle
with sides w and h oriented to the grid is placed upon it, where 0<w< h<a< b. It
is clear that the position of the rectangle is solely a function of the placement of the
centre of the rectangle within a ‘tile’ of the mesh. Figure 6 presents this case.

The shaded area in (cid:142) gure 6 represents that portion of the square in which the
rectangle centre must fall for it to cover a cell centrepoint. If the centre lies in the
white portion of the square, the rectangle will be ‘missed’ in the conversion to raster.
The probability that the rectangle will intersect a point is equal to the ratio of the
area of the shaded region to the total area of the square, that is:

P 5

wh
ab

(31)

Figure 6. Geometric representation of the probability of rectangle wh intersecting a grid
point mesh with spacing a and b.

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 Geometric probability and GIS

239

This is equivalent to equation 15, which indicates the probability that a rectangle
will intersect exactly four tiles. Suppose w >a. In that case the probability of intersec-
tion is solely a function of h and b, and the probability of intersection is:

P 5

h
b

P 5

p r2
s2

Now consider the probability that a circle with radius r overlaps a square grid
mesh with spacing s between cell centrepoints. As depicted in (cid:142) gure 7(a), the centre
of the circle centre must be located somewhere between the four nearest mesh points,
which form a box around the circle’s centre. To overlap one of these points, the
centre must be located within r of one of the points. Each of the four points therefore
has a quarter-circle ‘zone’, with radius r, within which the centre must be located.

If r<

s/2 the probability of intersection is simply:

If r>s/2 ( but less than s 2/2, at which point the probability of intersection
equals one), the solution is more complex, since portions of the quarter-circle zones
will overlap. Consider a single quadrant, as in (cid:142) gure 7(b). The shaded area is of
interest; because this area is symmetrical about the diagonal, just the area of the
eighth-circle ‘wedge’ farther than s/2 (henceforth called Ax ), subtracted from the
total area of p r2/8, is required. From (cid:142) gure 7(b), it is apparent that angle hw is:

The total area of the wedge Aw with angle hw is therefore:

The area of this wedge within s/2 of the grid point (At) is:

and so the area Ax beyond s/2 is:

The total non-overlappin g area (Ano) within r of the corners is therefore:

and the probability of the circle intersecting one of the grid mesh points is:

hw 5 arccos

s
2r

Aw 5

* arccos

r2
2

s
2r

At 5

s
2

2

2B

*Sr2Õ A s

2

Ax 5 AwÕ At

Ano 5 8Ap r2

8 BÕ Ax

P 5

Ano
s2

(32)

(33)

(34)

(35)

(36)

(37)

(38)

(39)

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 240

A. M. Shortridge and M. F. Goodchild

Figure 8 illustrates the probability of intersection of a circle on a grid mesh with
the radius expressed as a proportion of the mesh spacing. The curve is S-shaped,
indicating that increasing rate of intersection up to a radius of about 0.5 the mesh
spacing. For example, the probability for a circular polygon with radius 0.4
intersecting a gridpoint is only 0.5, while one of 0.5 has a probability of 0.79.

The probabilities presented in this section relate to a variety of application
problems in GIS modelling and analysis. One set of questions relates to identifying
the appropriate raster size for a particular application. For example, what digital
elevation model cell resolution is required to capture 90 % of terrain features 50 m
in diameter? (46.7 m).

Figure 7. Geometric representation of the probability of a circle with radius r intersecting a
grid point mesh. Shaded region indicates that portion of the tile the circle centre must
fall in to intersect a cell.

Figure 8. Probability of intersection as circle radius approaches grid spacing. Lightly shaded
line is calculated separately.

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 Geometric probability and GIS

241

Often tile resolution is (cid:142) xed. A scientist may, for example, be employing a Landsat
TM image, for which the spatial resolution of most bands is 30 m. Two diŒerent
questions can be posed. First, given a particular resolution, what is the intersection
probability for a polygon of speci(cid:142) ed size? This is a direct application of equations
31, 33, and 39. For example, what is the probability that a rectangular building
footprint with dimensions 15 m3 20 m intersects a cell centrepoint in a 40 m reso-
lution grid? (Low; if the rectangle is oriented to the grid it is 0.188). Second, given
a particular resolution, what polygon size is possible for intersection to occur at a
speci(cid:142) ed probability? This can be determined indirectly from equations 31, 33, and
39. As an example, one can calculate the size of a soil polygon with a 0.3 probability
of being identi(cid:142) ed in a raster soil map with cell resolution of 30 m. (About 20 m in
diameter, if it is a circle).

4. Discussion and conclusions

The (cid:142) rst portion of this paper reports probabilities for the intersection of lines
and regular tiles in a tessellation. First, the probability of an arbitrarily oriented
s) segment intersecting the tile is derived. Second, the expected number of
‘short’ (l<
tile intersections of an arbitrarily oriented ‘long’ (l>s) segment is identi(cid:142) ed. Each
case has relevance for a variety of GIS applications including distance calculation
in zonal georeferencing systems like the UK’s National Grid and the estimation of
intervening cells in a viewshed operation.

A second set of solutions deals with probabilities for the intersection of simple
areas and regular tiles. Again, two cases are discussed. The (cid:142) rst identi(cid:142) es intersection
probabilities for rectangles or circles and tile boundaries. These probabilities could
be used to develop optimal tile sizes for speci(cid:142) c applications or to estimate the
number of map sheets required to cover an area of interest. The second case identi(cid:142) es
probabilities for the intersection of rectangles and circles with points on a regular
grid. These probabilities are useful
for determining relationships between poly-
gons and raster grids, for example, determining the probability of ‘missing’ small
objects when converting vector data to raster grids, or of misreporting the area of a
particular class.

In the spectrum of activities that comprise the development and use of a GIS,
geometric probability appears to have greatest application in data-modelling
decisions. If critical application speci(cid:142) cations are known (e.g. mean trip distance for
a proposed routing system, or wetland polygon size for a land information system),
then optimal tile sizes can be established. Techniques from geometric probability
also have utility for developing accuracy estimates and data quality statements for
derived data sets.

We see a number of fruitful research directions linking geometric probability

theory to GIS. These are brie(cid:143) y described in the next paragraphs.

This paper has concentrated on intersection problems involving regular square
and rectangular tiles. A great many alternative tessellations are employed in GIS,
however; other regular tessellations employ equilateral triangles and hexagons, while
irregular (triangular and otherwise) tessellations are common in surface models, area
class, and choropleth maps, respectively (Boots 1999). Do analytical methods exist
for some of these tessellations? Can geometric probability inform the selection of
tessellation form and size for more cases than those covered here?

We have assumed throughout that position and orientation of the feature is
random. Geographical position is generally typi(cid:142) ed by spatial autocorrelation.

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 242

A. M. Shortridge and M. F. Goodchild

Location is not random but dependent upon other, nearby features and relationships.
Therefore, the quality and utility of the theoretically derived intersection probability
depends upon the degree to which autocorrelation aŒects the actual position of
randomly chosen features.

A related problem is the location of the needle in the tessellation. In section 2
this location is drawn from a uniform probability distribution. In many instances
needle location is not uniformly distributed, but subject to a more complicated
probability density function. Consider, for example, a classic monocentric urban area
with radially symmetric decline of tra(cid:141) c density from the core (Angel and Hyman
1976). Trip origin and destination in this environment are driven by population
density and their frequencies may be more appropriatel y modelled as exponential
functions of distance from the core. This distribution has important implications for
trip-length survey design, in which maximizing the probability of an intersection is
desirable (Kirby 1997). For line problems generally, alternatives to the uniform
distribution for location are important for developing appropriate tessellation
strategies.

Section 3.2 presents grid intersection probabilities for simple areas—rectangles
and circles. Real-world vector area class datasets (e.g. vegetation cover) consist of
many polygons considerably more complex than rectangles and circles. Typically
the area of a complex polygon is large compared with the raster cell size. However,
the sinuous outline of some polygons, for example those representing riparian zones,
may be such that the polygon class is under-encode d in the raster conversion. The
resulting raster data set misrepresents the true area and location of the class.
Intersection probabilities for these real-world polygons may not have a simple
analytical solution. Monte Carlo simulation is a promising approach for developing
estimates for intersection probability distributions on a case by case basis.

Much GIS functionality is descriptive and atheoretical, with little or no notion
of whether observed quantities or relationships are signi(cid:142) cant. The work in geometric
probability described here provides solid mathematical underpinnings for some
fundamental GIS operations. Solutions for such problems may exist in other literat-
ures, but they may not always have been communicated to the GIS community, or
applied to geographical problems. The introduction of approaches like these may
yield more rigorous and theoretically informed results from spatial analysis, leading
to better decisions and greater insight into spatial phenomena.

Acknowledgments

This work was (cid:142) nancially supported by the National Center for Geographic

Information and Analysis and the National Imagery and Mapping Agency.

References
Ahuja, N., and Schachter, B. J., 1982, Pattern Models (New York: Wiley).
Angel, S., and Hyman, G. M., 1976, Urban Fields (London: Pion).
Boots, B., 1998, Spatial tessellations. In Geographical Information Systems: Principles and
T echnical Issues, 2nd edn, edited by P. A. Longley, M. F. Goodchild, D. J. Maguire
and D. W. Rhind (New York: Wiley & Sons), pp. 503–526.

Bregt, A. K., Denneboom, J., Gesink, H. J., and van Randen, Y., 1991, Determination of
rasterizing error: a case study with the soil map of the Netherlands. International
Journal of Geographical Information Systems, 5, 361–367.

Burrough, P. A., and McDonnell, R. A., 1998, Principles of Geographical Information Systems

(Oxford: Oxford University Press).

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 Geometric probability and GIS

243

Clarke, K. C., 1995, Analytical and Computer Cartography, 2nd edn (Englewood CliŒs:

Fisher, P. F., 1993, Algorithm and implementation uncertainty in viewshed analysis.

International Journal of Geographical Information Systems, 7, 331–347.

Goodchild, M. F., 1980, Fractals and the accuracy of geographical measures. Mathematical

Prentice Hall ).

Geology, 12, 85–98.

Goodchild, M. F., 1989, A hierarchical spatial data structure for global geographic informa-
tion systems. NCGIA Technical Report 89-5, National Center for Geographical
Information and Analysis, University of California, Santa Barbara.

Kirby, H. R., 1997, BuŒon’s Needle and the probability of intercepting short-distance trips

by multiple screen-line surveys. Geographical Analysis, 29, 64–71.

Klain, D. A., and Rota, G.-C., 1997, Introduction to Geometric Probability (Cambridge:

Cambridge University Press).

Maling, D. H., 1980, Coordinate Systems and Map Projections (London: Phillip & Son).
Maling, D. H., 1989, Measurements from Maps: Principles and Methods of Cartometry (Oxford:

Pergamon Press).

Statistics, 24, 674–677.

Mantel, N., 1953, An extension of the BuŒon needle problem. Annals of Mathematical

Ordnance Survey, 1998, Calculating the distance between two points using their National

Grid references. http://www.ordsvy.gov.uk/literatu/info/cr212.html

Rogerson, P. A., 1990, BuŒon’s needle and the estimation of migration distances. Mathematical

Population Studies, 2, 229–238.

Solomon, H., 1978, Geometric Probability. CBMS-NSF Regional Conference Series in Applied

Mathematics 28 (Philadelphia: Society for Industrial and Applied Mathematics).

Sorenson, P. A., and Lanter, D. P., 1993, Two algorithms for determining partial visibility
and reducing data structure induced error in viewshed analysis. Photogrammetric
Engineering & Remote Sensing, 59, 1149–1160.

Switzer, P., 1975, Estimation of the accuracy of qualitative maps. In Display and analysis of

spatial data, edited by J. C. Davis and M. J. McCullagh (London: Wiley), pp. 1–15.

USGS, 1996, DEM/SDTS transfers. In T he SDT S Mapping of DEM Elements (US Dept.

Interior, U S Geological Survey).

Uspensky, J. V., 1937, Introduction to Mathematical Probability (New York: McGraw-Hill ).
Yoeli, P., 1985, The making of intervisibility maps with computer and plotter. Cartographica,

22, 88–103.

Downloaded by [Pennsylvania State University] at 06:00 18 August 2012 