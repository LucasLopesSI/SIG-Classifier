The Cartographic Journal
# The British Cartographic Society 2012

Vol. 49 No. 3

pp. 195–207

August 2012

R E F E R E E D P A P E R

Multidirectional Visibility Index for Analytical Shading
Enhancement

Tomazˇ Podobnikar1,2

1 Faculty of Civil and Geodetic Engineering, University of Ljubljana, Jamova 2, SI-1000 Ljubljana, Slovenia. 2Scientific
Research Centre of the Slovenian Academy for Sciences and Arts, Novi trg 2, SI-1000 Ljubljana, Slovenia
Email: tomaz.podobnikar@fgg.uni-lj.si

A novel method called multidirectional visibility index (MVI) has been developed and verified. The MVI improves
standard cartographic analytical shading with a number of enhancements to topographic detail and prominent structures,
i.e. the portrayal of flat areas in lighter tones, the accentuation of morphologic edges, and the multiscale visualisation of
morphologic terrain features. The procedure requires a digital elevation model (DEM) and involves the following steps:
visibility mask computation; the respective multidirectional altering of the azimuth and elevation angle; the generation of
continuous grid MVIs that indicate upper/lower views, quasi-slope, and relative relief; and an appropriate visualisation of
the relevant MVI as a standalone technique or in combination with standard hill-shaded relief. The modelling parameters
are robust and therefore highly adaptive to different landforms.

Keywords: multidirectional visibility index, relative relief, quasi-slope, digital elevation/terrain model, analytical
shading, enhancement of topographic detail, morphologic edge, generalisation, multiscale visualisation,
image
processing, cartography

INTRODUCTION
Analytical shading is a computer-based method for the
visualisation of landforms. It enables a rapid and accurate
perception of shapes, structures and proportions of terrain
on topographic and thematic maps. Analytical shading
methods are increasingly complex, utilizing local or global
illumination (and reﬂectance) models, with the support of
various techniques to enhance the topographic details
(graphical improvements).

A cartographic visualisation requires standard topographi-
cal rules for landform representation as part of an appropriate
abstraction of reality (Imhof, 1982). The plasticity and
comprehension of three-dimensional landforms by visualisa-
tions in two-dimensional cartography can be efﬁciently
demonstrated using manual — or hand-shading methods.
Wiechel (1878) developed a mathematical shading metho-
dology that used oblique illumination of a diffusely reﬂecting
surface for terrain elevations. Analytical shading, i.e. the
technique adapted to digital computers, was introduced by
Yoe¨li (1967b), who applied a diffuse reﬂection illumination
model to a digital elevation model (DEM). Brassel (1974)
suggested and applied various computational and graphic
procedures — enhancements that were intended to imitate
the complex hand-shading processes. Many methods based
on analytical shading have been developed to implement the
various styles of landform visualisation (Phong, 1975; Horn,

DOI: 10.1179/1743277412Y.0000000012

1981; Imhof, 1982; Zeverbergen and Thorne, 1987;
Peterson, 2002; Jenny and Ra¨ber, 2002; Patterson, 2004;
Jenny and Hurni, 2006; Kennelly, 2008; Leonowicz et al.,
2010).

The fundamental of most analytically shaded models is a
diffuse reﬂection illumination model that applies Lambert’s
cosine law. The reﬂectance is computed by considering the
gradient and its respective parameters with two adjustable
angles — the azimuth and elevation. This standard hill
shading or oblique shading technique is much used in
information systems (GIS) and computer
geographical
graphics since it is easily generated. The required DEM is
recorded in the form of a matrix or grid with a certain
resolution that denotes the dimension of the grid cell, and
in the form of a triangulated irregular network.

Enhanced analytical shading techniques include many
additional elements that consider observation points, the
type of light source, the reﬂectance of particular material,
landform characteristics, artistic aspects, etc. (Brassel, 1974;
Jenny and Ra¨ber, 2002) that deﬁne the quality of the
topographical
solutions
include the following: local light directions (Yoe¨li, 1967a;
Prechtel, 2000; Jenny, 2001); a combination of diffuse and
specular reﬂection (Phong, 1975); cartographic shading
generalisation (Leonowicz et al., 2010); ﬁlling in ﬂat areas
with a bright grey tone; elevation-dependent contrast;

representation. Enhancement

196

The Cartographic Journal

Figure 1. Computation parameters of MVI: Q is azimuth, d is azimuth interval, h is elevation angle

brightening local shadows on the light side of hills and
darkening on the shaded side; sharpening towards topo-
graphic peaks; vertical exaggeration; interpolation between
diffuse reﬂection and aspect-based shading (Jenny and
Hurni, 2006; Kennelly, 2008), etc. Many of the enhanced
analytical shading techniques are widely applicable through
the availability of morphologically high-quality DEMs and
the development of computer hardware and software
capable of handling the graphics.

The aim of this study is to develop an adaptive and
robust method that enables the enhancement of topo-
graphic details in order to improve the analytical shading.
We aim to achieve three goals with the method presented
in this paper: (1) to adjust the appearance of ﬂat areas so as
to present them in a lighter tone than their surroundings;
(2) to accentuate the morphologic edges slightly so as to
appear like the ‘worn out hemlines on jeans’ or the ‘scuffed
off edges of furniture’; and (3) to create a multiscale
terrain visualisation composed of morphologic terrain
features with different levels of detail. These three goals are
important to improve the visual impression and the ability
to depict the morphologic features on analytical shaded
maps. To fulﬁl the visualisation requirements, we propose
a single method called the multidirectional visibility index
(MVI).

THE ALGORITHM OF THE MVI

The procedure for generating the MVIs and the visual
appearances of the key steps are presented and described in
this section.

Procedure for generating the cartographically relevant MVI
The following parameters require deﬁnition in the MVI
technique (Figure 1):

integer;

N d is the azimuth interval5360u/n, where n is an
N Q is the azimuth [0u, 360u] with 0u indicating the
north direction, and with a sequence Q5{0u, d, 2d, 3d,
…, 360u–d};
N h is elevation (altitude) angle [–90u, 90u], where 90u is
pointing to the zenith, 0u to the horizon, and 290u to
the nadir (several h values between 0u and ¡50u can
be chosen);
N r is the catchment (search) radius that denotes the area
around the observation (central) point to be con-
sidered in the computation (r can be infinity in order
to apply a global shading context theoretically).

The procedural steps for generating the MVI are as follows:

1. Compute the visibility mask VM by applying a kind of
viewshed analysis at selected angles (Q, h) for all points
of the DEM as origin of the computation. The
visibilities are computed from an observation point of
the particular grid cell in the DEM, and assigned the
binary attributes {1, 0} within the catchment radius r:
N 1, if the grid cell (observation point) is visible
N 0, if it is not visible

3.

2. Repeat the visibility mask computation applying all
chosen values for parameters Q, h, and r to produce
numerous possible visibility masks VMQ,h,r. The VMs
allow generation of several outputs.
Sum up all visibility masks VMQ (at all chosen angles Q
and at each fixed h and r) to produce a continuous grid
SQ (VMQ):
N upper view: Uh, where h.0u (above the horizon,
N lower view: Lh, where h,0u (below the horizon,

zenith angle), and

nadir angle)

Multidirectional Visibility Index for Analytical Shading Enhancement

197

4. Compute the derivative continuous grids that simu-

late:
N quasi-slope (slope-like): QSh5UhzLh
N relative relief (relative relief-like) or local relief

(Mark, 1975): RRh5Uh – Lh

5. Compute the various MVIs based on a single method,
as composed continuous surfaces that correspond to
selected angles h, using Uh, Lh, QSh, RRh:
N MVI-U5Sh (Uh), MVI-L5Sh (Lh), MVI-QS5Sh
N MVI-x: the arbitrary combinations of Uh and Lh at
selected h and that fulfils all three introductory goals
concurrently

(QSh), MVI-RR5Sh (RRh)

6. Other possible cartographically relevant analytical
shading enhancements with appropriately generated
MVIs:
N an MVI as a universal standalone terrain visualisa-
N an MVI in combination with standard hill shading

tion

or any other enhancement

The values of the proposed parameters can be optimized to
shorten the processing time and to obtain high-quality
outputs. In general, the increment interval d for azimuths Q
is deﬁned heuristically by common sense, where larger
intervals might yield a rougher output. Typically, a limited
number of heuristically chosen elevation angles h are
selected depending on several generalisation criteria in
consideration of the multiscale aspect, the terrain properties
in the study area, and the goals of the visualisation. Too
many and too dense intervals will not improve the output
visualisations. The catchment radius r deﬁnes the strength
of the global inﬂuence of the prominent terrain features.
The MVI-RR and MVI-QS use visibility masks
to
compute relative relief-like and slope-like surfaces, which
are very similar to relative relief and slope surfaces. The
introduced MVIs are isotropic and consequently not
subject to inﬂuence from a speciﬁc azimuth Q. The ﬁnal
MVIs may be normalized to a standardized interval and/or
may be weighted (pondered) concerning different azimuths
Q (Loisios et al., 2007; Kennelly, 2008) or even concerning
different elevation angles h in order to realize anisotropic
MVIs.

The visual appearances of the MVIs
The visual appearances of the proposed MVIs are system-
atically described in the case study. The study area involves
different kinds of landform including plain, hilly, mountai-
nous and karstic areas. It comprises the surroundings of the
Slovenian capital, Ljubljana, including part of the Kamnik
Alps to the north, with its central coordinates 46u109N,
14u309E, covering an area of 11625 km, and using a
DEM of 25 m resolution. The DEM produced from various
data sources by data fusion is morphologically relatively
homogeneous.

The borders of the target study area were carefully
expanded for computing in order to avoid edge effects,

especially when the parameter of the elevation angle h was
around 0u (horizon). The ranges of the parameters for the
MVI technique were empirically chosen, with the azimuth
interval d55u, and consequently n572, the elevation angle
h5{¡1u, ¡2u, ¡5u, ¡10u, ¡25u}, and the catchment
radius r5‘.

All of the MVIs were normalized in order to obtain full
control of the processes. They were therefore stored as
digital
images with grey tone values (greyscale) in the
respective value ranges between 0 (0% illuminated, pre-
sented in black) and 255 (100% illuminated, presented in
white), all with standard linear ramps. The generation
procedures for the MVIs discussed in this paper, however,
are explained with original values.

In Figure 2, the upper views Uh with h5{1u, 2u, 5u, 10u,
25u} and the lower views Lh with h5{–1u, 22u, 25u, 210u,
225u} are presented at intervals [0, 72]. Value 0, presented
in black, denotes areas never visible, while value 72,
presented in white, denotes always-visible areas.

In Figure 3, the quasi-slopes QSh and relative reliefs RRh
are presented where h5{¡1u, ¡2u, ¡5u, ¡10u, ¡25u}.
QSh are in intervals [0, 144]. Value 0, presented in black,
denotes steep quasi-slopes (neither on Lh nor on Uh visible
areas); value 144, presented in white, denotes quasi-plains
(always-visible areas for Uh and for Lh). RRh are in intervals
[–72, 72]. Value 72, presented in black, denotes the lowest
areas or depressions (always-visible areas for Lh and never
for Uh); 0 is presented in grey and denotes transitional or
large ﬂat areas that are equally visible for Uh and Lh; value
72, presented in white, denotes the relative highest or most
exposed areas that are always visible for Uh and never for Lh.
Generally, from the visualisations, the Uh values show
convex topographic details, while the Lh values show
concave details. It is clear from the visualisations of QSh
and RRh that many very small features and prominent
structures are well recognized with h5¡1u and ¡2u for the
ﬂat areas, and with h5¡25u for the steep areas. In contrast,
the visualisations are generalized (low level of detail) with
h5¡1u and ¡2u for the hilly areas and h5¡25u for the ﬂat
areas.

According to the variable terrain roughness, the ﬁnal
MVIs were practically composed from continuous grids
using four selected elevation angles h5{¡2u, ¡5u, ¡10u,
¡25u}. Figure 4 presents the MVI-U in the interval [0,
288], MVI-L [0, 288], MVI-QS [0, 576] and MVI-RR
[2288, 288]. Interpretations of the particular MVIs are
similar to Uh, Lh, QSh and RRh, after the interval values are
divided by number 4 (5the number of continuous grids).

A COMPARISON OF MVIs AND RELATED METHODS

The relevance of the MVIs can be demonstrated by a
comparison with multidirectional
techniques based on
plasticity impression, which can be used to enhance
standard hill-shaded (HS) maps. The ﬁrst group of methods
are isotropic multidirectional approaches
that equally
employ multiple opposite parts of the sky. A potentially
applicable enhancement method is a sky-view factor (SVF).
Every raster cell of the SVF represents a portion of the
visible sky from a certain terrain point (Figure 5). The result

198

The Cartographic Journal

Figure 2. Upper and lower views Uh and Lh for different h values

is interrelated to diffuse irradiation or illumination (sky-
light; Streicher et al., 2004). More precisely, the SVF is the
ratio of the radiation received (or emitted) by a planar
surface to the radiation emitted (or received) by the entire
hemispheric environment (Corripio, 2003). The next poten-
tial method is topographic openness (TO) (Yokoyama et al.,
2002) (Figure 5). There are some methodological relation-
ships between positive openness (TO) and the MVI-U
(upper view), and between negative openness (TO) and the
MVI-L (lower view). The main difference is that the TO uses
the highest angle above or below the surface along each of the
azimuths, while the MVI computes the visibility on the
selected ﬁxed elevation angles h along each of azimuths.
The visual appearances of the SVF and TO have many
similarities to the MVI-U. Another possible approach is an
estimation of the visual exposure that describes how much
of the entire terrain is visible at all
locations (Llobera,
2003).

The second group are anisotropic methods. Two
approaches use four azimuths (225, 270, 315 and 360u)
for computation. Mark (1992) proposed a technique for
multidirectional oblique-weighted shaded relief visualisation
(Figure 5), while Loisios et al. (2007) suggested an analytical
shading methodology based on combining shadings from
different illumination directions. Sun motion simulation
visualisation may also be used for anisotropic multidirec-
tional visualisation (Wilson and Gallant, 2000; Olya and
Conrad, 2008). Another possibility is an anisotropic MVI-U
with weighted azimuths Q (see Figure 5), where the Q value is
weighted with a simple sine function, with the highest weight
1 at 315u and the lowest weight 0 at 135u.

The quasi-slope and the flat areas aspect
Typically, slope is computed by identifying the direction of
the maximum rate of change in a height value from each grid

Multidirectional Visibility Index for Analytical Shading Enhancement

199

Figure 3. Quasi-slopes QSh and relative reliefs RRh for different h values

cell (Wood, 1996). The steeper areas are less illuminated (in
darker tones) in the common slope (isotropic-like) shading
technique (Imhof, 1982) (Figure 6).

One problem of slope shading is that, on steep-sided
valleys (thalwegs) and on sharp mountain ridges, both the
surfaces and their shading tones lie close together, which
results in a vague and formless visualisation. Light strips
give the illusion of widening and ﬂattening of the ridges and
valleys (Imhof, 1982). The MVI-QS approach largely
overcame this problem by preserving topographic details
in steep slopes, while making ridges appear thinner. The
morphologic features have a higher global appearance, i.e.
the inﬁnite catchment radius r actually means the con-
sideration of the wider context of the particular prominent
topographic structure or feature, e.g. the whole valley or
crater is darker than the surroundings.

An important aspect of slope shading techniques is the
enhancement of ﬂat areas in order to present them in a

lighter tone than their surroundings. The proposed MVI-
QS technique offers a reliable solution, like the MVI-L and
MVI-U (see Figure 4). The quasi-slope can be analogous to
the described QSh computed as ‘positive’ plus ‘negative’
SVFs and TOs. Other approaches employ an aerial (atmo-
spheric) perspective as a phenomenon of diminished value
for contrast in lowlands that increases in upland areas. The
procedures allow for general change in tonal value as a
function of altitude (Brassel, 1974; Jenny and Ra¨ber,
2002). A further option is to classify morphologically ﬂat
areas using GIS-based algorithms.

Relative relief and morphologic edge aspects
The aim of absolute height visualisation is to differentiate
between lowlands and highlands. The height coding (or z-
coding, hypsometric height scale, hypsometric tinting, also
hypsometric colouring) uses grey shades or colours. High

200

The Cartographic Journal

Figure 4. Composed grids MVI-U, MVI-L, MVI-QS and MVI-RR

or relatively higher values are more illuminated when grey
shades are applied. Relatively higher values in relative relief
can be ridges and peaks (in lighter tones), while relatively
lower values can be valleys and pits (in darker tones).
Therefore, the relative relief enables the assessment of very
ﬁne structures.

The simplest application is to set the arbitrary relative
origin of the elevations to the model. Another possibility is
subtracting a smoothed DEM from the original, where the
smoothing can be computed by different techniques based
on a moving window, e.g. low-pass ﬁltering. The resulting
therefore a kind of high-pass ﬁltering
subtraction is
visualisation (Figure 7). Similar
to this approach is a
topographic position index, TPI (Weiss, 2001), where an
average elevation is subtracted from the original DEM.

Both visualisation approaches depend on the scale or size of
the moving window kernel. The relative relief can be
computed as a derivative of
the ‘positive’ minus the
‘negative’ SVFs and TOs, computed analogous to MVI-
RR (Figure 7). Any relative relief could be additionally
classiﬁed as ridges, slopes, valleys, ﬂat areas, etc. From a
comparison, clearly the terrain is most sensibly visualized by
the MVI-RR.

The main task of the relative relief techniques is the
relatively soft enhancement (accentuation) of morphologic
edges, e.g. ridges and valleys, to appear rather like the ‘worn
out hemlines on jeans’. In addition to relative relief, upper
(only for convex structures) and lower views (only for
concave structures) conveniently enhance the edges. There
are a large number of other algorithms that generate

Figure 5. Multidirectional methods: isotropic SVF, isotropic positive TO along four azimuths within 125 m distance, anisotropic multidirec-
tional oblique-weighted shaded relief, and anisotropic MVI-U

Multidirectional Visibility Index for Analytical Shading Enhancement

201

edges, and are therefore less
visualisation.

interesting for

terrain

Multiscale terrain visualisation aspect
A generalisation is a process of formulating general concepts
by abstracting common properties. Different approaches
may be used to generalize the DEM for various applications
(Weibel, 1989; Leonowicz et al., 2010; Podobnikar, 2008;
2012). They may consider criteria such as the type of
landform (ﬂat, hilly areas, etc. and their combination for the
visualisation), the size and signiﬁcance of the morphologic
features (context, structures), aesthetic and psychological
domains, the scales of the product, and topographical
aspects. A multiscale terrain visualisation is a composition of
different levels of detail of the terrain. It requires a series of
terrain visualisations generalized on different scales that are
jointly mapped, by applying a simple summation operation
tone mapping
as presented in this paper, or other
techniques (Devlin et al., 2002) that use a number of
continuous grids. Multiscale terrain visualisation permits a
sharp-smoothed appearance of the landform.

radius

In the case of the MVI, the level of detail can be
described by terrain roughness (corresponding to the
DEM), elevation angle h, and catchment
r.
Changes in resolution of the DEM are not a subject of
multiscale terrain visualisation in this paper. The terrain
roughness is geomorphometrically related to the periodic
functions (Mark, 1975), where: (1) a texture is used to refer
to the shortest wavelength in topography, corresponding to
signiﬁcant points used for DEM interpolation or
to
fundamental graphics primitives (Do¨llner et al., 2000);
(2) the grain is used to refer to the longest signiﬁcant
wavelength, corresponding to major ridges and valleys as
texture of topography; and (3) the slope is used to refer to
the waves’ amplitude. The elevation angle h is the main
parameter that controls the visual appearance of the MVIs.
Small elevation angles (e.g. 2u) sharply expose textures

Figure 6. Slope shading based on slope and MVI-QS

continuous surfaces with similar visual appearance to the
relative relief. Edges are accentuated by moving window
operations using kernels of different shapes or sizes, e.g.
high-pass ﬁltering (Gallant and Wilson, 2000). A very basic
procedure is visualisation of the relief (plan) curvatures by
enhancing convex and concave edges (Podobnikar, 2008;
Kennelly, 2008; Leonowicz et al., 2010). More complex is
computing and visualizing so-called relief-below, relief-
above or rim indices, which combine various ﬁltering
techniques
(Podobnikar, 2012). Further methods are
height above valley ﬂoors/height below summit culmina-
tions and convergence index (Olaya and Conrad, 2008).
There are many edge detection algorithms, but they do not
generate continuous surfaces or preserve details around the

Figure 7. Relative relief visualisations based on the difference between smoothed and original DEM (dDEM) — ‘positive’ minus ‘negative’
SVFs (SVF-RR) and TOs (TO-RR, and MVI-RR)

202

The Cartographic Journal

context of the surrounding structures. In the MVI-
RR, the edges are presented intuitively for human
perception: lighter tones for convex edges and darker
tones for concave edges. This would also be the case
for the MVI-U/MVI-L, where only convex/concave
details are sharp.
N Multiscale terrain visualisation is manifested in all
MVIs. Prominent structures (large scale) and smaller
details (small scale) are best recognized in MVI-RR.
Additionally, large areas in the hilly and flat terrain and
their surroundings are presented in increasingly
homogeneous tones. They are cartographically most
relevant in MVI-U, where whole mountains and their
near surroundings of lower elevations are in darker
tones.

Figure 8. Uh52u, Uh525u and MVI-U

(smaller details) in open ﬂat areas and outline the larger
prominent structures such as mountains (grain). Large
angles (e.g. 25u) sharply expose textures on the steeper
slopes of hills and mountains, while smaller details in ﬂat
areas are not visible. This problem can be illustrated in
practice with visual observation of topographic detail and
prominent structures in nature as the elevation angle of the
sun changes throughout the course of the day. The larger
catchment radius r causes particular types of terrain to
appear more global, with more homogeneously illuminated
tones. They are typically found within and around either
hills and mountains (particularly for MVI-U) or ﬂat and
riverbed areas (particularly for MVI-L), especially when the
elevation angle h is close to 0u. Therefore, every continuous
grid Uh, Lh, QSh or RRh with heterogeneously rough
terrain represents visualisation at different scales, while the
derived MVIs are true multiscale visualisations (Figure 8).
In our case study, the level of detail was controlled by the
parameter of elevation angle h on selected DEMs. The
h5{¡2u, ¡5u, ¡10u, ¡25u} was varied for four contin-
uous grid computations; r was inﬁnity. Finally, all four
continuous grids with different h values were added
together to produce the multiscale terrain visualisations of
the MVIs.

GENERATION OF THE FINAL MVI-x1 AND ITS
COMBINATION WITH THE HS MAP

The proposed MVIs (see Figure 4) fulﬁlled all three main
requirements for the topographically improved analytical
shading.

N Flat areas are less illuminated and therefore presented
in a lighter tone than their surroundings, especially by
the MVI-L and MVI-QS, with the exception of MVI-
RR.
N The morphologic edges are accentuated in all types of
terrain, especially by the MVI-RR, depending on the

Figure 9. MVI-x1

Multidirectional Visibility Index for Analytical Shading Enhancement

203

Figure 10. Analytically shaded maps: HS in comparison with enhanced shading as an equal combination of the HS with MVI-QS, MVI-RR,
and MVI-x1

The ﬁnal step of the cartographically relevant analytical
shading enhancements with the MVIs is the generation of
an MVI-x that should fulﬁl all three introductory require-
ments concurrently. The MVI-x is arbitrarily generated
from Uh and Lh, as a combination of particular portions
of the MVIs. The proposed example of x1 is: MVI-x154 ?
zUh525u (Figure 9). The particular MVI-
MVI-Uz2Lh51u
x1 was optimized for visualisation with HS maps (not for
standalone terrain visualisation).

The main component of the MVI-x1 is, therefore, the
MVI-U. A component of Lh with a particularly small
elevation angle of 1u is added to the MVI-QS that increases
the illumination of the ﬂat areas and improves the detail of
deep valleys and karstic pits. The second added component
is Uh, which, with the relatively large elevation angle of 25u,
increases the homogeneity of the prominent structures
(higher elevations and larger ﬂat areas) and the details of
steep slopes. These observations on the MVI-x composition
demonstrate how easily readable it
is as well as the
sensitivity of its visualisation, which signiﬁcantly uncovers
a greater
than an HS
visualisation would.

level of morphological detail

The usability of the MVI-x1 and other MVIs can be
demonstrated on analytically shaded maps, which are
generated as equal portions of the MVIs, and on HS maps,
which are generated by Horn’s (1981) algorithm (Q5315u,
h545u) (Figure 10). The brightness of all visualisations
presented should be adjusted to lighter tones with fewer
contrasts in those cases in which the visualisations serve as

backgrounds on topographic or
thematic maps. The
advantage of the MVI-x1 is its detailed and cartographically
more relevant presentation.

DISCUSSION

In our case, enhanced analytical shading is the task of
rendering where geometry is assured with DEM; lighting
and shading are provided by standard anisotropic hill
shading, and additional shading enhancements are provided
by the appropriate MVI. This combination simulates many
natural properties of the landform. Even when the HS maps
combined with isotropic MVIs are rotated horizontally,
they are very likely more correctly readable than the HS
maps alone.

In addition to the described MVIs and especially of the
ﬁnal MVI-x1, the interesting property is that the visualisa-
tion is easily readable on both small and large scale maps.
The two main reasons for this are the combination of
visibilities at different elevation angles
initiate a
multiscale effect, and the fact that the ﬂat areas are shown
in homogeneous light tones, which is a nice contrast to the
other areas on the small-scale representations. The quasi-
slope solution (MVI-QS) improves the slope shading
technique. The MVIs may provide a global and local
shading effect, especially when realizing an anisotropic
MVI. The MVIs actually fulﬁl so many of the demands of

that

204

The Cartographic Journal

n
o
i
t
a
s
i
l
a
r
e
n
e
g

c
i
h
p
a
r
g
o
t
r
a
c

t
n
e
r
e
f
f
i
d

n

i

t
l
u
s
e
r

s
e
u
l
a
v

h

t
n
e
r
e
f
f
i
d

r
u
o
f

t
u
o
b
a

l

;
)
y
g
o
o
h
p
r
o
m
n
o

s
d
n
e
p
e
d

y
l
t
h
g

i
l
s
(

n
i
a
r
r
e
t

f
o

e
p
y
t

y
n
a

t
s
o
m
l
a

r
o
f

s
t
l
u
s
e
r

e
v
i
t
p
a
d
a

n
i
a
t
b
o

d
n
a

t
s
u
b
o
r

e
b

o
t

d
e
v
o
r
p

e
v
a
h

s
e
u
l
a
v

h

d
e
s
o
p
o
r
p

e
h
t

—

l
i
a
t
e
d

u
5
2

o
t

f
o

1
5
h

l
e
v
e
l

n
o

s
d
n
e
p
e
d
(

u
5
4
y

l

)
y
g
o
o
h
p
r
o
m

1
x
-
I
V
M

)
R
R
-
I
V
M

(

f
e
i
l
e
r

.
l
e
R

)
S
Q

-
I
V
M

(

e
p
o
l
s
-
i
s
a
u
Q

)
L
-
I
V
M

,

U

-
I
V
M

(
w
e
i
v

l

r
e
w
o
/
r
e
p
p
U

)
n
a
i
t
r
e
b
m
a
L
(

i

g
n
d
a
h
s

l
l
i

H

)
s
e
r
u
t
a
e
f

s
u
o
e
n
o
r
r
e

y
n
a

t
u
o
h
t
i

w
e
b

o
t

h
g
u
o
n
e

l
l
a
m

s
(

u
5
5
d

,
Q

e
l
p
i
t
l
u
M

)
–
(

d

,
u
5
1
3
5
Q

n

i

s
e
r
u
t
c
u
r
t
s

d
e
s
o
p
x
E

p
u

,
s
e
l
a
c
s

t
n
e
r
e
f
f
i
d

y
l
e
g
r
a
l

e
r
a

s
e
g
d
e

p
r
a
h
S

n

i

e
r
a

s
y
e
l
l
a
v

,
d
e
s
o
p
x
e

s
e
n
o
t

r
e
t
h
g

i
l

n

i

e
r
a

s
a
e
r
a

t
a
l
f

—

s
e
g
d
e

p
r
a
h
s

y
r
e
V

)
h
t
o
b

t
o
n
(

p
r
a
h
s

e
r
a

t
n
e
i
d
a
r
g

r
i
e
h
t

o
t

i

g
n
d
r
o
c
c
a

d
e
t
a
n
m
u

i

l
l
i

s
e
g
d
e

e
v
a
c
n
o
c

r
o

x
e
v
n
o
C

e
r
a

s
e
c
a
f
r
u
s

:
r
a
l
u
c
i
t
r
a
p

t
o
N

l

c
i
g
o
o
h
p
r
o
m
d
e
s
o
p
x
E

d
e
h
t
o
o
m

s
-
p
r
a
h
S

y
t
i
c
i
t
s
a
l
p

e
n
i
f

e
v
a
c
n
o
c

d
n
a

x
e
v
n
o
c

s
e
n
o
t

e
t
i
h
w
n

i

d
n
a

p
r
a
h
s

e
r
a

y
t
i
c
i
t
s
a
l
p

e
n
i
f

f
o

s
e
n
o
t

t
n
e
r
e
f
f
i

D

e
v
a
c
n
o
c

d
n
a

x
e
v
n
o
C

p
r
a
h
s

e
r
a

s
a
e
r
a

e
v
a
c
n
o
c

r
o

x
e
v
n
o
C

,
e
c
a
f
r
u
s

e
v
i
t
i
u
t
n

i

y
r
e
V

e
c
n
a
r
a
e
p
p
a

l
a
u
s
i
v

l
a
r
e
n
e
G

e
n
i
f

y
r
e
V

)
e
v
a
c
n
o
c

r
o

x
e
v
n
o
c
(

e
n
i
f

y
r
e
V

r
a
l
u
c
i
t
r
a
p

t
o
N

l

c
i
g
o
o
h
p
r
o
m
e
h
t

f
o

e
r
u
t
x
e
T

)
1

d
n
a

0

n
e
e
w
t
e
b

s
i

t
h
g
i
e
w
(

c
i
p
o
r
t
o
s
i
n
a

r
o

)
e
s
a
c

r
u
o

n

i

,
s
h
t
u
m
i
z
a

l
l
a

r
o
f

1
5
t
h
g
i
e
w
(

c
i
p
o
r
t
o
s
I

)
Q

n
o

s
d
n
e
p
e
d
(

c
i
p
o
r
t
o
s
i
n
A

y
t
i

m
r
o
f
i
n
U

)
r

i

s
u
d
a
r

t
n
e
m
h
c
t
a
c

e
h
t

i

n
h
t
i

w
s
l
l
e
c

f
o

r
e
b
m
u
n

d
e
n
i
f
e
d

y
l
l
a
c
i
t
s
i
r
u
e
h

r
o

e
t
i
n
i
f
n

i

n
a
(

l
a
b
o
G

l

)
s
l
l
e
c

g
n
i
r
u
o
b
h
g
i
e
n
w
e
f
(

l
a
c
o
L

w
o
d
n
w

i

t
n
e
m
h
c
t
a
C

d

,
Q

l
a
m

i
t
p
O

h

l
a
m

i
t
p
O

d
o
h
t
e

M

s
e
r
u
t
a
e
f

s
e
r
u
t
a
e
f

i

e
u
q
n
h
c
e
t

t
n
e
m
e
c
n
a
h
n
E

l
e
d
o
m
n
o
i
t
a
n
m
u

i

l
l
i

d
r
a
d
n
a
t
S

s
I
V
M
d
n
a

i

g
n
d
a
h
s

l
l
i

h

f
o

n
o
s
i
r
a
p
m
o
c

e
v
i
t
p
i
r
c
s
e
D

.
1

e
l
b
a
T

d
e
l
i
a
t
e
d

o
t

e
n
i
f

y
r
e
V

h
g
h

i

y
r
e
V

h
g
h

i

y
r
e
V

h
g
h

i

y
r
e
V

,
t
h
g
i
s
n

i

e
u
l
a
v

w
e
N

h
g
h

i

h
c
u
m
y
r
e
V

s
e
n
o
t

r
e
k
r
a
d

e
n
F

i

h
g
H

i

i

m
u
d
e
M

i

m
u
d
e
M

t
h
g
i
s
n

i

w
e
N

t
h
g
i
s
n

i

w
e
N

h
c
u
M

h
c
u
M

i

m
u
d
e
M

i

m
u
d
e
M

h
g
H

i

i

m
u
d
e
M

w
o
L

w
o
L

t
h
g
i
s
n

i

w
e
N

h
c
u
M

i

m
u
d
e
M

f
o

n
o
i
t
a
s
i
l
a
u
s
i
v

o
t

s
s
e
n
t
s
u
b
o
R

y
t
i
x
e
l
p
m
o
c

l

l
a
c
i
g
o
o
h
p
r
o
m

h
g
h

i

y
r
e
V

t
u
o
h
t
i

i

w
g
n
d
a
e
r
(

s
s
e
n
e
v
i
t
i
u
t
n
I

)
e
g
d
e
l
w
o
n
k

d
n
u
o
r
g
k
c
a
b

d
e
r
i
u
q
e
r

h
g
H

i

r
o
f

t
i
f
e
n
e
b

l
a
i
t
n
e
t
o
p
(

l

s
s
e
n
u
f
e
s
U

)
s
p
a
m
c
i
h
p
a
r
g
o
p
o
t

f
o

y
t
i
l
i

b
a
d
a
e
r

e
u
l
a
v

h
g
H

i

s
s
e
n
e
v
i
t
c
e
f
f

E

e
l
t
t
i
L

l
e
d
o
m
a

e
t
a
r
e
n
e
g

o
t

s
t
r
o
f
f

E

r
a
e
n

i
l
-
n
o
n

g
n
i
y
o
p
m
e

l

r
o

i

g
n
d
a
h
s

l
l
i

h

h
t
i

w
n
o
i
t
a
n
b
m
o
c

i

:
p
r
a
h
s

o
o
t

y
l
l
a
u
s
i
v

s
a

r
a
e
p
p
a

n
a
c

s
e
g
d
e

t
n
u
b

l

y
l
l
a
c
i
h
p
a
r
g
o
p
o
T

y
l
l
a
c
i
h
p
a
r
g
o
p
o
t

e
m
o
S

s
k
c
a
b
w
a
r
d

r
o
j
a

M

k
c
a
b
w
a
r
d

s
i
h
t
e
m
o
c
r
e
v
o

n
a
c

s
p
m
a
r

e
l
a
c
s
y
e
r
g

n
e
d
d
h

i

e
r
a

s
l
i
a
t
e
d

t
n
a
c
i
f
i
n
g
i
s

Multidirectional Visibility Index for Analytical Shading Enhancement

205

Figure 11. One of the original photographs, and the analytically shaded scene as the MVI composed from visibility masks of the photographs

analytical shading that they may even be used as a universal
standalone terrain visualisation.

The MVIs were simply computed and presented with the
operations addition and subtraction, and with weighting,
using standard linear ramps. The visualisation of the MVI
can be considerably improved by employing more sophis-
ticated tone mapping techniques. An appropriate global or
local tone mapping operator can be applied (Devlin et al.,
2002) in order to reproduce more image detail, improve
image contrast, or just the aesthetic (perceptual) properties
of the MVIs.

Table 1 summarizes and standardizes selected signiﬁcant
characteristics, advantages and drawbacks of the series of
MVI enhancements in contrast to standard hill shading.
The evaluation follows the technical characteristics of the
techniques
surveyed, processing measurements, carto-
graphic theory, explored common senses, and expert
evaluations that were additionally proven by experiments
on morphologically different landforms and the quality of
the DEM, in order to provide understandable and as far as
possible, homogeneous and objective answers.

The MVI method of analytical shading enhancement can
be considered to be a broadly applicable technique in the
discipline of image processing. In this sense, the MVI is a
combination of multiple parts of images of the same scene,
where in practice, visibility masks are not computed from
the surfaces, but processed from the images. The visibility
masks contain the terrain surface areas directly irradianced
(visible) by the sun, and other areas (not visible). They are
determined by separation of direct irradiance areas from the
images. The natural paths of the sun (approximated as a
point) are analogous to the MVI principles determined by
the azimuths Q and the elevation angles h, while the
catchment radius of the sunrays r is approximated as
inﬁnity. Figure 11 presents an example of the composition
of a series of 36 binary (1-bit) visibility masks (46u059N,
14u179E, 26 September, from 10:00 AM to 15:50 PM,
GMTz1), extracted from oblique photographs oriented
southwards, with an azimuth interval d52.5u and variable
elevation angles h according to the sun’s motion, analogous
to the MVI-U principles. The resulting MVI is anisotropic
with Q that covers just a circular sector and with variable h

values, as well as being presented in perspective view. Many
very small
features and prominent structures are more
recognisable than in the original 8-bit photograph captured
on the same date at 12:00 AM (GMTz1).

Further studies on analytical shading problems could
incorporate a more interdisciplinary research team of
experts, such as geomorphologists, geologists, tectonic
researchers, psychologists, cartographers, GIS-analysts, etc.
MVIs have the potential to improve the quality of the
DEM on the basis of a visual or numerical assessment
(Podobnikar, 2009), which is one of the main assignments
of the spatial data warehouses. They also have the potential
for the visual or automatic recognition of morphologic
landform classiﬁcation on different scales and
features,
visual analytics of
the terrain, especially using high-
resolution lidar DEMs (Podobnikar, 2012). The MVI
techniques can be more widely applied to shading of
arbitrarily chosen surfaces in computer graphics in order to
process a rendered description of the virtual scenes.

CONCLUSIONS

The novel method of MVI was developed in order to
enhance cartographic analytical shading for terrain repre-
sentations on topographic and thematic maps, as well as for
standalone landform visualisations. The method is uncon-
ventional, since it does not relate directly to illumination
principles, but rather works on the compositions of visibility
masks, which emphasize other artistic aspects.

Continuous

surfaces were produced using different
isotropic or even anisotropic combinations of the visibility
mask computations on the DEM, considering various
azimuths and elevation angles, and optionally catchment
radius. These are called MVI-U, MVI-L, MVI-QS, MVI-
RR, and MVI-x, which indicate upper/lower view, quasi-
slope, relative relief, and their combination, respectively.
Each of the proposed MVIs fulﬁls particular requirements
toward enhanced cartographical analytical
shading for
topographic and thematic maps. The quasi-slope MVI-QS
and relative relief MVI-RR appear visually quite reliable,
while the proposed example MVI-x1 fulﬁlled all three

206

The Cartographic Journal

primary requirements: ﬂat areas appear in a lighter tone
than their surroundings; morphologic edges are slightly
accentuated; and morphologic features are visualized on a
multiscale, which allows a sharp-smoothed appearance of
the landform considering the variable roughness of the
terrain.

In contrast to those of standard hill shading, the results
from the MVIs can be characterized as follows: they are
basically isotropic and therefore do not depend on a
particular azimuth; they show a ﬁne level of morphologic
detail and give a natural
impression of the terrain; the
standard slope shading visualisation problems on steep-
sided valleys are overcome; the proposed parameters are
robust (independent of any type of landform morphology),
etc. The elevation angle parameter may need (although not
necessarily so) some minor adjustments to obtain the
optimal visualisation under extreme landform conditions. It
has been clearly demonstrated that MVIs provide a broad
for a number of
solution and have great potential
enhancements for aesthetically friendly analytical shading
on the basis of the DEM and other surfaces.

BIOGRAPHICAL NOTES

is

Tomazˇ Podobnikar
an
assistant professor at Faculty
of Civil and Geodetic Engi-
neering at University of Lju-
bljana, and a research advisor
at Scientiﬁc Research Centre
of the Slovenian Academy of
Sciences and Arts. He also
worked at Delft University
Technology
(The Nether-
lands), University of Franche-
Comte´ (France) and Vienna
of Technology
University
(Austria). He holds a BSc in GIS and its applications in natural
environment and archaeology, MSc in Monte Carlo methods
and GIS, PhD in digital terrain modelling on the base of
semantic integration of different type and quality data sources.
He is the author of several publications on GIS, DEM and its
applications, modelling of spatial uncertainty, environmental
archaeology and biology, paleo- and planetary environments,
visual analytics, as well as historical cartography and analytical
shading. He has been working on numerous projects, for
example production of a Slovenian DEM that is currently
widely available, on the base of his method.

ACKNOWLEDGMENTS

The morphometrical aspect of the MVI method was initially
utilized and extensively tested by the project TIMIS.morph
as part of the mission of the ESA’s research programme
‘HRSC on Mars Express’, and with the support of the
Austrian Research Promotion Agency within the framework
of the program ASAP at the Institute of Photogrammetry
the Vienna University of
and Remote Sensing of

Technology. The author would like to thank the anonymous
reviewers for their valuable comments and suggestions.

REFERENCES

Brassel, K. (1974).

‘A Model

for Automatic Hill-Shading’, The

American Cartographer, 1(1), pp. 15–27.

Corripio, J. G. (2003). ‘Vectorial algebra algorithms for calculating
terrain parameters from DEMs and solar radiation modelling in
mountainous terrain’, International Journal of Geographical
Information Science, 17(1), pp. 1–23.

Devlin, K., Chalmers, A., Wilkie, A. and Purgathofer, W. (2002).
‘Tone Reproduction and Physically Based Spectral Rendering’,
STAR Report, Eurographics, ed. by Fellner, D. and Scopignio, R.,
pp. 101–123.

Do¨llner, J, Baumman, K. and Hinrichs, K. (2000).

for

techniques
Proceedings of the IEEE, pp. 227–234.
Gallant, J. C. and Wilson, J. P. (2000).

terrain visualization’, Visualization 2000,

‘Primary Topographic
Attributes’, Terrain Analysis: Principles and Applications, ed.
by Wilson, J. P. and Gallant, J. C., pp. 51–85, John Wiley and Sons,
New York.

Horn, B. K. P. (1981). ‘Hill Shading and the Reflectance Map’, in

‘Texturing
in

Proceedings of the IEEE, 69(1), pp. 14–47.

Imhof, E. (1982). Cartographic Relief Presentation, Walter de

Gruyter, Berlin and New York

Jenny, B. (2001). ‘An interactive approach to analytical relief shading’,

Cartographica, 38 (1–2), pp. 67–75.

Jenny, B. and Hurni, L. (2006). ‘Swiss-Style Colour Relief Shading
Modulated by Elevation and by Exposure to Illumination’,
Cartographic Journal, 43(3), pp. 198–207.

Jenny, B. and Ra¨ber, S. (2002). Relief Shading, Institute of

Cartography, ETH Zu¨rich, http://www.reliefshading.com

Kennelly, P. J. (2008). ‘Terrain maps displaying hill-shading with

curvature’, Geomorphology, 102(3–4), pp. 567–577.

Leonowicz, A. M., Jenny, B. and Hurni, L. (2010). ‘Automated
Reduction of Visual Complexity in Small-Scale Relief Shading’,
Cartographica, 45(1), pp. 64–74.

Llobera, M. (2003). ‘Extending GIS based analysis: the concept of
visualscape’, International Journal of Geographic Information
Science, 17(1), pp. 25–48.

Loisios, T., Tzelepis, N. and Nakos, B. (2007). A Methodology for
Creating Analytical Hill-Shading by Combining Different Lighting
Directions,
ICA – Commission on Mountain Cartography,
Moscow, Russia, 10 p.

Mark, D. M. (1975). ‘Geomorphometric parameters: a review and

evaluation’, Geografiska Annaler, 57A(3–4), pp. 165–177.

Mark, R. K. (1992). A multidirectional, oblique-weighted, shaded-
relief image of the Island of Hawaii, U.S. Geological Survey open-
file report 92–422, 5 p., http://pubs.usgs.gov/of/1992/of92-
422/of92-422.pdf

Miliaresis, G. C. and Argialas, D. P. (2002). ‘Quantitative representa-
tion of mountain objects extracted from the Global Digital
Elevation Model
(GTOPO30)’,
Journal of
Remote Sensing, 23, pp. 949–964.

International

Olaya, V. and Conrad, O. (2008). ‘Geomorphometry in SAGA’, in
Geomorphometry: Concepts, Software, Applications, ed. by
Hengl, T. and Reuter, H. I., ch. 12., pp. 293–308, Developments
in Soil Science 33, Elsevier.

Patterson, T. (2004). Shaded Relief: Ideas and Techniques about Relief

Presentation on Maps, http://www.shadedrelief.com

Peterson, D. (2002). Hill Shading, http://maps.unomaha.edu/
Peterson/compmapping/Assign/Schummerung/HillShading.html
Phong, B. T. (1975). ‘Illumination for Computer Generated Pictures’,

Communications of the ACM, 18(6), pp. 311–317.

Podobnikar, T. (2008).

‘Enhancing terrain features for improved
cartographic
the Second
International Conference on Cartography and GIS, pp. 245–
253, Sofia, University of Architecture, Civil Engineering and Geodesy.

in Proceedings of

visualisation’,

Multidirectional Visibility Index for Analytical Shading Enhancement

207

Podobnikar, T. (2009). ‘Methods for visual quality assessment of a digital
terrain model’, S.A.P.I.EN.S., 2(2), http://sapiens.revues.org/
index738.html

Podobnikar, T. (2012). ‘Detecting Mountain Peaks and Delineating
Their Shapes Using Digital Elevation Models, Remote Sensing and
Geographic Information Systems Using Autometric Method-
ological Procedures’, Remote Sensing, 4(3), pp. 784–809.

Prechtel, N. (2000). Operational analytical hill shading within an
advanced image processing system, ICA – Commission on
Mountain Cartography, Dresden, Germany,
85–98,
Kartographische Bausteine 18.

pp.

Streicher, J. J., Culverhouse Jr., W. C., Dulberg, M. S. and Fornaro,
R. J. (2004). ‘Modeling the Anatomical Distribution of Sun-
light’, Photochemistry and Photobiology, 79(1), pp. 40–
47.

Weibel, R.

(1989). Concepts

the
Automatisation of Relief Generalisation, Doctor dissertation
(in German), Geo-Processing, 15, Department of Geography,
University of Zurich.

and Experiments

for

Weiss, A. (2001). Topographic position and landforms analysis, Poster

Presentation, ESRI User Conference, San Diego, CA.

nicht

gesetzmaessig

Wiechel, H. (1878).

‘Theorie und Darstellung der Beleuchtung
von
gebildeten Flaechen mit Rue-
cksicht auf die Bergzeichnung’, Civilingenieur, 24, pp. 335–364.
Wilson, J. P. and Gallant, J. C. (2000). ‘Secondary Topographic
Attributes’. in Terrain Analysis: Principles and Applications, ed.
by Wilson, J. P. and Gallant, J. C., pp. 87–131, John Wiley and
Sons, New York.

Wood, J. (1996). The Geomorphological Characterisation of Digital
Elevation Models, Doctor dissertation, Department of Geography,
University of Leicester.
(1967a).

‘Die Richtung des Lichtes bei analytischer

Yoe¨li, P.

Schattierung’, Kartographische Nachrichten, 2, pp. 37–44.
Yoe¨li, P. (1967b). ‘The Mechanisation of Analytical Hill Shading’,

Cartographic Journal, 4, pp. 82–88.

Yokoyama, R., Shirasawa, M. and Pike, R. J. (2002). ‘Visualizing
Topography by Openness: A New Application of Image Processing
to Digital Elevation Models’, Photogrammetric Engineering &
Remote Sensing, 68(3), pp. 257–265.

Zeverbergen, L. W. and Thorne, C. R. (1987). ‘Quantitative analysis of
and

topography’, Earth Surface Processes

land surface
Landforms, 12, pp. 47–56.

Copyright of Cartographic Journal is the property of Maney Publishing and its content may not be copied or

emailed to multiple sites or posted to a listserv without the copyright holder's express written permission.

However, users may print, download, or email articles for individual use.

