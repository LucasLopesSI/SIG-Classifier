bs_bs_banner

Research Article

Transactions in GIS, 2016, 00(00): 00–00

A Spatial Anomaly Points and Regions Detection Method
Using Multi-Constrained Graphs and Local Density

Yan Shi, Min Deng, Xuexi Yang and Qiliang Liu

Department of Geo-informatics, Central South University, Changsha, Hunan

Abstract
Spatial anomalies may be single points or small regions whose non-spatial attribute values are signiﬁcantly
inconsistent with those of their spatial neighborhoods. In this article, a Spatial Anomaly Points and
Regions Detection method using multi-constrained graphs and local density (SAPRD for short) is pro-
posed. The SAPRD algorithm ﬁrst models spatial proximity relationships between spatial entities by con-
structing a Delaunay triangulation, the edges of which provide certain statistical characteristics. By
considering the difference in non-spatial attributes of adjacent spatial entities, two levels of non-spatial
attribute distance constraints are imposed to improve the proximity graph. This produces a series of sub-
graphs, and those with very few entities are identiﬁed as candidate spatial anomalies. Moreover, the spatial
anomaly degree of each entity is calculated based on the local density. A spatial interpolation surface of
the spatial anomaly degree is generated using the inverse distance weight, and this is utilized to reveal
potential spatial anomalies and reﬂect their whole areal distribution. Experiments on both simulated and
real-life spatial databases demonstrate the effectiveness and practicability of the SAPRD algorithm.

1. Introduction

Spatial anomalies are spatial points or regions that deviate signiﬁcantly from the global and/or
local distribution. Such anomalies are widely found in various spatial databases. In the context
of geographical space, spatial anomalies may indicate implicit knowledge, signiﬁcant changes,
surprising patterns, and meaningful insights, instead of just being useless noise. These attractive
characteristics mean that spatial anomalies have received considerable attention in practical
applications, e.g. environmental monitoring (Li et al. 2009), abnormal distribution analyses of
disease and crime (Janeja and Atluri 2009; Cheng and Adepeju 2013), discovery of extreme cli-
mate events (Wu et al. 2010; Telang et al. 2014), and trafﬁc congestion detection (Pang et al.
2011; Pan et al. 2013). As a critical approach in spatial data mining, spatial anomaly detection
has become increasingly popular in recent years (Pei et al. 2001; Tan et al. 2006).

The concept of an anomaly was ﬁrst proposed by Hawkins in 1980, and deﬁned as “an
observation that deviates so much from other observations as to arouse suspicions that it was
generated by a different mechanism” (Hawkins 1980). At that time, anomaly detection algo-
rithms were mostly applied to transaction databases (Knorr and Ng 1998). With advances in
spatial data mining, a large number of algorithms were developed to discover anomalies in spa-
tial datasets. These algorithms can be roughly classiﬁed into two categories: (1) those that only
consider spatial attributes (spatial coordinates X and Y, for example); (2) and those that con-
sider both spatial and non-spatial attributes. The former are mainly used to accrue abnormal

Address for correspondence: Min Deng, Department of Geo-informatics, Central South University, Changsha, Hunan, China. E-mail:
dengmin028@yahoo.com

VC 2016 John Wiley & Sons Ltd

doi: 10.1111/tgis.12208

2

Y Shi, M Deng, X Yang and Q Liu

distributions (e.g. earthquake, crime, and disease distributions) from spatial event datasets by
traditional anomaly detection or spatial clustering methods (Ester et al. 1996; Breunig et al.
2000; Al-Zoubi et al. 2010; Deng et al. 2011). The latter focus on detecting spatial anomalies
by measuring the non-spatial attribute distance in spatial neighborhoods. In most geographical
applications, spatial data have both spatial and non-spatial attributes. Therefore, this article
looks at spatial anomaly detection algorithms that consider these two kinds of attributes.

The remainder of this article is organized as follows. In Sections 2, we discuss related work
and propose our research strategy. Section 3 introduces the proposed SAPRD algorithm.
Experiments on both simulated and real-life databases are described in Section 4. In Section 5,
our ﬁndings are summarized and future areas for research are highlighted.

2 Related Work and Our Strategy for Detecting Spatial Anomalies

2.1 Related Work

Shekhar and Chawla (2002) deﬁned a spatial anomaly as “a spatially referenced entity whose
non-spatial attribute values are signiﬁcantly different from those in its spatial neighborhood”.
Spatial attributes are used to build the neighborhood relationships, and a spatial anomaly is a
local instability with respect to values of non-spatial attributes, even though they may not be
signiﬁcantly different from the entire population (Cerioli and Riani 1999). Based on Shekhar
and Chawla’s idea, various algorithms have been proposed for spatial anomaly detection.
These can again be classiﬁed into six categories, namely diagram-based (Haslett et al. 1991),
distance-based (Shekhar et al. 2003), density-based (Chawla and Sun 2006), cluster-based (Bir-
ant and Kut, 2006), model-based (Chen et al. 2010), and graph-based (Lu et al. 2011).

2.1.1 Diagram-based methods

Diagram-based methods utilize variable clouds, pocket plots, or scatterplots to describe the dis-
tance between the non-spatial attributes of spatial entities and their neighbors (Haslett et al.
1991; Haining 1993; Anselic 1995). Diagram-based methods suffer from a lack of accurate
measurements for the spatial anomaly degree and the determination of spatial anomalies. For
this reason, they are rarely used.

2.1.2 Distance-based methods

Shekhar et al. (2003) introduced the idea of distance-based methods using his previous deﬁni-
tion of spatial anomalies. Chen et al. (2008) compared a single non-spatial attribute of a spa-
tial entity with the median of its k nearest neighbors, and employed a statistical method to
identify spatial anomalies. In addition, some scholars have used the weighted distance to mea-
sure non-spatial attribute differences between adjacent entities for spatial anomaly detection
(Liu et al. 2001; Kou et al. 2006). These methods detect spatial anomalies from a global per-
spective, so those anomalies locating in local heterogeneous regions will be ignored. In addi-
tion, those normal entities that are adjacent to true spatial anomalies cannot obtain accurate
spatial anomaly degree, followed by false positives and false negatives.

2.1.3 Density-based methods

Breunig et al. (2000) proposed a kind of density-based anomaly detection algorithm, called
LOF. Instead of just measuring the distance between two entities, this algorithm deﬁnes the
local density of each entity based on the distance between the entity and its neighbors. In this

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Spatial Anomaly Points and Regions Detection Method

3

condition, those entities with a smaller local density are more likely to be anomalies. Based on
this line of thought, a series of algorithms were developed for the discovery of spatial anomalies
in terms of both spatial and non-spatial attributes, e.g. SLOM (Chawla and Sun 2006). Com-
pared with distance-based methods, density-based methods are able to identify both global and
local spatial anomalies. However, they cannot completely solve the problem of false positives
and false negatives caused by spatial anomalies.

2.1.4 Cluster-based methods

Spatial clustering is a common method in spatial data mining, and aims to extract spatial clus-
ters in which entities are similar to each other and different from the entities in other clusters
(Han and Kamer 2006). Those entities that do not belong to any clusters can be seen as spatial
anomalies (Birant and Kut 2006; Li et al. 2008). In addition, Telang et al. (2014) discovered
homogeneous regions by spatial clustering, and detected spatial anomaly regions based on the
statistical difference from their neighborhoods. However, in these cluster-based methods, the
spatial anomalies detection results heavily depend on the selected clustering methods.

2.1.5 Model-based methods

Some scholars have used statistical models (e.g. Gaussian model, Chen et al. 2010) or machine
learning methods (e.g. self-organizing feature map, Cai et al. 2013) to detect spatial anomalies.
Model-based methods are not data-driven, and need to satisfy certain assumptions (e.g. obey-
ing a certain distribution). It should be noted that these assumptions cannot be satisﬁed pre-
cisely in real-world applications, which may lead to the detected results deviating from the
actual ground-truth.

2.1.6 Graph-based methods

Shekhar et al. (2001) proposed the strategy of building a graph structure for the spatial dataset,
and then measured the non-spatial attribute distance between an entity and its spatial neigh-
bors (i.e. those entities sharing edges with the entity in the graph) to further determine spatial
anomalies by a statistical method. Liu et al. (2010) combined random walks and bipartite
graphs to detect spatial anomalies. Lu et al. (2011) proposed a graph-based algorithm to detect
abnormal spatial points and regions. As a matter of fact, in graph-based methods, the distance-
based strategy is employed when measuring the spatial anomaly degree of entities, so they have
similar limitations with distance-based methods.

2.2 A Critical Analysis of Existing Methods

Most existing spatial anomaly detection methods simply aim to discover spatial anomaly
points. In fact, spatial anomalies exist as both points and small regions. Moreover, spatial
anomaly regions can cause entities near to true spatial anomalies to be falsely detected as spa-
tial anomalies, and those true spatial anomalies could be ignored because the adjacent normal
entities have a larger anomaly degree. Although some methods, e.g. SLOM (Chawla and Sun
2006), are designed to overcome this problem, complicated spatial datasets still cause prob-
lems. For example, Figure 1a shows a group of spatial grid data containing several apparent
spatial anomalies (e.g. A1, A2, and A3). One can see that this dataset can be divided into four
sub-regions by two bolder black lines, mainly because the four sub-regions have signiﬁcantly
different non-spatial attribute values to one another. Further, those regions that are adjacent to
spatial anomalies or share boundaries with the four sub-regions, namely R1, R2, R3, and R4,

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

4

Y Shi, M Deng, X Yang and Q Liu

Figure 1 Two types of spatial data containing spatial anomalies: (a) Spatial grid data; and (b) Spa-
tial sampling data

would be assigned a high spatial anomaly degree by most existing methods. In addition, spatial
anomaly regions A2 and A3 would be ignored by many current methods (e.g. SLOM). It should
be noted that the method proposed by Lu (2011) can efﬁciently solve the problem of false
detection and detect spatial anomaly regions. However, this method has some limitations. First,
it utilizes a strategy of global analysis for spatial anomaly detection, meaning it cannot deal
with spatial datasets that have strong heterogeneity. For example, the non-spatial attribute dis-
tance between adjacent entities in the upper-left sub-region of Figure 1a is about 0.2, whereas
this distance is approximately 2 in the upper-right sub-region. The method proposed by Lu
(2011) would divide the upper-right sub-region into a series of smaller fragments, and spatial
anomalies (e.g. A1 and A3) will possibly be ignored. Second, this method can only detect single
spatial anomaly points or spatial anomaly regions, and is not suitable for their mixture. Third,
this method requires users to input numerous parameters (e.g. the number of spatial anomaly
points, the non-spatial attribute difference threshold for deleting edges).

Moreover, most spatial datasets consist of discrete sampling points. By considering the spa-
tial distance, the dataset in Figure 1b can be seen as a combination of two sets of points that

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Spatial Anomaly Points and Regions Detection Method

5

are relatively distant from one another, and form two semi-circles. In terms of non-spatial
attribute values, they can also be divided into two parts; one part is the red and yellow points
with non-spatial attribute values [3, 4]; the other is the blue points with non-spatial attribute
values [10, 12]. Note that yellow points are far away from red points, even though they have
similar non-spatial attribute values. They are close to blue points, but are signiﬁcantly different
in terms of their non-spatial attribute values. As a result, these three yellow points will form a
spatial anomaly region. For discrete spatial sampling datasets, it is often difﬁcult to determine
spatial neighbors because of the complex shape and uneven density of the dataset.

To accurately and adequately detect single spatial anomaly points and spatial anomaly
regions simultaneously from complex discrete spatial sampling datasets, a hybrid approach
using multi-constraint graphs and local density is proposed in this article.

2.3 A New Strategy for Detecting Spatial Anomalies in Spatial Datasets

The construction of spatial proximity relationships and the measurement of non-spatial attrib-
ute differences (hereafter called the non-spatial attribute distance) are two critical factors in dis-
covering spatial anomalies accurately and sufﬁciently. Moreover, those anomalies that have
signiﬁcantly different non-spatial attribute values to their spatial neighbors will affect the pro-
cess of anomaly detection (Shekhar et al. 2003; Chawla and Sun 2006). With this in mind, this
article proposes a new strategy for detecting spatial anomalies in spatial datasets. The frame-
work is shown in Figure 2. In this framework, there are two main parts: (1) Multi-constrained
graph construction; and (2) Spatial anomaly detection based on spatial anomaly degree.

2.3.1 Imposing multi-constraints on Delaunay triangulation

Delaunay triangulation (Tsai 1993) with second-order constraints is ﬁrst employed to remove
long edges using two statistical constraints. In this case, a more reasonable spatial proximity
graph, which consists of a series of connected sub-graphs, is constructed. For each sub-graph,
those edges connecting two entities with a large non-spatial attribute distance will be further
removed using two other statistical constraints. This procedure obtains improved sub-graphs.

2.3.2 Detecting spatial anomalies based on local density

According to the volume of these sub-graphs and their adjacent sub-graphs, three kinds of pat-
tern can be identiﬁed (i.e. relative homogeneity patterns, apparent heterogeneity patterns, and
apparent spatial anomaly patterns). Further, the spatial anomaly degree of each entity belong-
ing to relatively homogeneous patterns and apparent spatial anomaly patterns is calculated by
a local-density strategy. The spatial interpolation surface of the spatial anomaly degrees of all
entities is generated and used to visually represent the potential distribution of spatial anoma-
lies. In the following, the SAPRD algorithm is described in detail.

3 The SAPRD Algorithm

In this section, the precise formulation of the SAPRD algorithm is introduced. Section 3.1
describes the construction of multi-constrained graphs. The process of spatial anomaly detec-
tion based on the spatial anomaly degree is discussed in Section 3.2. Finally, a description of
the SAPRD algorithm is given in Section 3.3.

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

6

Y Shi, M Deng, X Yang and Q Liu

Figure 2 Our framework of detection spatial anomalies in spatial datasets

3.1 Multi-Constrained Graph Construction

3.1.1 Two spatial distance constraints on the spatial proximity graph

The initial spatial sampling dataset often represents a discrete state of disorder, making it difﬁ-
cult to ﬁnd the spatial neighbors of each spatial entity. It has been proven that Delaunay trian-
gulation is an efﬁcient means of describing natural spatial proximity relationships. In fact,
Delaunay triangulation has already been successfully used in spatial clustering (Estivill-Castro
and Lee 2002a,b; Deng et al. 2011). In Delaunay triangulation, a vertex represents a spatial
entity, and edges connect two adjacent entities. However, spatial datasets are usually irregu-
larly distributed, and thus the spatial proximity graph built by the initial Delaunay triangula-
tion will possibly contain some errors in its boundary and some gaps between low- and high-
density regions. As shown in Figure 3, the edges intersected with dashed lines are obviously
erroneous, and appear in some regions with uneven density, such as boundaries, holes, and so
on. To obtain the accurate spatial proximity relationships, two spatial distance constraints will
be imposed on the initial Delaunay triangulation to delete such global and local long edges.

Deﬁnition 1: First-order spatial distance constraint:
Given a spatial database SDB with N spatial entities, the Delaunay triangulation DT is
ﬁrst constructed. In Delaunay triangulation, a vertex represents a spatial entity Pi, and an

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Spatial Anomaly Points and Regions Detection Method

7

Figure 3 An example of Delaunay triangulation: (a) A spatial dataset; and (b) The Delaunay trian-
gulation built on (a)

Þ. The average and standard deviation of all edge
edge Ei has spatial distance LenS Eið
lengths in the Delaunay triangulation, denoted as MeanS DTð
Þ, can then be
calculated. For an edge Ei, its ﬁrst-order spatial distance constraint indicator, denoted as
SA CI1ðEiÞ, is deﬁned as:

Þ and SDS DTð

SA CI1ðEiÞ5MeanSðDTÞ1aS (cid:2) SDSðDTÞ; where aS5

MeanSðDTÞ
LenSðEiÞ

Then, the ﬁrst-order long edges in the Delaunay triangulation can be further deﬁned as:

(cid:3)
SA LE15 8Ei : LenSðEiÞ > 5SA CI1ðEiÞ

(cid:2)

In Equation (1), aS is a self-adaptive coefﬁcient. One can see that a longer edge corre-
sponds to a smaller aS, so aS performs the function of identifying all ﬁrst-order long

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

(1)

(2)

8

Y Shi, M Deng, X Yang and Q Liu

Figure 4 Two order constraints on the initial Delaunay triangulation: (a) The initial Delaunay trian-
gulation; (b) The spatial proximity relationship after the ﬁrst-order constraint; and (c) The spatial
proximity relationship after the second-order constraint

edges. As shown in Figure 4a, ﬁrst-order long edges are viewed from a global perspective,
e.g. the edge E1 connecting points P1 and P2. After removing such global long edges, a
modiﬁed Delaunay triangulation is obtained and the spatial proximity relationships are
repaired, as shown in Figure 4b. However, there are still some edges that are relatively
long compared with their local surroundings, such as those edges in the region surrounded
by bold solid lines in Figure 3b. Therefore, a second-order spatial distance constraint is
deﬁned to further reﬁne the spatial proximity relationships.

Deﬁnition 2: Second-order spatial distance constraint:
After imposing SA CI1, all entities and remaining edges constitute a series of sub-graphs,
namely SGk, such as SG1 and SG2 in Figure 4b. Each spatial entity corresponds to a
group of local edges and the updated spatial neighbors. For an entity Pi in SGk, the set
of local edges is denoted as LEi, and each member in LEi
is denoted as LEij and has
length LenS LEij
Þ represent the average and standard deviation
of all edge lengths in LEi, respectively. For SGk, the second-order spatial distance con-
straint indicator for LEij can be deﬁned as:

(cid:5). MeanS LEi

Þ and SDS LEi

(cid:4)

ð

ð

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Spatial Anomaly Points and Regions Detection Method

9

(3)

(4)

SA CI2ðLEijÞ5MeanSðLEiÞ1bS

; where bS5bS

n

0 (cid:2) MeanSðLEiÞ
LenSðLEijÞ

n
X

j51

(cid:2)

SDSðLEiÞ

Then, the second-order spatial long edges in the updated spatial proximity graph can be
deﬁned as:

SA LE25 8LEij : LenSðLEijÞ > 5SA CI2ðLEijÞ

(cid:2)

(cid:3)

0. Based on numer-
To ﬁnd all second-order long edges, we require a suitable value for bS
ous experiments and the suggestion given by Liu et al. (2012), it is appropriate to take a
value of 2 for this parameter. All of the identiﬁed local long edges are then deleted to fur-
ther reﬁne the spatial proximity relationships. After imposing the above two spatial con-
straints, the correct spatial neighbors SN Pið
Þ have been captured for each spatial entity Pi
in SDB, as shown in Figure 4c.

3.1.2 Two non-spatial attribute distance constraints on spatial proximity graphs

The relationship between spatial and non-spatial attributes can be described by Tobler’s ﬁrst law
of geography (Tobler 1970), which states that the nearer two spatial entities are to each other,
the more similar they are in terms of their non-spatial attributes. In other words, the non-spatial
attribute distance between two adjacent entities should be very small. However, spatial heteroge-
neity (Adam et al. 2004) perhaps leads some entities or regions to have signiﬁcantly different
non-spatial attribute values from their neighbors. In this case, spatial anomalies are very possibly
embedded in spatially heterogeneous regions. To extract these heterogeneous regions, two con-
straints are employed to analyze the non-spatial attribute distance between adjacent entities on
the basis of the accurate spatial proximity graph obtained in the previous section. These two con-
straints are now described in detail and visually represented by a set of simulated data.

Deﬁnition 3: First-order non-spatial attribute distance constraint:
The accurate spatial proximity relationships in SDB constitute a series of sub-graphs, e.g.
FSG1, FSG2, and FSG3 in Figure 4c.
In FSGk, each remaining edge is denoted as
FSGk Eið
Þ, and its weight is deﬁned by the non-spatial attribute distance between the two
connected spatial entities:

LenNS FSGk Eið
½

(cid:3)5jAttrNSðPiÞ2AttrNSðPjÞj
Þ

(5)

where AttrNSðPiÞ and AttrNSðPjÞ are the non-spatial attribute values of entities Pi and Pj,
respectively. MeanNS FSGk Eð Þ
(cid:3) are the average non-spatial attribute
distance and the corresponding standard deviation of all edges in FSGk. In view of the
weights of all edges in FSGk, the ﬁrst-order non-spatial attribute distance constraint indi-
cator can be deﬁned as:

(cid:3) and SDNS FSGk Eð Þ

½

½

NSA CI1½FSGkðEiÞ(cid:3)5MeanNS FSGk Eð Þ

½

(cid:3)1aNS (cid:2) SDNS FSGk Eð Þ
(cid:3);

½

where aNS5

MeanNS FSGk Eð Þ
(cid:3)
½
LenNS FSGk Eið
(cid:3)
Þ
½

(6)

Then, ﬁrst-order non-spatial long edges, i.e. those edges with a large non-spatial attribute
distance in FSGk, can be deﬁned as:

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

10

Y Shi, M Deng, X Yang and Q Liu

Figure 5 Two order constraints on non-spatial attribute difference: (a) A selected sample region;
(b) A presentation describing the ﬁrst-order constraint; and (c) A presentation describing the
second-order constraint

NSA LE15 8Ei 2 FSGk : LenNS½FSGk Eið

Þ(cid:3) (cid:4) NSA CI1½FSGkðEiÞ(cid:3)

(cid:2)

(cid:3)

(7)

To explain this process visually, Figure 5a shows a sample region selected from FSG1, in
which the numbers attached to the entities represent the simulated non-spatial attribute
values. In Figure 5b, blue dashed lines represent the identiﬁed ﬁrst-order non-spatial long
edges. It can be seen that these long edges connect two spatial entities whose non-spatial
attribute values are signiﬁcantly different from each other at the global level. Thus, these
edges will be deleted to further repair the proximity graph. In addition to ﬁrst-order non-
spatial
long edges, some edges remain that have locally large non-spatial attribute dis-
tance, such as the red solid edges in Figure 5b. These edges need to be further identiﬁed
and deleted.

Deﬁnition 4: Second-order non-spatial attribute distance constraint:
A new series of sub-graphs FSGkm is obtained after imposing NSA CI1 in each FSGk. For
Þ denotes the set of local edges, and each member of
an entity Pi

in FSGkm, FSGkm LEi

ð

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Spatial Anomaly Points and Regions Detection Method

11

Þ

(cid:4)

is

as

(cid:5) with
distance
denoted
attribute
FSGkm LEi
ð
(cid:7). Then, the average and standard deviation of FSGkm LEi
(cid:5)
(cid:6)
LenNS FSGkm LEsij
Þ can be
calculated, and these are denoted as MeanNS FSGkm LEi
(cid:3), respec-
(cid:3) and SDNS FSGkm LEi
½
Þ
½
tively. For each FSGkm, the second-order non-spatial attribute distance constraint for FS
(cid:4)
Gkm LEij

(cid:5) can be deﬁned as:

FSGkm LEij

non-spatial

ð
ð

(cid:4)

ð

Þ

NSA CI2½FSGkm LEij

(cid:4)

(cid:5)(cid:3)5Mean½FSGkm LEi

ð

Þ(cid:3)1bNS (cid:2)

n
X

i051

SD½FSGkm LEi0

ð

Þ(cid:3)

n

; LEi0 2 FSGkm

where bNS5

MeanNS½FSGkm LEi
Þ(cid:3)
(cid:5)(cid:3)
LenNS½FSGkm LEij

(cid:4)

ð

(8)

Then, the second-order non-spatial long edges in each FSGkm are given by:

(cid:2)
NSA LE25 8FSGkm LEij

(cid:4)

(cid:5) : LenNS½FSGkm LEij

(cid:4)

(cid:5)(cid:3) (cid:4) NSA CI2½FSGkm LEij

(cid:4)

(cid:5)(cid:3)

(cid:3)

(9)

By eliminating all second-order non-spatial long edges (e.g. red dashed lines in Figure 5c),
the whole proximity graph can be further reﬁned. Eventually, those coupled entities con-
nected by the remaining edges are not only spatially adjacent, but also similar in terms of
their non-spatial attributes. The ﬁnal neighbors of each entity are denoted as FN Pið
Þ, and
each ﬁnal sub-graph is denoted as FGk.

3.1.3 Identiﬁcation of spatial distribution patterns

A spatial dataset may include three kinds of pattern, namely relative homogeneity patterns
(RHOPs), apparent heterogeneity patterns (AHEPs), and apparent spatial anomaly patterns
(ASAPs). RHOPs include those regions that have a wide spatial distribution and numerous enti-
ties with minor changes in terms of non-spatial attribute values. AHEPs consist of a series of
small adjacent regions with no homogeneous surrounding regions. These regions have similar
sizes but apparently different non-spatial attribute values. ASAPs include very small regions
adjacent to homogeneous regions. Note that AHEPs and ASAPs both consist of a series of small
graphs. The critical difference between them is in their type of neighbor. If none of the graphs
adjacent to a small graph belong to an RHOP, then this small graph belongs to an AHEP. Oth-
erwise, it is part of an ASAP. Therefore, ASAPs can be considered as a special kind of AHEP.
To determine the various patterns, some related concepts are introduced in the following
deﬁnitions.

Deﬁnition 5: Adjacent graphs:
Given a set of sub-graphs obtained by the above process, if an entity Pi satisﬁes:

a. Pi 2 FGm; and
b. 9Pj 2 SNðPiÞ; where Pj 2 FGn and FGn 6¼ FGm
then Pi is deﬁned as a turning entity between FGm and FGn, denoted as TPi
identifying all turning entities in FGm, the graphs adjacent to FGm, denoted as AG FGm
can be further obtained.

FGm!FGn . By
Þ,
ð

Deﬁnition 6: Candidate apparent spatial anomaly patterns:
For a sub-graph FGk, an indicator is proposed to measure whether its volume (the num-
ber of entities belonging to FGk) is extremely small. This is deﬁned as:

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

12

Y Shi, M Deng, X Yang and Q Liu

Figure 6 The obtained spatial anomaly pattern and heterogeneous pattern (ASAP: colorful solid
symbols; AHEP: colorful hollow symbols; RHOP: black points)

CSA I FGk
ð

Þ5MeanVol FGð

Þ2c (cid:2) SDVol FGð

Þ; where c5

jFGkj
MeanVolðFGÞ

In Equation (10), MeanVolðFGÞ is the average volume of all sub-graphs, SDVolðFGÞ is the
standard deviation, and c is a self-adaptive coefﬁcient. The candidate spatial anomaly sub-
graphs can then be deﬁned as:

CSAs5 8FGk :
f

jFGKj < 5CSA IðFGkÞg

By combining Equations (9) and (10), it can be seen that a smaller jFGkj corresponds to
a smaller c and a larger CSA I FGk
Þ. As a result, c has the ability to extract all extremely
small sub-graphs, without omission.

ð

Deﬁnition 7: Apparent spatial anomaly patterns:
A sub-graph FGk that satisﬁes the following two conditions is an apparent spatial anom-
aly sub-graph, i.e.

(10)

(11)

a. FGk 2 CSAs; and
b. 9FGl 2 AGðFGkÞ : FGl 2 RHOP.

All apparent spatial anomaly sub-graphs constitute ASAPs, whereas the other candidate
apparent spatial anomaly sub-graphs constitute AHEPs. Figure 6 denotes the identiﬁed
ASAPs, AHEPs, and RHOPs with different symbols.

3.2 Spatial Anomaly Detection Based on Local Density

The above process can qualitatively identify apparent spatial anomalies, but cannot reﬂect their
quantitative degree. In addition, the sub-graphs belonging to RHOPs may potentially contain
heterogeneous entities, whose non-spatial attribute values are locally inconsistent with those of
most of their neighbors. However, these heterogeneous entities are not different from their
neighbors, so cannot be accurately detected by the above indicators. Indeed, these special entities
belong to potential spatial abnormal patterns. Thus, it is necessary to further measure the spatial
anomaly degree for each entity. Traditional methods consider each entity in the same manner.

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Spatial Anomaly Points and Regions Detection Method

13

This leads to a large non-spatial attribute distance between adjacent sub-graphs, which affects
the identiﬁcation of true spatial anomalies. To solve this problem, a modiﬁed local density-based
approach is developed to analyze and calculate the spatial anomaly degree. In this local density
approach, spatial anomaly patterns are represented hierarchically.

3.2.1 Repairing spatial proximity relationships

It should be noted that each pair of nodes is not necessarily connected by an edge in the ﬁnal
sub-graph. If two entities are spatially adjacent, but there is no edge connecting them, then
there is some difference in terms of their non-spatial attribute values. In a sub-graph, edges
often indicate relatively homogeneous parts. In this case, spatial anomalies certainly exist in
those potentially heterogeneous parts where edges are eliminated, even though the correspond-
ing nodes are spatially adjacent. Therefore, the spatial proximity relationships in sub-graphs
need to be repaired so that the innate difference can be described and the spatial anomaly
degree measured accurately.

Deﬁnition 8: Compared neighborhood set:
a. Given a sub-graph FGk in RHOP and an entity Pi in FGk, if another entity Pj satisﬁes:
Þ, then Pj will be put into a different neighborhood set to Pi,
Þ together constitute the compared neigh-

Þ and Pj 62 FN Pið

Pj 2 SN Pið
i.e. Pj 2 AN Pið
borhood set of Pi, denoted as CN Pið

Þ. Therefore, AN Pið

Þ and FN Pið

Þ.

b. Given a sub-graph FGk in ASAP and a turning entity Pi in FGk, if entity Pj satisﬁes:
9Pj 2 SNðPiÞ : Pj 2 FGl; and FGl 2 RHOP, then Pi will be deﬁned as a feature anomaly
and Pj will be put into CN Pið

Þ.

3.2.2 Spatial anomaly degree measurement based on local density

In our framework, the spatial anomaly degree is calculated by a two-stage strategy. At the mac-
roscopic level, the spatial anomaly degree is used to describe to what extent an ASAP is differ-
ent from an adjacent RHOP. Through a further analysis, the spatial anomaly degree can reﬂect
the inconspicuous heterogeneous regions within an RHOP. In terms of AHEPs, it is difﬁcult to
quantitatively analyze the spatial anomaly degree, because there may be large local differences,
disordered distributions, and a lack of “normal” reference entities. In the following, a modiﬁed
approach for measuring the spatial anomaly degree is developed based on the idea of local den-
sity (Ester et al. 1996; Breunig et al. 2000; Chawla and Sun 2006).

Deﬁnition 9: Spatial anomaly degree in ASAPs:
For a sub-graph FGk in an ASAP, all feature anomalies in FGk constitute a set FA,
denoted as FA5 fa1; fa2; . . . ; fan
g. Given a feature anomaly fai, the local density of fai
f
can be deﬁned as:

L DenðfaiÞ51=

; Pi0 2 CNðfaiÞ

(12)

jCNðfaiÞj
X

i051

2

6
6
6
6
4

(cid:8)attrNSðfaiÞ2attrNSðPi0 Þ(cid:8)
(cid:8)
(cid:8)

(cid:8)
(cid:8)CNðfaiÞ(cid:8)
(cid:8)

3

7
7
7
7
5

For Pi0 2 CN fai

ð

Þ, the local density is deﬁned as:

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

14

Y Shi, M Deng, X Yang and Q Liu

L DenðPi0 Þ51=

; Pj 2 CNðPi0 Þ

(13)

jCNðPi0 Þj
X

j51

2

6
6
6
6
6
4

(cid:8)attrNSðPi0 Þ2attrNSðPjÞ(cid:8)
(cid:8)
(cid:8)

(cid:8)
(cid:8)CNðPi0 Þ(cid:8)
(cid:8)

3

7
7
7
7
7
5

The spatial anomaly degree of fai can then be deﬁned as:

"

jCNðfaiÞj
X

i051

#

L DenðPi0 Þ

(cid:8)CNðfaiÞ(cid:8)
=(cid:8)
(cid:8)

L DenðfaiÞ

SADðfaiÞ5

; Pi0 2 CNðfaiÞ

(14)

To avoid confusion with entities in AHEPs and represent the anomaly degree of ASAP
clearly, only the non-spatial attribute distance between a feature anomaly and its adjacent
entities in an RHOP is considered.

Deﬁnition 10: Spatial anomaly degree in RHOPs:
For a sub-graph FGk in an RHOP, the spatial anomaly degree of an entity Pi within FGk
is deﬁned as:

"

jCNðPiÞj
X

i051

#

L DenðPi0 Þ

(cid:8)CNðPiÞ(cid:8)
=(cid:8)
(cid:8)

L DenðPiÞ

SADðPiÞ5

; Pi0 2 CNðPiÞ

(15)

Unlike the measurement of entities in ASAPs, the main function of the spatial anomaly
degree in RHOPs is to determine the non-spatial attribute distance between an entity and
its spatial neighbors in the same sub-graph.

3.2.3 Spatial anomaly pattern representations based on spatial anomaly degree

For all entities in RHOPs and feature anomalies in ASAPs, the spatial anomaly degree can be
used to construct a spatial interpolation surface by an interpolation method. In this article, the
inverse distance weighted (IDW) spatial interpolation method is selected for its simplicity and
efﬁciency. Further, the spatial interpolation surface can reﬂect the locally maximum spatial
anomaly degree, i.e. provide a visual representation of local heterogeneity (Franke and Gertz
2008). As shown in Figure 7a, the spatial interpolation surface is obtained from the spatial
anomaly degree calculated for the simulated data, where the entities in AHEPs have been
removed. One can see that those entities in ASAPs have locally maximum spatial anomaly
degrees, colored deep blue. However, some potential spatial anomalies are not identiﬁed, as
shown by the red circles in the example region. To overcome this problem, different spatial
anomaly degree classiﬁcations can be used to visualize different details and distributions of spa-
tial anomaly patterns. In this example, it is more difﬁcult to highlight the potential spatial
anomalies by means of a hierarchical visualization of spatial anomaly degree, because the spa-
tial anomaly degrees of entities in the ASAPs mask those potential spatial anomalies with a
lower spatial anomaly degree. To solve this issue, those apparent spatial anomalies are deleted,
and the spatial interpolation surface is drawn from only the entities in RHOPs with a more
detailed hierarchy of spatial anomaly degree, as shown in Figure 7b. In this way, the potential

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Spatial Anomaly Points and Regions Detection Method

15

Figure 7 The process of presenting apparent and potential spatial anomaly pattern: (a) The spatial
interpolation surface drawn based on spatial anomaly degree of each entity except entities in het-
erogeneous regions; and (b) The spatial interpolation surface drawn based on spatial anomaly
degree of each entity except entities in heterogeneous regions and spatial anomalies

spatial anomalies colored deep blue can be highlighted, e.g. those on the right side of
Figure 7b.

3.3 Algorithm Description

The SAPRD algorithm can be summarized in four steps. The details of each step and its time
complexity are elaborated below:

Input: A spatial database SDB containing N spatial point entities with both spatial coor-

dinates and a certain type of non-spatial attribute

Output: Spatial anomaly patterns
Step I Construct spatial proximity graph based on two spatial distance constraints:

a. Construct the Delaunay triangulation for SDB to obtain the initial spatial proxim-

b.

ð

Þ time.

ity graph, requiring O NlogN
Impose the ﬁrst-order spatial distance constraint on the initial spatial proximity
graph to remove global spatially long edges, and obtain an improved spatial prox-
imity graph. The time complexity of this step is O M1
Þ, where M1 is the number
of edges in the initial spatial proximity graph.

ð

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

16

Y Shi, M Deng, X Yang and Q Liu

constraints:
a.

c.

Impose the second-order spatial distance constraint on the improved spatial proxim-
ity graph to remove local spatially long edges, and obtain the accurate spatial prox-
imity graph. The time complexity of this operation is about O N(cid:2)m1
Þ, where m1 is
the average number of spatial neighbors of all entities after the ﬁrst-order spatial dis-
tance constraint.

ð

Step II Construct ﬁnal proximity graph based on two non-spatial attribute distance

b.

Impose the ﬁrst-order non-spatial attribute distance constraint on the accurate spa-
Þ, where M2 is the number of
tial proximity graph. The time complexity is O M2
edges in the accurate spatial proximity graph.
Impose the second-order non-spatial attribute distance constraint, and obtain the
ﬁnal proximity graph. This has a time complexity of about O N(cid:2)m2
Þ, where m2 is
the average number of neighbors of all entities after the two spatial distance con-
straints and the ﬁrst-order non-spatial attribute distance constraint.

ð

ð

Step III Determine various spatial distribution patterns:

a. Based on the ﬁnal proximity graph, the ﬁnal sub-graphs are obtained. The time

complexity is O Nð

Þ.

b. Calculate the volume of each sub-graph and determine various spatial distribution
Þ, where N1 and n are
patterns. The time complexity of this step is about O N1
the number of ﬁnal sub-graphs and the average number of turning entities in all
ﬁnal sub-graphs, respectively.
Step IV Detect spatial anomaly patterns:

(cid:2)n

ð

a. Calculate the spatial anomaly degree of feature anomalies in ASAPs and all entities
in RHOPs. The time complexity here is about O N0(cid:2)m3
Þ, where N0 and m3 are the
number of spatial entities involved in the calculation and the average number of
spatial entities in their compared neighborhoods, respectively.

ð

b. Visually represent the spatial anomaly patterns by constructing the spatial interpo-

lation surface. The time complexity of this operation is O N0

ð

Þ.

4 Experimental Results and Comparisons

In this section, both simulated and real-life datasets are employed to test the proposed SAPRD algo-
rithm. Section 4.1 describes an experimental comparison on simulated datasets with ﬁve spatial
anomaly detection algorithms, namely SLZ (Shekhar et al. 2003), SLOM (Chawla and Sun 2006),
ST-DBSCAN (Birant and Kut 2006), POD-ROD (Lu 2011). Sections 4.2 and 4.3 describe two case
studies on meteorological and environmental datasets using the SAPRD algorithm.

4.1 Experimental Comparisons on Simulated Datasets

4.1.1 Simulated spatial dataset description

The simulated spatial dataset used in Section 3 will be utilized to test the SAPRD algorithm. This
simulated dataset contains three-dimensional attributes, i.e. two-dimensional spatial attributes and a
one-dimensional non-spatial attribute. Figure 8 shows the spatial distribution and non-spatial attrib-
ute values of each entity. This dataset was generated by ArcGIS 10.0, and the spatial distribution was
designed by presetting different densities. For example, regions R1 and R2 are obviously sparser than
regions R3 and R4. In addition, the non-spatial attribute value is evenly assigned to each entity. More-
over, some predeﬁned spatial anomalies and spatial heterogeneous patterns exist in this simulated

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Spatial Anomaly Points and Regions Detection Method

17

Figure 8 The initial simulated spatial dataset. (a) The spatial distribution, preset ASAP and AHEP
signed by different symbols (ASAP: colorful solid symbols; AHEP: colorful hollow symbols); and
(b)-(e) The preset distribution of non-spatial attribute value for R1-R4, respectively

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

18

Y Shi, M Deng, X Yang and Q Liu

Figure 9 The spatial anomaly detecting result of SAPRD: (a) The apparent spatial anomaly pattern
and heterogeneous pattern (colorful solid symbols: apparent spatial anomaly pattern; colorful hol-
low symbols: apparent heterogeneous pattern; black points: relatively homogeneous pattern); (b)
the spatial interpolation surface drawn based on spatial anomaly degree of each entity except enti-
ties belonging to AHEP; and (c) the spatial interpolation surface drawn based on spatial anomaly
degree of each entity belonging to RHOP

dataset. To test the accuracy of the SAPRD algorithm, these predeﬁned spatial anomalies and spatial
heterogeneous patterns were assigned non-spatial attribute values with signiﬁcantly different distribu-
tion characteristics. In addition, we examined the two special situations shown in Figures 8b and c.
The entities within red circles are very different from their adjacent entities, as they obey an even dis-
tribution from a local viewpoint. Therefore, they are local spatial anomalies, and should be identiﬁed
as such. One can see that the entities within the red ellipse also have different non-spatial attribute
values from their neighbors. However, their adjacent entities are unevenly distributed. And subtle dif-
ferences with some adjacent entities, such as the upper entity with non-spatial attribute value 1.2,
mean that the two signed entities will be assigned to a RHOP after a series of local connectivity.

4.1.2 Experimental results from the SAPRD algorithm

The spatial anomaly detection results given by SAPRD are shown in Figure 9. Figure 9a shows
the apparent spatial anomaly patterns and heterogeneity patterns, and Figures 9b and c show

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Spatial Anomaly Points and Regions Detection Method

19

Table 1

The quantitative results performed on the simulated dataset

Algorithms

True
Positives

False
Positives

False
Negatives

True
Negatives

Precision

recall

SLZ (KNN, k520, h51.4)
SLZ (CDT, h51.5)
SLOM
(KNN, k515, n581)
SLOM (CDT, n581)
ST-DBSCAN (Eps1545,
Eps250.5, MinPts55)
POD-ROD (k55, N512,

TEDGE50.08)

SAPRD

42
35
59

53
19

81

81

8
8
22

28
8

2

2

39
46
22

28
62

0

0

273
273
259

253
273

279

279

84.0%
81.4%
72.8%

65.4%
70.4%

51.8%
43.2%
72.8%

65.4%
23.5%

97.6%

100%

97.6%

100%

the spatial interpolation surface given by the spatial anomaly degrees of entities outside of
AHEPs and only in RHOPs, respectively. One can see that the apparent spatial anomaly pat-
terns and heterogeneity patterns identiﬁed by SAPRD are largely consistent with the predeﬁned
spatial anomalies in the simulated dataset. This illustrates that SAPRD cannot only detect vari-
ous kinds of single anomaly point and anomalous regions surrounded by homogeneity, but also
that heterogeneity regions can be distinguished. In summary, SAPRD considers both the local
non-spatial attribute distance and the spatial and non-spatial distribution characteristics of a
spatial dataset. Therefore, the two special situations mentioned above can be accurately dealt
with by SAPRD.

4.1.3 Experimental comparisons with other algorithms

Table 1 summarizes the detection results obtained by the SLZ, SLOM, ST-DBSCAN, POD-
ROD and SAPRD algorithms in a quantitative form, including true positives, false positives,
false negatives, true negatives, precision and recall. For SLZ and SLOM, two kinds of spatial
proximity construction methods are employed, i.e. k-nearest neighbors (KNN) and constrained
Delaunay triangulation (CDT). For all algorithms, the parameters are determined after numer-
ous experiments to obtain an ideal result. From Table 1, one can see that SLZ obtains more
accurate detection results (the precision is respectively 84.0% and 81.4% for KNN and CDT
neighbors) than SLOM (the precision is respectively 72.8% and 65.4% for KNN and CDT
neighbors) and ST-DBSCAN (the precision is 70.4%). For recall, SLZ and SLOM extract more
true spatial anomalies than ST-DBSCAN, because most spatial anomaly regions are clustered
into bigger clusters by ST-DBSCAN. However, in SLZ and SLOM, the true anomalies affect
the measurement of the spatial anomaly degree, so that the spatial anomaly degree of entities
adjacent to true anomalies is very high. ST-DBSCAN does not sufﬁciently consider the local
differences between spatial entities. So they all cannot obtain as ideal results as POD-ROD and
SAPRD, which return almost consistent results with the predeﬁned one.

In fact, POD-ROD is a graph-based method which is similar to SAPRD. In the removal of
edges, both spatial and non-spatial distribution characteristics are neglected by POD-ROD. As
the spatial and non-spatial distributions of the simulated dataset are both relatively even, POD
and ROD obtains a similar result with SAPRD. To further illustrate the limitation of POD-

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

20

Y Shi, M Deng, X Yang and Q Liu

Table 2

The quantitative results performed on the modiﬁed simulated dataset

Algorithms

True
Positives

False
Positives

False
Negatives

True
Negatives

Precision

recall

POD-ROD (k55, N512,

56

TEDGE50.08)

SAPRD

81

58

2

25

0

223

279

49.1%

69.1%

97.6%

100%

ROD, a modiﬁed simulated dataset was obtained by expanding the non-spatial attribute values
of the entities in R4 by a factor of 10 and retaining the same spatial distribution. This causes all
non-spatial attribute distances in R4 to be obviously larger than those in R1, R2, and R3. With
this modiﬁed simulated dataset, SAPRD also obtains satisfactory results. However, a number
of erroneous and missing identiﬁcations, the precision and recall are respectively 49.1 and
69.1%, arise in the results given by POD-ROD, as shown in Table 2.

The above analysis and comparisons demonstrate the advantages of the SAPRD algorithm.
For irregularly distributed spatial data, SAPRD can detect apparent and potential spatial anom-
aly patterns and heterogeneous patterns more efﬁciently and robustly than previous
algorithms.

4.2 Case Study I: Detection of Anomalous Precipitation

A meteorological dataset was provided by the China Meteorological Bureau. This dataset
includes the monthly average precipitation of 527 weather stations in the east and central main-
land of China from 1982–2011. The name and administration boundary of each province in
China and the spatial distribution of the weather stations are shown in Figures 10a and b,
respectively. In this experiment, the summer precipitation (i.e. the accumulated precipitation of
June, July, and August) for the years 1997–2001 was selected for practical application. The rea-
sons for this selection are two-fold. First, they provide some prior knowledge, and this can be
further used to test the validity of the SAPRD algorithm. Second, some interesting patterns can
be discovered in the process of spatial anomaly detection.

The apparent spatial anomaly patterns and heterogeneity patterns for summer precipita-
tion in the years 1997–2001, as obtained by SAPRD, are shown in Figures 11a-e, respectively.
Correspondingly, the spatial interpolation surfaces based on the spatial anomaly degree of the
entities in RHOPs and ASAPs are shown in Figure 12.

By analyzing the results for these ﬁve years, similar patterns and obvious distinctions can
be identiﬁed. On the whole, those regions exhibiting spatial anomaly patterns include the north
of Heilongjiang Province,
the south of Guangxi,
Guangdong, and Hainan Provinces, and so on. In 1998 and 1999, the precipitation in the
southeastern parts of China, i.e. Jiangxi, Zhejiang, and Fujian provinces, becomes signiﬁcantly
different from that in adjacent regions. In 2000, extreme precipitation fell in the middle and
lower reaches of the Yellow River and midwest China.

the southwest of Yunnan Province,

Because of limitations on space, only information about the summer precipitation of
spatial anomalies (i.e. R1 in Figure 12b) and their neighboring entities (i.e. R2 in Figure 12b)
over the ﬁve consecutive years are used to compare the differences in summer precipitation (see
Tables 3–7). By comparing the values in these tables, it can be found that the summer precipita-
tion in R1 is commonly heavier than that in R2. This is mainly because R1 is closer to the ocean,

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Spatial Anomaly Points and Regions Detection Method

21

Figure 10 The meteorological dataset: (a) The information of each province in China; and (b) The
spatial distribution of meteorological stations in China

and thus more strongly affected by typhoons. However, it is clear that the summer precipitation
in these two regions in 1998 and 1999 is much heavier than in the other three years. Moreover,
spatial anomaly region R1 recorded signiﬁcantly heavier summer precipitation than its adjacent
region R2 in 1998 and 1999 compared with the other three years. It is worthwhile noting that
the El Nino phenomenon occurred in 1998, resulting in serious ﬂood events in regions near
Dongting Lake, Poyang Lake, Songhua River, and Nen River (located in the north of Heilong-
jiang Province). Therefore, the spatial anomaly regions identiﬁed by SAPRD are highly consist-
ent with prior knowledge, proving the practicability of the proposed algorithm. In addition,
heterogeneity patterns occur in the southwest areas of Yunnan Province and Hainan Island.
These are due to the complex terrain of those regions. The southeast monsoon and proximity
to the ocean mean that precipitation in the southeast coastal areas of China is generally heavier

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

22

Y Shi, M Deng, X Yang and Q Liu

Figure 11 The apparent spatial anomaly pattern and heterogeneous pattern about the precipita-
tion in summer: (a)-(e) the results of 1997-2001, respectively. NR: Spatial normal regions; HP: Spa-
tial heterogeneous points; AP: Spatial anomaly points; HR: Spatial heterogeneous regions; AR:
Spatial anomaly regions

than in surrounding areas. The extremely heavy precipitation in the middle and lower reaches
of the Yellow River in 2000 is, to a large degree, due to the continued inﬂuence of the El Nino
phenomenon.

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Spatial Anomaly Points and Regions Detection Method

23

Figure 12 The potential spatial anomaly pattern about the precipitation in summer: (a)-(e) the
results of 1997-2001, respectively

In addition, Figure 12 illustrates some potential spatial anomalies in each of the ﬁve con-
secutive years (e.g. in the southern areas of China in 1999 and 2001). Although these anomalies
are not heterogeneous enough to be identiﬁed as AHEPs or ASAPs, they all have the maximum
spatial anomaly degree at the local level. Moreover, unknown but useful and important pat-
terns (e.g. the range of regions affected by ASAPs or those regions that will become anomalies)

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

R1 ID

R2 ID

Precipitation

(mm)

Precipitation

(mm)

R1 ID

R2 ID

Precipitation

(mm)

Precipitation

(mm)

R1 ID

R2 ID

Precipitation

(mm)

Precipitation

(mm)

R1

R2

(mm)

(mm)

24

Y Shi, M Deng, X Yang and Q Liu

Table 3
in R1 and R2 labeled in Figure 12b

The information about the difference of summer precipitation in 1998 between entities

360

370

457 461
1217 1137 1410 1363 1111 1368 1051 942 1449 970 1291 1001 1053 805

448 449

446 447

450

440

438

432

456

429

352

431 464
342
390 868 664 783 766 737 617 473 319 454 468 541 536 477

421 422

380 381

358

423

369

424

357

359

Table 4
in R1 and R2 labeled in Figure 12b

The information about the difference of summer precipitation in 1997 between entities

461
360 370 429
553 567 401 1283 1158 698 672 741 827 750 807 996 900 1002

438 440 446 447 448 449 450 456 457

432

342 352 357
649 428 381

358
322

359 369 380 381 421 422 423 424 431
276 309 609 646 286 585 187 332 476

464
868

Table 5
in R1 and R2 labeled in Figure 12b

The information about the difference of summer precipitation in 1999 between entities

360 370
457 461
766 869 1118 1283 2041 1206 1142 1265 1089 754 1036 771 814 525

450 456

448 449

429

446

438

432

447

440

342 352
724 690

357
607

358
359
886 688

369
573

380
381
889 737

421 422
393 779

423 424
431 464
470 713 1356 644

Table 6
in R1 and R2 labeled in Figure 12b

The information about the difference of summer precipitation in 2000 between entities

ID
Precipitation

370

360
461
426 486 273 791 740 524 502 618 921 625 640 840 760 818

448

432

438

450

457

449

456

447

446

440

429

ID
Precipitation

352

464
342
299 374 306 336 323 314 550 476 240 458 410 382 419 669

431

424

369

357

358

359

380

421

381

423

422

may be hidden in these anomalies, and should thus be identiﬁed by a deep analysis. In the ﬁeld
of spatio-temporal interpolation and prediction, these potential anomalies could affect the
accuracy of interpolation and development tendency predictions. As a result, the anomaly pat-
terns need to be put into a knowledge database and further utilized to predict where and when

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Spatial Anomaly Points and Regions Detection Method

25

Table 7
in R1 and R2 labeled in Figure 12b

The information about the difference of summer precipitation in 2001 between entities

ID
Precipitation

370

360
461
424 409 429 787 557 568 592 472 696 587 872 900 696 805

438

448

432

447

449

457

429

440

450

456

446

ID
Precipitation

352

464
342
275 214 362 321 411 244 335 572 263 370 329 195 735 719

358

359

424

357

423

381

422

431

421

369

380

R1

R2

(mm)

(mm)

Figure 13 The spatial distribution of environmental monitoring stations, pollution sources and
main rivers in a city in the south of China

they will occur, so that certain consequences of disasters (e.g. extreme climate events) can be
prevented in advance.

4.3 Case Study II: Detection of Anomalous Heavy Metal Element Concentrations

The SAPRD algorithm was applied to an environmental dataset. This real-life dataset is a
record of the heavy metal content of soil in a city located in south China for the year 2006. The
dataset includes 104 monitoring points, 249 pollution sources (various kinds of factories), and
the main rivers in the area, as shown in Figure 13. In this test, the concentration of heavy metal
elements As, Cd, Cr, Hg, and Pb was selected as the non-spatial attribute to detect spatial
anomalies.

The AHEPs and ASAPs obtained with respect to As, Cd, Cr, Hg, and Pb are shown in
Figures 14a-e, respectively. Correspondingly, the spatial interpolation surfaces based on the
spatial anomaly degree of entities in RHOPs and ASAPs are shown in Figure 15. One can
see that the RHOPs of the ﬁve sets of results include some regions colored deeper blue
than their surroundings. Indeed, these regions have a local maximum spatial anomaly

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

26

Y Shi, M Deng, X Yang and Q Liu

Figure 14 The apparent spatial anomaly pattern and heterogeneous pattern about the soil heavy
mental elements: (a)-(e) the results of As, Cd, Cr, Hg and Pb, respectively. NR: Spatial normal
regions; HP: Spatial heterogeneous points; AP: Spatial anomaly points; HR: Spatial heterogeneous
regions; AR: Spatial anomaly regions

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Spatial Anomaly Points and Regions Detection Method

27

Figure 15 The potential spatial anomaly pattern about the heavy mental elements: (a)-(e) the
results of As, Cd, Cr, Hg and Pb, respectively

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

28

Y Shi, M Deng, X Yang and Q Liu

degree, and are potential spatial anomalies. They cannot be obtained without visualizing
the interpolation surface of the spatial anomaly degree. By analyzing the results, it can be
found that most regions with frequent spatial anomalies are near to pollution sources. The
heavy metal concentrations at stations near pollution sources are higher than those from
stations farther from pollution sources. This illustrates that the factories have a serious
impact on the concentration of these heavy metal elements in the soil. However, there are
fewer anomalies and low heterogeneity in the results for As and Cd. On the contrary, more
anomalies exist in the results for Cr, Hg, and Pb. This is very possibly due to the charac-
teristics of the soil in this city, and that these factories have a slight effect on the content
of elements As and Cd.

The spatial interpolation surfaces given by the spatial anomaly degrees hierarchically
describe the spatial distribution of heavy metal concentrations in each station, from high to
low. In addition, anomaly regions along the rivers can, to a large degree, reﬂect the status of
contamination in the corresponding drainage basins. Further, these patterns and this knowl-
edge will be useful for decision-making by local government in the management of these facto-
ries and rivers.

5 Conclusions and Future Work

This article has described a methodology for detecting spatial anomaly points and regions from
spatial datasets with a set of discrete entities based on multi-graphs and local density. In the
ﬁrst step, a Delaunay triangulation was constructed on the initial spatial dataset using the spa-
tial coordinates of each entity. Two spatial distance constraints were imposed to obtain the
accurate spatial proximity relationship. Two further constraints based on the non-spatial
attribute distance between adjacent entities were then imposed to obtain a series of sub-graphs,
in which three types of spatial distribution patterns (i.e. RHOP, AHEP, and ASAP) can be dif-
ferentiated based on the volume of each sub-graph and its adjacent sub-graphs. Finally, the spa-
tial anomaly degree of the entities adjacent to RHOPs in ASAP and all entities in RHOP was
calculated based on the local density in terms of non-spatial attribute distance. The spatial
interpolation surface corresponding to the spatial anomaly degree was generated by IDW, and
this surface was used to hierarchically highlight potential spatial anomaly points and regions in
the RHOPs. The performance of the SAPRD algorithm was demonstrated for both simulated
and real-life datasets. By comparison with classical algorithms, it was found that SAPRD can
correctly and efﬁciently detect complex distributions of spatial anomaly points and regions, as
well as heterogeneous regions, for irregular discrete spatial datasets. SAPRD was also able to
hierarchically describe the areal distribution of spatial anomaly patterns by combining the spa-
tial anomaly degree and spatial interpolation surface. Applications of SAPRD to meteorologi-
cal and environmental data demonstrated its powerful practicality. In addition, the SAPRD
algorithm does not require any parameters.

Future work will focus on three aspects. First, the SAPRD algorithm will be extended to
other application domains, such as epidemiology, trafﬁc, and so on. Second, multiple non-
spatial attributes will be considered, and the associative relationships between different non-
spatial attributes will be examined to provide a deeper analysis of spatial datasets. Finally, the
detection of spatio-temporal anomaly patterns will be investigated by integrating a time attrib-
ute into the framework to further explore the dynamic characteristics of geographical
anomalies.

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

A Spatial Anomaly Points and Regions Detection Method

29

References

Adam N R, Janeja V P, and Atluri V 2004 Neighborhood-Based detection of anomalies in high-dimensional spa-
tio-temporal sensor datasets. In Proceedings of the 2004 ACM Symposium on Applied Computing, Nicosia,
Cyprus: 576–83

Al-Zoubi M B, Al-Dahoud A, and Yahya A A 2010 New outlier detection method based on fuzzy clustering.

WSEAS Transaction on Information Science and Applications 7: 681–90

Anselin L 1995 Local Indicators of Spatial Association: LISA. Geographical Analysis 27: 93–115
Birant D and Kut A 2006 Spatio-Temporal outlier detection in large databases. Journal of Computing and Infor-

mation Technology 14: 291–97

Breunig M M, Kriegel H P, Ng R T, and Sander J 2000 LOF: Identifying density-based local outliers. In Proceedings of
the Nineteenth ACM SIGMOD International Conference on Management of Data, Dallas, Texas: 93-104
Cai Q, He H B, and Man H 2013 Spatial outlier detection based on iterative self-organizing learning model. Neu-

Cerioli A and Riani M 1999 The ordering of spatial data and the detection of multiple outliers. Journal of Com-

rocompuing 117: 161–72

putational and Graphical Statistics 8: 239–58

9: 412–29

Chawla S and Sun P 2006 SLOM: A new measure for local spatial outliers. Knowledge and Information Systems

Chen F, Lu C T, and Boedihardjo A P 2010 GLS-SOD: A generalized local statistical approach for spatial outlier
detection. In Proceedings of the Sixteenth ACM SIGKDD International Conference on Knowledge Discov-
ery and Data Mining, New York, New York: 1069–78

Cheng D, Lu C T, Kou Y, Chen F 2008 On detecting spatial outliers. Geoinformatica 1 12: 455–475
Cheng T and Adepejue M 2013 Detecting emerging space-time crime patterns by prospective STSS. In Proceed-

ings of the Twelfth International Conference on GeoComputation, Wuhan, China

Deng M, Liu Q, Cheng T, and Shi Y 2011 An adaptive spatial clustering algorithm based on Delaunay triangula-

tion. Computers, Environment and Urban Systems 35: 320–32

Ester M, Kriegel H-P, Sander J, and Xu X 1996 A density-based algorithm for discovering clusters in large spatial
databases with noise. In Proceedings of the Second International Conference on Knowledge Discovery and
Data Mining, Portland, Oregon: 226–31

Estivill-Castro V and Lee I 2002a Multi-level clustering and its visualization for exploratory spatial analysis. Geo-

informatica 6: 123–52

Estivill-Castro V and Lee I 2002b Argument free clustering for large spatial point-data sets via boundary extrac-

tion from Delaunay Diagram. Computers, Environment and Urban Systems 26: 315–34

Franke C and Gertz M 2008 Detection and exploration of outlier regions in sensor data streams. In Proceedings

of the IEEE International Conference on Data Mining Workshops, Pisa, Italy: 375–84

Haining R P 1993 Spatial Data Analysis in the Social and Environmental Sciences. New York, Cambridge

Han J and Kamer M 2006 Data Mining: Concepts and Techniques (Second Edition). San Francisco, CA, Morgan

Haslett J, Brandley R, Craig P, Unwin A, and Wills G 1991 Dynamic graphics for exploring spatial data with

application to locating global and local anomalies. American Statistician 45: 234–42

Hawkins D M 1980 Identiﬁcation of Outliers. London, Chapman and Hall
Janeja V P and Atluri V 2009 Spatial outlier detection in heterogeneous neighborhoods. Intelligent Data Analysis

University Press

Kaufmann

13: 85–107

Knorr E M and Ng R T 1998 Algorithms for mining distance-based outliers in large dataset. In Proceedings of the

Twenty-fourth VLDB Conference, New York, New York: 392-403

Kou Y, Lu C T, and Chen D 2006 Spatial weighted outlier detection. In Proceedings of the Sixth SIAM Interna-

tional Conference on Data Mining, Bethesda, Maryland: 614-18

Li G, Deng M, Cheng T, Zhu J 2008 A dual distance based spatial clustering method. Acta Geodaetica et Cartog-

raphica Sinica 37: 482–88

Li G, Deng M, Zhu J, Cheng T, and Liu Q 2009 Spatial outliers detection considering distances among their

neighbors. Journal of Remote Sensing 13: 197–202

Liu H, Jezek K C, and O’Kelly M E 2001 Detecting outliers in irregularly distributed spatial data sets by locally adaptive
and robust statistical analysis and GIS. International Journal of Geographical Information Science 15: 721–41
Liu Q, Deng M, Shi Y, and Wang J 2012 A density-based spatial clustering algorithm considering both spatial

proximity and attribute similarity. Computers and Geosciences 46: 296–309

Liu X, Lu C T, and Chen F 2010 Spatial outlier detection: Random walk based approaches. In Proceedings of the
Eighteenth ACM SIGSPATIAL International Conference on Advances in Geographic Information Systems,
San Jose, California: 370–79

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

30

Y Shi, M Deng, X Yang and Q Liu

Lu C T, Santors R F, Liu X, and Kou Y 2011 A graph-based approach to detect abnormal spatial points and

regions. International Journal on Artiﬁcial Intelligence Tools 20: 721–51

Pan B, Zheng Y, Wilkie D, and Shahabi C 2013 Crowd sensing of trafﬁc anomalies based on human mobility and
social media. In Proceedings of the Twenty-ﬁrst ACM SIGSPATIAL International Conference on Advances
in Geographic Information Systems, Orlando, Florida: 344–53

Pang L X, Chawla S, Liu W, and Zheng Y 2011 On mining anomalous patterns in road trafﬁc streams. In Pro-
ceedings of the Seventh International Conference on Advanced Data Mining and Applications, Beijing,
China: 237–51

Pei T, Zhou C H, Luo J C, Han Z J, Wang M, Qin C Z, and Cai Q 2001 Review on the proceedings of spatial

data mining research. Journal of Image and Graphics 6: 854–60

Shekhar S, Lu C T, and Zhang P 2001 Detecting graph-based spatial outliers: Algorithms and applications
(A summary of results). In Proceedings of the Seventh ACM SIGKDD International Conference on Knowl-
edge Discovery and Data Mining, San Francisco, California: 371–76

Shekhar S and Chawla S 2002 A Tour of Spatial Databases. Englewood Cliffs, NJ, Prentice Hall
Shekhar S, Lu C T, and Zhang P S 2003 A uniﬁed approach to detecting spatial outliers. Geoinformatica 7:

139–66

234–40

Tan P, Steinbach M, and Kumar V 2006 Introduction to Data Mining. Boston, MA, Addison Wesley
Telang A, Deepak P, Joshi S, Deshpande P, and Rajendran R 2014 Detecting localized homogeneous anomalies

over spatio-temporal data. Data Mining and Knowledge Discovery 28: 1480–502

Tobler W 1970 A computer movie simulating urban growth in the Detroit region. Economic Geography 46:

Tsai V J D 1993 Delaunay triangulations in TIN creation: An overview and a linear-time algorithm. International

Journal of Geographical Information Systems 7: 501–24

Wu E, Liu W, and Chawla S 2010 Spatio-temporal outlier detection in precipitation data. In Gaber M M, Vatsa-
vai R R, Omitaomu O A, Gama J, and Chawla N V, and Ganguly A R (eds) Knowledge Discovery from Sen-
sor Data. Berlin, Springer Lecture Notes in Computer Science Vol. 5840: 115–33

VC 2016 John Wiley & Sons Ltd

Transactions in GIS, 2016, 00(00)

