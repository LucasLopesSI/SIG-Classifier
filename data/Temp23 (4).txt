bs_bs_banner

Research Article

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129)): (cid:129)(cid:129)–(cid:129)(cid:129)

Exploring Spatial Non-Stationarity and Varying
Relationships between Crash Data and Related Factors
Using Geographically Weighted Poisson Regression

Afshin Shariat-Mohaymany,* Matin Shahri,† Babak Mirbagheri† and
Ali Akbar Matkan†

*Faculty of Civil Engineering, Iran University of Science and Technology
†Faculty of Earth Sciences, Shahid Beheshti University

Abstract
The spatial nature of crash data highlights the importance of employing Geographical Informat-
ion Systems (GIS) in different ﬁelds of safety research. Recently, numerous studies have been carried
out in safety analysis to investigate the relationships between crashes and related factors. Trip genera-
tion as a function of land use, socio-economic, and demographic characteristics might be appro-
priate variables along with network characteristics and trafﬁc volume to develop safety models.
Generalized Linear Models (GLMs) describe the relationships between crashes and the explanatory
variables by estimating the global and ﬁxed coefﬁcients. Since crash occurrences are almost certainly
inﬂuenced by many spatial factors; the main objective of this study is to employ Geographically
Weighted Poisson Regression (GWPR) on 253 trafﬁc analysis zones (TAZs) in Mashhad, Iran, using
trafﬁc volume, network characteristics and trip generation variables to investigate the aspects of
relationships which do not emerge when using conventional global speciﬁcations. GWPR showed
an improvement in model performance as indicated by goodness-of-ﬁt criteria. The results also indi-
cated the non-stationary state in the relationships between the number of crashes and all independent
variables.

1 Introduction/Background

The rapid expansion of road construction and ever-increasing growth of urbanization have led
to a larger number of vehicles. Additionally, the high proportion of trafﬁc in urban areas has
increased the severity and number of crashes. Over the last few years, safety researchers have
attempted to develop innovative methodologies to explore crash-affecting factors and develop
accurate safety models. Among these, regression models with the purpose of exploring the
relationships between a dependent (the number or rate of crash occurrence) and a set of
explanatory variables have received considerable attention. Past studies suggest developing the
macro-level safety models, the variables of which have been aggregated at different spatial
units, e.g. trafﬁc analysis zones (TAZs) (Lovegrove and Litman 2008; Hadayeghi et al. 2010;
Naderan and Shahi 2010), census blocks (Levine et al. 1995; Wier et al. 2009; Satish et al.
2012), wards (Noland and Quddus 2004; Quddus 2008), and county (Aguero-Valverde and
Jovanis 2006).

Address for correspondence: Matin Shahri, School of Civil Engineering, Iran University of Science and Technology, PO Box 16765-163,
Narmak, Tehran, Iran. E-mail: matinshahri@gmail.com
Acknowledgment: Data for this study were provided by Tarhe Haftom Consulting Engineers. The writers wish to extend their very special
thanks and appreciation to Dr. Ali Naderan for his relentless and genuine collaboration in providing the data.

© 2014 John Wiley & Sons Ltd

doi: 10.1111/tgis.12107

2

A Shariat-Mohaymany, M Shahri, B Mirbagheri and A Akbar Matkan

Common regression methods to calibrate the safety planning models employ the General-
ized Linear Models (GLMs) with pre-assumed Negative Binomial (NB) (Noland 2003; Noland
and Quddus 2004; Hadayeghi et al. 2006; Gomesa et al. 2012) or Poisson distribution for
errors (Ye et al. 2009; Cheng et al. 2013), which results in estimating the global ﬁxed coefﬁ-
cients by characterizing stationary relationships between the dependent and independent vari-
ables. In fact, the coefﬁcients in global regressions are ﬁxed in the study area. The stationary
assumption in GLMs hides underlying spatial aspects which affect the crash occurrences
because it is likely that one variable has strong effects on crash occurrences in one location but
operates weakly elsewhere (Brunsdon et al. 1998). The main drawback to such global models
is neglecting the probable spatial non-stationarity and autocorrelation of the data that causes
the error terms of the global models to be spatially dependent. A few attempts have led to
development of the models considering the spatial properties of crash data, e.g. Spatial Lagged
Models (Levine et al. 1995), Conditional Autoregressive Models (Miaou 2003; Eksler and
Lassarre 2008), and Hierarchical Bayesian Models (Aguero-Valverde and Jovanis 2006). Such
models are generally thought of as semi-local models that only discover the local nature of
crash data, but the spatial non-stationarity still remains (Fotheringham et al. 2002). Geo-
graphically Weighted Regression (GWR) as a local technique enables calibration of multiple
regression models for any non-stationary process, and its adapted form for count data is
known as Geographically Weighted Poisson Regression (GWPR) (Fotheringham et al. 2002).
The estimated coefﬁcients resulting from local models vary, depending on the location of data
points, and will provide a better performance for the response variable due to modeling the
spatial non-stationarity. Furthermore, the residuals of such local models have more desirable
spatial randomness than those derived from global models.

GWR has mainly been applied to socioeconomic (Deller 2010; Harris et al. 2010; Zhang
et al. 2011), urban and environmental sciences (Gao and Li 2010; Li et al. 2010; Szymanowski
and Kryza 2011), and health studies (Nakaya et al. 2005; Gilbert and Chakraborty 2010).
Among the studies that developed this technique in transportation applications (Park 2004;
Zhao et al. 2005; Du and Mulley 2006; Clark 2007), very few cases have tended towards
safety, particularly crash analysis (Cloutier et al. 2007; Erdogan 2009).

In the few mentioned applications of the GWR in safety, a normal distribution for crashes
was assumed, but was deemed irrelevant for crash discrete data. In the study conducted by
Hadayeghi et al. (2010) the spatial variations in the relationship between the number of zonal
crashes and predictors for total and severe crashes in 481 TAZs in Toronto, Canada were
investigated by developing several GWR models. Different types of data affecting the crash
occurrence were categorized and the exclusive model was developed accordingly.

Review of past studies shows that common potential predictors such as network param-
eters (Noland 2003), land use (Noland and Quddus 2004; Hadayeghi et al. 2010), demo-
graphic characteristics (de Guevara et al. 2004; Noland and Oh 2004) and trafﬁc volume
(Caliendo et al. 2007) were used in calibrating the safety models. Trip generation as the ﬁrst
fundamental step in the travel demand process is employed to estimate the number of trips
generated from/to each TAZ based on different variables such as socioeconomic, demographic
and land use characteristics. Each trip generated from/to a TAZ can be subject to a risk of a
crash. In other words, travel demand in urban areas can be a contributing factor in crash
occurrence (Naderan and Shahi 2010).

Considering the importance of spatial properties of crash data, the main purpose of this
article is to develop the local macro-level safety model in Mashhad (the second most popu-
lated city in Iran with a population of 3,410,800 in the year 2008) by incorporating the
travel demand data and trafﬁc volume and network characteristics as a comprehensive

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

Non-Stationarity and Varying Relationships between Crash Data and Related Factors

3

model. The results are then compared with GLMs using the goodness-of-ﬁt measures. The
descriptive power of the local model’s contribution to investigating the local variations of
the chosen variables and the spatial non-stationarity in the study area will be discussed
towards the end of the article.

2 Data Survey

Data needed in this research for the year 2008 in Mashhad were provided by Mashhad Trans-
portation and Trafﬁc Organization (MTTO 2007). All data were aggregated, geocoded and
assigned to TAZ centroids using ArcGIS. The total number of crashes was applied as the
dependent variable in models. Trafﬁc volume data were obtained based on the results of allo-
cating the vehicle trips to the network and estimating vehicle kilometers travelled (VKT). In
line with Lovegrove and Sayed (2006) and Hadayeghi et al. (2010), the natural logarithm of
VKT, known as exposure, is employed to prevent the homoscedasiticity which considers the
same variance of the error terms in GLMs. The street network database also includes a variety
of attribute ﬁelds related to the network. The total number of trips over TAZs that were col-
lected, based on observations and trips regardless of the explicit classiﬁcation of trip purpose,
will be employed. Average Car Ownership (ACO) and Average Motorcycle Ownership (AMO)
are the last type of data used in this study. Table 1 lists all of the variables and their descriptive
statistics.

3 Methodology

3.1 Generalized Linear Models

GLMs are considered as the most prevalent techniques in calibrating safety models which
assume that the error structure is either Poisson or Negative Binomial. Given a set of observa-
tions (crashes) per TAZ, the natural log of λi is assumed to be a linear function of k independ-
ent variables in a Poisson model:

Ln

(

) =
λ β

i

+ ∑0

β

x
k ik

k

(1)

where β and x denote the set of estimated coefﬁcients and any of the independent variables,
respectively. The model coefﬁcients in Equation (1) are estimated using the maximum likeli-
hood method or ordinary least squares. The Poisson distribution is reasonable to model the
crash data; however, the requirement of a Poisson model is that the variance equals the mean,
which is mostly violated when dealing with crash data because the variance is much greater
than the mean – a phenomenon known as over-dispersion. To overcome this problem, Nega-
tive Binomial and Poisson with linear correction have been suggested (Cameron and Triverdi
1998). In Negative Binomial, the number of crashes yi per TAZ is assumed to follow a Poisson
distribution with a mean λi:

T
x
(2)
i
where exp (εi) is a Gamma-distributed term with a mean of 1 and variance τ and the addition
of this term allows the variance to differ from the mean as shown below:

exp

λ
i

=

(

+
β ε
i

)

(
var yi

) =

+λ τλ2
i

i

(3)

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

4

A Shariat-Mohaymany, M Shahri, B Mirbagheri and A Akbar Matkan

Category

Variable

Avg

S.D.

Min Max

1.129
10401.631
154.455

0.119
7796.847
1403

1.653
1
0

19.041
42564
1249

Table 1 Descriptive analysis of data

General

Crash Data

TAZ area in km2
Population per TAZ
Total number of

crashes per TAZ
in year 2008

0
0

0

0

0

0

0
1
0

0

Network

Characteristics

Number of intersections
Total main street length

7
500.832

5.06
595.866

27
3319.751

(in km)

median

median

Total street traversal

0.399

0.394

Total street non-traversal

0.421

0.770

Number of unsignalized

0.442

4.401

intersections
Network density
∗
Street length Street width
TAZ Area

⎛
⎝⎜

⎞
⎠⎟

0.020

0.010

3.654

9.056

66

0.057

Trip Generation
Trafﬁc Volume
Average

Total number of trips generated 33195.954
78460.021
VKT
0.018
AMO

20631.412
50447.062
0.062

121795
1996287.97
0.311

Average Car

ACO

0.047

0.042

0.214

Motorcycle
Ownership

Ownership

The number of trafﬁc analysis zones = 253

Therefore, the number of crashes per TAZ is considered to follow a Poisson distribution with
the mean of λi but the over-dispersion is assumed to follow a Gamma distribution (Equation
2). G(.) is a Gamma function and α is the over-dispersion parameter:
(
(
)
) +
1
y
α
i
) +
+(
Γ
y
α
i

1
α
) +
α

λ
i
) +
α

prob y

⎤
⎥
⎥
⎦

⎡
⎢
⎢
⎣

⎤
⎥
⎥
⎦

⎡
⎢
⎢
⎣

(4)

) =

)
1

λ
i

λλi

Γ

Γ

(

(

(

1

1

1

(

α

yi

1

i

In Poisson with linear correction, the variance is assumed to be a linear multiplier of the mean
and the over-dispersion parameter is deﬁned as:

α =

n

∑1
− −
1

n k

=

i

1

−(
y
i

ˆ
y

i

2

)

ˆ
y

i

(5)

in which n is the total number of samples (TAZs), k is the number of predictors and yi and yˆ i
the observed and estimated number of crashes in the ith TAZ. The Poisson standard error (σ)
is multiplied by the square root of the dispersion parameter to produce an adjusted standard

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

Non-Stationarity and Varying Relationships between Crash Data and Related Factors

5

Figure 1 (a) GWR with ﬁxed spatial kernel; and (b) GWR with an adaptive spatial kernel

error (σadj) which is used in the t-test to produce an adjusted t-value (McCullagh and Nelder
1989):

σ

adj

=

×
σ α

3.2 Geographically Weighted Poisson Regression

The estimated coefﬁcients in Equation (1) are constant and the model is often referred to as
global or spatially stationary model (Fotheringham et al. 2002). When spatial non-stationarity
prevails, the estimated coefﬁcients are a function of (ui, vi), implying the geographic coordi-
nates of data points (TAZ centroid), therefore Equation (1) can be rewritten as:

Ln

(

) =
λ β
0

i

(

,
u v
i

i

) +

(

β
1

u v Ln VKT

,

i

i

)

(

) +

∑

k

(

β
k

u v x
i
ik

,

i

)

Unlike GLMs, this method is carried out using localized data points within a geographic space
to capture the spatial variations (Fotheringham and Wenger 2000). Data in close spatial prox-
imity of any regression point have more inﬂuence on estimating the coefﬁcients compared with
those at further distances. Such an effect is considered by applying a weighting function; so the
estimated results not only depend on the observations, but also on the choice of weighting
function and its bandwidth. Two of the more common functions are as follows:

Gaussian:

Or Bi-Square:

w

ij

=

exp

⎛
⎝⎜

− × ⎛
1
⎝
2

d
ij
b
i

⎞
⎠

2

⎞
⎠⎟

=

w

ij

− ⎛
⎝

⎞
⎠

2 2
⎤
⎥
⎦

d
ij
b
i

⎧
⎡
⎪
1
⎢
⎨
⎣
⎪
⎩
0

if d

ij

<

b
i

otherwise

(6)

(7)

(8)

(9)

where, wij implies the spatial weight of the jth TAZ on the ith TAZ, dij is the Euclidean dis-
tance between the ith and jth TAZ, and bi is the kernel bandwidth which controls the distance
decay in the weighting function that determines the degree of locality. As the bandwidth
increases, the local variations are missed and the estimated values approach the global esti-
mates. If the bandwidth is ﬁxed, at each regression point it is assumed constant throughout
the study area (Gaussian function) (Figure 1a); alternatively, an adaptive spatial kernel
(Figure 1b) adapts for the density of data at each regression location (TAZ). The optimal

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

6

A Shariat-Mohaymany, M Shahri, B Mirbagheri and A Akbar Matkan

number of proximate TAZs in an adaptive kernel that is chosen to search for a speciﬁc number
of nearest TAZs and to ensure a constant number of local samples is included. The weights are
then computed by using the speciﬁed kernel and setting the value for any TAZ based on Equa-
tion (9) (Bi-square function). In other words, according to data density variations, lower
weights are allocated where the TAZs centroids are dispersed, and higher weights where TAZs
are denser or more abundant (Fotheringham et al. 2002). For the TAZs whose distance is
greater than the bandwidth, the weight is set to zero and the TAZ will be excluded from the
local calibration. In practice, the results obtained through GWR are not sensitive to the choice
of weighting function type, but are very sensitive to the bandwidth. If the bandwidth is known
a priori (ﬁxed), it is possible to apply it directly to the model; however, if it is unknown (adap-
tive), AICc and Cross-Validation (CV) are employed to optimize the bandwidth. According to
Nakaya et al. (2005), AICc is deﬁned as:

( ) =
AIC b D b

( ) +

c

( ) +

K b

2

2

( )

(
K b K b
n K b

( ) +
− ( ) −

)
1
1

where b is the bandwidth, D is the deviance of parameters, K is the effective number of parameters
in the model, and n is the number of total TAZs. The nest measure Cross-Validation is also deﬁned
as:

CV

=

n

∑

=

1

i

[

y

i

−

(cid:2)
( )
y b
≠
i

]
2

(cid:2)
y bi≠ ( ) is the ﬁtted value of yi using bandwidth equal to b, with the observations for
where
point i omitted from the calibration process. In the present study, the adaptive kernel for the
development of the model and the AICc selection process as highlighted above to optimize the
bandwidth are employed.

(10)

(11)

3.3 Assessing the Goodness-of-Fit

The goodness-of-ﬁt in this study is assessed in two ways. First, by calibrating the GLMs and
deciding on whether or not to keep a variable in the model based on: (1) the adjusted Pearson
chi-square and adjusted deviance over the degrees of freedom; and (2) t-statistic signiﬁcance at
the 5% level. Secondly, the goodness-of-ﬁt measures are employed in local model improvement
over a global model: 1) Pearson’s correlation coefﬁcient in the range of +1 and −1; (2) the
Mean Square Error (MSE); and 3) the Mean Absolute Deviance (MAD).

The mentioned criteria are described in detail as follows, where yi and

(cid:2)
yi are the total
(cid:2)
number of observed and predicted crashes per TAZ, yi and
yi are the mean observed and pre-
dicted number of crashes per TAZ and n denotes the sample size (the number of TAZs)
(Cameron and Triverdi 1998).

3.3.1 Adjusted Pearson chi-square and adjusted deviance

These two criteria measure the difference between the observed and predicted values (the
residual error) adjusted for the degrees of freedom. Adjusted Pearson chi-square and adjusted
deviance for Poisson and Negative Binomial statistics are deﬁned by the following equations.
For a well-ﬁtted model, the mentioned criteria should be approximately chi-square distributed
with n-k-1 degrees of freedom (n is the number of total samples and k the number of
independent variables). The closer the values are to 1, the model can better ﬁt the data, but

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

Non-Stationarity and Varying Relationships between Crash Data and Related Factors

7

according to Cameron and Triverdi (1998) the values 0.8–1.2 are acceptable and generally it is
concluded that the model’s ﬁt is satisfactory.

AdjustedPearsonChi

Square

−

=

n

∑

=

i

)
2
i
)

−(
y
y
i
(
σ
y
− −

1
n k

i
1

Poisson Adjusted Deviance

NB Adjusted Deviance

2

n

⎡
ln∑∑
y
⎣⎢

i

=

1

i

=

i

⎞
⎛
y
⎠⎟ −
⎝⎜
y
i
− −
n k 1

y

i

−

y

i

⎞
⎠⎟

⎤
⎦⎥

n

∑

=

1

i

⎡
⎢⎢
⎣

=

y

i

ln

⎛
⎝⎜

y
y

i

i

+(
y
i

⎞
⎠⎟ −
n k

− −

1

)
lnα

⎛
⎝⎜

y
y

i

i

+
+

α
⎞
⎠⎟
α

⎤
⎦⎥

3.3.2 Pearson’s correlation coefﬁcient

The Pearson’s correlation coefﬁcient is a measure of the correlation between the observed and
the predicted values. Values near +1 and −1 imply strong positive and negative relationships,
respectively. As the value approaches zero, it indicates that there is no linear correlation
between variables.

(cid:2)
−(
y

i

(cid:2)
y

i

)

n

∑

−(
y
i
)

)
2

i

y

y

i

)
(

1 2

(cid:2)
−(
y

i

(cid:2)
y

i

)

2

)

1 22

n

∑

=

1

i

=

R

(

n

∑

=

1

i

=
1
i
−(
y
i

3.3.3 Mean square error (MSE) and mean absolute deviance (MAD)

MSE measures the average of the squares of the difference between observed and predicted
number of crashes divided by the sample size (number of TAZs) and the MAD measures the
average of the absolute difference between the observed and predicted number of crashes
divided by sample size and are deﬁned as:

(12)

(13)

(14)

(15)

(16)

(17)

n

=∑

i

1

−(
y
i

(cid:2) 2
)
y

i

MSE

=

n

=∑

i

1

(cid:2)
y

i

−

y

i

MAD

=

n

n

The less the MSE and MAD, the better the model performance.

4 Results and Discussions

The process followed to choose the explanatory variables in developing the GLMs is similar to
the one used by Washington et al. (2006). Firstly, a correlation matrix was set up to examine
whether or not variables of interest were highly correlated with others. If two explanatory

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

8

A Shariat-Mohaymany, M Shahri, B Mirbagheri and A Akbar Matkan

variables are substantially correlated, inserting them simultaneously into the same model
must be strictly avoided to minimize the effects of collinearity. Then, an initial model was
developed based on the selected independent variables and stepwise procedure in 5%
conﬁdence intervals. The decision of whether or not to keep any variable in the model is based
on whether it is logically and statistically signiﬁcant. Finally, the model with the best goodness-
of-ﬁt criteria will be selected.

4.1 Results of GLMs

The results of developing GLMs to explore the relationship between crash frequency and
selected explanatory variables (with no correlation) are summarized in Table 2. As can be seen,
the over-dispersion parameter, deviance and Pearson chi square equal to 46.989, 43.266 and
47.179 shows that the Poisson model seems to be inappropriate due to the high variance of
crash data. The positive and signiﬁcant (sig <0.05) estimated coefﬁcient of VKT shows its
dominant inﬂuence on crash occurrences in both the Negative Binomial and Poisson with
linear correction models. The results also indicate the signiﬁcance and direct effect of the main
street length. It means the increase in total main street kilometers increases the crash occur-
rences which can be due to increase in operational speed on main streets. The unsignalized
intersections are expected to affect the crash occurrence and its positive inﬂuence is deduced by
the signiﬁcant estimated coefﬁcients at the 5% conﬁdence interval in both models. The direct
inﬂuence of travel demand is conveyed by the positive coefﬁcient of trip generation and corre-
sponding signiﬁcant t-statistics. This indicates how appropriate the use of such variable is as
surrogate variables of population and land use in developing safety models.

4.2 The Results of GWPR

The summary of the ﬁve factors representing the local estimated coefﬁcients resulting from
GWPR presented in Table 3 indicates that the local estimated coefﬁcients show a rather spatial
non-stationary state. One approach to test the degree of spatial non-stationarity is by compar-
ing the range of the local parameter estimates with a conﬁdence interval around the global
estimate of the equivalent parameter. Then, the range of values of the local estimates between
the lower and upper quartiles are compared with the range of values at ±1 standard deviations
of the global estimate. If the range of local estimates between the inter-quartile ranges is
greater than that of ±1 standard deviations of the global mean, it suggests the relationship
might be non-stationary (Fotheringham et al. 2002). As indicated in Table 4, the local esti-
mates between the inter-quartile ranges for all variables are greater than ±1 standard devia-
tions of the global mean and therefore it can be inferred that all variables show signiﬁcant
spatial non-stationarity and have a different spatial pattern. The variability of estimated coef-
ﬁcients which indicates the non-stationarity of related variables can also be tested by two other
statistical methods: ﬁrst by using the Monte Carlo signiﬁcance test and second by model com-
parison. In the latter, in order to test the variability of the kth varying coefﬁcient, a model
comparison is carried out between the ﬁtted GWR and a model in which only the kth coefﬁ-
cient is ﬁxed while other coefﬁcients are kept as they are in the ﬁtted GWR model. By assum-
ing these two models as the original and switched GWR models, respectively, it can be inferred
that if the original GWR is better than the compared switched GWR model according to a
model comparison criterion such as AICc, the non-stationary state of the kth coefﬁcient can be
conﬁrmed. The test routine repeats this process for each geographically varying coefﬁcient
(Nakaya 2012). When the two models compared have the same predictive performance, if the

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

Non-Stationarity and Varying Relationships between Crash Data and Related Factors

9

.

g
i
S

t
a
t
s
-
t

r
r
e
d
t
S

f
f
e
o
C

.

g
i
S

t
a
t
s
-
t

r
r
e
d
t
S

f
f
e
o
C

.

g
i
S

t
a
t
s
-
t

r
r
e
d
t
S

f
f
e
o
C

F
I
V

1
0
0
.
0

1
0
0
.
0

0
0
3
.
5

9
5
6
.
6
1

1
6
1
.
0

0
8
2
.
0

4
9
6
.
2

7
8
4
.
1

1
0
0
.
0

1
0
0
.
0

2
6
6
.
5

7
7
4
.
4

2
7
3
.
0

2
1
2
.
0

1
1
1
.
2

2
5
9
.
0

1
0
0
.
0

1
0
0
.
0

4
1
8
.
8
3

0
9
6
.
0
3

4
5
0
.
0

1
3
0
.
0

1
1
1

.

2

2
5
9
0

.

0
0
6

.

1

0

1
0
0
.
0

1
0
0
.
0

1
0
0
.
0

1
6
8
.
6

3
9
6
.
3

5
4
9
.
4

5
5
2
.
0

8
4
2
.
0

2
5
2
.
0

1
0
0
.
0

1
0
0
.
0

1
0
0
.
0

9
2
4
.
5

1
7
7
.
3

7
6
4
.
5

7
3
5
.
0

7
7
1
.
0

7
8
1
.
0

0
2
9
.
2

8
6
6
.
0

3
2
0
.
1

1
0
0
.
0

1
0
0
.
0

1
0
0
.
0

1
2
2
.
7
3

0
5
8
.
5
2

0
8
4
.
7
3

8
7
0
.
0

5
2
0
.
0

7
2
0
.
0

0
2
9

.

2

8
6
6
0

.

3
2
0
1

.

2
6
2
1

.

5
9
2

.

1

2
0
9

.

0

i

l
a
i
m
o
n
B
e
v
i
t
a
g
e
N

n
o
i
t
c
e
r
r
o
c

r
a
e
n

i
l

h
t
i

w
n
o
s
s
i
o
P

n
o
s
s
i
o
P

0
5
7
.
1

6
1
9
.
0

4
4
2
.
1

3
5
2

7
4
2

4
4
1
.
1

2
0
0
.
1

9
5
3

.
0

8
7
0
.
3
2
4
1
−

7
5
1
.
8
5
8
2

7
3
8
.
1
2

9
8
5
.
3
2

1

3
5
2

7
4
2

2
0
8
.
6
5
1
6
−

4
0
6
.
5
2
3
2
1

6
6
2
3
4

.

9
7
1

.

7
4

9
8
9
6
4

.

3
5
2

7
4
2

2
0
8
.

6
5
1
6
−

4
0
6
.
5
2
3
2
1

d
e
t
a
r
e
n
e
g

s
p
i
r
t

f
o
r
e
b
m
u
n

l
a
t
o
T

)

m
k
(
h
t
g
n
e
l

t
e
e
r
t
s
n
i
a
m

l
a
t
o
T

)
f
d
(

m
o
d
e
e
r
f

f
o
s
e
e
r
g
e
D

s
n
o
i
t
a
v
r
e
s
b
o
f
o

.

o
N

t
ﬁ
-
f
o
-
s
s
e
n
d
o
o
G

d
e
z
i
l
a
n
g
i
s
n
u
f
o
r
e
b
m
u
N

s
n
o
i
t
c
e
s
r
e
t
n

i

T
K
V

)
n
o
i
s
r
e
p
s
i
d
-
r
e
v
o
(
α

d
o
o
h

i
l
e
k
i
l
-
g
o
L

f
d
/
e
c
n
a
i
v
e
D

/

f
d
n
o
s
r
a
e
P

C
A

I

e
l
b
a
i
r
a
V

t
n
a
t
s
n
o
C

s

M
L
G

f
o
s
t
l
u
s
e
R

2

e
l
b
a
T

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

10

A Shariat-Mohaymany, M Shahri, B Mirbagheri and A Akbar Matkan

Table 3 Summary of ﬁve-factor representing the local coefﬁcients results from GWPR

Variable

Minimum

Lower
Quartile Mean

Upper
Quartile Maximum

Number of unsignalized Intersections
VKT
Total main street length (km)
Total number of trips generated

−0.561
−0.363
0.201
−0.220

0.391
1.639
0.695
0.334

0.818
2.945
1.040
0.790

1.055
4.688
1.420
2.108

1.723
8.038
2.787
4.568

Table 4 Results of testing spatial non-stationarity of variables

Variable

Number of unsignalized intersections
VKT
Total main street length (km)
Total number of trips generated

CI1*

0.424
1.074
0.354
0.374

CI2**

0.561
0.517
0.496
0.504

CI3***

0.664
3.049
1.774
0.724

*Conﬁdence Interval around the Poisson with linear correction estimate
**Conﬁdence Interval around the Negative Binomial estimate
***Conﬁdence Intervals between upper and lower quartiles from GWPR

Gaussian model is applied, the difference of deviance (Diff of deviance) between the two
models should follow the F-statistic under the null hypothesis that there is no difference in the
performance of the two models (Mei et al. 2006). When Poisson and Logistic models are
applied, the difference of deviance (Diff of deviance) between the two models should follow
the Chi-square distribution. When the null hypothesis is rejected, we can say that the term
shows signiﬁcant geographical variation at the signiﬁcance level used for the test. The result
table consists of rows of local terms with a “Diff of Criterion” column, which shows the dif-
ference in the model comparison indicator between the original and switched GWR models. A
positive “Diff of Criterion”, especially greater than or equal to two, suggests no spatial vari-
ability (Nakaya 2012). Therefore the results obtained from Table 5 suggest the signiﬁcant non-
stationarity of all variables.

Comparing the intervals between the upper and lower quintiles from GWPR for all vari-

ables indicates the broader varying range of the exposure variable (VKT), equal to 3.049.

Although the local parameter estimates for unsignalized intersections are strongly positive
in most of the TAZs, the intensity of the relationships is not constant (Figure 2a). The positive
and strong relationships are found in the central parts towards the south, some northwestern
areas and a distinct region located in the northeast of the study area. In such areas, the effect
of the unsignalized intersections upon crash occurrences is relatively higher than in other
TAZs, which indicates very efﬁcient strategies to enhance safety here.

The maps produced for trip generation coefﬁcients (Figure 3a) illustrate that there are
strong positive trends in trip generation in the north and northeast of the study area and
weaker but positive relationships in the western and central parts. The travel demand predic-
tion is mainly performed based on the different trip purposes, so the fewer the number of trips,
the lower the risk of crash occurrences. The results of the study conducted by Naderan and

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

Non-Stationarity and Varying Relationships between Crash Data and Related Factors

11

Table 5 Results of testing spatial non-stationarity of variables according to Chi-Square test

Variable

Constant
Number of unsignalized intersections
VKT
Total main street length (km)
Total number of trips generated

Diff of
deviance*

−709.061
−845.956
−357.607
−846.383
−375.289

Diff of
DOF**

9.836
11.874
9.654
8.471
10.155

DIFF of
Criterion***

−676.510
−807.056
−325.631
−818.158
−341.736

*Difference of deviance between the original and switched GWR models
**Difference of degree of freedom for Chi-Square test (non-stationarity test in Poisson model)
***Difference in model comparison indicator between the original and switched GWR models

Figure 2 (a) Local coefﬁcients of number of unsignalized intersections; and (b) Local t-statistics of
number of unsignalized intersections

Shahi (2010) through developing global Negative Binomial models using travel demand
variables in Mashhad, indicates the positive effects of travel demand on crash occurrence;
however, according to Figure 3a, the magnitude of the local coefﬁcients are not the same for all
TAZs, the indicator for a non-stationary state.

The estimated local coefﬁcients of VKT are for the most part positive over the study area
which echoes its direct effect on crash occurrences (Figure 4a). The stronger effects are found
in the southwest and a distinct region from north to south, and the weaker but positive rela-
tionships in the center and western parts of Mashhad. In line with the ﬁndings of Clark and
Cushing (2004), Aguero-Valverde and Jovanis (2006), and Quddus (2008), VKT has been
found to be an appropriate variable for safety planning models. Although the estimated coefﬁ-
cient for VKT has been shown to be an average ﬁxed value in previous studies, as depicted in
Figure 4a, the local coefﬁcients vary from 0.363 to 8.038. Similar ﬁndings have been presented
by Hadayeghi et al. (2010).

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

12

A Shariat-Mohaymany, M Shahri, B Mirbagheri and A Akbar Matkan

Figure 3 (a) Local coefﬁcients of trip generation; and (b) Local t-statistics of trip generation

Figure 4 (a) Local coefﬁcients of VKT; and (b) Local t-statistics for VKT

In Figure 5a, the direct effect of total main street length in kilometers has been illustrated

with greater magnitude in the east and northeast of the study area.

Although it is expected that the variables such as VKT or number of unsignalized inter-
sections show direct effects on crash occurrences, TAZs with negative signs are also detect-
able. One reason for such counterintuitive signs as expressed by Zhao et al. (2005) could be
due to the collinearity among some independent variables or the collinearity in estimated
local coefﬁcients. It is argued that the local coefﬁcients could be correlated even when there
is no collinearity among independent variables (Wheeler and Tiefelsdorf 2005; Grifﬁth
2008). It is worth noting that the Variance Inﬂation Factor (VIF) determines the degree of

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

Non-Stationarity and Varying Relationships between Crash Data and Related Factors

13

Figure 5 (a) Local coefﬁcients of total main street length (in kilometers); and (b) Local t-statistics for
total main street length

collinearity among predictors and its range from 5 to 10 or above indicates a collinearity
problem (Table 2). Another reason is that some variables might be less signiﬁcant at certain
locations than others or are completely insigniﬁcant, which is due to the method employed
in estimating the standard deviation in GWR models (Congdon 2003). Local t-statistics, as a
useful result of GWR models, prove useful to determine where relationships are signiﬁcant
and where they are not. As indicated in Figure 2a, 18 out of 253 TAZs appeared with unan-
ticipated negative signs; but t-statistics indicate that 11 TAZs are not signiﬁcant in the 95%
conﬁdence interval (Figure 2b). The same analysis for local coefﬁcients of trip generation
shows that among 17 TAZs with negative signs, seven TAZs are not signiﬁcant in 95%
intervals (Figure 3b). The TAZs which appeared with negative signs for VKT located in the
southeast of Mashhad were also indicated to be insigniﬁcant (Figure 4b). The local coefﬁ-
cients of total main street length (km) for all TAZs appeared with a positive sign (Figure 5a)
and all were shown to be signiﬁcant (Figure 5b). The unexpected signs for the remaining
TAZs with signiﬁcant t-statistics can be explained as owing to missing or mis-speciﬁed
explanatory variables in the model. In total, it is evident that while all coefﬁcients resulting
from global models are signiﬁcant (Table 2), such inference is too strong for local coefﬁcients
in terms of sign and magnitude.

4.3 Comparing the Goodness-of-Fit between Global and Local Models

The results of goodness-of-ﬁt measures obtained from GWPR and the corresponding values
from global models are presented in Table 6. It is deduced that the local model with a correla-
tion coefﬁcient equal to 0.85 has improved the model around 16% and 19% for Poisson with
linear correction and Negative Binomial, respectively. Moreover, the MAD and MSE values for
the model using GWPR is lower than the corresponding values for global models. The results
indicate that the local model has performed much more successfully to capture the crash vari-
ations and enhance the safety analyses.

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

14

A Shariat-Mohaymany, M Shahri, B Mirbagheri and A Akbar Matkan

Table 6 Comparing the goodness-of-ﬁt for GLMs and GWPR

Model

Poisson with linear correction
Negative Binomial
GWPR

Correlation
Coefﬁcient

0.691
0.662
0.857

MAD

61.734
64.750
41.369

MSE

9322.083
11673.801
5583.594

Figure 6 Results of local coefﬁcient of determination for GWPR

4.4 Results of Local Coefﬁcient of Determination (ri

2)

2) resulting from GWPR and the estimated coefﬁ-
The local coefﬁcient of determination (ri
cients provide a useful way to explore the spatial varying relationships. Such local variat-
ions provide a sense of how well a local model ﬁts the observations. Unlike the global
2) in GWPR represent a marked regional differentiat-
model, the spatial patterns of local (ri
ion characterized by higher values (0.78–0.83) in the center, southeast and northeast of
the study area (Figure 6). It is not expected that the model calibrated in one location will rep-
licate the data in other locations as well, unless the processes being modeled are relatively
stable.

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

Non-Stationarity and Varying Relationships between Crash Data and Related Factors

15

5 Conclusions and Recommendations

The GLMs with Poisson or Negative Binomial distribution of errors are the most common
known techniques for calibrating the safety planning models,
in which the relationships
between the dependent and the explanatory variables are assumed to be stationary, while
the actual spatial pattern might vary over space. This article searched for explicit spatial
non-stationary relationships between the number of zonal crashes and potential explanatory
variables using GWPR. The model was developed based on trip generation, network vari-
ables and trafﬁc volume. The varying magnitude of the regression coefﬁcients resulting from
GWPR indicated the stronger explanatory power of the local model compared with conven-
tional GLMs. Also, the estimated local coefﬁcients show organized patterns in the study
area, but the pattern of local coefﬁcients for one variable differs from others. This can be
explained through the nature of the local model, which captures the spatial autocorrelation
and non-stationary states. In fact, the local coefﬁcients change gradually when there is a sig-
niﬁcant spatial autocorrelation for any variable in any TAZ and its neighborhoods. There-
fore, the inﬂuence of that variable upon crash occurrence is almost the same for that area.
Additionally, our results reveal that GWPR not only represents a signiﬁcant improvement of
model performance over global models indicated by lower AICc, MAD, MSE and higher cor-
relation coefﬁcient values, but also has successfully removed the spatial autocorrelation of
residuals. The main objective of this research was to convey how the relationships might be
stronger in one location and weaker elsewhere. However, the analyses of the TAZs which
are affected more by a particular predictor still need further research.

Even though the local model might produce unexpected signs in some TAZs due to
the stated reasons, the local models perform much better than GLMs. It is concluded that the
power of local model estimation enhances the safety studies based on its analysis of the effects
of individual independent variables which lead to urban safety improvement.

References

Aguero-Valverde J and Jovanis P P 2006 Spatial analysis of fatal and injury crashes in Pennsylvania. Accident

Brunsdon C, Fotheringham A S, and Charlton M 1998 Geographically weighted regression: Modelling spatial

Analysis and Prevention 38: 618–25

non-stationarity. The Statistician 47: 431–43

Caliendo C, Guida M, and Parisi A 2007 A crash-prediction model for multilane roads. Accident Analysis and

Prevention 39: 657–70

Press

Cameron C and Triverdi K P 1998 Regression Analysis of Count Data. Cambridge, UK, Cambridge University

Cheng L, Geedipally S R, and Lord D 2013 The Poisson–Weibull generalized linear model for analyzing motor

Clark D and Cushing B M 2004 Rural and urban trafﬁc fatalities, vehicle miles, and population density. Acci-

vehicle crash data. Safety Science 54: 38–42

dent Analysis and Prevention 36: 967–72

Clark S D 2007 Estimating local car ownership models. Transport Geography 15: 184–97
Cloutier M S, Apparicio P, and Thouez J P 2007 GIS-based spatial analysis of child pedestrian accidents near

primary schools in Montreal, Canada. Applied GIS 3(4): 1–18

Congdon P 2003 Applied Bayesian Modeling. New York, John Wiley and Sons
de Guevara F L, Washington S, and Oh J 2004 Forecasting crashes at the planning level: Simultaneous
negative binomial crash model applied in Tucson, Arizona. Transportation Research Record 1897:
191–99

Deller S 2010 Rural poverty, tourism and spatial heterogeneity. Annals of Tourism Research 37: 180–205
Du H and Mulley C 2006 Relationship between transport accessibility and land value: Local model approach

with geographically weighted regression. Transportation Research Record 1977: 197–205

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

16

A Shariat-Mohaymany, M Shahri, B Mirbagheri and A Akbar Matkan

Eksler V and Lassarre S 2008 Evolution of road risk disparities at small-scale level: Example of Belgium. Safety

Erdogan S 2009 Explorative spatial analysis of trafﬁc accident statistics and road mortality among the provinces

Research 39: 417–27

of Turkey. Safety Research 40: 341–51

Wiley and Sons

Taylor and Francis

Fotheringham A S, Charlton M, and Brunsdon C 2002 Geographically Weighted Regression. New York, John

Fotheringham A S and Wenger M (eds) 2000 Spatial Models and GIS: New Potential and New Models. London,

Gao J and Li S 2010 Detecting spatially non-stationary and scale-dependent relationships between urban land-
scape fragmentation and related factors using Geographically Weighted Regression. Applied Geography
31: 292–302

Gilbert A and Chakraborty J 2010 Using geographically weighted regression for environmental justice analysis:

Cumulative cancer risks from air toxics in Florida. Social Science Research 40: 273–86

Gomesa S V, Geedipally S R, and Lord D 2012 Estimating the safety performance of urban intersections in

Grifﬁth D 2008 Spatial-ﬁltering-based contributions to a critique of geographically weighted regression (GWR).

Lisbon, Portugal. Safety Science 50: 1732–9

Environment and Planning A 40: 2751–69

Hadayeghi A, Shalaby A S, and Persaud B N 2010 Development of planning level transportation safety tools

using Geographically Weighted Regression. Accident Analysis and Prevention 42: 676–88

Hadayeghi A, Shalaby A S, Persaud B N, and Cheung C 2006 Temporal transferability and updating of zonal

level accident prediction models. Accident Analysis and Prevention 38: 579–89

Harris R, Singleton A, Grose D, Brunsdon C, and Longley P 2010 Grid-enabling Geographically
Weighted Regression: A case study of participation in higher education in England. Transactions in GIS 14:
43–61

Levine N, Kim K E, and Nitz L H 1995 Spatial analysis of Honolulu motor vehicle crashes: Zonal generators.

Accident Analysis and Prevention 27: 675–85

Li S, Miaomiao X, Zhao Z, and Yanglin W 2010 Investigating spatial non-stationary and scale-dependent rela-
tionships between urban surface temperature and environmental factors using geographically weighted
regression. Environmental Modelling and Software 25: 789–800

Lovegrove G R and Litman T A 2008 Macrolevel collision prediction models to evaluate road safety effects of
mobility management strategies: New empirical tools to promote sustainable development. In Proceedings
of the Eighty-seventh Annual Meeting of the Transportation Research Board, Washington, DC

Lovegrove G R and Sayed T 2006 Macro-level collision prediction models for evaluating neighbourhood trafﬁc

safety. Canadian Journal of Civil Engineering 33: 609–21

McCullagh P and Nelder J 1989 Generalized Linear Models. London, Chapman and Hall
Mei C L, Wang N, and Zhang W-X 2006 Testing the importance of the explanatory variables in a mixed geo-

graphically weighted regression model. Environment and Planning A 38: 587–98

Miaou S-P 2003 Modeling trafﬁc crash-ﬂow relationships for intersections: Dispersion parameter, functional

form, and Bayes versus empirical Bayes methods. Transportation Research Record 1840: 31–40

MTTO 2007 Comprehensive Transportation Studies of Mashhad City. Mashhad City, Iran, Mashhad Transpor-

Naderan A and Shahi J 2010 Aggregate crash prediction models: Introducing crash generation concept. Accident

Nakaya T 2012 GWR4 User Manual. WWW document, http://www.st-andrews.ac.uk/geoinformatics/wp-

tation and Trafﬁc Organization

Analysis and Prevention 42: 339–46

content/uploads/GWR4manual_201311.pdf

Nakaya T, Fotheringham A S, Brundson C, and Charlton M 2005 Geographically weighted Poisson regression

for disease association mapping. Statistics in Medicine 24: 2695–717

Noland R 2003 Trafﬁc fatalities and injuries: The effect of changes in infrastructure and other trends. Accident

Analysis and Prevention 35: 599–611

Noland R and Oh L 2004 The effect of infrastructure and demographic change on trafﬁc-related fatalities and

crashes: A case study of Illinois county-level data. Accident Analysis and Prevention 36: 525–32

Noland R and Quddus M A 2004 A spatially disaggregate analysis of road casualties in England. Accident

Analysis and Prevention 36: 937–84

Park N 2004 Estimation of Average Annual Daily Trafﬁc (AADT) using Geographically Weighted Regression
(GWR) Method and Geographic Information Systems. Unpublished PhD Dissertation, Florida Interna-
tional University

Quddus M A 2008 Modelling area-wide count outcomes with spatial correlation and heterogeneity: An analysis

of London crash data. Accident Analysis and Prevention 40: 1486–97

Satish U, Miranda-Morenob L F, Ramaduraic G, and Isa-Tavarez J 2012 The role of built environment on

pedestrian crash frequency. Safety Science 50: 1141–51

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

Non-Stationarity and Varying Relationships between Crash Data and Related Factors

17

Szymanowski M and Kryza M 2011 Application of geographically weighted regression for modelling the spatial
structure of urban heat island in the city of Wroclaw (SW Poland). Procedia Environmental Sciences 3:
87–92

Washington S, Schalwyk I V, and Mitra S 2006 Incorporating Safety into Long-Range Transportation Planning.

Washington, DC, National Cooperative Highway Research Program

Wheeler D and Tiefelsdorf M 2005 Multicollinearity and correlation among local regression coefﬁcients in geo-

graphically weighted regression. Geographical Systems 7: 161–87

Wier M, Weintraub J, Humphrey E H, Seto E, and Bhatia R 2009 An area-level model of vehicle-pedestrian
injury collisions with implications for land use and transportation planning. Accident Analysis and Preven-
tion 41: 137–45

Ye X, Pendyala R M, Washington S, Konduri K, and Oh J 2009 A simultaneous equations model of crash

frequency by collision type for rural intersections. Safety Science 47: 443–52

Zhang H, Zhang J, Lu S, Cheng S, and Zhang J 2011 Modeling hotel room price with geographically weighted

regression. International Journal of Hospitality Management 30: 1036–43

Zhao F, Chow L-F, Li M-T, and Liu X 2005 Transit ridership model based on geographically weighted regres-

sion. Transportation Research Record 1972: 105–14

© 2014 John Wiley & Sons Ltd

Transactions in GIS, 2014, (cid:129)(cid:129)((cid:129)(cid:129))

