The Cartographic Journal
# The British Cartographic Society 2013

Vol. 50 No. 1

pp. 19–32

February 2013

R E F E R E E D P A P E R

Identification of Optimal Colours for Maps from the Web

Jo¨rg Steinru¨cken and Lutz Plu¨mer

Institute of Geodesy and Geoinformation, University of Bonn, Bonn, Germany
Email: steinruecken@igg.uni-bonn.de

Maps which are created on demand by combining geospatial data from different Web Map Services integrate conflicting
portrayals and do not satisfy the requirements of effective cartographic communication. A significant improvement is
achieved by selecting clearly distinguishable colours which are determined by solving an optimisation problem.
Cartographic guidelines and user characteristics (e.g. colour vision impairment) can be incorporated into the optimisation
model as constraints which guide the selection of colours.

Keywords: colours, optimisation, web mapping, mapping on demand, personalisation of maps

INTRODUCTION

The World Wide Web (WWW) has had a huge impact on
cartography since its appearance in the early 1990s. The
process of creating and distributing maps has always
reﬂected the emerging potential of the WWW. In the early
stages, it was mainly used as a medium of presentation,
offering maps to a large audience. During the last few years,
the WWW has taken on more and more functions that were
traditionally performed on desktop computers and in
intranets. Today, not only maps but also numerous
geospatial databases are available on the Web. Many of
these databases can be freely accessed by using a Web Map
Service (WMS; La Beaujardiere, 2006) as an interface which
is speciﬁed by the Open Geospatial Consortium (OGC). A
WMS provides spatially referenced data as image ﬁles; the
content of an image may vary from single features or map
themes (e.g. streets) to complete topographic maps. WMS
supports interoperability: data are accessible and usable
independent of formats, systems and vendors.

The portrayal output of WMS allows individual maps to
be generated on demand: users who need a map to answer
a current question can combine images of different
services, regardless of location and time. Such a combina-
tion may range from overlaying existing maps with
additional themes to creating entirely new maps that
integrate features of different thematic layers. Figure 1
presents an example in which a topographic map is overlaid
by cycle ways.

This approach of Mapping on Demand is simple from a
technical point of view, but the results are often unsatisfac-
tory: since graphical representations of data from each
service are deﬁned independently of other services, their
combination may produce maps in which users cannot

DOI: 10.1179/1743277412Y.0000000017

distinguish objects or themes. Thus, the maps do not meet
the requirements of a concise cartographic product and do
not fulﬁl their function of communicating geospatial data
efﬁciently. Poor map design is mainly caused by colours
which lack sufﬁcient
the graphical
representation of maps can be signiﬁcantly improved by
colours which are clearly distinguishable by human visual
perception.

contrast. Hence,

the optimisation problem is

In this paper, we present an approach that formulates
the selection of clearly distinguishable colours as an
optimisation problem. This approach requires a description
of colours in a colour space in which the distance function
corresponds to the visual distance as perceived by the
human eye. Hence,
to
maximize the minimal distance between colours in a
three-dimensional space. This is a nonlinear problem which
is characterized by a large number of
locally optimal
solutions. Optimisation methods, which compute one of
these solutions, are available from local and global
optimisation. Local methods are efﬁcient but, as a rule,
do not ﬁnd the globally optimal solution; general methods
of global optimisation, which ﬁnd the global optimum, are
computationally hard to solve. In order to achieve a
solution close to the global optimum on demand, we use
speciﬁc characteristics of the solution space and present a
method in which a local method is supported by a method
which determines good starting points and a method which
evaluates local solutions.

Our approach is designed to cope with the demands of
speciﬁc mapping scenarios that occur when using WMS. As
our basic problem, we take the most common case in which a
given topographic map is overlaid by additional features.
The colours of the topographic map are assumed to be

20

The Cartographic Journal

section reviews

We have organized the rest of this paper as follows: The
next
related work on designing and
colouring maps. The third section outlines important
colour spaces which are required for the selection of well
distinguishable colours. In the fourth section, we explain
the optimisation problem,
its solution and its use for
cartographic problems. The incorporation of personalized
information is also described. Our paper ends with some
concluding remarks.

This paper is based on the PhD thesis of the ﬁrst author
(Steinru¨cken, 2009) and extends it signiﬁcantly by for-
malizing cartographic rules as constraints of an optimisation
problem.

BACKGROUND AND RELATED WORK

The use of colours in map design belongs to a system of
cartographic rules which recommend how graphical means
should be used to achieve an effective communication.
These rules are mainly based on visual variables, which were
foremost proposed by Bertin (1974) and modiﬁed and
extended by later approaches, e.g. MacEachren (1995),
who also gives an overview of different approaches. Whereas
Bertin introduced ‘colour’ and ‘value’ within his variables,
later approaches agree on the variables ‘hue’, ‘saturation’
and ‘value’ spanning a space along the three perceptual
dimensions of colour. Important design principles for the
use of colour are (MacEachren, 1995; Robinson et al.
1995):
N the perceived variation of a dimension should correspond
to the level of measurement: hue is used to express a
qualitative level; value and saturation are used to
represent data with ordinal and numerical scale;
N the selection of colours should respect conventional
associations (e.g. a blue hue is expected as water, green as
vegetation) and colour standards which arise e.g. from
government agencies;
N graphical symbols must have a sufficient visual contrast.
Studies of or approaches to colouring maps focus on
thematic, especially choropleth maps (e.g. Mersey, 1990;
Brewer, 1994; Brewer et al., 1997); the use of colours is
based on colour schemes which fulﬁl cartographic guide-
lines, as mentioned above. However, creating effective
colour schemes is a difﬁcult task. In order to support users
in selecting appropriate colour schemes for their maps,
Harrower and Brewer (2003) developed an online tool
called ColorBrewer.org. The tool is based on 35 colour
scheme sets which are designed using experience and
cartographic guidelines. Each of these scheme sets contains
up to 15 colours from which ColorBrewer.org selects
colour schemes for data of qualitative, ordinal or numerical
scale and a range from 3 to 12 classes. The usability on
different kinds of digital devices (screens, projectors and
printers) and for people with colour vision impairment is
indicated for each scheme.

The colouring in maps which are created on demand is
mainly based on colour-order systems; the colour selection
depends on user preferences as well as colour contrast.
Christophe (2008b) describes an approach of deriving a

Figure 1. A topographic map is overlaid by cycleways. The upper
part illustrates the default colours of the WMS, and the lower part
an improved version which colours are more distinguishable (topo-
graphic map from Euregio Rhine-Waal and Euregio Rhine-Maas)

well chosen; the colours of the features must be clearly
distinguishable from each other and from the topographic
map. The upper part of Figure 1 depicts a map as provided by
the WMSs, the lower part illustrates contrasting colours
which distinguish the overlaid features from the background
map. As more speciﬁc problems, we describe scenarios
requiring further cartographic design principles: incorpora-
tion of conventional associations of colours and expression of
the level of measurement.

As a basic assumption, the on-demand maps are to be
displayed on all kinds of monitors. In doing so, the problems,
outlined so far, concern standard users and standard
conditions. Adapted colour spaces allow for speciﬁc condi-
tions which inﬂuence perception of maps. Such conditions
are colour vision impairment, which affects nearly 8% of
males and 0.4% of females (Wyszecki and Stiles, 1982),
device-speciﬁc colour reproduction and environmental con-
ditions (dark room or sunlight). As a result, colour selection
is reﬁned and personalized.

The selected colours are applied to the output of WMS.
Services which support
the Styled Layer Descriptor
Speciﬁcation (SLD; Lupp, 2007) of the OGC enable users
to overwrite the default portrayal directly. If SLD is not
supported, the colours of the output must be manipulated in
a post-processing step. An implementation of the colour
selection as a Web Service and its integration into an
architecture of WMS has already been described in
Steinru¨cken and Plu¨mer (2009).

Identification of Optimal Colours for Maps from the Web

21

Figure 2. Modelling of sRGB in CIELUV

map design in an iterative man–machine dialogue in which
the machine learns users’ taste and needs and improves the
proposal of map samples until users are satisﬁed. The
colours of the samples have been chosen from a colour-
order system, which uses 14 hues, each graduated by seven
steps of value. The convergence of the selection process is
achieved by classifying samples into groups which are
perceived as similar; similarity is measured by distances
between colours. In Christophe (2008a), further develop-
ments of the man–machine dialogue are described: a user is
enabled to comment on a map sample by accepting or
rejecting a colour for a speciﬁc map theme (‘I like this
colour for this theme’). Colours for themes not commented
on by a user are found by solving a Constraint Satisfaction
Problem which explores remaining assignments of colours
to themes.

the data’s

Buard and Ruas (2009) describe a process which aims at
improving colour contrast of topographic maps. Colours of
a map should respect two rules. Firstly, a theme should be
coloured typically, i.e. the relationship of a theme and its
colour is described as ‘often used’, ‘never used’ and ‘may be
used’. Secondly, the relationship between colours should
respect
level of measurement (itemized as
association, order and difference). These rules are evaluated
by a global analysis, considering all the colours on a map, or
a local analysis, considering colours between nearby
symbols. Colours which do not respect the rules are
improved by selecting colours from a colour order system
which is basically the same as the one used by Christophe
(2008b), although extended by ‘grey’ and ‘greyish’
colours. Subject to the result of the analysis, the selection
is made using different methods: in global analysis, either by
solving a Constraint Satisfaction Problem or by using a
Multi-Agent System (each item in the legend is an agent);
in local analysis, improvements are found through a local
search.

In contrast, we use a colour space instead of a colour
scheme or colour order system. A colour space is a ﬁnite set
of colours which can be reproduced by monitors, whereas
systems are further discretisations:
schemes or order
available colours are limited and distances between neigh-
bouring colours are increased, i.e. the resolution is reduced.
For example, assuming a distance of 45 units of length as
the
the minimum threshold for distinguishability (cf.
section on ‘Description of colours’), a distance of 20
between neighbouring colours instead of 1 will affect the

selection signiﬁcantly. In other words, in the case of a
colour order system, a selection problem has to be adapted
to the colour system, in the case of a colour space, the
selection adapts to the problem.

DESCRIPTION OF COLOURS

Use and reproduction of colours require their description in
a reference system, called colour space. Colour and vision
theory provide various colour spaces for different areas of
application. Subject to a speciﬁc task, a suitable colour space
has to be chosen.

The selection of clearly distinguishable colours requires
two colour spaces which model the reproduction of colours
on monitors and distinguishability of colours. Moreover, a
third space is required to identify colours which can be
perceived by users affected by colour vision impairment; a
fourth space is used to incorporate device-speciﬁc colour
reproduction and environmental conditions.

Reproduction of colours on monitors
Reproduction of colours on monitors is based on the RGB
colour model. This model describes colours as an addition
of red (R), green (G) and blue (B) light, called additive
primaries (Foley et al., 1996). Specifying the exact colour of
the primaries results in colour spaces as instances of the
RGB colour model. The primaries determine the range of
colours which can be reproduced (colour gamut). A
common representation is given by a cube (Figure 2, left).
On computers, the gamut usually contains 16.8 million
colours which arise from encoding each primary by tone
levels in the range 0(R,G,B(255. For the selection of
clearly distinguishable colours, we choose Standard RGB
(sRGB; Stokes et al., 1996) as the colour space which is
often used in digital devices, especially in monitors of
personal computers.

Distinguishability of colours
Unfortunately, sRGB is not suitable for modelling visual
distinguishability of colours: Colour differences calculated
by available distance functions (usually Euclidean distance)
do not correspond to colour differences perceived by the
human visual system. In order to evaluate colour differ-
ences, an equidistant or uniform colour system is required.

22

The Cartographic Journal

Figure 3.

sRGB and planes of protanopia (left) and deuteranopia (right) in CIELUV

Here, we use the CIELUV colour space as it is more
common in display industry (Sharma, 2003). However,
CIELUV can be replaced by other colour spaces which fulﬁl
speciﬁc requirements. These requirements will be men-
tioned after introducing CIELUV.

CIELUV was recommended in 1976 by the Commission
internationale de l’e´clairage (CIE, International Commission
on Illumination); its coordinates are denoted as (L*,u*,v*).
L* describes the lightness, while u*,v* the hue of a colour
(Wyszecki and Stiles, 1982). The direction of the u*-axis is
is blue-yellow
green-red,
(Fairchild, 2005). A hue is reddish if u*.0, greenish if
u*,0, yellowish if v*.0 and bluish if v*,0. For achromatic
colours it holds u*,v*50, i.e. these are represented by L*. The
distance between two colours is given by the Euclidean
distance:

the direction of

the v*-axis

k

d1,2

k2

~ L2{L1

Þ2z u2{u1
ð

Þ2z v2{v1
ð

Þ2

h
ð

i1=2

(1)

We assume colours as clearly distinguishable, if their distance
exceeds a threshold of 45 units (cf. Nagy et al., 1990).

In order to describe dependencies between colours as
constraints (e.g. an order), the components which correlate
with the perceived lightness, saturation and hue must be
identiﬁed. As mentioned above, L* is the correlate of
lightness. Chroma, as the distance between a chromatic and
achromatic stimulus, is deﬁned by the following formula
(Wyszecki and Stiles, 1982):

C (cid:2)
uv

(cid:2)

~ (u(cid:2))2z(v(cid:2))2

(cid:3)1=2

Saturation is obtained by dividing chroma by lightness
(Wyszecki and Stiles, 1982):

A quantiﬁcation of hue is given by an angle in the u*2v*-
plane (Wyszecki and Stiles, 1982):

s (cid:2)
uv

~ C (cid:2)
uv
L(cid:2)

huv~arctan

v(cid:2)
u(cid:2)

(2)

(3)

(4)

The hue angle lies between 0u and 90u if u*,v*.0, between
90u and 180u if u*,0 and v*.0, between 180u and 270u if
u*,v*,0, and between 270u and 360u if u*.0 and v*,0
(Schanda, 2007).
In CIELUV,

the entirety of colours available for
optimisation forms a three-dimensional body which results
from transforming the
into CIELUV
(Figure 2). The transformation requires two steps. At ﬁrst,
sRGB must be converted into the CIE 1931 XYZ Primary
System (formulas, e.g. in Stokes et al., 1996). In a second
step, colours from XYZ are transformed to CIELUV
(formulas, e.g. in Wyszecki and Stiles, 1982). Of course,
after calculating colours
these must be
converted back to sRGB.

in CIELUV,

sRGB cube

The formulation of an optimisation problem requires a
suitable modelling of the colour body and its mathematical
representation as a set of constraints. Such a modelling is
given by a convex polyhedron created by the intersection of
hyperplanes or half-spaces (Figure 2, right part). Thus, the
constraints form a set of linear inequalities:

(cid:4)

xjaT

k xƒbk

(cid:5) with a[<n, a=0, b[< and k~1, 2, . . . ,p (5)

where a good approximation of the colour body is given by
nine hyperplanes (p59).

As mentioned above, CIELUV can be replaced by colour
spaces which fulﬁl the following requirements: the space
must be uniform, and the body which results
from
transforming sRGB to the uniform space must have a good
convex representation. For application scenarios, which are
discussed in the section on ‘Representing cartographic rules
as constraints’, the colour space must additionally provide
correlates of lightness, saturation and hue. In contrast to
another commonly used uniform colour space, CIELAB,
CIELUV is more appropriate for our purpose as CIELAB
does not provide a correlate of saturation (Wyszecki and
Stiles, 1982).

Identification of colours, perceived by users with colour vision
impairment
Colour vision impairment can be simulated by transform-
ing colours from CIE 1931 XYZ Primary System into the

Identification of Optimal Colours for Maps from the Web

23

three-dimensional LMS space which is spanned by the
longwave sensitive (L),
the middlewave sensitive (M)
and shortwave sensitive (S) photoreceptors of the human
eye (Vie´not et al., 1999). Frequent
forms of colour
vision impairment are caused by restriction or lack of
one of these receptors; those affected are called dichro-
mats. Among the dichromats, the most common forms
are protanopes, who lack the L-receptors, and deuteranopes,
who lack the M-receptors (Brettel et al., 1997; Wyszecki
and Stiles, 1982). Within the LMS space, the colour
appearance for these dichromats is simulated by projecting
all colours belonging to a confusion line (lines parallel
to the axis of the missing receptor) to a single colour, i.e.
all colours are reduced to planes (Brettel et al., 1997;
Vie´not et al., 1999). Transformed to CIELUV, these
planes are preserved as planes. Figure 3 shows
the
protanop (left part) and deuteranop (right part) plane
within the colour body which represents
sRGB in
CIELUV. Each plane is visualized by colours perceivable
by the respective dichromat. As the ﬁgure suggests, the
colours are very similar.

In an optimisation problem, a geometrical representation

of the planes is given by adding a linear equality

(cid:4)

xjaTx~b

(cid:5) with a[<n, a=0, b[<

(6)

to the set of constraints from equation (5).

Incorporation of colour reproduction and ambient light
Colour restriction arising from a distorted colour reproduc-
tion and a bright ambient light can be reduced by using a
colour appearance model. Such a model predicts the
appearance of colours
in different environments and
between colours. As state-of-the-art colour appearance
model, which is recommended by the CIE, CIECAM02
is available (Fairchild, 2005). The colour appearance is
predicted by transforming colours from CIE 1931 XYZ
Primary System which are given under speciﬁc source
into the perceptual correlates H (hue), J
conditions
(lightness), Q (brightness), C (chroma) and M (colour-
fulness) of CIECAM02. Using modiﬁed conditions within
the inverse transformation results in predicted colours in
the XYZ Primary System. Beyond the colours in XYZ, the
transformation requires some further input parameters: the
adapting ﬁeld luminance (luminance of the ﬁeld which is
observed, i.e. the display), the white point (XW,YW,ZW), the
relative luminance of the background (often 20% of white)
and surround conditions (average, dim, dark). For each of
these conditions, values
three parameters, which
for
inﬂuence the transformation, are deﬁned. An extended
description of the model and the transformations is e.g.
given in Fairchild (2005).

mentioned above, the problem aims at identifying colours
whose distances are as large as possible, i.e. the minimal
distance between colours has to be maximized. In mathe-
matical notation, the problem is described as maximisation of
a differentiable function over a set of colours which is
modelled as a continuous space, represented by differentiable
functions.

As we will

illustrate, the problem is characterized by
multiple locally optimal solutions. In order to solve the
problem, efﬁcient gradient-based methods are available.
These methods ﬁnd a locally but usually not the globally
optimal solution. Furthermore, it is not possible to test a
solution for global optimality. Instead, the solution which is
found depends on a starting point. Solving a large number of
problems with different starting points may ﬁnd the globally
optimal solution, but such a strategy is not efﬁcient. The
problem is also solvable by methods which presume a discrete
set of colours and which search all possible solutions. While
this approach ﬁnds the global optimum, it is computationally
hard to solve.

In order to solve the optimisation problem on demand, we
use speciﬁc characteristics of the problem and present a
method in which a gradient-based method is supported by a
method which determines good starting points and a
method which evaluates and possibly rejects a local solution.
The determination of good starting points takes advantage of
the convex modelling of the colour space and places points
on the polyhedron’s boundary. The evaluation method
detects bad local solutions by considering point density and
identifying possible improvements on the basis of a Voronoi
diagram. Altogether, an almost globally optimal solution is
achieved. Furthermore, we describe a reﬁnement of the
colour selection by introducing constraints which model
speciﬁc cartographic rules, colour vision impairment of
users, device-speciﬁc colour
reproduction and ambient
conditions.

Formulation and characterisation of the optimisation problem
The formulation of the optimisation problem is based on a
scenario which we introduced as the most common case in
the section on ‘Introduction’:

S1: Given a topographic map with m colours which are
assumed as well chosen. This map is to be overlaid by geospatial
objects of n themes. The n themes are to be clearly distinguishable
from each other as well as from the topographic map.

In order to achieve distinguishability by colours, the

scenario can be restated:

Given a set C of m colours. Each colour is determined by its

location in Standard RGB and may not be changed.

Find a set X of n colours such that the minimum distance of
the location of any colour from X to the location of any other
colour from X as well as to the location of any colour from C is
maximal in CIELUV.

Such a problem is called a MAXMIN problem; a
common application is given by Obnoxious Facility
Location or Undesirable Facility Location, which aims at
placing dangerous facilities far away from inhabited areas
(e.g. Erkut and Neuman, 1989).

In mathematical notation, the problem MAXMIN is

IDENTIFICATION OF OPTIMAL COLOURS

In this section, the identiﬁcation of clearly distinguishable
colours is formulated as an optimisation problem. As

written as1:

24

The Cartographic Journal

Figure 4. Possible solutions for placing three new points in addition to two given points in a rectangle

maximize min Xi,Yj

(cid:7)

(cid:6)
(cid:6)

(cid:8)

,

(cid:6)
(cid:6)2

i~1, 2, . . . , n, j ~1, 2, . . . , mzn, j§i

(7)

subject to aT

k Xiƒbk,

i~1, 2, . . . , n, k~1, 2, . . . , 9

where Y5(X,C) is the set of searched and given colours.
Typically, MAXMIN is formulated as an equivalent problem
which avoids
the non-smooth Minimum function.
Furthermore, we use the squared Euclidean distance and
we adopt the convention that optimisation problems are
formulated as minimisation problems2:

minimize {d

subject to

(cid:6)
d2ƒ Xi,Yj
(cid:6)

(cid:6)
2
2,
(cid:6)

i~1, 2, . . . ,n, j ~1, 2, . . . , mzn, j §i

(7a)

aT
k Xiƒbk,
i~1, 2, . . . , n, k~1, 2, . . . ,9

(cid:6)
2
where 2d is the linear objective function, d2ƒ Xi,Yj
2 are
(cid:6)
k Xiƒbk are linear
quadratic inequality constraints and aT
inequality constraints. The problem aims at ﬁnding a
minimal distance 2d and a set X of searched colours which
satisfy the constraints: The quadratic constraints force all
squared Euclidean distances

(cid:6)
(cid:6)

(cid:6)
Xi,Yj
(cid:6)

(cid:7)
~ YjL(cid:2)

(cid:6)
2
(cid:6)
2

{Xi

L(cid:2)

(cid:8)2

(cid:9)
z Yju(cid:2)

{Xiu(cid:2)

(cid:9)
(cid:10)2z Yjv(cid:2)

{Xiv(cid:2)

(cid:10)2 ,

i~1, 2, . . . , n, j~1, 2, . . . , mzn, j§i

(7b)

between two colours from the set X and from the set
Y5(X,C) of both searched and given colours, to be greater
or equal than d2; all colours are represented in CIELUV as
(L*,u*,v*). Furthermore, all colours of X must lie in the
convex polyhedron of available colours, represented by the

k Xiƒbk, i~1, 2, . . . , n, k~1, 2, . . . , 9
set of hyperplanes aT
(cf. equation (5)). A point (d,X) which satisﬁes the constraints
is called feasible. An optimal solution ( ^d, ^X ) is found if ( ^d, ^X )
minimizes the objective function and if ( ^d, ^X ) is feasible.
( ^d, ^X ) is locally optimal, if ( ^d, ^X ) minimizes the objective
function over all feasible points in a neighbourhood of ( ^d, ^X );
( ^d, ^X ) is globally optimal, if ( ^d, ^X ) minimizes the objective
function over all feasible points.

In order to compute a solution of optimisations problems,
various methods are available. These methods can be
distinguished into different types which correspond to
different classes of problems. Each class – and the complexity
of the problem – depends on the kind of objective function
and the existence and kind of constraint functions. Hence,
applying a method requires a characterisation of
the
problem.

The most basic distinction must be made between
unconstrained and constrained problems, of which con-
strained problems are more complex: In unconstrained
problems which aim at minimizing a differentiable function
f(x), it is necessary for an optimal solution ^xx that ^xx is a
stationary point
in constrained problems,
additionally, an optimal solution ^xx must be from the set
of feasible colours deﬁned by the constraints.

(+f(^xx)~0);

are

conditions)

expressed with

Obviously, MAXMIN is a constrained problem in which
all functions are continuous and differentiable. Necessary
conditions for a locally optimal solution ^xx of such problems
(Kuhn–Tucker
the
Lagrangian function, which reduces a constrained problem
to an unconstrained problem by augmenting the objective
function with a weighted sum of the constraint functions
(Fletcher, 1987). The weights are called Lagrange multipliers.
Points which satisfy the Kuhn–Tucker conditions can be
found by efﬁcient methods which, generally speaking,
proceed iteratively from a starting point in a descent
direction. The next local minimum, found in this direction,
is the solution. Such local methods are best suited to convex
optimisation problems3, i.e. problems in which each locally
optimal solution is globally optimal (cf. Rockafellar, 1993).
In MAXMIN, the objective function and the linear inequal-
the squared Euclidean
ities are convex. Furthermore,

Identification of Optimal Colours for Maps from the Web

25

Figure 5. Packing of circles in a polygon; classical packing requires the circle completely within the polygon (left); colour selection requires
circles’ centres within the polygon (right)

(cid:6)
2
distance is convex on <n, whereas the d2ƒ Xi,Yj
2, which
(cid:6)
are squared complements of Euclidean balls, are not. Thus,
the problem MAXMIN is a non-convex or nonlinear
problem.

(cid:6)
(cid:6)

Nonlinear problems are characterized by multiple local
solutions. Solving such problems, local optimisation methods
ﬁnd a local solution that depends on the starting point, mostly
determined at random. A local solution may be globally
optimal, but it is not guaranteed. It is also not possible to test
a solution for global optimality. Instead,
this can be
handled by a random sampling of a large number of different
starting points. After applying a local method, the best
solution is assumed as globally optimal. Obviously, such a
procedure has a poor performance with regard to computa-
tional costs.

The occurrence of multiple locally optimal solutions is
illustrated in Figure 4 by a simple example in the plane.
Assuming that the set C contains two points placed in a
rectangle, three points are to be placed additionally. After
placing three starting points within the rectangle at
random, these points are moved by a local method in a
way that increases the distances between all new points and
between given points and new points. The method
terminates and yields a solution when a movement of a
point would decrease the minimal distance achieved so far.
locally optimal
Figure 4 illustrates possible solutions:
solutions are found if one or more points are blocked by
other points; a globally optimal solution is found if the new
points are able to diverge until a global solution is
reached. Further solutions arise from permutations of the
points.

As Figure 4 also suggests,

are of
varying quality,
are poor
(Figure 4, left), others approximate the global optimum
(Figure 4, middle).

i.e. while some solutions

solutions

local

Standard methods for solving medium and small non-
linear constrained problems are Sequential Quadratic
Programming algorithms (SQP; Sun and Yuan, 2006;
Fletcher, 1987), which aims at ﬁnding Kuhn-Tucker-
points, points, satisfying the Kuhn–Tucker conditions.

Unlike local methods, global optimisation methods ﬁnd a
solution whose global optimality is guaranteed. However,
such a solution is found at the expense of efﬁciency: the
worst case complexity of global optimisation methods
grows exponentially with the number of variables and
constraints (NP-complete). Efﬁcient global methods which

are available for solving discrete problems are not applicable
to the problem in hand.

Solving the optimisation problem
As described above, solving the optimisation problem
globally comes at the expense of efﬁciency. In order to
achieve a solution on demand, we take advantage of speciﬁc
characteristics of the problem and present a method in
which a gradient-based method is supported by a method
which determines good starting points and a method which
evaluates the local solution globally:
N the determination of good starting points utilizes the
linear constraints of the problem and assumes that points
located on the polyhedron’s boundary are well suited as
starting points. Such points are obtained by placing n
points on the boundary at random and improving these
points by successively solving modified MAXMIN
problems;
N the local improvement of the starting points uses a local
optimisation method which solves the MAXMIN pro-
blem and calculates a locally optimal solution;

N the suboptimality of locally optimal

solutions and the
global improvement is determined by considering point
density in subspaces. The density is found by deriving the
from a Voronoi diagram.
largest empty ball
Improvements are achieved by jumping points.

The combination of these methods results in a good
approximation to the global optimum.

Determination of good starting points
The determination of good starting points for a local
optimisation method is based on a speciﬁc characteristic
of the problem: The linear constraints deﬁne a convex
polyhedron (cf. Figure 2 and equation (5)), which is
the outer boundary of the space of available colours.
We can now assume that points which are distributed all
around this boundary are well suited as starting points.
Suitability of
those points becomes apparent by two
observations:
N within the local optimisation method,

the starting
points are improved by local movements. Placing
points on the boundary prevent them from blocking
each other. Instead, points are able to move on the

26

The Cartographic Journal

boundary as well as make way by going inside the
polyhedron;
N a solution needs a number of points on the boundary: as
the points of a solution span a convex polyhedron within
the colour polyhedron, the available colours are well
utilized if the solution polyhedron approximates to the
colour polyhedron. At best, both polyhedrons are
identical, which can occur if some colours lie in the
vertices of the colour polyhedron.

We can illustrate this by considering packing problems, a
class of optimisation problems which has similarities with
the selection of colours. Packing problems assume a
number of objects, each with a weight or a volume and a
value. A subset of these objects is to be packed into a
container so that the total weight is less than a limit and
the total value is maximized4. Adapting the model
representation of packing problems,
the selection of
colours can be imagined as a packing of balls in a convex
polyhedron or - for better illustration – as a packing of
circles5 in a convex polygon. The important difference
between packing problems and colour selection is illu-
strated in Figure 5: packing problems require all objects
(circles) completely within a container (left part), whereas
it is sufﬁcient for colour selection that the centres of circles
lie within the polygon (right part). Obviously, in the latter,
the number of circles which can be packed is increased
signiﬁcantly.

The observation above is based on the assumption
that all circles are objects of given size. The boundary’s
importance will become apparent by considering the
analogy to classical circle packing problems which aim at
maximizing the radius of n uniform circles: The area AP of
the polygon is to be ﬁlled with n circles, each with area Ai
(i51, 2, …, n). Maximizing the minimal distance of the
centres maximizes radius and area of the circles, so it holds
that

n
X

i~1

Ai?AP

(8)

i.e. the difference between the sum of Ai and AP has to be as
small as possible. Obviously, the less of a circle’s area lies in
the polygon, the larger the radius can be. This fact is
signiﬁcantly inﬂuenced by the circles’ location: (1) if a circle
lies completely within the polygon, its whole area must be
added; (2) if a circle’s centre lies within an edge of the
polygon, it demands an area Ai/2 of AP; (3) if a circle is
located near or in a vertex of the polygon, it demands less
than Ai/2.

These observations can be extended to three dimensions
in which balls are packed in a polyhedron. For our problem,
we conﬁrmed these observations by packing balls into the
colour polyhedron systematically: In each case, the centres
of more than 75% of the balls lie on or next to the
boundary. Thus, points on the boundary are well suited as
starting points.

The algorithm for determining the starting points is
initialized by randomly placing n points on the polyhe-
the
dron’s boundary. Afterwards,

the distribution of

points is improved by successively moving the worst
located point (one of the points which cause the minimal
distance between all points) on the boundary. Modifying
the well-known Simplex algorithm6, the movements are
executed by systematically describing the point’s location
on the boundary by linear equations: In the beginn-
ing, the worst located point PW1 may be located inside a
face k of the polyhedron. In the MAXMIN problem,
this location is described by changing the inequality
k PW1ƒbk, which represents the face, to an
constraint aT
equality constraint. Solving this MAXMIN problem
with a local method, moves the point and tries to ﬁnd a
better location in the face. After this, PW1 may no longer
be the worst located point, and the algorithm tries to
improve the worst located point PW2. If PW1 is still
the worst located point, three cases have to be distin-
guished:

1. PW1 lies still in the interior of the face: The set of points
cannot be improved by moving the worst located point
on the boundary; the algorithm stops.

2. PW1 has been moved to an edge of the polyhedron; now
it is shifted beyond the edge to an adjacent face:

PW1 on an edge
PW1 in face k
1 PW1ƒb1
1 PW1ƒb1
aT
aT
.
.
..
..
j PW1~bj
j PW1ƒbj
aT
aT
k PW1~bk
k PW1~bk R aT
aT
l PW1ƒbl
l PW1ƒbl
aT
aT
.
.
..
..
p PW1ƒbp
p PW1ƒbp
aT
aT

PW1 in an adjacent face j
1 PW1ƒb1
aT
.
..
j PW1~bj
aT
k PW1v~bk
R aT
l PW1ƒbl
aT
.
..
p PW1ƒbp
aT

2. The algorithm proceeds by solving the next MAXMIN

problem, which moves PW1 in the new face.

3. The point has been moved to a vertex of the polyhedron

and is shifted in one of the two adjacent faces:

PW1 on a vertex
PW1 in face k
1 PW1ƒb1
1 PW1ƒb1
aT
aT
.
.
..
..
j PW1~bj
j PW1ƒbj
aT
aT
k PW1~bk R
k PW1~bk R aT
aT
l PW1~bl
l PW1ƒbl
aT
aT
.
.
..
..
p PW1ƒbp
p PW1ƒbp
aT
aT

PW1 in an adjacent face l
1 PW1ƒb1
aT
.
..
j PW1ƒbj
aT
k PW1v~bk
aT
l PW1~bl
aT
.
..
p PW1ƒbp
aT

3. The algorithm proceeds by solving the next MAXMIN

problem, which moves PW1 in the new face.

Thus,
the distribution of points on the boundary is
successively improved by solving a series of modiﬁed
MAXMIN problems in which a point is forced to a face of
the polyhedron.

Algorithm 1 formulates the identiﬁcation of clearly
distinguishable colours
in pseudocode as a procedure
‘calculateColours (n, givenRGB, polyhedron)’, where n
is the number of searched colours, ‘givenRGB’ are the
given colours in sRGB and ‘polyhedron’ are the hyper-
planes of the colour polyhedron. The procedure starts by

Identification of Optimal Colours for Maps from the Web

27

Algorithm 1 (part1): Calculation of n well distinguishable colours

transforming given colours from sRGB to CIELUV (lines
1–3); the determination of good starting points is described
in lines 4–17.

Local improvement of the starting points
A local optimisation method improves the locations of the
starting points by solving the original optimisation pro-
blem. In contrast to the former step, the points may not
only move on the polyhedron’s boundary, but also inside
the polyhedron. As the local method, we use Sequential
Quadratic Programming. In Algorithm 1, SQP is called in
line 18.

Evaluation of locally optimal solutions and global improvements
The ﬁnal step detects solutions which are not close to global
optimality and proposes improvements. The quality of the

solution, generated by the local method,

current
is
characterized by the minimal distance between the colours;
the minimal distance is caused by at least one of the new
points (worst located point). Obviously, moving this point
to a better position improves the solution. Such a candidate
for a better solution is identiﬁed as the centre of the largest
empty ball, which is the largest ball whose centre lies inside
the colour
(cf.
Toussaint, 1983). If the radius of the ball exceeds the
minimal distance calculated so far, the current solution will
located point must be
be suboptimal and the worst
displaced by the centre of the largest empty ball.

space and which contains no points

The largest empty ball can be easily found by calculating
the three-dimensional Voronoi diagram (Okabe et al.,
2000) of the set of both given and searched points. The
centre of the largest empty ball is from the set7, which
contains the Voronoi vertices, lying in the polyhedron,

28

The Cartographic Journal

Algorithm 1 (part2): Calculation of n well distinguishable colours

intersections of Voronoi edges and faces of the polyhedron,
and vertices of the polyhedron.

In Algorithm 1,

the detection of

suboptimality is

described in lines 19–30.

If no further improvement can be found, the calculated
colours
transformed from CIELUV to sRGB
(Algorithm 1, lines 31–33) and returned to the caller of
the procedure.

are

Figure 6 shows six clearly distinguishable colours for the
topographic map in Figure 1. The appliance of the colours
has also been shown in the lower part of Figure 1.

Introducing colours into the discussion of the algorithm,
the general proceeding can be described as follows: The
algorithm starts with colours on vertices, edges and faces of
the polyhedron, i.e. in terms of RGB, at least one of the
coordinates
is 0 or 255. Within the local
optimisation method, the colours are primary moved on
the boundary of the polyhedron, secondary some colours
move slightly into the inner of the polyhedron. The

(R,G,B)

algorithm does not choose ‘grey colours’. Black and white
may be chosen, but, in general, these can be assumed as
given colours in the topographic map. In terms of hue,
saturation and lightness, the algorithm identiﬁes colours
with a high lightness and/or a high saturation.

Representing cartographic rules as constraints
Above, we have considered a common case of mapping on
demand in which a topographic map is enhanced by
geospatial objects representing several themes. We have
formulated a constrained, nonlinear optimisation problem
and we have explained our solution method. Now, we will
describe some variants of the optimisation problem which
arise from introducing more speciﬁc cartographic design
principles. We will show that these design principles can be
formulated mathematically and incorporated into the
optimisation model8. These augmented problems can also
be solved by the method described above.

Figure 6. Six clearly distinguishable colours which are identiﬁed for the topographic map in Figure 1 (given colours)

Identification of Optimal Colours for Maps from the Web

29

Figure 7. Eighteen clearly distinguishable colours

S2: Given geospatial objects of n themes. These themes are to
be composed into a new map in which the n themes are to be
clearly distinguishable.

This scenario is a special case of scenario S1, in which the
set F of given colours is the empty set. The n colours, which
are to be determined, can be positioned anywhere in the
colour space, regarding only the distances between these
colours. This problem and its solution have a long tradition
in colour science. In 1965, Kelly (1965) determined twenty
two colours of maximum contrast by using a colour naming
system (ISCC-NBS). Carter and Carter (1982) describe an
approach of calculating high-contrast colours for coding
different categories. Their basic conditions are very similar
to ours: They address additive colour mixing (especially
cathode ray tubes) and use the CIELUV colour space. They
also aim at maximizing the minimum distance, but they do
not
formulate the problem in terms of mathematical
optimisation. A solution is found by an iterative heuristic:
At ﬁrst, n points are randomly selected; subsequently single
points are moved so that
the minimum distance is
increased. The problem of high-contrast colours is also
addressed by Campadelli et al. (1999). Instead of a colour
space, they use discrete colour palettes (ISCC-NBS colour
naming system, X Windows and Munsell Atlas). The
problem is
formulated within terms of combinatorial
optimisation and modelled as a complete undirected graph.
As solution method, they use an iterative heuristic. Glasbey
et al. (2007) aim at updating the problem of Carter and
Carter (1982) with modern computers and more colour
metrics. They formulate an optimisation problem which
maximizes the minimum distance in CIELAB. They use a
sequential search algorithm and a simulated annealing
algorithm to solve the problem.

As a main characteristic, none of the approaches aimed at
ﬁnding a solution on demand and none incorporates given
colours into the model. However, as this problem is
independent of given colours, there is no need to solve it
on demand: colours can be determined once and used as
colour schemes.

The optimisation problem must be modiﬁed to

minimize {d

subject to

(cid:6)
d2ƒ Xi,Xj
(cid:6)

(cid:6)
2
2,
(cid:6)

i~1, 2, . . . , n, j ~1, 2, . . . , n, j§i

(9)

aT
k Xiƒbk,
i~1, 2, . . . , n, k~1, 2, . . . , 9

in which Y is replaced by X. Figure 7 shows an example of
18 clearly distinguishable colours.

S3: Assume scenario S1 in which a topographic map is
overlaid by geospatial objects of n themes. But now also
semantics of some themes is known. The n themes are to be
clearly distinguishable from each other as well as from the
topographic map. Furthermore, the colours of themes whose
semantics are known are to respect colour conventions.

In this scenario, semantics allow us to incorporate
knowledge about typically used colours or conventional
associations of colours (e.g. a greenish hue for vegetation or
a bluish hue for water). The optimisation problem is
extended by constraints which restrict hue to a sector of
(cid:10)ƒh2, where h1
CIELUV’s u–v-plane (h1ƒarctan v(cid:2)
and h2 are two angles, cf. equation (4)) and by constraints
which ensure unambiguity of arctan:

i =u(cid:2)
i

(cid:9)

minimize {d

subject to

(cid:6)
d2ƒ Xi,Yj
(cid:6)

(cid:6)
2
2,
(cid:6)

i~1, 2, . . . , pƒn, {900ƒh1ƒ900

(10)

i~1, 2, . . . , n, j ~1, 2, . . . , mzn, j§i

aT
k Xiƒbk,
i~1, 2, . . . , n, k~1, 2, . . . , 9

arctan

ƒh1,

v(cid:2)
i
u(cid:2)
i

{arctan

ƒh2,

v(cid:2)
i
u(cid:2)
i

liuiƒ0,

civiƒ0,

i~1, 2, . . . , pƒn, {900ƒh2ƒ900

i~1, 2, . . . , pƒn, l [ -1, 0, 1

f

g

i~1, 2, . . . , pƒn, c [ {1, 0, 1
cj j= lj

j, lzc=0

f

g,

Figure 8. Six clearly distinguishable colours which are identiﬁed for the topographic map in Figure 1. The colours contain a blue hue (colour
1) and a green hue (colour 2)

30

The Cartographic Journal

Figure 9. Six clearly distinguishable colours which are identiﬁed for the topographic map in Figure 1. The six colours are mainly distin-
guished by hue

In order to solve this problem, we have slightly modiﬁed
Algorithm 1. Firstly, in the local optimisation method, it is
guaranteed, that the starting point next to a desired sector
of the u–v-plane, is forced to this sector. Secondly, the
detection of suboptimal solutions ensures that a possible
improvement lies in the correct hue-sector. Figure 8 depicts
six clearly distinguishable colours for the topographic map
in Figure 1. One of the six colours has been requested as
‘Bluish’, another one as ‘Greenish’.

S4: Assume scenario S1 in which a topographic map is
overlaid by geospatial objects of n themes. The n themes are to
be clearly distinguishable from each other as well as from the
topographic map. Furthermore the distinction of the themes’
quality is to be emphasized.

In scenarios 1–3, contrast of colours was achieved by
varying hue, saturation and value. In this scenario, distinction
of quality has to be emphasized by varying the hue (cf. the
section on ‘Background and related work’). Thus, we extend
the optimisation problem by adding constraints which can
ensure a difference of hue by keeping variation of saturation
(equation (3)) and value below a threshold:

minimize {d

subject to

(cid:6)
d2ƒ Xi,Yj
(cid:6)

(cid:6)
2
2,
(cid:6)

i~1, 2, . . . , n, j~1, 2, . . . , mzn, j §i

aT
k Xiƒbk,
i~1, 2, . . . , n, k~1, 2, . . . , 9

(11)

q

ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
(cid:10)2z v(cid:2)
(cid:9) (cid:10)2
(cid:9)
u(cid:2)
i
i
L(cid:2)
i

{

i, j~1, 2, . . . , n, i=j

r

ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
(cid:7) (cid:8)2
(cid:7) (cid:8)2
z v(cid:2)
u(cid:2)
j
j

L(cid:2)
j

ƒsthreshold

,

{L(cid:2)
L(cid:2)
j ƒLthreshold,
i
i, j~1, 2, . . . , n, i=j

hues. Figure 9 depicts six clearly distinguishable colours for
the topographic map in Figure 1. The algorithm differen-
tiated the colours primarily by their hue. Obviously, this
scenario is very hard to solve for the topographic map at
hand: the hues of the given colours are mainly clustered at
hues from red to green.

S5: Assume scenario S1 in which a topographic map is
overlaid by geospatial objects of n themes. Now, the objects of a
theme are ordered. The n themes are to be clearly distinguish-
able from each other as well as from the topographic map.
Furthermore, the order is to be visualized.

Here, the order can be represented by varying the value
(cf. the section on ‘Background and related work’). Thus,
we extend the optimisation model by adding constraints
which keep the difference of hue below a threshold.

minimize {d
subject to

(cid:6)
d2ƒ Xi,Yj
(cid:6)

(cid:6)
2
2,
(cid:6)

i~1, 2, . . . , n, j~1, 2, . . . , mzn, j §i

aT
k Xiƒbk,
i~1, 2, . . . , n, k~1, 2, . . . , 9

(12)

r

ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
(cid:8)2
(cid:7)

(cid:8)2

(cid:7)
z v(cid:2)
i

{v(cid:2)
j

u(cid:2)
i

{u(cid:2)
j

ƒsthreshold,

i, j~1, 2, . . . , n, i=j

Again, the detection of suboptimal solutions tests whether a
possible improvement keeps
the distinction of values.
Figure 10 illustrates four ordered colours which are clearly
distinguishable from the colours of the topographic map in
Figure 1.

Of course, adding further constraints to the optimisation
model decreases the number of colours which can be
identiﬁed.

As in scenario 3, the detection of suboptimal solutions tests
whether a possible improvement keeps the distinction of

Modelling users’ properties
Up to now, we have identiﬁed colours subject to data
characteristics and cartographic rules. We will now explain,

Figure 10. Four ordered colours which are identiﬁed for the topographic map in Figure 1

Identification of Optimal Colours for Maps from the Web

31

how to personalize colours by modelling users’ colour
vision impairment, device and environment.

Colour vision impairment
As described in the section on ‘Description of colours’, the
colour spaces perceivable by users with various forms of
colour vision impairment collapse into planes. The optimi-
sation problem is given by

minimize {d

subject to

(cid:6)
d2ƒ Xi,Yj
(cid:6)

(cid:6)
2
2,
(cid:6)

(13)

i~1, 2, . . . , n, j ~1, 2, . . . ,mzn, j §i

aT
k Xiƒbk,
i~1, 2, . . . , n, k~1, 2, . . . , 9

aTXi~b,

i~1, 2, . . . , n

The latter constraint forces colours into a plane. Again, we
slightly modify Algorithm 1: after determining starting
points, these points should be projected onto the plane;
improvements are found by means of a Voronoi diagram in
the plane.

Colour reproduction and ambient light
The colour reproduction of monitors and a bright ambient
light can be inﬂuenced by using the colour adaption model
CIECAM02 (cf. the section on ‘Incorporation of colour
reproduction and ambient light’). The optimized colours
are transformed into the perceptual correlates H, J, Q, C
and M under speciﬁc conditions; the inverse transformation
incorporates modiﬁed conditions. However, poor colour
reproduction can only be reduced to a certain degree –
especially over the WWW. Firstly, the input parameter of
the luminance of the adapting ﬁeld should be at best
it must be
measured with a photometer; otherwise,
estimated. Secondly, the parameter values of the surround
conditions must be indicated by users, i.e. they reﬂect their
subjective impression. These impressions can be improved,
if users are confronted with sample images from which they
have to choose the image best represented on their
displays.

CONCLUSIONS

We have described an approach of colouring maps created
on demand. The mapping is based on data which are
available via WMS and which can be combined by users into
new maps. In general, such a combination of data does not
result in a concise map design. A signiﬁcant improvement is
achieved by using colours which are clearly distinguishable
for human visual perception. Our approach formulates the
selection of colours as an optimisation problem maximizing
the minimal distance between colours (MAXMIN pro-
blem). In order to measure distinction of colours, we use
CIELUV as uniform colour space. Within CIELUV, the
the colours which can be reproduced by
entirety of

is modelled as

convex polyhedron and
a
monitors
represented in the optimisation problem as a set of linear
inequalities.

MAXMIN is characterized as a nonlinear problem which
has a large number of locally optimal solutions. Efﬁcient
solution methods ﬁnd a locally but usually not the globally
optimal solution.

In order to achieve an almost globally optimal solution
on demand, we use speciﬁc characteristics of the problem
and provide a method in which a local method is supported
by a method which determines good starting points and a
method which evaluates a local solution. The essential
observation is that points on the boundary of the colour
polyhedron are well suited as starting points for a method of
local optimisation. A three-dimensional Voronoi diagram is
used to detect suboptimal solutions and to identify possible
improvements. Altogether, this approach achieves a good
solution in a few seconds.

We have explained how to model speciﬁc cartographic
problems as well as users’ display and vision properties within
the optimisation problem. The different problems and
scenarios illustrate the advantage of using a colour space
which can be ﬂexibly modiﬁed by introducing constraints.

The selection of colours is implemented prototypically as a
Web Service and can be tested at http://colour.ikg.uni-bonn.
de

BIOGRAPHCIAL NOTES

Jo¨rg Steinru¨cken is a post-
doctoral researcher and lec-
the Institute for
turer at
Geodesy and Geoinforma-
tion, University of Bonn,
Germany. He received his
diploma deegree in geodesy
from the University of Bonn
where he also got his PhD
in 2009. His main research
interest is on web mapping
where he focuses on visua-
lisation, presentation and
usability of data from geodata
infrastructures.

NOTES

1 A detailed description of the formulation and notation of
optimisation problems is e.g. given in Boyd and Vandenberghe
(2006).

2 Maximize f(x) is equivalent to minimize 2f(x).
3 In a convex problem,
i.e.

the objective and constraint
functions
inequality
they
f[txz(12t)y](tf(x)z(12t)f(y) (Boyd and Vandenberghe,
2006). Thus, a convex function is optimized over a convex
set, formed by the convex constraints.

are convex,

satisfy the

4 Such problems are commonly called ‘knapsack pro-
is packing his knapsack for a
blems’: a mountaineer
mountain tour and has to decide which objects he should
take with him (Kellerer et al., 2004).

32

The Cartographic Journal

5 Circle packing is a special case of packing problems and
aims at ﬁnding the maximum radius of n uniform sized and
non-overlapping circles which are placed in a container, e.g.
in a unit square (Castillo et al., 2007). It is important to
note that knapsack problems choose a subset out of n given
items, while circle packing searches for the size of the items
(circles).

6 The simplex is an algorithm for solving linear optimisa-
tion problems. In linear problems, the constraints (linear
the optimal
form a convex polyhedron;
inequalities)
solution is a vertex of the polyhedron. Simplex starts at a
vertex which can be found easily and moves along the edges
of the polyhedron to vertices which yield a better solution.
Each vertex is deﬁned as a linear system of equations; the
movements are executed by systematically changing the
equations
in
Vanderbei, 1996).

(an extended description is given e.g.

7 An extended description for two dimensions (largest

empty circle) is given by Toussaint (Toussaint, 1983).

8 In the models below, modiﬁcations are depicted in bold

font.

REFERENCES

Bertin, J. (1974). Graphische Semiologie: Diagramme Netze

Karten, de Gruyter, Berlin.

Boyd, S. and Vandenberghe, L. (2006). Convex Optimization,

Cambridge University Press, Cambridge.

Brettel, H., Vie´not, F. and Mollon, D. J. (1997). ‘Computerized
simulation of color appearance for dichromats’, Journal of the
Optical Society of America A, 14, pp. 2647–2655.

Brewer, A. C. (1994).

‘Color use guidelines for mapping and
visualization’, in Visualization in Modern Cartography, ed. by
MacEachren, M. A. and Taylor, R. D., pp. 123–147, Elsevier
Science, Tarrytown, NY.

Brewer, A. C., MacEachren, M. A., Pickle, W. L. and Herrmann,
D. (1997) ‘Mapping mortality: Evaluating color schemes for
choropleth maps’, Annals of the Association of American
Geographers, 87, pp. 411–438.

Buard, E. and Ruas, A. (2009). ‘Processes for Improving the Colours
of Topographic Maps in the Context of Map-on-demand’, in 24th
International Cartographic Conference, Santiago, Nov 15–21.
The paper is available online: http: // icaci.org/files/documents/
ICC_proceedings/ICC2009/html/refer/30_2.pdf.

Campadelli, P., Posenato, R. and Schettini, R. (1999) ‘An algorithm
for the selection of high-contrast color sets’, Color Research &
Application, 24, pp. 132–138.

Carter, C. R. and Carter, C. E. (1982). ‘High-contrast sets of colors’,

Applied Optics, 21, pp. 2936–2939.

Castillo, I., Kampas, J. F. and Pinte´r, D. J. (2008). ‘Solving circle
packing problems by global optimization: numerical results and
industrial applications’, European Journal of Operational
Research, 191, pp. 786–802.

Christophe, S. (2008a). ‘Creative Cartography Based on Dialogue’, in
17th AutoCarto Conference (AutoCarto’08), Shepherdstown,
WV, Sep 8–11. The paper is available online: http: //www.cartogis.
org/docs/proceedings/2008/christophe.pdf

Christophe, S. (2008b). ‘Legend design on the web: creating accurate
styles’, International Journal of Spatial Data Infrastructures
Research, 3, pp. 38–57.

Erkut, E. and Neuman, S. (1989). ‘Analytical models for locating
facilities’, European Journal of Operational

undesirable
Research, 40, pp. 275–291.

(2005). Color Appearance Models, Wiley,

Fairchild, D. M.
Chichester.

Fletcher, R. (1987). Practical Methods of Optimization, Wiley,

Chichester.

Foley, D. J., van Dam, A., Feiner, K. S. and Hughes, F. J. (1996).
Computer Graphics: Principles and Practice, Addison-Wesley
Publishing Company, Reading, MA.

Glasbey, C., van der Heijden, G., Toh, F. K. V. and Gray, A. (2007).
images’, Color Research &

‘Colour displays for categorical
Application, 32, pp. 304–309.

Harrower, M. and Brewer, A. C. (2003). ‘Colorbrewer.org: An online
tool for selecting colour schemes for maps’, The Cartographic
Journal, 40, pp. 27–37.

Kellerer, H., Pferschy, U. and Pisinger, D. (2004). Knapsack

Problems, Springer, Berlin/Heidelberg.

Kelly, K. L. (1965). ‘Twenty two colors of maximum contrast’, Color

Engineering, 3, pp. 26–27.

La Beaujardiere, J. (2006). Opengis web map server implementation
specification. OpenGIS Implementation Specification OGC 06-
042. Open Geospatial Consortium. http://www.opengeospatial.
org/standards/wms

Lupp, M. (2007). Styled layer descriptor profile of the web map service
implementation
Implementation
specification. OpenGIS
Specification OGC 05-078r4. Open Geospatial Consortium.
http://www.opengeospatial.org/standards/sld

MacEachren, M. A. (1995). How Maps Work: Representation,

Visualization, and Design, Guilford Press, New York.

Mersey, E. J. (1990). ‘Colour and thematic map design: the role of
colour scheme and map complexity in choropleth map commu-
nication’, Cartographica, 27, Monograph 41.

Nagy, L. A., Sanchez, R. R. and Hughes, C. T. (1990). ‘Visual search
for color differences with foveal and peripheral vision’, Journal of
the Optical Society of America A, 7, pp. 1995–2001.

Okabe, A., Boots, B., Sugihara, K. and Nok Chiu, S. (2000). Spatial
Tessellations: Concepts and Applications of Voronoi Diagrams,
Wiley, Chichester.

Robinson, H. A., Morrison, L. J., Muehrcke, C. P., Kimerling, J. A.
and Guptill, C. S. (1995). Elements of Cartography, Wiley, New
York.

Rockafellar, T. R. (1993).

‘Lagrange multipliers and optimality’,

SIAM Review, 35, pp. 183–238.
(2007).

Schanda,

J.

in Colorimetry:
‘CIE colorimetry’,
Understanding the CIE system, ed. by Schanda, J., pp. 25–78,
Wiley, Hoboken, NJ.

Sharma, G. (2003).

in
Digital Color Imaging Handbook, ed. by Sharma, G., pp. 1–114,
CRC Press, Boca Raton, FL.

‘Color fundamentals for digital

imaging’,

Steinru¨cken, J. (2009). Automatisierte Erzeugung personalisierter ad-
hoc-Karten in einem Service-basierten GIS (Mapping on Demand).
PhD thesis. University of Bonn, Bonn. Germany. http://hss.
ulb.uni-bonn.de/2009/1946/1946.htm

Steinru¨cken, J. and Plu¨mer, L. (2009). ‘A Web Service to Personalise
Map Colouring’, in 24th International Cartographic Conference
(ICC 2009), Santiago, Nov 15–21. The paper is available online:
http://icaci.org/files/documents/ICC_proceedings/ICC2009/
html/nonref/13_18.pdf

Stokes, M., Anderson, M., Chandrasekar, S. and Motta, R. (1996). A
Standard Default Color Space For The Internet – sRGB. World
Wide Web Consortium. http://www.w3.org/Graphics/Color/
sRGB.html

Sun, W. and Yuan, Y.-X. (2006). Optimization theory and methods:
nonlinear programming, Springer SciencezBusiness Media, New
York.

Toussaint, T. G. (1983) ‘Computing largest empty circles with
Journal of Parallel

International

location
constraints’,
Programming, 12, pp. 347–358.

Vanderbei, J. R. (1996). Linear Programming: Foundations and

Extensions, Kluwer Academic Publishers, Boston, MA.

Vie´not, F., Brettel, H. and D. Mollon, D. J. (1999). ‘Digital video
colourmaps for checking the legibility of displays by dichromats’,
Color Research & Application, 24, pp. 243–252.

Wyszecki, G. and Stiles, S. W. (1982). Color Science: Concepts and
Methods, Quantitative Data and Formulae, Wiley, New York.

Copyright of Cartographic Journal is the property of Maney Publishing and its content may not be copied or

emailed to multiple sites or posted to a listserv without the copyright holder's express written permission.

However, users may print, download, or email articles for individual use.

