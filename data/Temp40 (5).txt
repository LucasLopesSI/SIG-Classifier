This article was downloaded by: [Florida State University]
On: 20 December 2014, At: 22:33
Publisher: Taylor & Francis
Informa Ltd Registered in England and Wales Registered Number: 1072954 Registered
office: Mortimer House, 37-41 Mortimer Street, London W1T 3JH, UK

International Journal of Geographical
Information Science
Publication details, including instructions for authors and
subscription information:
http://www.tandfonline.com/loi/tgis20

Theoretical analytics of stereographic
projection on 3D objects' intersection
predicate
Shuqing Zhang a a & Junyan Zhang a
a Northeast Institute of Geography and Agricultural Ecology ,
Chinese Academy of Sciences , Changchun 130012, China
Published online: 12 Feb 2010.

To cite this article: Shuqing Zhang & Junyan Zhang (2010) Theoretical analytics of stereographic
projection on 3D objects' intersection predicate, International Journal of Geographical Information
Science, 24:1, 25-46, DOI: 10.1080/13658810802687327

To link to this article:  http://dx.doi.org/10.1080/13658810802687327

PLEASE SCROLL DOWN FOR ARTICLE

Taylor & Francis makes every effort to ensure the accuracy of all the information (the
“Content”) contained in the publications on our platform. However, Taylor & Francis,
our agents, and our licensors make no representations or warranties whatsoever as to
the accuracy, completeness, or suitability for any purpose of the Content. Any opinions
and views expressed in this publication are the opinions and views of the authors,
and are not the views of or endorsed by Taylor & Francis. The accuracy of the Content
should not be relied upon and should be independently verified with primary sources
of information. Taylor and Francis shall not be liable for any losses, actions, claims,
proceedings, demands, costs, expenses, damages, and other liabilities whatsoever or
howsoever caused arising directly or indirectly in connection with, in relation to or arising
out of the use of the Content.

This article may be used for research, teaching, and private study purposes. Any
substantial or systematic reproduction, redistribution, reselling, loan, sub-licensing,
systematic supply, or distribution in any form to anyone is expressly forbidden. Terms &
Conditions of access and use can be found at http://www.tandfonline.com/page/terms-
and-conditions

International Journal of Geographical Information Science
Vol. 24, No. 1, January 2010, 25–46

Research Article

Theoretical analytics of stereographic projection on 3D objects’
intersection predicate

SHUQING ZHANG* and JUNYAN ZHANG
Northeast Institute of Geography and Agricultural Ecology, Chinese Academy of
Sciences, Changchun 130012, China

(Received 27 August 2008; final version received 1 December 2008 )

Based on stereographic projection (SP), a novel and systematic three-dimensional
(3D) objects’ intersection predicate theory is inferred and formularized. The
theory is deduced from the intersection of quasi-convex bodies. Since composite
mapping has omnidirectional one-to-one mapping properties for any quasi-
convex bodies, they can be accurately projected to the equatorial plane, and their
intersection predicate can be simplified into two dimensions. Those predicate
conclusions are further applied to common polyhedrons by the introduction of
the radial dividing point concept.
‘Point inclusion’ and ‘line traversing’ are
mathematically abstracted as the primary intersection predicate types for all kinds
of 3D objects, even including curved line and curved surface. As a special case of
‘point inclusion’, ‘polyhedron entirely included’ is also pointed out. Meanwhile,
the process of intersection predicate is heuristically optimized at object and face
levels with well-matched bounding boxes: bounding sphere and projective cone.

Keywords: stereographic projection (SP); intersection predicate; 3D GIS analysis
models; point inclusion; line traversing

1.

Introduction

As the increasingly complex tasks in many geo-scientific, urban and other
applications require the capability to analyze and visualize spatial features and
their relationships in three-dimensional (3D) space, 3D geographical information
systems (3D GIS) have become an important research area in the last decade or so
(Houlding 1994, Pilouk 1996, Ko¨ ninger and Bartel 1998, Shiode 2001, Coors 2003,
Kwan and Lee 2004, Lee and Kwan 2005). Since conventional 2D GIS methods are
inadequate for handling 3D geometry and performing 3D spatial analysis, the
development of 3D theory and techniques have attracted much interest in recent
years (e.g., Guo et al. 1998, Ramos 2002, Tse and Gold 2003). The intention behind
this interest is to improve the capability of GIS in handling 3D geometry, analyzing
3D topological relations, performing 3D spatial queries and visualizing the data (Lee
and Kwan 2005). A large number of spatial models have been developed in these
aspects so far. But most of the models primarily focus on the object construction and
topological relationships. Geometrical modeling for spatial operation, however, is
rather limited (Chen et al. 2007).

Spatial intersection is regarded as one of the fundamental GIS geometric spatial
operations (Shortridge and Goodchild 2002). Though geometric intersection is not a

*Corresponding author. Email: zhangshuqing@neigae.ac.cn

International Journal of Geographical Information Science
ISSN 1365-8816 print/ISSN 1362-3087 online # 2010 Taylor & Francis
http://www.tandf.co.uk/journals
DOI: 10.1080/13658810802687327

Downloaded by [Florida State University] at 22:33 20 December 2014 26

S. Zhang and J. Zhang

complex mathematical problem, it has its challenges, as it should be performed
within reasonable computational time (Verbree et al. 2005). But such a geometrical
computation on highly discrete 3D objects can be very costly. Suppose we have a
model composed of a set of triangulated surfaces representing faults and horizon
boundaries. For answering the query ‘Select the set of horizon Q which are
intersected by a given fault f’ we have to test the pairwise geometrical intersection
between the surfaces (Apel 2006). Geometrical models concerning intersection may
also aspect 3D GIS’s diverse functions. For example, binary topological relations
can be computed from the geometrical relationships of the two simplex sets (Breunig
1996), like two sets of surface triangles (Apel 2006). The importance of the study on
3D object geometric intersection would be hence self-evident.

The current research in 3D GIS intersection mainly focuses on the optimization of
intersection test algorithms supported by techniques like oriented bounding box tests
(Eberly 2001), octrees (e.g., Van Oosterom 1994), and sweep lines or sweep planes
(e.g., Hertel et al. 1984, Chazelle and Dobkin 1987, Van Roessel 1990). Even as the
work proceeds, the geometrical intersection is still computationally demanding for
highly discrete objects (Apel 2006). It would be necessary to develop systematic and
efficient methodology to meet the highly computational requirements of intersection
predicate for different kinds of 3D objects.

Setting out from the analysis of the newly defined convex body, called quasi-
convex body, a novel intersection predicate theory is deduced with vector algebra
and stereographic projection (SP). The advantage of SP is that it is able to map 3D
objects from 3D space onto the equatorial plane. Meanwhile, the inverse images of
the 3D object mapped on the equatorial plane can be reconstructed, and the
intersection predicate for 3D objects can be performed on the equatorial plane. This
would significantly reduce the computational complexity of geometrical intersection.
At the same time, the face unit to be described here is made the most of the
macroscopic geometrical characteristics of a 3D object’s surface, so as to keep the
integrity of 3D object’s surface geometry. This would be very useful for the
optimization of intersection process.

The paper is organized as follows: (1) basic concepts are introduced in Section 2;
(2) the SP and its property theorems will be studied in Section 3; (3) the method of
3D object intersection predicate based on SP will be discussed in Section 4; (4)
important issues about the newly proposed methodology are discussed and analyzed;
and (5) conclusions will be made in Section 5.

2. Basic concepts

Bounding sphere. Suppose P is a 3D-object. p is a point of P, p g P. In a metric
space, the minimum sphere enclosing P is called the bounding sphere of P. O refers to
the spherical center, and r the radius of the bounding sphere of P. In practice, a
sphere, whose diameter is not larger than the diagonal of the regular bounding
(hexahedral) box of the 3D object, can be used as the minimum bounding sphere.
Quasi-convex body. Consider an arbitrary radial coming from the spherical center
O to the surface of a common polyhedron’s bounding sphere, if there is one and only
one intersection point between the radial and the polyhedron’s surface,
the
polyhedron will be defined as a quasi-convex body; otherwise, the polyhedron is a
non-quasi-convex body.

Face and sub-face. Suppose a volumetric 3D object is represented by a polyhedron
primitive P. P is composed of finite faces. Not necessarily being flat, a face is defined

Downloaded by [Florida State University] at 22:33 20 December 2014 Stereographic projection on 3D objects’ intersection predicate

27

by the macroscopic geometric property of the object in visual sense or expressed with
a curved face function. Each face consists of a finite set of discrete planar (or flat)
polygons (which can be used by GIS directly), called sub-faces. Note that different
from the definition by Stoter and Van Oosterom (2002), the face defined here is not
necessarily a flat polygon, and thus the polyhedron constructed by such faces can be
a curved one.

Radial dividing point (RDP). Suppose radial LR coming from O (the center of
bounding sphere of a polyhedron) intersects with the surface of the polyhedron at
point Pi (i51, 2, 3 … n), which cuts LR into two sections. If Pi’s d neighborhoods in
the radial: (1) belong to the inner and outer sides of the polyhedron respectively, Pi
will be a radial dividing point (RDP), denoted as Pf; (2) lie entirely either the interior
or the exterior of the polyhedron, Pi will not be a radial dividing point, called non-
radial dividing point (non-RDP), denoted as Pn; and (3) are uncertain with respect to
the interior or the exterior of the polyhedron, called uncertain radial dividing point
(URDP), denoted as Pu (which may be either an RDP or a non-RDP). URDP may
lie on the boundary of a sub-face that is coplanar with origin O or on one of the end
points of the line segment which is collinear with O (see Figure 1).

Inside hemisphere, outside hemisphere, up hemisphere, down hemisphere. Suppose a
sphere is intersected by an arbitrary plane P, the hemisphere including the spherical
center O is defined as inside hemisphere (I-hemisphere), the other side outside
hemisphere (O-hemisphere). The hemisphere where the sphere’s south pole (S) exists
is called down hemisphere (D-hemisphere),
the other side up hemisphere (U-
hemisphere).

p plane and p circle. The plane P mentioned above is called p plane, and the circle

intersected by the p plane with the spherical surface is defined as p circle.

Projective cone. When a sphere is intersected by a plane, a p circle and a U-
hemisphere can be obtained. Projective cone, denoted as Pc, is the set constructed by
connecting all points on the U-hemisphere with the spherical center O. The p circle is
also defined as projective cone’s p circle (Pc2p circle). The direction of Pc is that of
the radial (denoted as LRc) from the spherical center O to the center of Pc2p circle.
The angle between the line from O (the spherical center) to an arbitrary point on the
Pc2p circle, and LRc, is defined as the half angle (denoted as h) of Pc. For a projective
cone Pc, if the intersection set between the radial coming from the spherical center
and the surface of the polyhedron is a single value, then Pc is called a ‘convex
projective cone’; otherwise, if the intersection set has multi-values, Pc is called a ‘non-
convex projective cone’.

Figure 1. Cutaway view map of radial dividing point (RDP). LR is the radial starting the
spherical center O(0,0,0), points denoted as Pf, Pn, and Pu are RDPs, non-RDPs, and URDPs,
respectively. S is the surfaces of a polyhedron.

Downloaded by [Florida State University] at 22:33 20 December 2014 28

S. Zhang and J. Zhang

Coordinate system. Local coordinate system Oxyz is adopted as the coordinate
system of SP (CSSP). The spherical center O is used as the origin of the coordinate
system with x-axis pointing north, y-axis east, and z-axis upwards, respectively. u, v,
and w are the unit vectors in the positive directions of the x, y, and z axes,
respectively.

Inclination angle, orientation angle, and distance parameter. The inclination angle
(a) of any plane (P) is defined as the angle between the P’s upward normal vector
and the positive direction of z-axis, and the orientation angle (b) of P is referred as
the angle between x-axis and the projection (on oxy plane) of P’s normal vector in
clockwise direction plus 90u (Shi 1977). The distance from origin O to plane P is
defined as distance parameter (S).

3. Stereographic projection

3.1 Stereographic projection for point mapping

Points on the spherical surface could be projected onto the equatorial plane by
intersecting lines, which link the points on the spherical surface to one of the
spherical poles, with the equatorial plane.

With the spherical center as origin O(0,0,0) and RR radius, the equation of the

spherical surface in CSSP can be defined as follows:

x2zy2zz2~R2
R:

ð1Þ

Suppose ~aa is an arbitrary vector (Figure 2) that starts from O and intersects with
the spherical surface at a point. The line segment linking the intersected point to the
south spherical pole S(0,0,2RR) intersects with the equatorial plane (z50) at point
g(xg, yg, 0) (in fact Og is the projection of vector ~aa on the equatorial plane) (Shi 1977,
He 1979, Zhang et al. 2004). (xR, yR, zR) are the spherical coordinates of vector ~aa, h is

Figure 2. Section plane of stereographic projection (SP). S(0,0,2RR) and N(0,0,RR) are,
respectively, the south and north poles of the sphere with spherical center O and radius RR, AB
!
is the equatorial plane. ~aa and a’
are vectors, whose projections on the equatorial plane are Og
!
and O9g respectively. a and a9 (a5a9) are the angles between ~aa and a’
with the equatorial
!
plane, respectively. h and h9 are the angles between ~aa and a’
with z-axis, respectively, and r is
the horizontal projection of vector ~aa.

Downloaded by [Florida State University] at 22:33 20 December 2014 Stereographic projection on 3D objects’ intersection predicate

29

the angle between ~aa and z-axis, and r is the horizontal projection of vector ~aa. We then
have the following relations:

Based on the relations of the similar triangles in vertical direction, we get

On equatorial plane z50, the coordinate of point g(xg, yg, 0) can be derived from the
relations of the similar triangles in horizontal direction,

r~RR:sin h,

r2~xR

2zyR

2,

O2g~xg

2zyg

2:

Og
RR

~

r
RR: 1zcos h

½

Þ

(cid:1)

,

Og~RR:

ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1{cos h
:
1zcos h

ð
or
r

xg~l:xR,
yg~l:yR,
l~1= 1zcos h
ð
Og~l:r,
cos h~zR=RR,

Þ,

ð2Þ

ð3Þ

ð4Þ

where l5Og/r.
!
For a’

(the inverse vector of ~aa), Formula 4 still holds. Formula 4 is defined as the
SP formula for point mapping from spherical surface to equatorial plane, denoted as
g5V(s). Thus SP (g5V(s)) sets up an omnidirectional mapping relationship (i.e.,
surjection) from spherical surface to equatorial plane (Figure 2).

3.2 Projective circle

For the geometrical intersection in 3D GIS, the advantage of SP does not lay in the
intersection through point mapping, but in that through face or sub-face mapping.
!
Vectors ~aa and a’
in Figure 2 are used for further analysis. The normal form equation
of plane P can be expressed as

x cos Qzy cos yzz cos c{p~0,

ð5Þ

where Q, y, and c are the angles between the normal vector of P with x, y, and z axes,
respectively. p is the distance between the origin O(0,0,0) and P.

Suppose a spherical surface with radius RR is intersected by plane P, and their
intersection set forms a p circle. The intersection set, between equatorial plane (z50)
and lines linking each point on the p circle to the spherical pole S(0,0,2RR), also
forms a circle. Being the projection of the p circle on the equatorial plane, this circle
is defined as projective circle, denoted as pg. The coordinate of the center and the
radius of pg can be calculated as follows (Shi 1977).

Suppose a straight line coming from the spherical pole S(0,0,2RR) and through an
arbitrary point (x, y, 0) on the equatorial plane intersects with the spherical surface

Downloaded by [Florida State University] at 22:33 20 December 2014 30

S. Zhang and J. Zhang

at point [xt, yt, (t21)RR]. The following equation holds

where t~2R2
R

(cid:3)
(cid:2) x2zy2zR2
R

ð

x2t2zy2t2z t{1
(cid:4).

Þ2R2
R

~R2
R,

Suppose the inclination angle and the orientation of a plane P are a and b,

respectively, then the equation of plane P can be expressed as

x sin a sin b{y sin a cos bzz cos a~S,

where S is a distance parameter. Compared with Formula 5, we can see that S
corresponds to p, the distance from the spherical center O(0,0,0) to plane P. And the
relationships between the two equations can be readily found as follows:

Since pt[xt, yt, (t21)RR] is on plane P, the projective equation of pg can be expressed
as

2R2
R sin a sin b
x2zy2zR2
R

x{

R sin a cos b

2R2
x2zy2zR2
R

(cid:5)

yz

2R2
R
x2zy2zR2
R

(cid:6)

{1

RR cos a~S:

ð9Þ

If S + RR cos a50, plane P passes through the spherical pole S(0,0,2RR), and the
projective equation will turn into a linear equation:

x sin a sin b{y sin a cos bzRR cos a~0:

Let k5S/RR, if k + cos a?0 (i.e., S + RR cos a?0), the projective Equation (9) will
become a circular equation:

(cid:5)

x{

RR sin a sin b
kzcos a

(cid:6)2

(cid:5)
z yz

RR sin a cos b
kzcos a

(cid:6)

~

(cid:3)

(cid:4)R2
1{k2
R
Þ2 :
kzcos a

ð

The coordinate of the center (x, y) and the radius (Rg) of the projective circle pg are

cos Q~sin a sin b,

cos y~{sin a cos b,

cos c~cos a,

p~S:

x~

y~

Rg~

,

RR sin a sin b
kzcos a
Þ
ð
{RR sin a cos b
kzcos a
ð
p
+ ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1{k2
kzcos a
ð

Þ
:RR
Þ

,

:

ð6Þ

ð7Þ

ð8Þ

ð10Þ

ð11Þ

ð12Þ

In Formula 12, since Rg is always positive, the sign ‘¡’ ahead of the radical sign
will be the positive sign when k g (2cos a, 1]; Similarly, the negative sign will be
adopted when k g [21, 2cos a). When k50, the projective circle pg is mapped from
the plane P passing through the spherical center O(0,0,0). In such a case, the
coordinate of the center (x, y) and the radius of the pg will be as follows:

Downloaded by [Florida State University] at 22:33 20 December 2014 Stereographic projection on 3D objects’ intersection predicate

31

x~RR:tga:sin b,
y~RR:tga:cos b,

Rg~

RR
cos a

:

ð13Þ

Based on Formula 7, the following property theorems for plane mapping under SP

(hereafter referred as property theorems for short) are defined.

Property Theorem 3.1: The necessary and sufficient conditions for two planes to be
parallel are that both their corresponding inclination angle a and orientation angle b are
identical.

Property Theorem 3.2: The necessary and sufficient conditions for two planes to be
coplanar are that their corresponding inclination angle a, orientation angle b, and
distance parameter S are identical.

Based on Formula 11, the following property theorem can be deduced:
Property Theorem 3.3: If a spherical surface is cut by a plane, the intersection set
between them must be a circle, and the projection of the circle (on equatorial plane)
under SP should be a circle too.

p

ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1{k2

For Formula 12, if k?0 and if a50, the Formula will be in the form of x50, y50,
Rg~RR:
Þ, which represents a series of concentric circles with O (the
origin of the coordinate system) as their circular centers, and Rg the radius of the
concentric circles.

= 1zk
ð

Property Theorem 3.4: All latitudes will be mapped in the form of concentric circles
on the equatorial plane under SP. Based on Formula 10, the following property
theorems hold:

Property Theorem 3.5: When the spherical surface is intersected by any plane
passing through the south spherical pole S(0,0,2RR), their intersection set (i.e., the p
circle) will be mapped as a straight line on the equatorial plane under SP.

If a5p/2, Formula 10 turns into

x sin b{y cos b~0:

ð14Þ

Property Theorem 3.6: Any longitude will be mapped as a radial from the origin

O(0,0,0) on the equatorial plane under SP.

3.3

Inverse transformation of SP (ITSP)

It is defined as inverse transformation of SP (ITSP) to map the images on the
equatorial plane back to their corresponding inverse images on spherical surface.
ITSP is denoted as s5v(g), where g and s represent the image on the equatorial plane
and the corresponding inverse image on spherical surface, respectively. The
expression of ITSP can be derived based on Formulas 3 and 4 as,

h

cos h~ 1{ Og=RR

ð

Þ2

i.

h
1z Og=RR

ð

i
,

Þ2

xR~xg: 1zcos h
ð
yR~yg: 1zcos h
ð
zR~RR:cos h,

Þ,

Þ,

ð15Þ

Downloaded by [Florida State University] at 22:33 20 December 2014 32

S. Zhang and J. Zhang

where h is the angle between vector ~uu and z-axis, (xR, yR, zR) are the spherical
coordinates of vector ~uu in CSSP, RR is the radius of the sphere, and point g(xg, yg, 0)
is the projection of point (xR, yR, zR) on the equatorial plane (Figure 2).

Since the answer to Equation (15) is also exclusive, SP is an injection. From
Section 3.1, we know that SP is a surjection. Being injective and surjective, SP is
therefore considered as ‘one-to-one mapping’ or ‘bijection’.

3.4 Mapping and inverse mapping from quasi-convex body’s surface to spherical
surface

3.4.1 Point mapping from quasi-convex body’s surface to the spherical surface. In
order to perform the geometrical intersection of quasi-convex bodies under SP, the
sub-faces of the quasi-convex bodies should first be mapped onto spherical surface
and then to equatorial plane.

Suppose p(xp, yp, zp) is a point on a plane P(p g P), and s(xR, yR, zR) is the image
of point p on the spherical surface S(s g S). Point mapping from quasi-convex
body’s sub-face (i.e., the plane P) to the spherical surface, denoted as s5U(p), can be
expressed as follows:

xR~t:xp,
yR~t:yp,
zR~t:zp,

2zzp

2,

2zyp

r2~xp
t~RR=r,

ð16Þ

ð17Þ

where RR is the radius of the bounding sphere of a quasi-convex body and r is the
distance from the spherical center O(0,0,0) to point p(xp, yp, zp).

It is self-evident from Formula 16 that point mapping from quasi-convex body’s

sub-face (i.e., surface) to the spherical surface belongs to surjection.

Inverse point mapping from the spherical surface to quasi-convex body’s
3.4.2
surface. Consider a line l linking point s(xR, yR, zR) on spherical surface to the origin
O(0,0,0). The equation of the line l is x5u?t, y5v?t, z5w?t. l intersects with a plane P
(whose equation is x sin a sin b2y sin a cos b + z cos a5S) at point p(xp, yp, zp). The
formula of inverse point mapping from spherical surface to quasi-convex body’s
surface can be obtained by solving the simultaneous equations of the line l and the
plane P:

u~

tp~

xR
RR

, v~

, w~

yR
RR

zR
RR
S
u:sin a:sin b{v:sin a:cos wzw:cos a

ð

Þ

xp~u:tp, yp~v:tp, zp~w:tp:

Formula 17 is the inverse point mapping from spherical surface to the quasi-
convex body’s sub-face p5u(s). A single point set, i.e., injection, will be achieved
under such inverse point mapping. Being also injective and surjective, point mapping

Downloaded by [Florida State University] at 22:33 20 December 2014 Stereographic projection on 3D objects’ intersection predicate

33

from the quasi-convex body’s surface to the spherical surface therefore belongs to
‘one-to-one mapping’.

Inverse point mapping from the spherical surface to a line segment. Suppose l is
3.4.3
a line linking point s(xR, yR, zR) on the spherical surface to the origin O(0,0,0) and l1
is the line linking end points p1(x1, y1, z1) and p2(x2, y2, z2). l intersects with l1 at
point p(xp, yp, zp). The coordinate of p can be obtained by solving the two lines’
simultaneous equations:

cx1~0, cy1~0, cz1~0, u1~

x~cxizui:ti, y~cyizvi:ti, z~czizwi:ti,
yR
RR
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
Þ2
x2{x1
ð

Þ2z y2{y1
ð

Þ2z z2{z1
ð

, v1~

xR
RR

F ~

q

i~1, 2
zR
RR

, w1~

~x1, cy2

~y1, cz2

~z1

ð

, cx2
z2{z1
F
(cid:4)

Þ

, w2~

Þ

ð

Þ

ð

(cid:4)

(cid:3)

~

u2~

tp1~

, v2~

y2{y1
F
(cid:3)

x2{x1
F
:u2
:v2{cy2
cx2
u1:v2{v1:u2
Þ
ð
(cid:3)
{v1:cx2
u1:cy2
u1:v2{v1:u2
Þ
ð
xP~u1:tp1 , yP~v1:tp1 , zP~w1:tp1
zu2:tp2 , yP~cy2
xP~cx2

tp2~{

~{

(cid:4)

zv2:tp2 , zP~cx2

zw2:tp2

~

:v2
:w2{cz2
cy2
v1:w2{w1:v2
Þ
ð
{w1:cy2
v1:cz2
v1:w2{w1:v2
Þ
ð

:w2
:u2{cx2
cz2
Þ
ð
w1:u2{u1:w2
Þ
ð
(cid:4)
{u1:cz2
w1:cx2
Þ
ð
w1:u2{u1:w2
Þ
ð

~{

(cid:3)

ð18Þ

In Formula 18, ui, vi, and wi(i51, 2) cannot be 0 at the same time. tpi(i51, 2) can be
computed with the item whose denominator is not 0. Formula 18 is the inverse point
mapping from spherical surface to line segment. It will be necessary to perform the
inverse mapping with Formula 18 when the sub-face is coplanar with spherical center
O(0,0,0). Note that the result of inverse point mapping in such a case is usually an
interval value (not a single point), and the intersection predicate will be more
complicated.

3.5 Composite and inverse composite mapping of SP

The steps of SP composite mapping (composite mapping for short, denoted as
W:PRG) are to first map a quasi-convex body’s sub-face onto the spherical surface
(of its bounding sphere), U:PRS, and then to further project from the spherical
surface into the equatorial plane, V:SRG. g5W(p) is the composite mapping from
quasi-convex body’s sub-face to equatorial plane. The inverse composite mapping
from equatorial plane to quasi-convex body’s sub-face is both v:gRs and u:sRp, i.e.,
w:gRp. p5w(g) is therefore the inverse composite mapping from equatorial plane to
quasi-convex body’s sub-face. Since both U:PRS and V:SRG are ‘bijective’,
W:PRG is ‘bijective’ as well, i.e., ‘one-to-one mapping’. The following property
theorem will be therefore deduced.

Property Theorem 3.7: The composite mapping from quasi-convex body’s sub-face to

equatorial plane bears one-to-one mapping relationship.

Based on the one-to-one mapping relation defined by Property Theorem 3.7, we

can conclude:

Downloaded by [Florida State University] at 22:33 20 December 2014 34

S. Zhang and J. Zhang

Property Theorem 3.8: If two sub-faces intersect with each other, their images on

equatorial plane must intersect.

Suppose that a line segment and the spherical center O(0,0,0) (O not collinear with

the line segment) forms a p plane. The following theorem will hold.

Property Theorem 3.9: The image of a line segment on equatorial plane appears as

an arc less a p radian on the projective circle (pg). (Proof is omitted.)

Property Theorem 3.10: Suppose a p circle, whose image is a projective circle pg, is
formed by the intersection set between the spherical surface and an arbitrary plane P.
The points on U-hemisphere will be mapped within pg on the equatorial plane, and the
points on D-hemisphere be projected outside of pg.

Proof: Consider a plane P with inclination angle a and orientation angle b. In
Formula 12, when k52cos a, P passes through the south spherical pole S and cuts
the sphere into an I-hemisphere and an O-hemisphere. Formula 19 will be derived by
computing the first-order partial derivative for Rg on k in Formula 12,

LRg
Lk

~

+RR: 1zk: cos a
Þ
ð
Þ1=2: kz cos a
1{k2
ð

h

ð

Þ2

i ,

(cid:7)(cid:7)(cid:7)(cid:7)(cid:7)(cid:7)(cid:7)(cid:7)(cid:7)(cid:7)(cid:7)!0
lim Rg k { cos a
Þ?+1
ð

ð19Þ

when k g (2cos a, 1], based on Formula 12, the negative sign for ‘7’ in Formula 19
will be taken, and qRg/qk will always be negative under such k value. Similarly, when
k g [21, 2cos a), the positive sign for ‘7’ in Formula 19 will be taken, and qRg/qk
will always be positive. On two sides of the abnormal point k52cos a, when k
changes from k52cos a towards kR + 1 (kR21, respectively) on O-hemisphere (I-
hemisphere, respectively), Rg, the corresponding radius of the projective circle
becomes smaller and smaller, tending to zero (Figures 3(a) and (b)).

Figure 3. Different k values and their corresponding projective circles. (a) Spatial positions
in the sphere of different k values, O (0,0,0) is the spherical center, S(0,0,2RR) is the south
pole, a is the inclination angle of plane P, SQ is the line passing abnormal point k52cos(a), M
is the O-hemisphere, and N is the I-hemisphere. (b) Spatial distribution of the projective circles
with different k values.

Downloaded by [Florida State University] at 22:33 20 December 2014 Stereographic projection on 3D objects’ intersection predicate

35

Suppose the U-hemisphere and D-hemisphere on two sides of the plane P are
intersected by plane P1 and P2, respectively, both P1 and P2 parallel to P, i.e., P1//P//
P2. If both P2 and P are simultaneously located in the I-hemisphere or in the O-
hemisphere of P, relation Rg2.Rg,Rg1 will hold, based on the derivative in
Formula 19. Rg2, Rg, and Rg1 refer to the radius of pg2, pg, and pg1 (the projective
circles of P2, P, and P1, respectively). Since P1//P//P2, there are no intersections
between P and P1 or P2, i.e., P1>P5w, P>P25w. Therefore, the intersection set
between pg and both pg1, pg2 is empty, i.e., pg>pgi5w, (i51, 2). pg must be contained
in pg2, and pg1 in pg. If P and P2 are not in the same hemisphere (i.e., P in U-
hemisphere and P2 in D-hemisphere), the spatial relation between pg and pg1 does not
change. But pg and pg2 will locate on both sides of the line, respectively:

x sin a sin b{y sin a cos bzRR cos a~0 i:e:, k~{cos a

ð

Þ:

In such a case, pg lies in the D-hemisphere of pg2, meanwhile, pg2 is in the D-
hemisphere of pg. And there is no intersection between them (as illustrated in
Figure 3(b)), i.e., pg>pg25w. The theorem is therefore proven.

3.6 Application of composite mapping and inverse composite mapping

Example 1. In Figure 4, suppose there is a p plane at Y585 within a sphere whose radius
is 100. Sub-face (m0) is formed by points P1, P2, and P3. Sub-face mi(i51, 2, 3) is
constructed by Pj, Pk (i?j?k) and origin O(0,0,0) (e.g., m1 is closed by points P2, P3 and
origin O(0,0,0)). Besides points P1, P2, and P3, there are nine other points (01, 02, 03,
04, 05, 06, P4, P5, and P6) at different sites. The position of the 12 points (whose
coordinates are listed in Table 1) and their spatial positions are shown in Figure 4(a).
The parameters of the sub-faces mi(i50,1,2,3) including inclination angle a, orientation
angle b, and distance parameter S are listed in Table 2. The images of the points and
those of the sub-faces (i.e., projective circles) are demonstrated in Figure 4(b). It can be
seen that the edge of a sub-face will be mapped as an arc on the equatorial plane. And
points on the edge of a sub-face will be mapped on the corresponding projective circle
of the sub-face. The spatial relationships between the points and polygon (or sub-face)
(P1P2P3) are given in Table 3. As point 01 is inside of P1P2P3, the inner and outer
relations between 01 and the arcs of the projective circles (mapped by the polygon’s

Figure 4. p plane and its corresponding images on the equatorial plane. (a) Section plane of
the p plane. (b) Images on the equatorial plane of the points and sub-faces in (a).

Downloaded by [Florida State University] at 22:33 20 December 2014 Point

36

P1
P2
P3
P4
P5
P6
01
02
03
04
05
06

No

m0
m1
m2
m3
n0
n1
n2
n3

Point

01
02
03
04
05
06
P4
P5
P6

S. Zhang and J. Zhang

Table 1. Points and their spherical coordinates.

x-coor

0.00
243.00
43.00
221.65
0.00
21.65
0.00
10.35
35.00
235.00
25.00
225.00

y-coor

85.00
85.00
85.00
85.00
85.00
85.00
85.00
85.00
85.00
85.00
85.00
85.00

z-coor

50.00
225.00
225.00
12.50
225.00
12.50
0.00
10.00
25.00
25.00
235.00
235.00

x-coor, y-coor, and z-coor are the x, y, and z coordinate of a point under spherical coordinate.

Table 2. Sub-faces and their projective circles’ parameters under stereographic projection
(SP).

a

90.0
16.4
61.3
61.3
78.5
35.5
69.6
12.5

B

180.0
0.0
71.2
271.2
10.0
90.0
297.6
270.0

S

85
0
0
0
284.9
0
0
0

x

0.0
0.0
173.2
2173.2
100
100
100
100

y

117.6
29.4
258.8
258.8
226.18
71.43
2237.97
222.22

Rg

62.0
104.2
208.5
208.5
148.54
0.00
2124.47
0.00

No, the sub-face’s name; a, the inclination angle; b, the orientation angle; S, the distance
parameter; x and y, the coordinate of projective circle’ center; Rg, the radius of the projective
circle.

Table 3. The spatial relations between the points and sub-face (or polygon) P1P2P3 on
equatorial plane.

m1

In
In
In
In
Out
Out
In
On
In

m2

Out
Out
In
Out
Out
Out
Out
Out
on

M3

Out
Out
Out
In
Out
Out
On
Out
Out

Polygon

In_p
In_p
Out_p
Out_p
Out_p
Out_p
In_p
In_p
In_p

in, inside; out, outside; on, on the boundary of sub-face; in_p, in polygon; out_p, out of
polygon.

Downloaded by [Florida State University] at 22:33 20 December 2014 Stereographic projection on 3D objects’ intersection predicate

37

boundary) can be known. If any other point has the same inner and outer relations with
the arcs as 01 does, then the point will be within the polygon; otherwise, it will be
outside of the polygon. For example, since 05 has a different relationship with arc
P2P5P3 as that of 01, 05 is out of polygon P1P2P3 (Figure 4(b)).

4.

Intersection predicates for 3D objects

4.1

Intersection predicates for two spheres

The spherical shape is one of the 3D object’s basic geometric shapes. The study on
intersection predicate for 3D objects under SP, therefore, starts from that of 3D
objects’ bounding spheres.

In Figure 5, suppose A and B are 3D objects, their bounding spheres are OA and
OB with spherical center O1 and O2, and radii R1 and R2 (suppose R1.R2)
respectively, and the intersection set between OA and OB is C, C5OA>OB. Ac (Bc,
respectively) is the subset of A (B, respectively) contained in C, i.e., Ac,A, Ac5C>A;
Bc,B, Bc5C>B. It will be necessary to calculate C, Ac, and Bc in order to compute
the intersection set between 3D objects A and B.

Suppose the secant circle obtained from the intersection set between OA and OB
refers to pc. The radius of pc and its related parameters can be computed as follows:

v
u
u
t

(cid:3)

ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
i: L2zR2
i
h
h
(cid:4)2{R2
R2
2
2
2:L

{ L2{R2
1

(cid:4)2

(cid:3)

1

r~

L~S1zS2
(cid:3)

S1~

S2~

L2zR2
1
2:L
L2zR2
2
2:L

(cid:3)

(cid:4)

{R2
2

(cid:4)

{R2
1

,

,

ð20Þ

Figure 5. Spheres intersected with one or without spherical center in the intersection set,
where h is the half angle of the projective cone OA. (a) Spheres intersected without spherical
centers contained, where P1 and P2 are the intersection points between the two circles. (b)
Spheres intersected with one spherical center contained.

Downloaded by [Florida State University] at 22:33 20 December 2014 38

S. Zhang and J. Zhang

where S1 and S2, the distance from O1 and O2 to pc, respectively, L is the distance
between O1 and O2, and r is the radius of the p circle (pc).

Whether there are no (Figure 5(a)), one or two spherical center(s) contained in the
intersection set C, formula 20 is all applicable. But if there is one spherical center
enclosed in C, the tangent circle (referred as p’c) instead of the secant circle (pc) will
be used as p circle. The tangent circle p’c
Þ is formed by the intersection set between
the tangents of OB through O1 and OA. The radius of p’c, r’1 and its related
parameters can be calculated as follows:

ð

S’1~R1:cos h’1,
r’1~R1:sin h’1,

sin h’1~R2=L,

ð21Þ

where S’1 is the distance from O1 to p’c, h’1 is the angle between the tangent ray and
the line linking O1 to O2 (Figure 5(b)). Here p’c still lies on the O-hemisphere of the
bigger bounding sphere OA. For the smaller sphere OB, however, p’c now no longer
reflects the spherical surface of the O-hemisphere as usual, but that of the I-
hemisphere.

Predicate Theorem 4.1 (Intersection of spheres). The necessary condition for two 3D
objects being intersected is that their bounding spheres intersect, i.e., the distance
between the two spherical centers (L) is less than or equal to the sum of the two
spherical radii (R1 and R2):

LƒR1zR2:

ð22Þ

4.2 Projective cones’ making and their intersection predicating

If the bounding spheres of 3D objects intersect, we should then determine whether
there are faces being intersected by performing intersection predicate with projective
cones.

For a polyhedron P, the minimum projective cone containing P’s face m, is
defined as m’s projective cone. The parameters describing a projective cone include
the inclination angle a, orientation angle b and distance parameter S of its p plane,
and the vector radius Rv and half angle of h, which describe the length (or model)
and the range, respectively. Rv is referred as the maximum distance from the
spherical center (of the minimum bounding sphere of the polyhedron) to points on
m.

In Figure 6, two sets of projective cones are made, where qA, i.e., ,COAF, (qB, i.e.,
,DOBE, respectively) the half angle of spherical center OA (OB, respectively), wA the
angle ,COAOB, and wB the angle ,DOBOA, (wA2hA) the angle ,FOAOB, and
(wB2hB) the angle ,EOBOA, L the distance between OA and OB. OA with radius RA,
RA1, and RA2 (RA.RA1.RA2) refers to projective cone OA(RA), OA(RA1), and
OA(RA2), respectively, OB with radius RB, RB1, and RB(RB.RB1.RB2) to OB(RB),
OB(RB1), and OB (RB2). OAA1 (OBB1, respectively) is the projection of the vector
radius of OA(RA1) (OB(RB1), respectively). The conditions for projective cones to be
intersected can be seen from the figure.

Predicate Theorem 4.2 (Intersection of projective cones): The necessary conditions

for two projective cones being intersected are as follows (see Figure 6):

Downloaded by [Florida State University] at 22:33 20 December 2014 Stereographic projection on 3D objects’ intersection predicate

39

Figure 6.

Intersecting relations between projective cones OA and OB with different radii.

(2)

(1) under the same coordinate system, the projective circles of the projective cones
on equatorial plane intersect (i.e., direction filtration of the projective cones);
the sum of the projections of the two projective cones’ vector radii on the line
segment linking the spherical centers, is larger than or equal to the distance
between the two spherical centers (i.e., vector radius filtration of the projective
cones, e.g., in Figure 6, OA(RA1) and OB(RB1) intersect), i.e.,
RvAi:kvAizRvBjkvBj§L,
{hxlƒ0,

kvxl~

Þ, Qxl{hxl
ð

Þ [ 0, p=2

½

(cid:1),

8
>><
>>:

1, Qxl
cos Qxl{hxl
0, Qxl

ð

{hxl§p=2,

ð23Þ

x~A, B,

l~i, j

where A and B represent 3D objects, RvAi and RvBj refer to the vector radius of
ith face of A (mAi) and that of jth face of B (mBj), respectively, L is the
distance between the two spherical centers, kvxl is the projective parameter of
the vector radius (where x5A, B, l5i,j), Q is the angle between the direction of
projective cone and the line linking the two spherical centers, and h is the half
angle of the projective cone (see Figure 6). (Proof is omitted.)

4.3

Intersection predicate between two sub-faces

If the intersection set between objects’ faces exists (based on Predicate Theorem 4.2),
further intersection predict for their sub-faces should be carried out.

Based on Property Theorem 3.8, if two sub-faces intersect with each other, their
images on the equatorial plane must also intersect. But the intersection of the images
is just the necessary condition for sub-faces’ intersection, rather than the sufficient

Downloaded by [Florida State University] at 22:33 20 December 2014 40

S. Zhang and J. Zhang

and necessary condition. It is necessary to perform intersection predicate using
vector radii of the inverse images further. 3D objects, in whatever forms: point, line,
surface, or volume, their intersection can be mathematically abstracted as two
categories:

(note, point

(1) point inclusion, indicating the point on the surface (or inside) of other 3D
in

inclusion or point being included is identical

object
mathematics);
line traversing, referring to the line intersecting with the surface of other 3D
object, i.e., there being intersection set between the line and any point, line
segment or sub-face of other 3D-object’ surface. Here the line can be a spatial
line, a polygon’s or a volume’s edge.

(2)

‘Point inclusion’ and ‘line traversing’ are the basic categories of the intersection
between 3D objects. Though sometimes there might be an intersection set between
the two intersection types, they could not be replaced by each other.

Suppose A and F are 3D objects, mA (mF, respectively) a sub-face of A (F,
respectively) (mA,A, mF,F), and gA (gF, respectively) the image (on the equatorial
plane) of mA (mF, respectively). The intersection predicate will be performed under F
coordinate system by default, unless the other coordinate system is specified.

Predicate Theorem 4.3 (Point inclusion): gp is the intersection point between gA and
gF on the equatorial plane (gp g gA>gF). For spatial object A and polyhedron F, the
inverse images of gp are pAj5w(gP), pFk5w(gP) (subscript Aj the jth sub-face of A and
Fk the kth sub-face of F), respectively. pFfi5w(gP) is the ith RDP of F (i, the sequence
of RDPs from outside to the bounding spherical center of F). If i is an odd number, and
the following equation holds,
(cid:7)(cid:7)!
(cid:8)
(cid:8)
§ pAj
(cid:8)
(cid:8)

i~1, 3, 5, 7, 9 (cid:2) (cid:2) (cid:2)

(cid:7)(cid:7)(cid:7)(cid:7)!
(cid:8)
(cid:8)
§ pFfiz1
(cid:8)
(cid:8)

[A\F =w,

(cid:7)(cid:7)!
(cid:8)
(cid:8)
pFfi
(cid:8)
(cid:8)

ð24Þ

Þ,

ð

(cid:7)(cid:7)!
(cid:8)
(cid:8)
A and F will intersect with each other (where pFfi
(cid:8)
(cid:8)
vector radius of pFfi, pAj, and pFfi + 1, respectively).

(cid:7)(cid:7)!
(cid:8)
(cid:8)
, pAj
(cid:8)
(cid:8)

(cid:7)(cid:7)(cid:7)(cid:7)!
(cid:8)
(cid:8)
, and pFfiz1
(cid:8)
(cid:8)

refer to the

Corollary: If F is a quasi-convex body, and the following equation holds,

j(cid:7)(cid:7)!
pAj

j(cid:7)(cid:7)!
ƒ pFj

[p [ A\F =w,

ð25Þ

j(cid:7)(cid:7)!
A and F will intersect with each other. In the formula, pAj

j(cid:7)(cid:7)!
( pFj

, respectively) is the

vector radius of pA (pF, respectively). (Proof is omitted.)

Example 2. In Figure 7, m0 (n0, respectively) is a sub-face of F (A, respectively), i.e.,
m0,F, n0,A. The image of m0 on equatorial plane is a fan-shaped region closed by
points P1, P2, and P3, and n0 the region of points 01, 02, and 03. Points 01, 04, and 05
are the intersection points between the images of m0 and n0. The parameters of sub-
face m0 and n0 are listed in Table 2. After inverse composite mapping, the vector
j(cid:7)(cid:7)!
of the three points (01, 04, and 05) under F coordinate system
radius pm0
j
can be calculated respectively, and the intersection relationship between A and F
based on the corollary of Predicate Theorem 4.3 can be predicated (Table 4). The
results show that A and F intersect with each other.

j(cid:7)(cid:7)!
and pn0
j

Predicate Theorem 4.4 (Line traversing): Suppose there is an arc gl with end points
gl1 and gl2 (gl1, gl2 g gl) on equatorial plane (gl,gA>gF). The inverse images of gl1

Downloaded by [Florida State University] at 22:33 20 December 2014 Stereographic projection on 3D objects’ intersection predicate

41

Figure 7.
equatorial plane.

Image intersection on the equatorial plane. XOY is the coordinate system on the

and gl2 on sub-face mA and mF are pA15w(gl1), pA25w(gl2), pF15w(gl1), pF25w(gl2),
respectively. The condition that mA and mF intersect (i.e., A and F intersect with each
other) is

(cid:9)
j(cid:7)(cid:7)!
pA1
j

j(cid:7)(cid:7)!
{ pF 1
j

(cid:9)
(cid:10): pA2
j(cid:7)(cid:7)!
j

j(cid:7)(cid:7)!
{ pF 2
j

(cid:10)

ƒ0[A\F =w:

ð26Þ

Proof: Since the origin O(0,0,0) is on line pA1 pF1, and O(0,0,0) belongs to line pA2
pF2 too, both the lines pass through the origin O(0,0,0). In fact, pA1 and pF1 are on
the same edge of a fan-shaped region (pA2 and pF2, correspondingly on the other edge
(cid:9)
(cid:10): pA2
j(cid:7)(cid:7)!
j(cid:7)(cid:7)!
{ pF 1
v0, there must be a
of the fan-shaped region). As
j
j
j(cid:7)(cid:7)!~0. Point pAj and pFj are in fact the same point pj. Since pj
j(cid:7)(cid:7)!{ pF j
point letting pAj
j
j
is on the line segment linking pA1 to pA2, relation pj g mA holds; similarly, we also
have relation pj g mF, as pj is also on the line segment from pF1 to pF2. We finally
have pj g A>F?w, i.e., A and F intersect.

j(cid:7)(cid:7)!
{ pF 2
j

(cid:7)(cid:7)(cid:7)!
PA1
j
j

(cid:10)

(cid:9)

When combining the vector radii of the inverse images of point 01, 04, and 05
(Figure 7, Example 2) in pairs, intersection predicate can be executed with Predicate
Theorem 4.4. Consistent results with Table 4 (i.e., A and F intersect) can also be
obtained (Table 5), which shows the applicability and correctness of Predicate
Theorem 4.4.

Table 4. Intersection predicate for the points on equatorial plane using the corollary of the
intersection Predicate Theorem 4.3.

EP-coor

Point

x

y

01

04

05

0.00
219.80

239.35

100.00

82.34

101.00

85.00

88.63

91.52

Vector radius
(cid:7)(cid:7)(cid:7)!
Pm0
j
j

j(cid:7)(cid:7)!
Pn0
j
88.00

91.14

87.20

Comparing
(cid:7)(cid:7)(cid:7)!
(cid:7)(cid:7)(cid:7)!
~85v Pn01
Pm01
j
j
j
j
(cid:7)(cid:7)(cid:7)!
(cid:7)(cid:7)(cid:7)!
~88v Pn04
Pm04
j
j
j
j
(cid:7)(cid:7)(cid:7)!
(cid:7)(cid:7)(cid:7)!
~91v Pn05
Pm05
j
j
j
j

Int-predicate

~88 Not intersect
~91 Not intersect
~87

Intersect

EP-coor, coordinate on the equatorial plane; comparing, vector radius comparing; Int-
predicate,
intersection predicate between A and F based on the illation of intersection
Predicate Theorem 4.3.

Downloaded by [Florida State University] at 22:33 20 December 2014 S. Zhang and J. Zhang

42

Point
pair

01,04

01,05

04,05

Table 5. Intersection predicate for the points on equatorial plane using intersection Predicate
Theorem 4.4.

Predicate using Formula (26)

(cid:9)
(cid:7)(cid:7)(cid:7)!
Pm01
j
j

(cid:9)
(cid:10)
(cid:7)(cid:7)(cid:7)!
(cid:7)(cid:7)(cid:7)!
| Pm04
{ Pn01
j
j
j
j

(cid:10)
(cid:7)(cid:7)(cid:7)!
{ Pn04
j
j

~ 85{88

ð

Þ| 88:63{91:14

ð

Þ~7:53w0

(cid:9)
(cid:7)(cid:7)(cid:7)!
Pm01
j
j
(cid:9)
(cid:7)(cid:7)(cid:7)!
Pm04
j
j

(cid:9)
(cid:10)
(cid:7)(cid:7)(cid:7)!
(cid:7)(cid:7)(cid:7)!
| Pm05
{ Pn01
j
j
j
j
(cid:9)
(cid:10)
(cid:7)(cid:7)(cid:7)!
(cid:7)(cid:7)(cid:7)!
{ Pn04
| Pm05
j
j
j
j

(cid:10)
(cid:7)(cid:7)(cid:7)!
{ Pn05
j
j
(cid:10)
(cid:7)(cid:7)(cid:7)!
{ Pn05
j
j

~ 85{88

ð

Þ| 91:52{87:2

ð

Þ~{12:96v0

~ 88:63{91:14

ð

Þ| 91:52{87:2

ð

Þ~{10:84v0

Int-
predicate

Not
intersect
Intersect

Intersect

Int-predicate, intersection predicate between A and F based on intersection Predicate Theorem
4.4.

Corollary: Line segment lA of spatial object A will intersect with sub-face mFi of
spatial object F at point Pj (whose image on equatorial plane is gj), i.e., A and F
intersect, providing the following relation holds

gj [ glA\gFi[A\F =w:

ð27Þ

Predicate Theorem 4.5 (polyhedron entirely included): Suppose: (1) the intersec-
tion set between the bounding spheres of polyhedron A and F contains spherical
center(s); (2) the intersection predicate is performed under coordinate system of F,
whose bounding spherical center is enclosed in the intersection set of bounding spheres;
and (3) no intersection between A and F is predicated, i.e., neither ‘point inclusion’ nor
‘line traversing’; then A and F will be thought of as intersection uncertainty. In such a
case, further intersection predicate should be carried out under A coordinate system to
examine whether F is entirely contained in A. This can be done with an arbitrary point p
of F with Predicate Theorem 4.3 (point inclusion). If p is found in A, then A contains F
completely; otherwise A and F do not intersect.

Proof: Suppose: (1) the intersection set between polyhedron A and F contains
bounding spherical center(s); (2) the intersection relation between A and F is
predicated as intersection uncertainty under F coordinate system; and (3) the
intersection predicate under A coordinate system is that a point p of F is in A while
the other point q of F is outside of A; then ‘line traversing’ must exist. This
contradicts with the intersection predicate ‘intersection uncertainty’ under F
coordinate system. Therefore, F must be entirely contained in A. Otherwise if p is
not in A, A and F will not intersect.

4.4 Predicate of radial dividing point

When performing intersection predicate for a non-convex body (whose coordinate
system is used) with Predicate Theorem 4.3, all inverse images of the body should be
distinguished whether they are RDPs or non-RDPs.

A non-RDP Pn on equatorial plane could be affirmed if all the following
conditions meet: (1) the intersection of two sub-faces’ images (gm1 and gm2) of F is an
arc (denoted as c) on circle pgl (for example, in Figure 8, m1 is the arc through points
P1, Pn, and P3, m3 is the arc through points P1, Pn, P3, and P5; m1 (being c) is the
intersection set between m1 and m3; pgl is the projective circle where m3 lies); (2) point
Pn lies interior of c (not at end points); and (3) the images (gm1 and gm2) of the two

Downloaded by [Florida State University] at 22:33 20 December 2014 Stereographic projection on 3D objects’ intersection predicate

43

Figure 8. Radial dividing point (RDP). m1, m2, and m3 are the polygons on the equatorial
plane; m1 constructed by points P1, P2, and P3; m2 by points P2, P3, P4, and P5; and m3 by
points P1, P2, P3, P4, and P5. Pf (a non-RDP) is on arc P1P3, Pn (a RDP) on arc P2P3 which is
the intersecting arc between m1 and m2, and Pu (a non-RDP) is on one of the end points (P3) of
arc P1P3.

sub-faces lie on the same side of the circle pgl (either within or outside) (see Figures 1
and 8).

The method to avoid URDPs includes: (1) do not use the image whose inverse
image is a node (as point P3 in Figure 8); (2) do not use the images whose inverse
images are collinear or coplanar with the origin O(0,0,0) (as the points denoted as Pu
in Figures 1 and 8).

Due to the length limitation of this article, we cannot give the detailed method
how to determine whether a URDP is a RDP or a non-RDP. And this will be
specifically discussed in our next paper.

5. Discussion and analysis

The intersection predicate of spatial objects starts from quasi-convex bodies. A
quasi-convex body can accurately be described on the equatorial plane (which is
called ‘quasi-plane’) due to the omnidirectional one-to-one mapping character under
composite mapping of SP. As composite mapping from a common polyhedron’s
surface to equatorial plane may not always possess omnidirectional one-to-one
mapping character, the concept of RDP is consequently introduced. The equatorial
plane could be regarded as a ‘quasi-plane’ because the inverse image of any image on
the quasi-plane can be reconstructed. Intersection predicate can therefore be
performed on the equatorial plane. The problem of intersection predicate for spatial
objects in three dimensions is thus turned into one in two dimension, and the
computational complexity of intersection predicate should consequently be reduced
for geometrically complex spatial objects.

Projective cone can organically organize a curve face and its sub-faces of a spatial
object, which is useful for the visualization of a 3D object. On one hand, projective
cone could describe the macroscopic geometrical property of a face; on the other
hand, it specifies the orientation of a face or a sub-face and sorts the corresponding
intersection algorithms. Projective cone also plays the similar role of an oriented
bounding box in heuristically optimizing the intersection algorithm for 3D objects at
face level, which avoids confining the whole intersection predicate process to trivial
details. In contrast, the bounding sphere of a 3D object is an isotropic bounding box,
namely, it remains unchanged no matter how the object is oriented. With two kinds
of well-matched bounding boxes, a comprehensive heuristic and optimal strategy of
intersection predicate can hence be performed at both object and face levels. And the

Downloaded by [Florida State University] at 22:33 20 December 2014 44

S. Zhang and J. Zhang

time complexity of the intersection method could be greatly deduced for mass data
and geometrically complicated 3D objects.

Spatial operations are implemented through a certain GIS data structure. Based
on the newly proposed intersection theory, a novel 3D GIS data structure supporting
complex geometric functions is being designed. Runtime measurement and detailed
theoretical analysis on our intersection methodology’s complexity will be given in
future research along with the data structure.

The intersection set information (CB) between 3D objects could be reflected by the
projection on spherical surface of the intersection set (C) between their bounding
spheres. But whether or not spherical center(s) are included in C has influence on the
integrity of CB. If C does not comprise spherical center, the projection of C can
reflect CB completely. In such a case, intersection predicate can be accomplished by
only visiting the faces and sub-faces whose images are intersected or contained
within the image of C. Else if C contains spherical center(s), the projection of C
would express CB partially; hence, all the faces and sub-faces of the enclosed 3D
object(s) have to be examined for intersection predicate.

Predicate Theorems 4.3, 4.4, and 4.5 are mathematic abstracts of the intersection
predicate for different kinds spatial objects. All categories of 3D object intersection
can be summarized as two kinds:
‘point inclusion’ or ‘line traversing’ (Note
‘polyhedron entirely included’ is a special case of ‘point inclusion’). As for the
intersection predicate under a non-convex projective cone, Predicate Theorem 4.4
(i.e., line traversing) and its corollary should first be applied in consideration of the
time complexity. If the predicate result is intersection uncertainty, Predicate Theorem
4.5 and its corollary should be used subsequently. Compared with Formula 26
(Predicate Theorem 4.4), Formula 27 (the corollary of Predicate Theorem 4.4) is
more concise and practical, as it transforms a complex ‘line traversing’ into a simple
one-‘point inclusion’.

6. Conclusion

Based on SP, a novel theory for 3D object intersection predicate is proposed in this
paper. The derivation of the theory starts from quasi-convex bodies. Thanks to the
omnidirectional one-to-one mapping properties under composite mapping, a quasi-
convex body can be accurately projected to the equatorial plane. The problem of 3D
object intersection predicate is thus simplified and performed in two dimensions.
Those predicate conclusions can be further applicable to common polyhedrons by
the introduction of RDP concept.

Our methodology has considered the intersection predicate of mass data and
geometrically complex 3D objects. The process of intersection predicate can be
generalized as: three cores – (1) object filtration, (2) direction and vector radius
filtration of face’s projective cones, and (3) sub-face intersection. With bounding
sphere and projective cone boxes, the process is thus hierarchically and heuristically
optimized at object and face levels while keeping integrity of 3D object’s surface
geometry. And the time and computation complexity of 3D objects’ intersection
predicate should be reduced.

All kinds of 3D object intersections are mathematically abstracted as ‘point
inclusion’ and ‘line traversing’. Being a special case of ‘point inclusion’, ‘Polyhedron
entirely included’ is also suggested as a supplement of predicate. These intersection
types are formulated with predicate Theorems 4.3, 4.4, and 4.5, which are suitable
not only to the intersection predicate for straight line and flat plane, but also that for

Downloaded by [Florida State University] at 22:33 20 December 2014 Stereographic projection on 3D objects’ intersection predicate

45

curved line, curved surface, and non-convex body. Derived under SP, the theorems
are concise, and their corresponding intersection algorithms are fixed, and easily
formulization.
implemented by computer software due to the mathematical
Furthermore, based on the abstracts, different transmuted formulas of intersection
predicate could be further deduced.

Acknowledgements
This research was under the auspices of the National Natural Science Foundation of
China (No. 40871188), the Knowledge Innovation Program of Chinese Academy of
Sciences (No. KZCX3-SW-356) and National Key Technology R&D Program
Application in the 11th Five Year Period: (No. 2006BAD23B03). We are grateful to
Anusha Kunjumman for her help in English. We also appreciate the two anonymous
reviewers for their valuable comments and constructive suggestions.

References
APEL, M., 2006, From 3D geomodelling systems towards 3D geosciences information systems:
data model, query functionality and data management. Computers & Geosciences, 32,
pp. 222–229.

BREUNIG, M., 1996, Integration of spatial information for geoinformation systems. Lecture

Notes in Earth Sciences, 61, pp. 171–179.

CHAZELLE, B. and DOBKIN, D.P., 1987, Intersection of convex objects in two and three

dimensions. Journal of the ACM, 34, pp. 1–27.

CHEN, T.-K., ALIAS, A.-R. and ZLATANOVA, S., 2007, 3D spatial operations in geo DBMS
environment for 3D GIS. In O. Gervasi and M. Gavrilova (Eds), ICCSA 2007, LNCS
4705, Part I (Berlin: Springer), pp. 151–163.

COORS, V., 2003, 3D-GIS in networking environments. Computers, Environment and Urban

Systems, 27, pp. 345–357.

EBERLY, D., 2001,

Intersection of convex objects:

separating axes.
Documentation and C + + source code [online]. Available from: http://www.magic-
software.com (accessed 22 March 2007).

the method of

GUO, W., ZHAN, P. and CHEN, J., 1998, Topological data model for 3D GIS. IAPRS, 32, pp.

HE, S., 1979, Stereographic projection in tectonics (Beijing: Geological Press).
HERTEL, S., MA¨ NTYLA¨ , M., MEHLHORN, K. and NIEVERGELT, J., 1984, Space Sweep Solves

intersection of convex polyhedra. Acta Informatica, 21, pp. 501–519.

HOULDING, S.W., 1994, 3D Geosciences modeling (Berlin: Springer).
KO¨ NINGER, A. and BARTEL, S., 1998, 3D-GIS for urban purposes. GeoInformatica, 2, pp.

657–661.

79–103.

KWAN, M.P. and LEE, J., 2004, Geovisualization of human activity patterns using 3D GIS: a
time-geographical approach. In M.F. Goodchild and D.G. Janelle (Eds), Spatially
integrated social science (New York: Oxford University Press), pp. 48–66.

LEE, J. and KWAN, M.P., 2005, A combinatorial data model for representing topological
relations among 3D geographical features in micro-spatial environments. International
Journal of Geographical Information Science, 19, pp. 1039–1056.

PILOUK, M., 1996, Integrated modeling for 3D GIS, Dissertation (PhD) Netherlands: ITC).
RAMOS, F., 2002, A multi-level approach for 3D modeling in geographical information

systems. Actes du symposiumde l’ISPRS, commision IV, Ottawa, Canada.

SHI, G., 1977, Stereographic projection methods on rock block stability analysis. Science in

China, 3, pp. 269–271.

SHIODE, N., 2001, 3D urban models: recent developments in the digital modeling of urban

environments in three-dimensions. GeoJournal, 52, pp. 263–269.

Downloaded by [Florida State University] at 22:33 20 December 2014 46

Stereographic projection on 3D objects’ intersection predicate

SHORTRIDGE, A.M. and GOODCHILD, M.F., 2002, Geometric probability and GIS: some
applications for the statistics of intersections. International Journal of Geographical
Information Science, 16, pp. 227–244.

STOTER, J.E. and VAN OOSTEROM, P.J.M., 2002, Incorporating 3D geo-objects into a 2D geo-

DBMS. Proceedings FIG ACSM/ASPRS, Washington DC, USA, 12. [CD-ROM].

TSE, R.O.C. and GOLD, C.M., 2003, A proposed connectivity-based model for a 3-D cadastre.

Computers, Environment and Urban Systems, 27, pp. 427–445.

VAN OOSTEROM, P.J.M., 1994, An R-tree based map overlay algorithm. EGIS, MARI’94, pp.

318–327.

VAN ROESSEL, J.W., 1990, Attribute propagation and line segment classification in plane
sweep overlay. Proceedings, 4th International Symposium on Spatial Data Handling,
Zu¨ rich, Switzerland, pp. 127–140.

VERBREE, E., et al. 2005, Towards a 3D feature overlay through a tetrahedral mesh data
structure. Cartography and Geographic Information Science, 32, pp. 303–314.
ZHANG, S.Q., ZHANG, J.Y. and ZHANG, B., 2004, Deduction and application of generalized
Euler formula in topological relation of geographic information system (GIS). Science
in China Series D Earth Sciences, 47, pp. 749–759.

ZLATANOVA, S., RAHMANB, A.A. and SHI, W., 2004, Topological models and frameworks for

3D spatial objects. Computers & Geosciences, 4, pp. 419–428.

Downloaded by [Florida State University] at 22:33 20 December 2014 