REFEREEDPAPERATechniqueforBuildingRepresentationinObliqueViewMapsofModernUrbanAreasNeeharikaAdabalaMicrosoftResearchIndia,‘Scientia’,196/36,2ndMain,Sadashivnagar,Bangalore560080,IndiaEmail:neeha@microsoft.comThispaperpresentsatechniqueforcreatingobliqueviewmapsofurbanareas.Weidentifyandapplycartographicandcognitiveprinciplestodevelopasolutioninthecontextofstate-of-artgeographicinformationsystems.Thegapintheabilityofthesesystemstorenderthree-dimensionalbuildingsintomapsisaddressed.Atthecoreofoursolutionisabuildingfacademodellingapproachthatsupportsvaryingdegreesofabstraction.Thisisachievedbyintroducingaconceptof‘facadewaveforms’andrepresentingbuildingfacadesascombinationsofthesewaveforms.AFourierseriesapproximationofthewaveformsisusedduringtherenderingprocessesresultinginanelegantsolutiontoanti-aliasing.Theformulationretainsthesemanticinformationintherepresentationthatenablesmeaningfulextensionslikenighttimefacadegeneration.Thesolutionisimplementedasapixelshaderandthereforeleadstoalargereductionintexturememoryrequirementcomparedwithexistingbuildingrenderingtechniques.Additionally,inthecaseofwebbasedsystems,thereissignificantreductioninbandwidthrequirement.Wehighlightthefeaturesoftheproposedsolutionbygeneratingdemonstrativemapsandimages.Keywords:Panoramicmaps,Urbanmaps,Touristmaps,Bird’seyemaps,BuildingFac¸ademodels,FourierSeries,Anti-AliasingINTRODUCTIONGeographicmapstypicallydepicttwo-dimensionaltopviewsofaportionoftheearth’ssurface.Detailsoftheearth’ssurfacedepictedonthemapdependbothonthescaleofthemapanditsfunctionality.Whenazoomedinmapofanurbanregioniscreated,thebuildingsintheregionarevisible.Buildingspossessheightandatopviewtwo-dimensionalmapcannotcapturethisinformation;therefore,itisnolongeranadequateschemetovisualizetheregion.Thislimitationoftopviewmapsisovercomebymakingobliqueviewmapsofurbanregions.Suchobliqueviewmapsarewelldocumentedincartographicliteratureandarepopularlyknownaspanoramicmaps,perspectivemaps,bird’seyemapsoraeromaps(GeographyandMapsDivision,2007;Reps,1984).Thesemapsconstituteanimportantcategoryoffrequentlyusedmapsasasigniﬁcantfractionofthepopulationlivesinorvisitsurbanareas.Cartographyhasundergoneatransformationfromthetraditionalformofusingthepen,inkandpapermediumtoanapplicationthatmakesextensiveuseofcomputersformapcreation.Computer-aidedmap-makingapproachesfocusmainlyongenerationoftwo-dimensionalvectormapswithvaryingmapsymbolsforimprovingaesthetics.Theproblemofenablingcreationofpanoramicmapshasreceivedrelativelylessattentionasitrequiresasigniﬁcantmodiﬁcationtothetypicaltwo-dimensionalmap-makingprocesses.Weaddressthisgapinexistingcomputer-aidedtechniquesforpanoramicmap-making.Mapsofurbanareasaredirectlyinterpretedbyuserswhentheyinteractwiththeirneighbourhood;thisdistinguishesthemfrommapsoflargerregions,likecontinents,countriesorstates,whereamapmainlycontributestotheusersconceptualperceptionoftheregion.Therefore,urbanmapsshouldbeuserfriendly.Thetaskofestablishingthecorrespondencebetweenfeaturesinamapandgroundtruthsisnon-trivialanddeterminestheuserfriendlinessofamap.Mapsthatdonotrepresentbuildingsinurbanregionsexpecttheusertoapplyadvancedinterpretationskillstocreateanassociationfromthegroundtruthtotheinformationpresentedinthemaps.Thepresenceofvisualcluesintheformofthree-dimensionalmodelsoflandmarksgreatlyenhancethereadabilityofamap(Tufte,1997).Thisisvalidatedbytouristmapswherethetechniqueofaugmentingthetwo-dimensionalroadmapswiththree-dimensionaldrawingsofbuildingsiscommonlyusedtoimprovetheirusability.Therefore,themainchallengeinmakingmapsofurbanareasistheabilitytoaugmentthemwithbuildings.Thisleadsustotheideaofusingaerialphotographsoftheregionasmapsthatprovidetheuserwiththenecessaryinformationonbuildingsintheregion.However,TheCartographicJournalVol.46No.2pp.104–114May2009#TheBritishCartographicSociety2009DOI:10.1179/000870409X444776photographsareclutteredwithdistractingdetailsintheformofpeople,cars,lightingandshadows,andothertemporalinformationthatisnotrelevantforamap.Maskingthesedetailsisatediousprocessandmaynotalwaysbefeasible.Abstractionofbuildingrepresentationisapowerfultoolthathasbeenexploitedbycartographerstoreduceclutterofinformationinpanoramicmaps,butitisdifﬁculttoapplythistechniqueinthecontextofobliqueviewphotographsofurbanarea.Anotherlimitationforadoptingaphotographbasedapproachtomappingisthatmodernurbanregionscontainseveralbuildingsthatoccludeeachother,makingitdifﬁculttoﬁndasuitableviewpointfromwhichaphotographoftheregioncanserveasamap.Therefore,theproblemofmakingcomputer-aidedpanoramicmapsisstillanopenproblem.Betweenthemid-sixteenthcenturyandearlytwentiethcentury,severalmapsofurbanregionsofEuropeandNorthAmericawerecreatedinthepanoramicstyle.Thesemapswerecreatedbyartistswhoroamedthestreetsoftheurbanregionandpainstakinglytransferredthedetailsoftheirobservationsintothemaps.Astheurbanareasgrewinsizeandthetypesofbuildingschanged,thepanoramicmapscouldnotkeepup.ThisisillustratedinFigure2,whichshowscroppedregionsfrompanoramicmapsofSeattlecreatedintheyears1878,1884,1891,1903and1925.InterestedreaderscanseethecompletemapsthatareavailableonlineattheGeographyandMapDivision,oftheLibraryofCongress(GeographyandMapsDivision,2007).Itcanbeseenthatwithtimetherewasanincreaseinthenumberofbuildingsintheregionbyobservingthemapsfrom1878to1891.However,asthenumberofbuildingsfurtherincreased,theartistscouldnothandledisplayingalltheinformation,andtherefore,theyresortedtodrawingonlythebuildingsthattheyconsideredimportant.Alsothetechniqueofabstractionthattheyemployedtorepresentthemodernbuildingsreducedtheaestheticappealofthemapscreatedinthelateryears.Weobservedasimilarevolutioninthemakingofurbanpanoramicmapsrepeatedly,whereweﬁndthatthechallengesposedbythenew‘urbanscapes’wereunwieldyfortheartistsandresultedinsimpliﬁedlessaestheticallyappealingmaps.Thisleadtothedisappearanceoftheartofmakingpanoramicmapsofurbanregionswithyears.Ourresearchﬁllsthisvoid,byaddressingthechallengeofrecreatingatechniqueofmakingpanoramicmapsinthecontextofmodern‘urbanscapes’.OurcontributionInthispaper,weaddresstheproblemofgeneratingpanoramicmapsofmodernurbanregions.Generatingpanoramicmapshastwomainaspects–generatingthemapthatisrenderedontheterrainandgeneratingtherepresentationsofbuildingsonthismap.Wesolvetheproblemintheframeworkofcurrentsolutionsofmap-makingthatarepresentingeographicalinformationsystems(GIS)inordertoavoidduplicationofresearchacrosscomputergraphicsandcartography.Theproblemofgeneratingtwo-dimensionalmapsthatcovertheterrainfromvectordataiswellexploredincartography;weuseanexistingsolutionthatcreatesgroundmapsintheMercatorproject(Robinsonetal.,1995),andemployingalternativeprojectionsisastraightforwardextensionofthecurrentsolution.Cartographersuseexaggeratedterrainshadingtodisplaytheground(earth’ssurface)inpanoramicmaps,theexaggeratedshadingsolution(Rusinkiewiczetal.,2006)isemployedbyusforthispurpose.Creatingthree-dimensionalrepresentationsofbuildingsonapanoramicmapinvolvescreatingthegeometryofbuildingsandtexturingthem.Creatinggeometricmodelsofmodernbuildingspresentinurbanareasiscarriedoutbyextrudingthefootprintofabuilding,byreconstructingthebuildingfrommultiplephotographsorbyextractingthebuildingfromahighresolutiondigitalelevationmapoftheregion.However,theproblemofcreatingtexturesforthesebuildingsismoredifﬁcultandtherefore,somecurrentapplicationsdisplaybuildingsinasingletexture,e.g.Googlemaps(Google,2007)displaybuildingmodelsasplaingreyshadedgeometry.Usingaconstanttextureforallthebuildingswouldrenderthemapsmonotonousandnotaestheticallyappealing.TheothersolutionthatexistsisthetechniqueofcreatingtexturesfromphotographsthathasbeenemployedbyMicrosoftVirtualEarth3D(Microsoft,2007).Thisprocessistimeconsumingduetoocclusionbetweenbuildings;severalphotographshavetobeexam-inedbeforeatextureatlasforasinglebuildingcanbegenerated.Otherlimitationsofthisapproacharethattexturescreatedfromphotographscontaintemporalinformationlikeilluminationandshadowsthatcluttertheresultingmap.Also,textureatlasesofbuildingsarelarge,andconsumesigniﬁcantbandwidthwhentheyaretrans-mittedfromaservertoaclientinawebbasedGIS.Largetextureatlaseshaveanadditionaldisadvantageofincreasingtheclientsidetexturememoryrequirementduringrender-ing,especiallywhenmipmappingisused.Oursolution,illustratedinﬁgure1,focusesonbuildingrepresentationinpanoramicmaps.Westudypanoramicmapsandderivekeyinsightsontheabstractionprocessadoptedbyartistsinbuildingrepresentation.Atthecoreofourapproachisaformulationofanabstractionframework,inspiredbyartistictechniques.Ithasbeentailoredforrepresentingbuildingfacadesinmoderndayurbanenvironments.Theformulationisaproceduraltexturesynthesisapproachwiththefollowingfeatures:1.Asupportfordegreesofabstraction:theparametersofthefacademodellingtechniquecanbeselectedsuchthattheresultingtexturecloselyresemblesthereal-worldfacadetextureofthebuildingorsuchthatitisanabstract/simplifiedrepresentationofthebuildingFigure1.ApanoramicmapofSeattlecreatedwithourapproachATechniqueforBuildingRepresentationinObliqueViewMaps105facade.Thereisnoformulationthatfacilitatesvaryingdegreesofabstractionbeforeourapproach.2.Abilitytoretainsemanticsinaprogramaccessibleform:thetechniqueisaproceduraltexturesynthesisapproach,whichisdefinedsuchthatthesemanticsofwindowandwallregionofabuildingfacadeareretained.Thismakesitpossibleforustocreatemodifications,likesimulatingnighttimeappearanceofthebuildingfacades,easily.Existingtexturebasedtechniquesdonotretainsemanticsandrequiremanualredesignofthetexture.3.Anti-aliasingiscarriedoutimplicitly:buildingfacadesexhibitsharp,varyingfeaturesintheformoftransi-tionsbetweenwallandwindowcomponents.Sinceseveralbuildingsarevisibleinapanoramicmap,mipmappingofallthetexturestoenableantialiasingresultsinarequirementforlargetexturememory.OurtechniqueemploysFourierseriesbasedmodellingofthebuildingfacade.Itisproceduralandcanhandleanti-aliasingimplicitlybytruncatingtheevaluationofthehighfrequencycomponentswheneverneeded.4.Simplificationoffacadetexturecreation:creationofpanoramicmapsrequiresthecreationoftexturesofthree-dimensionalmodelsofbuildings.Moderntech-nologyhasenabledsignificantspeed-upofthegeometryreconstructiontechniquesfromdigitalelevationmaps.However,asmentionedearlier,thecreationoftexturescontinuestobeabottleneckinthecreationofmodelsofcities,asseveralimagesfromdifferentviewpointsshouldbeconsideredbeforeasuitableregionofthebuildingthatcanbeusedasatexturecanbeidentified.Illuminationinimagesandocclusionbyneighbouringbuildingsarethemainimpedimenttofastextractionoftexturesfromphotographs.Theselimitationsareovercomebyourformulationthatenablescreationofafacadetexture;definingafewparametersenablesthecreationofvariationsofthefacadetexture.5.Compression:textureatlasesofbuildingsareoftenlargeandthereforerequirelargeamountsofmemoryforstorageandalsoresultinincreasedbandwidthrequirementswhentransmittedfromawebserverbasedGISsystem.Oursolutionisimplementedasapixelshaderandthereforegreatlyreducesthememoryrequirementoftextures.Itsformulationallowsthecreationofseveraltexturesbyvaryingafewparameters.Wedemonstratethecapabilitiesofourtechniquetocreatepanoramicmapswithexamples.Theproblemofabstractionofbuildingrepresentationinthecontextofcartographyhasnotbeenaddressedbefore.Otherresults(e.g.DeCarloandFigure2.CroppedsectionsofpanoramicmapsofSeattlecreatedinyears1878,1884,1891,1903and1925(fromtoptodown).Noticetheincreaseinnumberofbuildingsintheﬁrstthreemaps(1878,1884and1891).Theartistsareunabletocapturethecon-gestedviewsthatresultfromsubsequent(1903and1925)increaseinthenumberofbuildings,sotheydepictbuildingsselectively.Also,astheirtechniqueofabstractingmodernbuildingswasnaive,theresultingpanoramicmapsarenotasaestheticaspossible.Wewereunabletoﬁndpanoramicmapsofcurrentdayurbanregions,andSeattleinparticular106TheCartographicJournalSantella,2002)provideimpressivesolutionstotheproblemofabstractioninthecontextofdrawingtheattentionofanobservertopartsofanimage.Butmapshavetwoconﬂictingrequirements:theyshouldprovidesigniﬁcantdetailsofanypartthatisofpotentialinteresttoauser,yettheclutterfromthesedetailsmustnotdistracttheuser.Tomeettheserequirements,cartographicapplicationsrequireatoolthatsupportsvaryingdegreesofabstraction,andourtechniqueprovidesasolutionforthisproblembydeﬁningaproceduralfacadetexturesynthesistechnique.Therestofthepaperisorganizedasfollows.Wediscussrelatedworkinthefollowingsection.Thesectionon‘OBSERVATIONSOFBUILDINGDEPICTIONINPANORAMICMAPS’presentssomeofourobservationsonthetechniquesemployedbyartiststorepresentbuild-ingsinpanoramicmaps,whichareincorporatedintooursolution.Thesectionon‘PROPOSEDFORMULATIONFORMODELLINGBUILDINGFACADES’describesourtechniquewithexamples.Thesectionon‘IMPLEMENTATIONDETAILS’presentsimplementa-tiondetailsoftheproposedtechnique.Resultsthatdemonstratethecapabilitiesofourapproacharepresentedinthesectionon‘RESULTSANDDISCUSSION’.Weconcludeinthesectionon‘CONCLUSIONS’.RELATEDWORKInthissection,webrieﬂycoversomerelatedwork.Theproblemofrenderingobliqueviewmapsofmodernurbanregionshasnotbeendirectlyaddressedpreviously.However,sometechniquesthathavebeendevelopedassolutionsinthecontextofotherproblemscanbeapplied.Suchworkbroadlyfallsintothreecategories:solutionsproposedinthecontextofmap-making,solutionsdevel-opedformodellingvirtualcitiesandsolutionsinnon-photorealisticrendering.ThebooksbyMacEachren(1995)andMonmonier(1993)onprinciplesofmap-makingandthebooksonthematicmaps(Slocumetal.,2003)describekeyconceptsincartographythatprovideusefulinsightsintotheperceptionandinterpretationofmaps.Theyprovideguidelinesforeffectivemapcreation.TheroutemapsdesignedbyAgarwalaandStolte(2001)areanexampleofhowskillfulapplicationofprinciplescanresultininterestingsolutionsincartography.Beingawareofprinciplesofmap-makingenablescreationofbettermaps.Weoutlinesomeoftheprinciplesthatwehaveusedindeﬁningourtechniqueinthefollowingsection.Thereisasigniﬁcantbodyofworkcarriedoutinthecontextofmodellingbuildingsandtheirfacades.TherecentpapersofMu¨lleretal.(2006)andtherelatedpreviousworkbyWonkaetal.(2003)forproceduralmodellingofbuildingsusegrammars.Theyaddresstheproblemofautomaticallycreatinggeometricdetailsofarchitecturallymeaningfulbuildingsbasedonrules.Thiselegantsolutionisexcellenttocreatedetailedbuildings;however,detailedgeometryisnotrequiredforpanoramicmapsasthebuildingsarerenderedatdistancesthatdonotrequireelaboratemodels.Also,sinceourmapsdepictseveralbuildingsinanygivenview,anincreaseincomplexityofmodelsofindividualbuildingswillresultinincreasedprocessorandmemoryrequirementsatthegraphicscards.Weconsidereddevelopingatechnique,basedonasimplemodiﬁcationoftheirapproach,whichcancomposeelementarytexturesofwallsandwindowstogetherintobuildingfacadetexturesusinggrammars.However,signiﬁcanteffortofdesignerisneededtocreateadatabaseofindividualtexturesthatcanbecomposedtogetherintothebuildingfacadewiththegrammar.Anotherlimitationofthegrammarbasedapproachisthattoachieveanti-aliasing,onehastogeneratethecompletefacadetextureusingthecompositiontechniqueandthenapplymipmapping,andthisincreasesthememoryrequire-mentofthesolutionsigniﬁcantly.Also,anon-trivialextensiontotheCGAgrammarisneededtosupportvariousdegreesofabstractionoftenemployedincartogra-phy.TheworkpresentedinParishandMu¨ller(2001)mainlyfocusesoncreatingproceduralmodelsofcities;theyalsomentionatechniqueofcreatingtexturesforbuildingswhichidentiﬁesperiodsofoccurrenceoftextures,andcreatedetailedproceduraltextureswithintheperiodsidentiﬁed.Apartfromthisworkonbuildingmodelling,thereareresearchresults(Fru¨hetal.,2004)thatdescribeautomatingtheprocessofextractingtexturesforbuildingfacadesfromphotographs.Alltheseapproacheshavelimitedsuccessinmodernurbanenvironmentswherethepresenceofseveralmultistoriedbuildingsresultsinlargescaleocclusionandshadowingmakingitdifﬁculttogetphotographsofbuildingfacades.Architecturaldrawingapplicationshavebeentheinspirationforseveralfacadetexturemodellingpapersfromtheearlydaysofcomputerbasedgraphics(Yessios,1979;Legakisetal.,2001).Theseapproaches,however,addresstheproblemoffacadedesignataverydetailedscalethatisnotrequiredinobliqueviewmaps.Fourierrepresentationisatoolthatisoftenusedfortexturecreation,andanearlyexampleofitsapplicationwasinthecontextoftexturesynthesisfordigitalpainting(Lewis,1984).WealsoapplytheFourierseriesinaneffectivewayforourwork.Inthecontextofnon-photorealisticrendering(NPR),theresultspresentedinWinkenbachandSalesin(1994)wereinspiredbyarchitecturaldrawings.TheimpressivesolutionstoabstractionofimagespresentedinDeCarloandSantella(2002)andSantellaandDeCarlo(2002)arerelevantaswealsoaddresstheproblemofabstraction.TheirresultsinDeCarloandSantella(2002)andSantellaandDeCarlo(2004)speciﬁcallydemonstratetheapplica-tionoftheabstractiontechniquestoabuilding,andmentionitasadifﬁcultexampletohandle.Pursuinganimagebasedapproachtocreatepanoramicmapsrequiresstartingfrom‘good’photographsoftheregion,whichisoftendifﬁculttoobtainbecausemodernurbanareasareﬁlledwithcloselylocatedhigh-risebuildingsthatoccludeeachother.TheNPRworkbyDo¨llneretal.(Do¨llnerandWalther,2003;Buchholzetal.,2005)presentsanon-photorealisticstyleforrenderingcitiesthatisinspiredbypanoramicmaps.Theymentionsomecartographicandcognitiveaspectsofexpressivecityrepresentation.TheyhanddesigndetailedtexturesthatgivetheappearanceofNPR.TheymanuallyATechniqueforBuildingRepresentationinObliqueViewMaps107designbuildingtexturesatvariouslevelsofdetailtomimictheartistrenderinginmaps.Theresultisnottargetedtowardsmap-makingandhaslimitedapplicabilityasitinvolvessigniﬁcanteffortofdesignertocreatetextures.OBSERVATIONSOFBUILDINGDEPICTIONINPANORAMICMAPSAspointedoutbyMacEachreninhisbook‘HowMapsWork:Representation,Visualization,andDesign’(MacEachren,1995),cartographyisaﬁeldwithalongpracticalhistorybutashortacademicone.Therefore,onedoesnotﬁndanytreatiseonhowtomakepanoramicmaps.However,thereisnodearthforanumberofpanoramicmaps,createdbyvariousartists,whichcanbeobservedtoarriveattheprinciplesthatformthebasisfortheircreation.Inthissection,webrieﬂyoutlinesomeofourobservationsfrompanoramicmapsandrelatethemtovisualizationandcognitiveprinciplesthathavebeenestablishedinrecentresearch.Thejustiﬁcationforourmodelformulationwhichisdescribedinthefollowingsectionliesintheseobserva-tionsthatcanserveasguidelinesforcreatingpanoramicmapsingeneral.AbstractionIfanimage,isdeﬁnedasatwo-dimensionalreproductionoftherealitywithnoabstraction-e.g.aphotograph,andadiagramisdeﬁnedasanabstractrepresentationofreality;thenamapcanbethoughtofaslyingsomewhereinbetweenonthisimage-diagramabstractioncontinuum.Thekeyistouseabstractionasatoolthatenablesreductionofclutter.Figure3illustratestheuseofabstractioninpanoramicmaps.Noticethatthebuildingsintheblocksvisibleinthismapsectionhavefacaderepresentationsthatdonotattempttoberealistic.Forexample,therearesomebuildingsthatdonotseemtohavedoorsandmanyhouseshavewindowsofapproximatelythesamesizelocatedinapproximatelythesameplaceonthebuildingfacade.Alsoallthebuildingshavethesamecolour.Thiskindofabstractionenablesthemapmakerstoreduceclutterbyexploitingtheconceptof‘smallesteffectivedifference’thatisdemonstratedexcellentlyinthebook‘VisualExplanations:ImagesandQuantities,EvidenceandNarrative’byTufte(1997).Thisconceptemphasizestheneedtocreatedifferencesinshading/contrasttosendaclearsignalofseparation,whileatthesametimekeepingthevisualdifferencesmall.Ignoringthisprincipleleadstovisualclutterandjumpychangesincomposition.Prominentsecondaryelementsinamapdistracttheuserwithunnecessarydetailsandmakethemaplesscoherent,asusefuldataarelostintheriotofdetails.Awelldesignedtechniqueforcreatingminimaldifferenceinvisualizationcanmaximizetheinformationthatcanbeconveyedinasinglemap(Tufte,1997).The1925mapofSeattle(partofwhichispresentedinFigure2)failstomaketheminimumdifferencebetweenbuildingfacades;therefore,iftheartisthaddrawnallthebuildings,itwouldhavebeendifﬁculttoperceivetheseparationbetweenbuildings.Global–localprecedenceTheconceptofglobal–localprecedenceisacognitiveprinciplethatsuggestsanapproachthatcanbeadoptedforabstraction.PsychologistshaveconductedexperimentswithcompoundlettersliketheonesshowninFigure4.Theyfoundthatthesubjectsarefasteratidentifyingthegloballetterthanthelocalletter(MacEachren,1995).Theirrecognitionofgloballetterwasnotinﬂuencedbythelocalletters.Inpanoramicmapping,ittranslatestothenotionthatifthegeometricmodelofthebuildingresemblestheoriginalbuilding,thenvariationsinthefacadetexturedonotinterferesigniﬁcantlywiththerecognitionofthebuilding.Thisprovidesaprincipleforabstractionatthefacadetexturedesignlevel,whichisdemonstratedinthepanoramicmapsectionpresentedinFigure5whichshowsthattheartistsusedasimilarstyletopaintwindowsonsigniﬁcantlydifferentshapedbuildings.ThisstyleofpaintingwindowsisanabstractrepresentationoftheactualfacadeandonlyconveystheinformationofpresenceofwindowsinFigure5;however,asthegeometryofthebuildingshasbeenreproducedwithsomeaccuracy,itisstraightforwardforamapusertoestablishthecorrespon-dencebetweentheactualbuildingsandtheonesinthemap.Anotherinterestingobservationaboutpanoramicmapsisthatnoeffortismadeinanypanoramicmaptoreproducetheoriginalcolourofbuildings.Infact,theyusecolourasadimensiontoincludeadditionalinformationintoamap,forFigure3.Illustrationofabstractionemployedinpanoramicmaps.Noticethatallthebuildingshaveapproximatelythesameshapeandfacadesofthebuildingsdonotattempttoreproducereality.Theyaremorelikeplaceholdericonsthattheuserinter-pretssuitablyFigure4.Compoundlettersusedinglobal–localprecedenceexperimentsbypsychologists.Itisfoundthatthesubjectsarefasteratidentifyingthegloballetterthanthelocalletter(thatmakesupthegloballetter).Theirrecognitionofthegloballetterwasnotinﬂuencedbythelocalletters108TheCartographicJournalexample,inthe1891mapofSeattle(excerptshowninFigures2and5)colourseemstohavebeenusedtoenabledistinguishingbetweenpublicandprivatebuildings(orange/reddishonesarepublicbuildingswhiletheoff-whiteonesareprivatebuildings).RenderingatvariousscalesPanoramicmapspresentbuildingsdetailsoveralargeregion,sobuildingsthatoccuratalargedistancearedrawnverysmallbecauseofperspectiveprojection.Asaresult,thedetailthatcanberepresentedondistantbuildingsreduces,andanartisthandlesthisbydrawingfewerwindowsinadditiontoreducingthesizeofthewindows,asshowninFigure6.Texturebasedsolutionscanbedesignedtoreducethesizeofwindowsrenderedondistantbuildings,butleadtoeitherexcessivelyblurred-out(ifﬁlteringisapplied)orcluttered(ifnoﬁlteringisappliedtohighfrequencycrowdeddetail)appearancefordistantbuildings.PROPOSEDFORMULATIONFORMODELLINGBUILDINGFACADESExistingtechniquesformodellingbuildingfacadestreatthebuildingsurfaceasanaggregateofarchitecturalentitieslikewindows,walls,ledges,etc.Theydesignfacadesofbuildingsbydeﬁningrulesbasedonwhichtheseentitiescanbecomposedtogethertoformanarchitecturallyvalidfacade.Therefore,thetwofundamentalaspectsoftheirmodelareadatabaseofarchitecturalentitymodelsandasetofrulesthatcombinethem.Intheproposedtechnique,wemakeadeparturefromthisparadigmanddeﬁneanewapproachtocreateafacadebytreatingitasasingleentitythatcanbedeﬁnedprocedurallyusingmathematicalformulations.Ourtechniqueconsistsoftwophases:Nrepresentationofthefacade(modellingphase):weabstractthefacadewithwaveformrepresentationintheverticalandhorizontaldirections.Wedefinemethodstocombinetheverticalandhorizontalrepresentationstocreatethefacademodel;Nsmoothfunctionapproximation(renderingphase):weapproximatethesefunctionsusingorthonormalfunc-tions;weusetheFourierseriestocreateaspectralrepresentationforthefunctions.Weapplythecombin-ingmethodsdefinedinthemodellingphasetomergethesmoothfunctionapproximations,andcreatetheproceduralrenderingofthebuildingfacade.RepresentationofbuildingfacadeWecreateaparametricrepresentationforthebuildingfacadebyintroducingaconceptcalled‘facadewaveforms’.Abuildingfacadeisdeﬁnedasacombinationoffacadewaveforms.Afacadewaveformisaperiodicfunctiondeﬁnedbyfollowingascanlinealongabuildingfacadewherewindowsandwalloccur,andassigningvaluesbasedonunderlyingcomposition.Figure7illustratesasimplefacadewaveformthattakesvalues1and0dependingonwhetherthefacadeatthatpointalongthescanlineisawallorawindow.Thoughabi-valuedfunctionispresented,othermultiplevaluedfunctionscanbeusedtocaptureinformationlikeorientationofthefacade.Forexample,thefacadewaveformofabuildingwithajaggedfacadecantaketheformofasawtoothwave.Thehorizontalandverticalfunctionsarecombinedusingan‘and’(multiplicative)operator,tocreatethefacadeFigure5.Illustrationofglobal/localcognition.Noticethatallthebuildingshaveapproximatelythesamefacade,similarblackrectan-glesdrawnonthesidesofthebuildingsirrespectiveoftheshapeofthebuildings.Despitethisgrosssimpliﬁcationofthefacade,auserstillrecognizesthelandmarksastheirglobalshapehasbeencap-turedproperlyFigure6.Artistsdepictionofbuildingsatvariousscalesofdetail.Theextractfrommapontheleftshowsthedepictionofbuildingsatclose-upwhiletheoneontherightshowsthebuildingdepictionwhentheyareatadistance.Noticethereductioninnumberofelements(windows)drawnonthebuildingsapartfromthereductioninsizeofdrawingATechniqueforBuildingRepresentationinObliqueViewMaps109representation.Whenmultiplefacadewaveformsareusedinthemodelling,individualwaveformsinthehorizontaldirectionorverticaldirectionarecombinedtogetherwithemphasisonthewindowarea.Thatis,ifanyofthemultiplewaveformindicatethepresenceofawindow,thentheﬁnalhorizontalrepresentationalsoindicatesthepresenceofawindow.Forcomplexfacades,morethanonefacadewaveformissuperimposedtocreatethedesiredappearance.WepresentanexamplethatillustratestheuseofmultiplefacadewaveformsinthehorizontaldirectioninFigure8.Weusemultiplewaveformstolimitthevariationpatternwithinasingleperiodofeachfacadewaveform,andthisconstraintenableseasysmoothfunctionapproximationthatisrequiredintherenderingphase.SmoothfunctionapproximationAliasinginfacadetexturesisinevitablebecauseofthepresenceofsharptransitionsbetweenwindowandwallregions.Aliasingiscausedwhenthereisasharptransitionfromonevaluetotheother,soinordertoavoidaliasing,oneshouldhavesmoothtransitionsbetweenstates.Thesolutionistoapproximatethesharptransitionswithsmoothlyvaryingfunctions,thatis,functionsthatareinﬁnitely(indeﬁnitely)differentiable.WeimplementthesmoothfunctionapproximationusingtheFourierseries.Theseseriesleadtoanelegantsolutiontotheproblemastheyhavethefollowingproperties:Npowerfulapproximationtool:theycanapproximatearbitraryfunctionswiththetrigonometricsineandcosinefunctions;Nperiodic:facadesareperiodic,sowecandefinetheFourierrepresentationinaperiodTandapplyitrepeatedlytomodelthewholefacade;Nimplicitsupportforanti-aliasing:accuracyoftheapproximationisdependentonthenumberofharmonicsoftheseriesevaluatedintheapproximation.Atrunca-tionoftheseriesfordistantviewsleadstoonlythelowfrequencycomponentsbeingevaluated,andthereforeresultsingoodanti-aliasing.Anadditionaladvantageofthisapproachisthatthesineandcosinefunctionsaresupportedonprogrammablegraphicscards,makingitpossibletoimplementtheproposedproceduralfacademodellingasapixelshader.ItisalsopossibletouseotherfunctionsliketheexponentialandGaussianfunctionsintheapproximationofthefacadewaveforms.Thisiscarriedoutbycreatingtheapproximationforoneperiodofthefacadeandapplyingtheapproximationrepeatedlyonthewholefacade.ExampleoffacadetextureformulationsWepresentanexampleoffacadewaveformandasmoothfunctionapproximationstoclarifythefacademodellingandrenderingprocess.Weconsiderasingleperiodofthesimplestandmostfrequentlyusedfacadewaveform,namely,thesquarewave(Figure9).ItisrepresentedbytheFourierseries(HarrisandStocker,1998)f(t)~2cTz2pX?n~1({1)nnsin2npcT(cid:1)(cid:2)cos2nptT(cid:1)(cid:2)(1)whereTistheintervaloftheperiodicfunctionthatisrepresentedbytheabovefunction,2cisthepartoftheintervalforwhichthefunctiontakesthevalue1,andnrepresentsthenumberofharmonicsthatareevaluated.ThevaluesofTandcareselectedbasedonfacadeproperties.Figure10illustratesthebehaviouroftheFourierseriesapproximationwiththenumberofharmonicsnusedintheevaluationofthefunction.ThesamefacadewaveformisalsousedintheverticaldirectionasshowninFigure7.TheresultingfacadeisillustratedinFigure11.Figure7.Functionalrepresentationofthebuildingfacadealongthehorizontalandverticaldirections.ThefacadewaveformrepresentationFigure8.ModellingoffacadewithmultiplefacadewaveformsFigure9.Squarewaverepresentedbyequation(1)110TheCartographicJournalIMPLEMENTATIONDETAILSWeimplementedthealgorithmwithintheframeworkofanexistingpopularGISsystem.Thesummaryoftheimplementationtorenderpanora-micmapsisasfollows:1.Createtheterrainmapsfromvectordata,andperformtheterrainshadingbasedonterrainelevationmapusingexaggeratedshading(Rusinkiewiczetal.,2006).2.Renderingofthree-dimensionalbuildingsintothemap:Nselectfacadewaveformsforthehorizontalandverticaldirections;Nselecttherepetitionperiodbasedonthedetailofrenderingandthesizeofthebuildingfacade.Usethesmoothfunctionapproximationfortheselectedwaveform;Ncombinethewaveformsbasedontherequiredstyleofrendering.Weenableselectionoffacadewaveformsfromasubsetoffewrepresentationsthatserveasabstractionsforalargevarietyofbuildingsinmodernurbanregions.Weobservethatmostmodernbuildingshavefacadesthatfallintooneoffourmaincategories,namely,thosewith:Nsignificantwallandwindowregions;Nonlywindowregions;Nhorizontalemphasisoflayersofwindowsandwall;Nverticalemphasisresultingfromalternatecolumnsofwindowsandwall.Wecreatesmoothwaveformabstractionsforeachofthesestylesoffacades.TherepresentationisparameterizedwithparametersTandcasillustratedinFigure9.Thisenablesustoaligntheresultingfacadetexturetothebuildings’structure.Wecanusevariouscombinationsofthesefourstylestocreateacloseapproximationtoreal-worldfacades,demonstrativeexamplesofwhicharepresentedinthefollowingsection.Theabstractionusingfacadewaveformscanevenmodelstaggeringofwindowsbyapplyingphasedifference.Thetechniqueenablesreplicationoftheartisticstyleofrenderingatvariousscales(describedintheprevioussection).ThisisachievedbydecreasingorincreasingthevalueoftheparameterT,whichdirectlycontrolsthenumberoffeatureelementsrenderedonafacade.RESULTSANDDISCUSSIONThissectionpresentsimagesthatdemonstratethefeaturesofourtechnique.Figures12–14demonstratethecapabilityofthefacademodellingapproachtocreatevariouslevelsofabstractionofreal-worldbuildings.Figure12isanexamplewherethebuildinghashorizontalemphasisoflayersofwindowsandwall.Itisseenthatourabstractioncapturesthisaspectwell.Figure13presentsacomparisonofthefacademodelwithaphotographoftheEmpireStatebuilding.Thisfacadehastwotypesoffacadecategoriesinit,namely,thewindowFigure10.Theﬁrst,thirdandﬁfthharmonicapproximationsoffunctioninFigure9usingequation(1)Figure11.AbstractionofsimplefacademodelpresentedinFigure7.Thehollowrectangularregionpreventsaliasing,anditgivestheimpressionofrectangularwindowsinzoomedoutview.ThisimageresemblesthehanddrawnwindowsfoundinhistoricalpanoramicmapsFigure12.TheabstractionofafacadesimilartothatofPetronasTowers.Leftshowsaphotographandrightisourabstractionofthefacadeforamap.Wehaveusedaapproximategeometrytocre-atethisimageFigure13.TheabstractionofafacadesimilartotheEmpireStateBuilding.Leftshowsaphotographandrightisourabstractionofthefacadeforamap.Wehaveusedaapproximategeometrytocre-atethisimageATechniqueforBuildingRepresentationinObliqueViewMaps111andwallregions,andthecolumnsthatarepredominantlywindowsonly.Alsowithintheseonlywindowcolumns,thereisanalternatingdarkandlightregion.Alltheseaspectsarecapturedinourfacademodel.Weusedfourfacadewaveform,twoeachinthehorizontalandverticaldirectionsinthismodel.Figure14showsvaryingdegreesofabstractionthatcanbeusedforrepresentingafacadewithourapproach.Eachfacadewaveformusedinthemodeladdsadetailedfeaturetotheappearanceoftheﬁnalbuildingtexture;therefore,wecancreatesimplerabstractionsusingfewerfacadewaveforms.Thenumberoffacadewaveformsusedtocreateafacadecanbeusedasaparametertoapanoramicmapgeneratingtool.Thisparameterdecidestheabstractionofthemapinrepresentingthebuildingdetails.Alltheseimagesaregeneratedwithourtechniquethatisimplementedasapixelshader.Ourbuildingshadingprogramisa9KBﬁle,anditgeneratesthetexturesforallthebuildingsinapanoramicmap.Ifatexturebasedapproachisused,aminimumof44KB(2566256)or117KB(5126512)sizetextureatlasesisrequiredforeachbuilding.Also,whenthesetexturesaremipmappedinthegraphicscard,theyleadtoadditionalrequirementintexturememory.Therefore,itcanbeseenthatourapproachresultsinsigniﬁcantreductioninsystemmemoryandstoragerequirements,andifitisdeployedasaserverbasedapplication,itgreatlyreducesthebandwidthrequirements.Theappearanceofamapisinﬂuencedbythreemainfactors,namely,qualityofinformationrepresented,techniqueandtechnologyusedtocreateamap,andcartographicandcognitiveprinciplesapplied.Inthiswork,wehaveobservedthepanoramicmapscreatedbyartists,identiﬁedthecartographicandcognitiveprinciples,andbuiltsupportfortheminourmodel.Sincewehaveaframeworkformakingpanoramicmaps,wecanexperimentwithsynthesizingvariousstylesofmapsbyincorporatingthetechniqueandtechnologybasedaspects.Figure15presentsamapwegeneratedwithoursolution,augmentedbyfeaturesthatresultfromtheuseofpenandinktechnologyincreatingmaps.Weconsiderthetechniquesadoptedbyartistsoftheearlynineteenthcentury,e.g.theuseofthesamefacademodelforallthebuildings.Theresultsareaestheticallyappealing,butitcanbeobservedthatthetechniqueofthoseartistsandthepenandinktechnologyemphasizededgesthatarenotscalable(resultinclutter)torepresentmodernurbanareasasmaps.Figure16presentsanexamplemapthatcreatesanaestheticallyappealingmapthatexploitstheprincipleof‘smallesteffectivedifference’.Thereisscopetoaddlayersofinformationinthismapasthetexturesonthebuildingaresufﬁcienttodistinguishthebuildingswhileatthesametimenotcreatingvisualclutterbybeingoverzealousinmimick-ingreality.Figure17presentsavariationinappearanceofthescenethatwecancreatebecauseweretainthesemanticsofwindowandwallinourmodel.ItisbecauseofthisthatweareabletolimitthelightedeffecttotheregionsthatFigure14.Demonstrationofdegreesofabstractionofthebuildingfacadetexture.Theabstractionisachievedusingfourfacadewaveforms(left),threefacadewaveforms(middle)andtwofacadewaveforms(right),tocreatethetextureFigure15.Anexampleofpanoramicmaprenderingthatincorpo-ratespenandinktechnologyfeatures,andthestyleofthenine-teenthcenturypanoramicartistsFigure16.Anexampleofpanoramicmapthatexploitstheprincipleof‘smallesteffectivedifference’intherepresentationofbuildings112TheCartographicJournalrepresentwindow.Thisisimpossibletodoinastraightfor-wardwayintexturebasedapproaches.CONCLUSIONSWehavepresentedatechniquetomakepanoramicmapsofmoderndayurbanareasinthispaper.Wehavedevelopedoursolutioninthecontextofstate-of-artGIS.Themainlimitationofthesesystemsisthelackofatoolthatenablesinclusionofabstractrepresentationsofbuildingsintoatwo-dimensionalmap.OursolutionaddressesthisgapinexistingGISsystems.Ourkeycontributionisabuildingrenderingsystembasedoncartographicandcognitiveprinciplesidentiﬁedfromobservationsofpanoramicmaps.Theseobservationsallowedustosuggestaclassiﬁcationschemeforbuildingsthatoccursinamapbasedonkeyfacadefeatures.Wethenemployedtechnique,whichmodelsfacadesbyintroducingtheconceptoffacadewaveformsandenables:Ncreationofvaryingdegreesofabstractionofthebuildingfacades;Nanti-aliasingimplicitly;Nretainingofsemanticsofbuildingfacadesforfurthervariationsinrendering;Neasycreationoffacadetextures;Ncompressionleadingtoreduceddemandontexturememoryandbandwidth.ThetechniquehasbeendevelopedinthecontextofpanoramicmapsforGIS;however,itcanbeappliedinanyapplicationthatrequireslowdetailedmodelsofbuildingslikegamingandedutainment.Itcanalsobeusedtocreateimpostersandlowdetailmodelsofbuildingsinapplicationswherethereisaneedtorepresentseveralbuildingsinasinglegraphicalscene.Wedemonstrateourresultswithimagesofobliqueviewmapscreatedautomaticallywithourtechnique.Suchmapsofmodernurbanareashavenotbeensynthesizedpre-viously.Asongoingwork,weareinvestigatingimageprocessingtechniquesthatcanhelpustoautomaticallyderivetheparametersforafacadewaveformfromphoto-graphsofbuildings.BIOGRAPHICALNOTESNeeharikaAdabalaisaresearcherintheVision,GraphicsandVisualizationGroupofMicrosoftResearchIndia.Hercurrentresearchfocusesoneffectivevisualizationofandinterac-tionwithinformation,anduseofsemanticstoimproveuser-computerinteraction.ShehasworkedinPhilipsResearchIndia,MIRALab-UniversityofGeneva,andUniversityofCentralFlorida.ShehasaMastersfromtheIndianInstituteofTechnology,MadrasandaPhDfromtheIndianInstituteofScience,Bangalore.REFERENCESAgrawala,M.andStolte,C.(2001).‘Renderingeffectiveroutemaps:improvingusabilitythroughgeneralization’,inSIGGRAPH2001:Proceedingsofthe28thAnnualConferenceonComputerGraphicsandInteractiveTechniques,pp.241–249,ACMPress,NewYork.Buchholz,H.,Do¨llner,J.,Nienhaus,M.andKirsch,F.(2005).‘Real-timenon-photorealisticrenderingof3Dcitymodels’,in1stInternationalWorkshoponNextGeneration3DCityModels,Bonn,Jun21–22.DeCarlo,D.andSantella,A.(2002).‘Stylizationandabstractionofphotographs’,inSIGGRAPH2002:Proceedingsofthe29thAnnualConferenceonComputerGraphicsandInteractiveTechniques,pp.769–776,ACMPress,NewYork.Do¨llner,J.andWalther,M.(2003).‘Real-timeexpressiverenderingofcitymodels’,in7thInternationalConferenceonInformationVisualization,pp.245–250,London,Jul16–18.Fru¨h,C.,Sammon,R.andZakhor,A.(2004).‘Automatedtexturemappingof3Dcitymodelswithobliqueaerialimagery’,in2ndInternationalSymposiumon3DDataProcessing,Visualization,andTransmission,pp.396–403,Thessaloniki,Sep6–9.GeographyandMapsDivision(2007).TheLibraryofCongress:panoramicmapscollection,http://memory.loc.gov/ammem/pmhtml/panhome.htmlGoogle.(2007).GoogleEarth–broadband,3Dapplication,http://earth.google.com/Harris,J.W.andStocker,H.(1998).HandbookofMathematicsandComputationalScience,Springer-Verlag,NewYork.Legakis,J.,Dorsey,J.andGortler,S.(2001).‘Feature-basedcellulartexturingforarchitecturalmodels’,inSIGGRAPH2001:Proceedingsofthe28thAnnualConferenceonComputerGraphicsandInteractiveTechniques,pp.309–316,ACMPress,NewYork.Lewis,J.-P.(1984).‘Texturesynthesisfordigitalpainting’,inSIGGRAPH’84:Proceedingsofthe11thAnnualConferenceonComputerGraphicsandInteractiveTechniques,pp.245–252,ACMPress,NewYork.MacEachren,A.M.(1995).HowMapsWork:Representation,Visualization,andDesign,GuilfordPress,NewYork.Microsoft.(2007).VirtualEarth3D–onlinemapservice,http://maps.live.com/Figure17.Nighttimerendering,demonstratingtheretainingofsemanticsinourrepresentation.Herewehaveenabledallthelightsinthewindowsofthescene.AsimplemaskingprocedurecanbeappliedtoturnoffsomelightsATechniqueforBuildingRepresentationinObliqueViewMaps113Monmonier,M.(1993).MappingItout:ExpositoryCartographyfortheHumanitiesandSocialSciences,UniversityofChicagoPress,Chicago,IL.Mu¨ller,P.,Wonka,P.,Haegler,S.,Ulmer,A.andGool,L.V.(2006).‘Proceduralmodelingofbuildings’,inSIGGRAPH2006:ACMSIGGRAPH2006Papers,pp.614–623,ACMPress,NewYork.Parish,Y.I.H.andMu¨ller,P.(2001).‘Proceduralmodelingofcities’,inSIGGRAPH2001:Proceedingsofthe28thAnnualConferenceonComputerGraphicsandInteractiveTechniques,pp.301–308,ACMPress,NewYork.Reps,J.W.(1984).ViewsandViewmakersofUrbanAmerica:LithographsofTownsandCitiesintheUnitedStatesandCanada,Columbia:UniversityofMissouriPress.NotesontheArtistsandPublishers,andaUnionCatalogofTheirWork,1825–1925,UniversityofMissouriPress,Columbia,MO.Robinson,A.H.,Morrison,J.L.,Muehrcke,P.C.,Kimerling,A.J.andGuptill,S.C.(1995).ElementsofCartography,UniversityofMissouriPress,Columbia,MO.Rusinkiewicz,S.,Burns,M.andDeCarlo,D.(2006).‘Exaggeratedshadingfordepictingshapeanddetail’,ACMTransactionsonGraphics,25,pp.1199–1205.Santella,A.andDeCarlo,D.(2002).‘Abstractedpainterlyrenderingsusingeye-trackingdata’,inNPAR2002,pp.75–82,ACMPress,NewYork.Santella,A.andDeCarlo,D.(2004).‘VisualinterestandNPR:anevaluationandmanifesto’,inNPAR2004,pp.71–78,ACMPress,NewYork.Slocum,T.A.,McMaster,R.B.,Kessler,F.C.andHoward,H.H.(2003).ThematicCartographyandGeographicVisualization,2nded.,PrenticeHall,UpperSaddleRiver,NJ.Tufte,E.R.(1997).VisualExplanations:ImagesandQuantities,EvidenceandNarrative,GraphicsPress,Cheshire,CT.Winkenbach,G.andSalesin,D.H.(1994).‘Computer-generatedpen-and-inkillustration’,inSIGGRAPH’94:Proceedingsofthe21stAnnualConferenceonComputerGraphicsandInteractiveTechniques,pp.91–100,ACMPress,NewYork.Wonka,P.,Wimmer,M.,Sillion,F.andRibarsky,W.(2003).‘Instantarchitecture’,inSIGGRAPH2003:ACMSIGGRAPH2003Papers,pp.669–677,ACMPress,NewYork.Yessios,C.I.(1979).‘Computerdraftingofstones,wood,plantandgroundmaterials’,inSIGGRAPH’79:Proceedingsofthe6thAnnualConferenceonComputerGraphicsandInteractiveTechniques,pp.190–198,ACMPress,NewYork.114TheCartographicJournal