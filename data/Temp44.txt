The Cartographic Journal
The World of Mapping

ISSN: 0008-7041 (Print) 1743-2774 (Online) Journal homepage: http://www.tandfonline.com/loi/ycaj20

A Triangulation Data Structure for Choropleth
Base Maps

Robert G. Cromley

To cite this article: Robert G. Cromley (1984) A Triangulation Data Structure for Choropleth
Base Maps, The Cartographic Journal, 21:1, 19-22, DOI: 10.1179/caj.1984.21.1.19

To link to this article:  http://dx.doi.org/10.1179/caj.1984.21.1.19

Published online: 18 Jul 2013.

Submit your article to this journal 

Article views: 3

View related articles 

Citing articles: 1 View citing articles 

Full Terms & Conditions of access and use can be found at
http://www.tandfonline.com/action/journalInformation?journalCode=ycaj20

Download by: [Monash University Library]

Date: 15 April 2016, At: 20:26

Mostearlymethodsforencodingchoroplethmapshaveusedtheregionorindividualdatazoneastheorganisationalunitforstoringthelocationalandtopologicalpropertiesofthemap.Thispaperpresentsanalternativeapproachtoencodingchoroplethmapswheretheneighbourhoodrelationshipsareencodedusingthenodeastheorganisationalunit.ThedirectrelationshipbetweenchoroplethbasemapsandaThiessendiagramenablesthesametriangulardatastructuresdevelopedtostoreaDelauneytriangulationtobeusedtostoreachoro-plethmap.Individualpolygonsareretrievedbyenumeratingthesequenceofnodesthatcomprisetheiroutlineinaclockwisemanner.Theconmumali~amongthedatastructuresforstoringdifferenttypesofmapsshouldpennitthedevelopmentofgeneralpurposedisplayalgorithms.ATriangulationDataStructureforChoroplethBaseMapsRobertG.CromleyDepartmentofGeography,UniversityofConnecticutINTRODUCTIONToproduceacomputer-drawnmap,mucheffortisexpendedgeneratinganinitialdigitalimageoftheareatobedisplayed.Theencodingofthisimageistimeconsumingandsusceptibletoerror,bothcartographic(thewronglocationisrecorded)andtopological(thewrongneighbourhoodinformationislisted).Acriticalelementofanygeographicalinformationsystemisacartographicdatastructurethatminimisesthelikelihoodofencodingerrorandisefficientwithrespecttothetimerequirementsoftheinitialencodingandsubsequentprocessing.Thereexist,however,manydifferentmethodsforencodingandstoringthecartographicinformationneces-sarytoproduceachoroplethmap.TheearlymappingprogramSYMAplusesasimpledatastructurethatcontainsonlycartographicinformationanddisregardsanytopologicalrelationshipsamongthevariouselementsofthemapdisplay.Eachindividualdatazoneisencodedasapolygonthatisrepresentedbyastringof(X,Y)cartesiancoordinates.Thisapproachhasseveralvisual,storageandanalyticaldrawbacks.Whenevertheoutlinesofcontiguouszonesaredrawn,theircommonboundaryisdrawntwice.Theaestheticappearanceisalsodegradediftheboundarypointsinoneoutlinedonotmatchthesequenceintheotheroutline,producinggapsoroverlapzones.Storageproblemsarisebecausethesequentialfilecontainingtheoutlineshasmanyredundantpointsandthefileisdifficulttoupdate.Finally,withoutanytopologicalinformationregardingneighbourhoodrelationshipsitisextremelydifficulttocalculatecertaintypesofstatisticalfunctionsthatrequireknowledgeofadjacentdatazones.Recognisingthesecriticisms,othermappingsystemssuchastheDIMEsystemandPOLYVRThaveretainedtopologicalaswellascartographicproperties.Buildingonthisapproach,thedatastructurepresentedhereutilisesthecommonpropertiesbetweenchoroplethandproximalbasemapsandthedualrelationshipbetweenThiessenpolygonsandDelauneytriangulationtodevelopatriangulationdatastructureforstoringchoro-plethbasemaps.THERELATIONSHIPBETWEENCHOROPLETHANDPROXIMALBASEMAPSPeuckerandChrisman2havenotedthatchoroplethandproximalmapsareplanarrepresentationsofthree-dimensionalsteppedsurfaces.Givenasetofndatapointsforwhich(X,Y,Z)coordinatesareknown,allpointsonthesurfacewithinthevicinityofagivendatapointhavethesameZvalueasthedatapoint.ThechoroplethapproachdefinesthevicinityofeachdatapointbyasimpleclosedpolygonwhiletheproximalapproachdefinesitastheThiessenpolygonwithinwhichallpointsareclosertothegivendatapointthantoanyotherdatapoint(seeRhynsburger3andBrasselandReif).TheformerapproachismorecommonlyusedwhentheZvaluehasbeencollectedforaboundedarealunit,usuallyapoliticalunit;thelatterismoreappropriatewhentheZvaluehasbeenrecordedforadiscretesetofdatapoints.Biggs,SBrassel,6andFegeas7haveidentifiedthebasicelementsusedtodefinechoroplethmapsasnodes,arcs,regions,andislands(seeFigure1).Nodes(N)aredefinedaszero-dimensionallocationidentifiersthathavetopo-logicalrelationships.Anodeisformedbytheinter-sectionofthreearcs.Anarcisdefinedasaone-dimensionallocusofpointsthatconnecttwonodes.Anarcisformedbytheintersectionoftworegions.Inpractice,arcsareapproximatedbyafinitesequenceofpoints.Regions(R)aretwo-dimensionalplanarsurfaces.Ifaregionhasaholeinit,orisadetachedarealsegment,thesefeaturesaretermedislands.Assumeforthepresentthateachregionisrepresentedbyasingleclosedpolygonwithoutanyholes.Oneregionistermedaneighbourofanotherregioniftheyshareacommonarc.Next,assumeforaproximalmapthatthesurfaceisboundedbyanouterrectangle(Figure2).ThesetofndatapointsgivenintheplaneboundedbythisrectanglearecalledThiessencentroids(C).AThiessenedge(E)isdefinedasthelocusofallpointsequidistantandclosesttoTheCartographicJournalVol.21June198419Downloaded by [Monash University Library] at 20:26 15 April 2016 FigureI.AnExampleChoroplethBaseMap.N1C3Figure3.NodeandVertexRelationships.V1V3E3C2C13).Eacharcoredgeisborderedbyaright-handandleft-handregionorThiessenpolygon.'Right-hand'and'left-hand'isdeterminedbythedirectionofmov~mentalongthearc.InFigure3,giventhedirectionfromNOtoN2,RIistheright-handregionandR2theleft-handregionofarcA2.·,Inpractice,morethanthreearcs'occasionallyintersectatapointsuchasthewell-known'fourcorners'thatliesattheintersectionofArizona,NewMexico,Utah,andColorado.Inthi~case,ArizonaandColoradoandNewMexicoandUtahshareonlyacommonpointnotanarc.ThisisanalogoustotheconceptofaThiessenhalf-neighb()ur;centroidsaretermedhalf-neighboursiftheyshareornyavertexratherthailanedge.Wheneverthesesi~uationsoccur,twoormorenodes(vertices)area,ctuallyoccupyingthesamegeographicallocation.Ifall'nodes(vertites)areuniquelyenumerated(althoughtwoormoremayhavethesamelocation),theneachnode(vertex)isformedbytheintersectionofexactlythreearcs(edges)andeacharc(edge)connectsexactlytwonodes(vertices)although.thearc(edge)willhavezerolength(Figure4).Theassignmentofwhicharc(edge)shouldconnectwhichnodes(vertices)isarbitraryandmorethanonepossibilityexists.InFigure4,regionRBisdefinedasaileighboutofRDwhileregionRAisnotaneighbourofregionRC.twocentroids.~AThiessenvertex(V)isdefinedasapointthatisequidistantandclosesttothreecentroids.EachThiessenvertexisformedattheintersectionofthreeedges.Asdiscus~edabove,aThiessenPolygonisdefinedasthesetofpointsthatareclosertoonecentroidthantoanyother.Finally,onecentroidistermedaThiessenneighbourofanothercentroidifthetwocentroidsshareacommonedge.Thereisaclearparallelbetweenthe.basicelementsandtopologicalrelationshipsofbothchoroplethandproximalmaps.First,nodes,arcs,andregionshavethesametopologicalsignificanceasThiessenvertices,edges,andpolygons.'Bothnodes'andverticesareformedbytheintersectionof'threelinearfeaturesthatconnecteachnodeorvertex'tothreeadjacentnodesorvertices(FigureRARSRARBNNN'V1RDRCRDRCFigure2.AnExamplePro~alBaseMap.Figure4.ResolvingtheFourcomerProblem.20Downloaded by [Monash University Library] at 20:26 15 April 2016 ATRIANGULATIONDATASTRUCTUREFORCHOROPLETHICBASEMAPSItisimportanttoenumerateeachnodeandarcinabasemapbecauseanexactnumberofthemexistasafunctionofthenumberofregions.Achoroplethbasemapwithoutanyislandsisanexampleofaplanargraph.Inaplanargraph,twoarcscannotintersectwithoutforminganewnode.Anybasemapcanbeconstructedbyaddingregionstoaninitialclosedregion.Eachnewregionisaddedbyintersectinganarcwiththepreviousconfigura-tion.Becauseeachnewarchastwointersections(oneateachendforclosure),twonewnodesareformed.Secondly,eachnewnodesplitsanexistingarcintotwonewones.Thisresultsintheadditionofthreearcsforeachnewregion.Thus,givennregions,thereexists3(n-l)arcsand2(n-l)nodes.ShamosandBentley8havealsoshownthattheThiessendiagramisthedualofaDelauneytriangulationmeshofnpoints.InaDelauneygraph,atriangularmeshisformedbyconnectingeachcentroidtoeachofitsThiessenneighbours.Elfick9andMcCullaghandRoss10havedevelopedalternativealgorithmsforconstructingatriangularmeshamongasetofdiscretecontrolpoints.BecauseThiessencentroidsarethecircumcentresofDelauneytriangles,onecanconstructadatastructureforThiessendiagramsandsimilarlychoroplethmapsthatparallelsElfick'striangulationstructureforcontourmaps.Aspreviouslydiscussed,eachnodeisdirectlyconnectedtothreeothernodesbytheirrespectivearcs.Anodereferencefile,therefore,can'beformedwhereeachrecordcontainstheneighbourhoodinformationcorre-spondingtoeachuniquenode.Thefirstthreeentriesofeachrecordcontainthereferencevaluesofthethreeadjoiningnodesrecordedinacounter-clockwiseorder.Thenextthreeentriesarethereferencevaluesofthe:correspondingregionthatistheright-handregionofthearcconnectingthecurrentnodetotheadjoiningnode.:InFigure1,RIistheright-handregionofthearcconnectingNItoN3;inTableIRIhasthesamepositionamongneighbouringregionstheN3hasamongadjoiningnodes.Thebackgroundisrepre-sentedinthistablebyRO.Thefinalthreeentriesineachrecordarethereferencevaluesofthecorrespondingchainthatconnectsthecurrentnodetoea~hofitsadjoiningnodes.TABLE1NodeReferenceFileRefer-AdjoiningNodesRight-HandRegionsConnectingArcsenceNodeFirstSe<:ondThirdFirstSecondThirdFirstSecondThirdNIN2N4N3ROR2RIA2AlA3N2NIN8N6R2ROR5A2AI2AllN3NINS'N7RORIR3A3A6A7N4NIN6NSRIR2R4AlA4ASNSN3N4N7R3RIR4A6ASA8N6N4N2N8R4R2RSA4AllAION7NSN8N3R3R4ROA8A9A7NSN7N6N2ROR4R5A9AIOAI2Theoutlinesofindividualregionscanberetrievedbycross-referencingthisfilewitharegionpointerfileandanarcfile.Theregionpointerfilecontainsastartingnodeforeachregionwhilethearcfilecontainsthesequenceofpointsthatapproximateeacharc.Inthelatterfile,thestartingnodeforeacharcisincludedtodeterminethedirectionofthepointsequence.Theoutlineisfoundbyenumeratingthesequence~fnodesthatcomprisetheoutlineinaclockwisedirection.GiventhestartingnodeNforareiion,R,thenodefilerecordcorrespondingtoNisfirstcheckedtofindR.ThenextnodeintheoutlineistheadjoiningnodeforwhichRistheright-handregion.ThefirstarcoftheoutlineisthearcinthisrecordforwhichRistheright-handregion.Asone'walks'aroundtheoutlineofRinaclockwisedirection,Ris.alwaystheright-handneighbour.ThenextarcandnewpointernodeisfoundbyscanningtherecordofthecurrentnodetodeterminethepositionofR.TheentiresequenceofnodesandarcsthatcomprisetheoutlineofRhavebeenenumeratedwhenthenextpointernodeistheoriginalstartingnode.Theregioncanthenbeshadeditsappropriatetone.Atthesametimethattheoutlineisbeingretrieved,anystatisticalfunctionrequiringknowledgeofR'sneighbourregionscanbecalculatedastheseneighboursaretheleft-handregionsofeacharcintheoutline.Thisinformationiscontainedinthenodefileastheleft-handregionistheoneimmediatelyfollowingRi.nthelist(ifRisthethirdregion,thentheleft-handoneISthefirstoneinthelist).Thelengthsoftheindividualarcscanalsobeusedasweightsint~efunction.Thusneighbouringregionssharinganarcofzerolength(the'fourcorner'problem)wouldhavethesameinfluenceasregionsthatdonotborderR.THEINCLUSIONOFISLANDSAlthoughislandshavenotbeenpermittedthus(ar,itisasimpletasktoaccommodatethesefeatures.InFigure6thebasemappresentedinFigureIhasb¢enmodifiedtoincludetwointernalislandsinregionR4.BothislandscompriseregionR6:First,oneofthenodesintheoutlineischosenasthestartingnodeforR4;inthisexample,NSwaschosen.Adummynode,N9,iscreatedtoformabridgefromtheperimeterofR4toone:oftheislands.Thisdummynodemusthavethesamegeographicallocationasthestartingnodeforclosure.Inthenodereferencefile,thenodethathaspointedtothestartingnode,inthiscaseN4,nowpointstothedummynode(seeTable2).However,NSstillpointstoN4asonewalkaroundtheoutlineofRl.TABLE2NodeReferenceFilewithIslandsRefer-AdjoiningNodesRight-HandRegionsConnectingArcsenceNodeFirstSecondThirdFirstSecondThirdFirstSecondThirdN4N3N6N9RIR2R4AlA4ASNSN3N4N7R3RIR4A6ASASN9NIO00R400000NIONIlN130R4R60AI400NilNIONI20R6R40AI400NI2N13NIl0R4R60AI500N13NI2NS0R6R40AIS0021Downloaded by [Monash University Library] at 20:26 15 April 2016 \·Figure5.AnExampleBaseMapwithIslands.TABLE3NodeReferenceFilewithInternalandExternalIslandsRefer-AdjoiningNodesRight-HandRegionsConnectingArcsenceNode-rrrstSecondThirdFirstSecondThirdFirstSecondThirdN3NIN5Nl4RORIR3A3A6A7N4NIN6N9RIR2R4AlA4A5N5N3N4N7R3RIR4A6A5A8N7N5N8N3R3R4ROA8A9A7N9NIONl20R6R40000NIONllNll0R4R60Al400NllNIONl20R6R40Al400Ni2N13N70R4R30Al500N13Nl2N50R3R40Al500Nl4N1300R300000"Next,twonodesmustbeaddedforeachisland.Bothnodesoneachislandhavethesamegeographicallocationtoensureclosure.Thedummynode,N9bridgestoNIO.Inturn,thisnodepointstoNilwhichbridgesN12.NI2pointstoNI3whichbridgesbacktoN5,thestartingnode.ThefulloutlineofN4hasnotbeenenumerated.Becausethebridgesareimaginary,avalueofzeroisinsertedforthecorrespondingarcreferencevalue.ItshouldbenotedthatwhiletheexternalperimeterofR4istraversedinaclockwisedirection,theperimetersoftheinternalislandaretraversedinacounter-clockwisedirection.Finally,inFigure6,oneoftheinternalislandsinR4isanexternalislandofR3.Thebridgetothisexternalislandisformedbyaddingadummynode,N14,totheoutlineofR3.AgainthedummynodehasthesamegeographicallocationasstartingnodeN7.InTable3,N3nowpointstoNI4whileN7stillpointstoN3.The22Figure6.InternalandExternalIslands.dummybridgestoN13whichinturnpointstoNI2;NI2thenbridgesbacktoN7.TheprogressionforR4remainsasitwas.Allexternalislandsarealsotraversedinaclockwisedirection.,SUMMARYTheelementsofchoroplethbasemapshavethesametopologicalrelationshipsasdotherespectiveelementsofproximalmap.ThisfactenableschoroplethbasemapstobestoredinacartographicdatastructuresimilartoElfick'striangulationmethodforisarithmicmaps.Becauseallplanarmapswithdiscretedistribution(choropleth,proximal,andisarithmic),havethesameunderlyingdatastructure,complementaryalgorithmsfordisplayingeachtypeofmapshouldbedeveloped.REFERENCES1.LaboratoryforComputerGraphicsandSpatialAnalysis,HarvardUniversity(1975).SYMAPUser'sReferenceManual.Cambridge,Mass.2.Peucker,T.K.andChrisman,N.(1975).Cartographicdatastructures,TheAmericanCartographer,2,No.1,55-69.3.Rhynsburger,D.(1973).AnalyticdelineationofThiessenpolygons,GeographicalAnaO'sis,5,No.2,133-144.4.Brassel,K.andReif,D.(1979).AproceduretogenerateThiessenpolygons,GeographicalAnaO'sis,11,No.3,289-303.5.Biggs,R.D.(1978).Cartographicdatastructuresforthematicapplicationsofautomatedcartography,HarvardPapersonGeographicalInformationSystems.6.Brassel,K.(1978).Atopologicaldatastructureformulti-elementmapprocessing,HarvardPapersonGeographicalInformationsystems.7.Fegeas,R.G.(1978).Thegraphicinputprocedure-anopera-tionallinesegmentIPolygonGraphictoDigitalConversion,HarvardPapersonGeographicalInformationSystems.8.Shamos,M.I.andBentley,J.(1978).OptimalalgorithmsforstructuringGeographicData,HarvardPapersonGeographicInformationSystems.9.El1ick,M.H.(1979).Contouringbyuseofatriangularmesh,The"CartographicJournal,16,No."I,24-29.10.McCullagh,M.J.andRoss,C.G.(1980).Delauneytriangulationofarandomdatasetforisarithmicmapping,TheCartographicJournal,17,No.2,93-99.Downloaded by [Monash University Library] at 20:26 15 April 2016 