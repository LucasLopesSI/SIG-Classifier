This article was downloaded by: [University of New Mexico]
On: 24 November 2014, At: 11:10
Publisher: Taylor & Francis
Informa Ltd Registered in England and Wales Registered Number: 1072954 Registered
office: Mortimer House, 37-41 Mortimer Street, London W1T 3JH, UK

International Journal of Geographical
Information Science
Publication details, including instructions for authors and
subscription information:
http://www.tandfonline.com/loi/tgis20

Quantifying local flow direction
uncertainty
Glenn O'Neil a & Ashton Shortridge b
a Institute of Water Research , Michigan State University , East
Lansing , MI , USA
b Department of Geography , Michigan State University , East
Lansing , MI , USA
Published online: 25 Sep 2012.

To cite this article: Glenn O'Neil & Ashton Shortridge (2013) Quantifying local flow direction
uncertainty, International Journal of Geographical Information Science, 27:7, 1292-1311, DOI:
10.1080/13658816.2012.719627

To link to this article:  http://dx.doi.org/10.1080/13658816.2012.719627

PLEASE SCROLL DOWN FOR ARTICLE

Taylor & Francis makes every effort to ensure the accuracy of all the information (the
“Content”) contained in the publications on our platform. However, Taylor & Francis,
our agents, and our licensors make no representations or warranties whatsoever as to
the accuracy, completeness, or suitability for any purpose of the Content. Any opinions
and views expressed in this publication are the opinions and views of the authors,
and are not the views of or endorsed by Taylor & Francis. The accuracy of the Content
should not be relied upon and should be independently verified with primary sources
of information. Taylor and Francis shall not be liable for any losses, actions, claims,
proceedings, demands, costs, expenses, damages, and other liabilities whatsoever or
howsoever caused arising directly or indirectly in connection with, in relation to or arising
out of the use of the Content.

This article may be used for research, teaching, and private study purposes. Any
substantial or systematic reproduction, redistribution, reselling, loan, sub-licensing,
systematic supply, or distribution in any form to anyone is expressly forbidden. Terms &
Conditions of access and use can be found at http://www.tandfonline.com/page/terms-
and-conditions

International Journal of Geographical Information Science, 2013
Vol. 27, No. 7, 1292–1311, http://dx.doi.org/10.1080/13658816.2012.719627

Quantifying local ﬂow direction uncertainty

Glenn O’Neila* and Ashton Shortridgeb

aInstitute of Water Research, Michigan State University, East Lansing, MI, USA; bDepartment of
Geography, Michigan State University, East Lansing, MI, USA

(Received 29 November 2011; ﬁnal version received 23 July 2012)

Absolute elevation error in digital elevation models (DEMs) can be within acceptable
National Map Accuracy standards, but still have dramatic impacts on ﬁeld-level esti-
mates of surface water ﬂow direction, particularly in level regions. We introduce and
evaluate a new method for quantifying uncertainty in ﬂow direction rasters derived from
DEMs. The method utilizes ﬂow direction values derived from ﬁner resolution digital
elevation data to estimate uncertainty, on a cell-by-cell basis, in ﬂow directions derived
from coarser digital elevation data. The result is a quantiﬁcation and spatial distribution
of ﬂow direction uncertainty at both local and regional scales. We present an implemen-
tation of the method using a 10-m DEM and a reference 1-m lidar DEM. The method
contributes to scientiﬁc understanding of DEM uncertainty propagation and modeling
and can inform hydrological analyses in engineering, agriculture, and other disciplines
that rely on simulations of surface water ﬂow.

Keywords: DEM; ﬂow direction; hydrology; accuracy; lidar

Introduction

1.
Digital elevation models (DEMs) are frequently used to predict surface water ﬂow direc-
tion for the purpose of modelling overland ﬂow and deriving digital stream networks. The
accuracy of these predictions and subsequent analyses relies on the ﬁdelity of the source
DEMs to the land surface. In ﬂatter areas, the impact of inaccuracies within a DEM on
ﬂow direction can be more pronounced, particularly if landscape relief is low relative to
the vertical precision of the data used to construct the DEM (Carter 1988, 1992, Wilson
and Gallant 2000). Furthermore, DEMs often contain erroneous sinks which are typically
ﬁlled during pre-processing, yielding perfectly ﬂat surfaces over these features. In ﬂatter
locations, these ﬁlled sinks can cover large areas, adding to the overall uncertainty of ﬂow
direction within a given DEM. In addition to their low relief, agricultural areas are espe-
cially prone to DEM inaccuracy. The source contour vector lines can contain topological
errors, such as intersections, around drainage ditches that may confuse the interpolation
algorithm, even if the algorithm incorporates stream locations. The resulting digital terrain
representations are questionable predictors of surface water ﬂow direction. Uncertainty
introduced by this lack of ﬁdelity can propagate throughout any topographically based
ﬂow-routing algorithm and vary at different spatial scales. These errors are of scientiﬁc
interest to scholars concerned with spatial data uncertainty and also concern researchers

*Corresponding author. Email: oneilg@msu.edu

© 2013 Taylor & Francis

Downloaded by [University of New Mexico] at 11:10 24 November 2014 International Journal of Geographical Information Science

1293

and geographic information system (GIS) users who rely on models of surface water ﬂow
direction.

In this article, we present a method for quantifying and mapping uncertainty in a ﬂow
direction raster derived from a DEM. The method utilizes ﬂow directions derived from
ﬁner resolution DEMs to calculate uncertainty, on a cell-by-cell basis, in ﬂow directions
derived from coarser DEMs. The method allows for measurement, visualization, and
analysis of this uncertainty at the local scale of the cell neighborhood and at regional
scales, such as watersheds and DEM tiles. In practice, the method can inform hydrological
analyses in engineering, agriculture, and other disciplines that rely on simulations of
surface water ﬂow.

The following paragraphs consider the nature of DEM-derived ﬂow direction uncer-
tainty. We then develop a conceptual model for our approach to characterize local ﬂow
direction uncertainty, followed by a case study in which we implemented the model on
a 10-m DEM. The article concludes with a discussion of the case study ﬁndings and the
method’s potential utility for both the study of ﬂow direction uncertainty and applications
that employ ﬂow direction.

2. Uncertainty in ﬂow direction
For the purposes of this research, we deﬁne ﬂow direction uncertainty as the lack of ﬁdelity
between ﬂow direction derived from a DEM and ﬂow direction derived from a source of
ﬁner spatial resolution and higher accuracy. There are several potential contributors to this
lack of ﬁdelity, all of which we discuss below:

(1) Data inaccuracy in the elevations of the DEM under study.
(2) Spatial scale-related effects that result in the omission of surface features important

(3) Algorithm-related effects due to the means by which ﬂow is routed across the

for the direction of local ﬂow.

DEM.

Elevation error has been a well-studied topic within geographic information science (for
overviews, see, e.g., Wilson and Gallant 2000, Fisher and Tate 2006, Wechsler 2007).
Global measures of error are commonly used to summarize elevation data quality. The
US Geologic Survey (USGS) reports the root-mean-square error (RMSE), a measure of
vertical accuracy using a sample of reference elevations, for each DEM it produces (USGS
1998). Fisher (1998) argued that in addition to RMSE, DEMs should be published with
measures of spatial autocorrelation of the error to allow users to appropriately represent
and model the error for propagation to derivative products.

Although elevation data quality reports may be useful in some contexts (e.g., Carson
et al. 1997, Shortridge 2006), they appear to be less informative for DEM derivative prod-
ucts such as slope, aspect, and ﬂow direction. Even low-RMSE DEMs can yield substantial
errors in their derivatives, particularly for relatively ﬂat areas (Garbrecht and Starks 1995,
Veregin 1997, Florinsky 1998, Wise 1998, Holmes et al. 2000, Wise 2000, Endreny and
Wood 2001, Usul and Pasogullari 2004, Barber and Shortridge 2005, Zhou et al. 2006).
Elevations in the relatively ﬂat 7.5-minute quadrangle DEMs of northern Ohio, one of
which is utilized in this article’s case study, can vary by less than 15 m over areas as large
as 166 km2. Although RMSEs for such areas may be well within DEM production stan-
dards, derivative products dependent upon local relief can nevertheless be greatly affected
by even subtle elevation errors.

Downloaded by [University of New Mexico] at 11:10 24 November 2014 1294

G. O’Neil and A. Shortridge

Numerous studies have evaluated the accuracy of derived products ranging from slope
to soil carbon (e.g. Chang and Tsai 1991, Desmet 1997, Kienzle 2004, Venteris and Slater
2005, Wu et al. 2005, 2007, Wechsler and Kroll 2006, Riggs and Dean 2007, Ziadat 2007).
Others have scrutinized DEM-based characterizations of surface hydrology, although with
different methods than we introduce in this article. Endreny and Wood (2001) studied
differences between ﬂow direction methods in terms of predicted ﬂow paths on three
64-ha study sites in western Oklahoma. They compared simulated ﬂow path networks
to control networks and recorded the percentage overlap. Walker and Willgoose (1999)
demonstrated the inaccuracies in derivatives of published DEMs through quantitative com-
parisons of upstream ﬂow-accumulation networks, slope–area relationship, and normalized
width function within a 1.4-km2 surveyed reference dataset in southwest Australia. Wise
(2000) also evaluated DEMs through catchment basins and upstream ﬂow accumulation
on a small catchment in South West England. Wise (2007), Wilson et al. (2007), Barber
and Shortridge (2005), and Thompson et al. (2001) studied DEM-derived surface ﬂow
through comparisons of derived catchment boundaries. Clarke and Lee (2007) evaluated
DEM estimates of surface ﬂow through a comparison of known stream features.

Although these analyses have demonstrated the propagation of DEM error into
hydrological derivatives, important limitations remain in the characterization of surface
water ﬂow direction uncertainty. In particular, most of these studies employed coarser geo-
graphic sampling frames (e.g., watersheds) than we propose here, limiting their utility for
identifying local uncertainty. To understand uncertainty in DEM hydrological derivatives at
the ﬁnest scales, evaluations must be made on a cell-by-cell basis; the following three stud-
ies accomplish this, although with distinctive limitations. Clark and Lee (2007) approached
this speciﬁcity in their comparison of DEM-derived ﬂow to known stream features, but
their method would not allow for a direct comparison where stream features do not exist,
such as the middle of a farm ﬁeld. Endreny and Wood (2003) estimated a cell-by-cell binary
spatial congruence of simulated surface ﬂow and observed ﬂow on two agricultural slopes,
but this would be impractical in quantifying ﬂow uncertainty at the scale of a 7.5-minute
quadrangle. Kienzle (2004) calculated aspect difference on a cell-by-cell level between a
coarser DEM and a ﬁner control. However, aspect values do not directly describe the direc-
tion of surface water ﬂow for an area (Endreny and Wood 2003). For example, the majority
of ﬁne-resolution cells within a coarser cell might point south; however, it is possible that
a topographic feature, such as a small gully that runs east to west, ultimately drains sur-
face water from the ﬁner cells out to the coarser cell’s eastern neighbor. Veregin (1997)
evaluated ﬂow direction differences between a DEM and simulated error-free realizations
on a cell-by-cell basis. He used the RMSE and spatial autocorrelation models of a USGS
30-m DEM to produce 500 randomized error rasters, which were added to the DEM to
yield 500 hypothetically error-free DEM realizations. Flow direction rasters were derived
from each realization; each cell’s modal ﬂow direction value across all simulations was
compared with ﬂow direction derived from the original DEM. Veregin concluded that ﬂow
direction uncertainty was highly sensitive to vertical error in the DEM. The method we
present here differs from Veregin’s method in several important ways. First, we employ a
single, ﬁner, and more precise DEM as the reference dataset, rather than using large num-
bers of simulations. Second, we identify a new means of quantifying local error magnitude.
Third, our method includes a means for evaluating ﬂow direction difference in cells with
multiple ﬂow directions (MFDs) (i.e., ﬂow can be partitioned among multiple neighbors).
Evaluating coarse, less precise terrain data with more precise data is a standard research
approach (e.g., Chang and Tsai 1991, Fisher 1998, Kyriakidis et al. 1999, Walker and
Willgoose 1999, Holmes et al. 2000, Kienzle 2004, Januchowski et al. 2010) and endorsed

Downloaded by [University of New Mexico] at 11:10 24 November 2014 International Journal of Geographical Information Science

1295

by the USGS (Digital Cartographic Data Standards Task Force 1988). Numerous studies
have explored performance differences between DEMs of different resolutions and gener-
ally found ﬁner resolutions superior, depending on the application (Chang and Tsai 1991,
Wolock and McCabe 2000, Mouton 2005, Wu et al. 2005, Deng et al. 2007, Riggs and
Dean 2007, Wu et al. 2007, Aziz et al. 2009). However, Zhou and Liu (2004a) pointed out
that the superior accuracy of the reference dataset is more important than ﬁner resolutions,
and Erskine et al. (2007) found that DEM data source was a more important contributor to
derivative sensitivity than resolution.

In order to better characterize surface ﬂow, it is often desirable to pre-process DEMs
(even ﬁne resolution ones) by ﬁlling spurious sinks and enforcing known channel loca-
tions via stream burning prior to generating hydrological derivatives such as ﬂow direction.
These steps can reduce surface ﬂow uncertainties due to DEM artifacts. If implemented
incautiously, however, these pre-processing steps can actually reduce the ﬁdelity of the
ﬂow direction model, as we demonstrate in our example application.

The utilization of a ﬁner DEM as a reference dataset for ﬂow direction may not be
appropriate in all cases. Carter (1992) observed higher uncertainty in DEM-derived aspect
values with ﬁner cell sizes, which he attributed to the lack of improvement in the vertical
accuracy and precision (elevation values were still only reported in integers) at ﬁner spatial
resolutions. Integer elevation values in DEMs are common, as many are interpolated from
topographic sheet contours with whole values; although, this is changing as the availability
of ﬁner remotely sensed elevation products, such as lidar, is increasing. It would be of ques-
tionable value to conduct a comparative study based on a reference DEM whose vertical
precision or accuracy is not sufﬁciently superior to the DEM under evaluation.

The third and ﬁnal source of ﬂow direction uncertainty is the particular algorithm used
to identify ﬂow across the elevation surface. Although a full survey of ﬂow algorithms is
beyond the scope of this article, we note that these methods can be divided into two main
types. The ﬁrst is the single ﬂow direction (SFD) approach, such as D8 (O’Callaghan and
Mark 1984, Greenlee 1987, Jenson and Domingue 1988), in which a single neighboring
cell receives all of the ﬂow. The other is the MFD approach, such as MF (Quinn et al. 1991)
and D-Inﬁnity (Tarboton 1997), in which ﬂow from a cell can be apportioned to more than
one neighbor.

The most thorough assessments of aspect and ﬂow direction uncertainties resulting
from ﬂow algorithm selection have been conducted on DEMs generated from simple sur-
faces deﬁned by mathematical functions (Zhou et al. 2006, Zhou 2000, Zhou and Liu 2002,
2004a, b, Qin et al. 2007). These artiﬁcially smooth surfaces allow for precise, mathemat-
ically derived derivatives such as ﬂow direction and catchment area, which are free of
propagated error due to DEM production and scale. These outputs can then be compared
with outputs from more traditional algorithms, such as SFD and MFD, to reveal true error,
not just uncertainty. Although these methods have been essential in informing our under-
standing of algorithm contribution to ﬂow direction uncertainty, their reliance on idealized
surfaces prevents them from being utilized to quantify such uncertainty in an actual DEM.
Most studies that have evaluated SFD and MFD ﬂow algorithms, including those based
on mathematical surfaces, have found MFD to be superior. Although SFD has performed
adequately in some studies (Skidmore 1989, Mouton 2005, Lin et al. 2008), it has been
frequently maligned in literature as being too rigid and prone to introducing artifacts into
the data, including long runs of parallel water ﬂows (Mitasova et al. 1996, Jones 1998,
Burrough et al. 2000, Schmidt and Persson 2003, Venteris and Slater 2005, Raaﬂaub and
Collins 2006, Wilson et al. 2007). Despite these ﬂaws, SFD is the most commonly installed,
if not the most commonly utilized, ﬂow direction algorithm in desktop GIS.

Downloaded by [University of New Mexico] at 11:10 24 November 2014 1296

G. O’Neil and A. Shortridge

In this article, we control for any uncertainty from the routing algorithm by using a sin-
gle algorithm in any one experiment. This enables us to focus on data- and resolution-based
sources of difference between test and reference terrain datasets. The following section
presents our particular approach, which can be applied to both single and multiple ﬂow
direction algorithms.

3. Conceptual model
We begin by developing notation. RAST is a coarse raster of cell size D. rast is a ﬁne
raster with cell size d = D/x, where x is an integer representing the number of rast cells
within a particular dimension of one RAST cell (Figure 1). Consider an arbitrary inte-
rior cell of RAST: C. C has eight neighboring cells in RAST: CNi, i = {1, 2, . . . , 8}.
Various ﬂow-routing algorithms can predict ﬂow from C to one or multiple members of
CN: FLOWC→CN. C also has an intersecting neighborhood of rast cells: Crast. We deﬁne
the ﬂow frontier (FF) of C as a ring of cells in rast at or beyond the extent of C.1 We can
then utilize the same ﬂow-routing algorithm that produced FLOWC→CN to route ﬂow from
the cells in Crast to FF in each member of CN: FLOWCrast → CN . Suppose that FF is square
and centered on the center of C. It is then evident that each cell in rast along FF falls in
one of the members of CN. The objective is to compare the proportions of ﬂow received
through each edge of FF in each CNi as calculated in FLOWCrast → CN to those received by
the coarser cells in CN from C as represented by FLOWC→CN. Assuming the ﬁner reso-
lution rast as the reference dataset, we then estimate ﬂow direction uncertainty for each
cell in RAST by applying the degree of difference between FLOWC→CN and FLOWCrast → CN
(Figure 2) weighted by ﬂow percentages and calculated in its simplest form (employing an
SFD algorithm) as follows:

FDUC =

(FLOWCrast→CNi

× DDi)

(1)

8(cid:2)

i=1

Figure 1. Conceptual model of a neighborhood of coarse RAST cells and intersecting rast cells.

Downloaded by [University of New Mexico] at 11:10 24 November 2014 International Journal of Geographical Information Science

1297

Figure 2. Flow direction uncertainty magnitudes, when 100% of FLOWCrast → CN is allocated
to CN4.

where FDUC is the ﬂow direction uncertainty for the arbitrary cell C in RAST,
is the fraction of FLOWCrast → CN reaching FF in CNi, and DDi is the degree
FLOWCrast→CNi
difference (ranging continuously from 0◦ to 180◦) between CNi and the member of CN that
receives FLOWC→CN (Figure 2).

As we point out, (1) would apply if the ﬂow direction for each cell in C and Crast
were limited to one direction. The calculation of FDUC becomes more complicated
when ﬂow can be routed in multiple directions. In (1), DDi represents the degree dif-
ference between the member of CN receiving all of FLOWC→CN and the CNi receiving
. When FLOWC→CN can be distributed among multiple neigh-
ﬂow from FLOWCrast → CNi
bors (FLOWC→CNi), 64 possible degree differences must be considered, one for each
combination of FLOWC→CNi and FLOWCrast → CNj
, yielding DDi,j. Consider the hypotheti-
cal ﬂow directions for a particular C in Figure 3. Sixty percent of FLOWC→CN is routed
= 0.60), with the remaining ﬂow split among CN 8 and CN 2
to CN 5 (FLOWC→CN5
= 0.20). Sixty-ﬁve percent of FLOWCrast → CN is
(FLOWC→CN8
= 0.65), with the remaining ﬂow evenly split among the
routed to CN 1 (FLOWCrast → CN1
other members of CN. In estimating FDUC, we must consider the degree differences
(DDi,j) between each CNi that receives a portion of FLOWC→CN and each CNj that receives

= 0.20 and FLOWC→CN2

Figure 3. Hypothetical ﬂow routing for a particular C and Crast using a multi-directional ﬂow
algorithm.

Downloaded by [University of New Mexico] at 11:10 24 November 2014 1298

G. O’Neil and A. Shortridge

Figure 4. Routing multi-directional ﬂows from Crast to FF. (a) Crast cells to be routed to FF. (b)
Each Crast cell is assigned a unit ﬂow volume of 1; note the selected cell in blue. (c) Routing the ﬂow
from the selected cell in (b) to its neighbors. (d) Routing continues to FF.

a portion of FLOWCrast → CN . For example, DD5,1 would equal 180◦ (the difference between
CN 5 and CN 1), whereas DD2,1 would equal 45◦.

To account for these complexities, we ﬁrst calculate each FLOWC→CNi. Each Crast cell
is assigned a volume of ﬂow equal to one, which is iteratively routed in multiple directions
until it crosses FF (Figure 4) in a particular CNi, yielding FLOWCrast → CNi
. The task, then,
is to apportion FLOWCrast → CN among FLOWC→CNi values in order to calculate FDUC. For
example, in Figure 3, most of the coarser ﬂow (FLOWC→CN5) and ﬁner ﬂow differ by 180◦.
Sixty percent of FLOWC→CN is routed west, whereas 65% of FLOWCrast → CN is routed east.
Various approaches to quantify the agreement between coarse and ﬁne raster ﬂows might be
adopted. One method would calculate an FDU for each individual CNi (FDUi), weighted
by the proportions in FLOWCrast → CN . Then each FDUi is weighted by the proportions in
FLOWC→CN . Formally,

FDUC =

⎝FLOWC→CNi

×

(FLOWCrast→CNj

× DDij)

(2)

⎛

8(cid:2)

i=1

8(cid:2)

j=1

⎞

⎠

Downloaded by [University of New Mexico] at 11:10 24 November 2014 International Journal of Geographical Information Science

1299

In the hypothetical ﬂows in Figure 3, Equation (2) would equal 112◦.

However, this approach would overestimate the inﬂuence of FLOWCrast → CN1

(0.65) on
= 0.60, DD5,1 = 180◦). The approach we propose in this article
FDU 5 (FLOWC→CN5
preferentially to neighboring cells. In the current example, these
assigns FLOWCrast → CN1
ﬂows are FLOWC→CN8 (0.20, DD8,1 = 45◦) and FLOWC→CN2 (0.20, DD2,1 = 45◦), which
to be applied to FLOWC→CN5. We incrementally appor-
would leave 0.25 of FLOWCrast → CN1
tion FLOWC→CNi to each FLOWCrast → CNi
, beginning with the largest FLOWC→CNi value
values to the farthest, until
and progressing from the nearest neighboring FLOWCrast → CNi
FLOWC→CNi has been completely accounted for. Essentially, the largest coarse ﬂow value
is matched with the closest (in terms of proximity) ﬁner ﬂow values until the sum of those
ﬁner values is equal to the coarser ﬂow, then the next largest coarse ﬂow is matched to the
remaining ﬁner ﬂows, and so on. More formally,

CNsorted = {i| max(FLOWC→CN ) = FLOWC→CNi, . . . , i| min(FLOWC→CN ) = FLOWC→CNi

CNNNi

=

⎧

⎪⎪⎪⎪⎪⎪⎪⎪⎪⎨
⎪⎪⎪⎪⎪⎪⎪⎪⎪⎩

{1, 2, 8, 3, 7, 4, 6, 5}
{2, 3, 1, 4, 8, 5, 7, 6}
{3, 4, 2, 5, 1, 6, 8, 7}
{4, 5, 3, 6, 2, 7, 1, 8}
{5, 6, 4, 7, 3, 8, 2, 1}
{6, 7, 5, 8, 4, 1, 3, 2}
{7, 8, 6, 1, 5, 2, 4, 3}
{8, 1, 7, 2, 6, 3, 5, 4}

i = 1
i = 2
i = 3
i = 4
i = 5
i = 6
i = 7
i = 8

FDUC = 0

for i in CNsorted:

> 0:

if FLOWC→CNi
FLOWToApportion = FLOWC→CNi
FDUi = 0
for j in CNNNi :

if FLOWCrast→CNj

> 0:

> 0:

if FLOWToApportion − FLOWCrast→CNj
FDUi += (FLOWCrast→CNj
FLOWToApportion −= FLOWCrast→CNj
= 0
FLOWCrast→CNj

else if FLOWToApportion − FLOWCrast→CNj

< 0:

/ FLOWC→CNi ) × DDij

FDUi += (FLOWToApportion / FLOWC→CNi) × DDij
FLOWToApportion = 0
FLOWremainder = abs(FLOWToApportion − FLOWCrast→CNj )
FLOWCrast→CNj

−= FLOWremainder

else:

FDUi += (FLOWCrast→CNj
FLOWToApportion = 0
= 0
FLOWCrast→CNj
if FLOWToApportion = 0:

stop for j

FDUC += FDUi × (FLOWC→CNi

/ FLOWC→CN)

/ FLOWC→CNi ) × DDij

Downloaded by [University of New Mexico] at 11:10 24 November 2014 1300

G. O’Neil and A. Shortridge

where CNsorted is a set of neighbor indices (i) sorted by the fraction of FLOWC→CN received
by each CNi, from greatest to least; CNNNi is a set of nearest neighbor indices (including
CNi) for each CNi; and FLOWToApportion is a variable tracking the amount of FLOWC→CNi
apportioned among FLOWCrast→CN across iterations over CNNNi . To illustrate this proce-
dure, consider Figure 3. FLOWC→CN is distributed to three neighboring cells: CN5 (0.60),
CN2 (0.20), and CN8 (0.20) in order of magnitude. CN5 is evaluated ﬁrst. Reference ﬂow
FLOWCrast → CN is apportioned to CN5 by proximity: ﬁrst 0.05 from CN5 itself, then CN 4 and
CN 6, and so on iteratively from increasingly distant cells. Ultimately, all of FLOWCrast → CN1
from cells {CNi, i = 2,3,4, . . . ,8} are assigned to CN5, totaling 0.35 of FLOWCrast → CN , and a
portion (0.25) from CN 1 comprising the balance of FLOWC→CN5. Flow to CN 2 and CN 8 is
. In this illustration, FDUC equals
then assigned from the remaining 0.40 in FLOWCrast → CN1
90◦, indicating a large disagreement in ﬂow direction between the two surfaces, although
less than 112◦ difference calculated using (2). This method can also be used with ﬂows
generated by an SFD algorithm. In this instance, FLOWC→CN will be routed to only one
CNi. FLOWCrast→CN can still be distributed over multiple members of CN; however, the val-
ues for each CNi will not represent fractions of unit ﬂow routed from each cell (as detailed
in Figure 4), but the fraction of total Crast cells routed through FF in each CNi.

4. Example application
We applied the conceptual model for ﬂow direction uncertainty to a USGS 10-m resolu-
tion DEM (RAST) using a 0.76-m resolution lidar DEM (rast) as the reference dataset and
employed the D-inﬁnity (Tarboton 1997) MFD ﬂow routing algorithm. The USGS DEM
covers the Doylestown, OH, 7.5-minute quadrangle, southwest of Akron (Figure 5) with
an RMSE of 3.8 m (Ohio Ofﬁce of Information Technology 2005), whereas the lidar DEM
has an RMSE of 0.15 m (Woolpert Inc. 2007). Although the lidar DEM is still an uncertain
representation of the surface, as discussed earlier, its superior vertical accuracy makes its

Figure 5. Lidar tiles intersecting the Doylestown quadrangle.
Data sources: Quadrangle, USGS; lidar tiles, OGRIP; counties, US Census Bureau.

Downloaded by [University of New Mexico] at 11:10 24 November 2014 International Journal of Geographical Information Science

1301

use as a reference appropriate. We obtained both datasets from the Ohio Geographically
Referenced Information Program (OGRIP), with the lidar data distributed in roughly
600 m × 600 m tiles (Figure 5). The quadrangle’s overall relief (110 m) is relatively high
for the northern portion of Ohio; land use is dominated by agriculture, with 68% of its area
classiﬁed as farm land, 21% as forest, and 7% as urban (Homer et al. 2007).

We developed a Python script, employing components of the Geospatial Data
Abstraction Library (GDAL 2010) module, to calculate ﬂow direction uncertainty for most
of the cells in RAST. To avoid edge issues, we ignored RAST cells that intersected lidar
tiles along the edges of the Doylestown quadrangle, and cells that intersected the bound-
aries of each lidar tile. These ignored cells are visible as regular, linear gaps in Figure 6.
Furthermore, to avoid issues in evaluating ﬂow direction among cells rendered perfectly
ﬂat by a sink-ﬁlling routine (a common problem in deriving surface water ﬂow from DEMs
in ﬂat areas), any C whose rast cells within its FF contained even one perfectly ﬂat cell
was discarded from the analysis. Although it is theoretically possible for the actual terrain
represented by a pixel to experience no topographic relief at all, it is highly unlikely. This
conservative approach discarded 27% of RAST cells from the analysis. The discarded areas
can also be seen in Figure 6 (unshaded) in ﬂatter areas and along stream features where sink
ﬁlling is prone to creating artiﬁcially ﬂat terrains.

Figure 6. Flow direction uncertainty calculated for each 10-m pixel in the Doylestown DEM. The
white areas within the quadrangle boundary are null values, corresponding to discarded ﬂat cells and
cells along the quadrangle and lidar tile boundaries.
Data sources: Quadrangle, USGS; counties, US Census Bureau.

Downloaded by [University of New Mexico] at 11:10 24 November 2014 1302

5. Results

G. O’Neil and A. Shortridge

The output of the Python script was a map of ﬂow direction uncertainty (Figure 6). FDU is
highly spatially autocorrelated, with broad patches of low uncertainty and hot spots of very
high uncertainty. This pattern should be expected as uncertainty may be associated with
particular, structured geomorphologic or land-cover characteristics. The most discernible
spatial feature is the large band of null-value FDU cells running east to west along the
center of the map in Figure 6. This band is the byproduct of discarding ﬂat cells from
the analysis. Roughly 27% of RAST cells were discarded in this analysis, due to their
corresponding FF containing at least one ﬂat rast cell. The band follows a ditch and pair
of railroad tracks that created artiﬁcial basins in rast and were subsequently ﬁlled ﬂat by
the sink-ﬁlling routine. These basins are likely due to the nature of lidar data as a product
of airborne sensors. The sensors cannot capture certain hydrological features, which route
ﬂow under elevated features, such as culverts running under railroad tracks. Therefore, the
lidar does not perceive an outlet along the base of the railroad tracks, creating a basin to
be ﬁlled. Similar null-value-based features can be seen running north to south in the top
half of the quadrangle, following roads that can experience the same culvert issues posed by
railroad tracks, and following streams that can also be rendered ﬂat by sink-ﬁlling routines.
Figure 7 and Table 1 illustrate a smaller scale analysis of FDU across the entire DEM.
As shown in Figure 7, roughly 45% of analyzed USGS DEM cells in the Doylestown quad-
rangle had an FDU within the 22.5◦–67.5◦ range. This implies that in almost half of the
cells in the study area, the ﬂow direction from the USGS DEM cell (FLOWC→CN) differed
from the ﬂow out of the corresponding lidar cells (FLOWCrast → CN ) by roughly one neighbor.
The median FDU value of 28.4◦ (Table 1) indicates that FLOWC→CN and FLOWCrast → CN

Figure 7. Histogram of ﬂow direction uncertainty (FDU) values calculated for the RAST cells of
the Doylestown quadrangle DEM.

s

l
l

e
c
 
f
o
 
e
g
a
t
n
e
c
r
e
P

40
35
30
25
20
15
10
5
0

N = 500,621

0

0–22.4
22.5–44.9

45.0–67.4

112.5–134.9
67.5–88.9
90.0–112.4

135.0–157.4

157.5–179.9

180

Flow direction Uncertainty (°)

Table 1. Descriptive statistics of ﬂow direction uncertainty
values for the Doylestown quadrangle.

Flow direction uncertainty for Doylestown, OH, quadrangle

Mean
Standard deviation
Median
Interquartile range
N

37.0◦
32.4◦
28.4◦
14.4◦–47.3◦
500,621

Downloaded by [University of New Mexico] at 11:10 24 November 2014 International Journal of Geographical Information Science

1303

were within one CNi of agreement for the majority of cells, despite the fact that the ﬂows
were in complete agreement (FDU = 0) in only 2.3% of the cells.

In an effort to validate our approach, we calculated FDU for a version of the
Doylestown DEM in which we did not burn streams (DEMno-burn) and compared the results
to those discussed above (DEMburn). As stream burning is supposed to re-enforce the loca-
tion of known stream features in a DEM and, therefore, improve the representation of
surface ﬂow, we assumed. We assumed that the mean FDU for DEMno-burn would be greater
than mean FDU for DEMburn (reported in Table 1 as 37.0◦). Mean FDU for DEMno-burn
was only slightly higher at 37.4◦; however, given the large sample size (N = 500,621),
this difference proved statistically signiﬁcant in a paired t-test: t(500,619) = 6.01, P <
0.001, supporting our assumption. Unsurprisingly, most of the cells with the highest FDU
difference were found within riparian areas (Figure 8a and Figure 8b), as the impact of
stream burning typically diminishes with increased distance from the burned stream. The
red pixels in Figure 8b are cells where FDU was higher in DEMburn, whereas the blue pix-
els are cells where FDU was higher in DEMno-burn. The large cluster of blue pixels in the
south central portion of the map in Figure 8b illustrates one of the reasons stream-burning
improves estimates of ﬂow direction. In DEMno-burn, not re-enforcing the presence of the
ditch along the base of the railroad track caused the ditch’s entire local basin to be ren-
dered ﬂat during the sink-ﬁlling routine, because the basin did not have an outlet in the
DEM (Figure 8d). The resulting ﬂow direction values for the basin’s cells were homoge-
neous and highly uncertain. The outlet was present in DEMburn; therefore, the ditch’s local

Figure 8.
Impact of stream burning on ﬂow direction and FDU. (a) Stream locations from USGS
DLG hydrography. (b) Areas where FDU values for a stream-burned DEM differ from an un-burned
DEM. Blue pixels indicate higher uncertainty in un-burned DEM, red pixels indicate higher values
in burned DEM. (c) Burned DEM, shaded to reﬂect the topography of the main local basin running
east to west through the quadrangle. (d) Unburned DEM, with the local basin rendered ﬂat by the
sink-ﬁlling routine.
Data sources: Quadrangle and streams, USGS; counties, US Census Bureau.

Downloaded by [University of New Mexico] at 11:10 24 November 2014 1304

G. O’Neil and A. Shortridge

basin retained the varying topography (Figure 8c), which allowed for more reasonable ﬂow
direction estimates. This analysis indicates that, in terms of reducing uncertainty in the
estimation of surface water ﬂow direction, stream burning has the most dramatic impacts
in ﬂat areas and areas with a relatively high number of stream features.

6. Discussion

The method we present here differs from previous studies of hydrological DEM derivatives
in its focus on the individual raster cell. Other studies have evaluated DEMs’ ability to char-
acterize surface water ﬂow through analyses of much coarser geographic scale sampling
frames, including derived catchment basins or approximation of known stream features,
or through comparison of ﬂow direction proxies like aspect. Our method, however, allows
for a local and direct evaluation, enabling assessment of ﬂow direction uncertainty across
intermediate-scale geographic features of interest, such as agricultural ﬁelds, marshes, or
small watersheds. Catchment boundaries and simulated digital stream networks will not
necessarily evaluate surface ﬂow within the middle of an agricultural ﬁeld, which is impor-
tant to soil conservationists trying to address ﬁeld-level soil erosion. This method can
better inform such groups and identify speciﬁc areas where uncertainty in DEM derived
hydrology may be greatest.

It should be pointed out, although, that the beneﬁts of our method may be difﬁcult to
realize due to the limitations of computer processing power and storage. In our example
application, the necessary pre-processing of input datasets and the actual implementation
of the method required several hours of automated computer processing, and the lidar
data required multiple gigabytes of storage. Furthermore, DEMs with resolutions as ﬁne
and elevations as accurate as the one used in this study are not available in the majority of
locations. In places where such DEMs are available it may be impractical or unnecessary to
conduct a hydrological analysis at resolutions so ﬁne. It is possible that a particular analysis
is sufﬁciently served by relatively coarse DEMs. Our method could be utilized on a sample
of locations in a particular study area to gauge overall ﬂow direction uncertainty, to develop
geostatistical models of uncertainty at unsampled locations, or to guide the selection of a
hydrological study’s DEM resolution. For example, designers of an agricultural gully map-
ping project may weigh the beneﬁts of simulating surface ﬂow with high-resolution lidar
against the increased costs of computer storage and processing time. The FDU metric
applied to a 10-m DEM could help the designers determine whether coarser and more man-
ageable data are sufﬁcient for their needs. Our hope is that this method will contribute to
the broader understanding of ﬂow direction uncertainty, so that practitioners can determine
acceptable levels of uncertainty and, therefore, choose appropriate resolutions at which to
conduct their hydrological analyses.

Several future directions of ﬂow direction uncertainty research present themselves.
More research into the nature of ﬂow direction uncertainty is needed. In order to evalu-
ate the associations between ﬂow direction uncertainty and geomorphologic or land-cover
characteristics, a larger study encompassing variable landscapes is needed. Furthermore,
the relationship of ﬂow direction uncertainty to a changing cell neighborhood size needs
to be explored. We presented results calculated at a local 3 × 3 cell neighborhood and
over an entire DEM; however, it is worth investigating how values of FDU change for a
particular C as FF is expanded. At what scale for a particular C would FLOWC→CN and
FLOWCrast→FF agree? Perhaps the ﬂows would align in an FF encompassing a 5 × 5 cell
neighborhood, or not until the basin outlet was reached. Such research is needed to fully
document ﬂow direction uncertainty in DEM-based hydrological modeling.

Downloaded by [University of New Mexico] at 11:10 24 November 2014 International Journal of Geographical Information Science

1305

7. Conclusion

In this article, we present a method for quantifying local ﬂow direction uncertainty in
DEMs. By comparing a coarse resolution DEM (RAST) with a ﬁner reference DEM (rast),
this method measures uncertainty on a cell-by-cell basis. We utilize a ﬂow-routing algo-
rithm to derive ﬂow direction rasters from both RAST and rast. We illustrate its use with a
multi-directional ﬂow direction routine, although it could be applied to single ﬂow direc-
tion routines as well. For each RAST cell (C), we compare ﬂow percentages (FLOWC→CN)
from C to its immediate neighbors (CN), to ﬂow percentages (FLOWCrast → CN ) from rast
cells that intersect C (Crast) to a ﬂow frontier (FF) that extends to the center of each mem-
ber of CN. We then use these ﬂow percentages to calculate a weighted degree difference
between the ﬂow we are evaluating (FLOWC→CN) and the reference ﬂow (FLOWCrast → CN ).
We refer to this difference as the ﬂow direction uncertainty for a particular C (FDUC).
Perfect ﬂow agreement would result in an FDUC of 0◦, whereas an FDUC of 180◦ would
represent the highest possible uncertainty. FDU could then be mapped over a particular
study, and analyzed spatially and through regional descriptive statistics.

We implemented the method on a 10-m USGS DEM (RAST) for a 7.5-minute quadran-
gle in northern Ohio, using lidar DEMs (rast) as the reference dataset. The resulting map
not only identiﬁed FDU hot spots but also illustrated the challenges in working with lidar-
derived DEMs, as stream-burning proved difﬁcult (Appendix) and a number of cells were
discarded due to creation of perfectly ﬂat surfaces as a result of sink ﬁlling. FDU values
summarized across the quadrangle revealed that ﬂow from most RAST cells were within
one neighbor of agreement when compared to the corresponding ﬂow from rast cells.

Our method of calculating ﬂow direction uncertainty enables an exploration of uncer-
tainty at scales ﬁner than those typically employed in studies of DEM-derived hydrology.
We hope that this approach will lead to a better understanding of this uncertainty, con-
tribute meaningfully to the study of error propagation in DEM derivatives, and inform the
numerous ﬁelds of research and application that rely on DEM-derived surface water ﬂow.

Note
1. Although FF could be constrained to the boundary of C, we extended FF to the center of each
member of CN because most ﬂow-routing algorithms, including the one used is this study, base
their calculations of ﬂow direction on changes in elevation over the horizontal distance between
the center point of a cell and the centers of its neighboring cells. In order to justiﬁably com-
pare FLOWC→CN and FLOWCrast → CN , we ensured that their predictions correspond to the same
geographic space.

References
Aziz, S.A., et al., 2009. Utilizing repeated GPS surveys from ﬁeld operations for development of

agricultural ﬁeld DEMs. Transactions of the ASABE, 52 (4), 1057–1067.

Barber, C.P. and Shortridge, A., 2005. Lidar elevation data for surface hydrologic modeling: res-
olution and representation issues. Cartography and Geographic Information Science, 32 (4),
401–410.

Burrough, P., vanGans, P.F.M., and MacMillan, R.A., 2000. High resolution landform classiﬁcation

using fuzzy k-means. Journal of Fuzzy Sets and Systems, 113, 37–52.

Carson, W. and Reutebuch, S., 1997. A rigorous test of the accuracy of USGS digital elevation
models in forested areas of Oregon and Washington. In: Volume 1 surveying and cartography.
ACSM/ASPRS Annual Convention & Exposition Technical Papers, 7–10 April 1997 Seattle,
133–143.

Carter, J.R., 1988. Digital representations of topographic surfaces. Photogrammetric Engineering

and Remote Sensing, 54, 1577–1580.

Downloaded by [University of New Mexico] at 11:10 24 November 2014 1306

G. O’Neil and A. Shortridge

Carter, J.R., 1992. The effect of data precision on the calculation of slope and aspect using gridded

DEMs. Cartographica, 29 (1), 22–34.

Chang, K. and Tsai, B., 1991. The effect of DEM resolution on slope and aspect mapping.

Cartography and Geographic Information Systems, 18 (1), 69–77.

Clarke, K.C. and Lee, S.J., 2007. Spatial resolution and algorithm choice as modiﬁers of downslope
ﬂow computed from digital elevation models. Cartography and Geographic Information Science,
34 (3), 215–230.

Deng, Y., Wilson, J., and Bauer, B., 2007. DEM resolution dependencies of terrain attributes across
a landscape. International Journal of Geographical Information Science, 21 (2), 187–213.
Desmet, P., 1997. Effects of interpolation errors on the analysis of DEMs. Earth Surface Processes

and Landforms, 22, 563–580.

Digital Cartographic Data Standards Task Force, 1988. A proposed standard for digital cartographic

data. The American Cartographer, 15 (1), 129–136.

Douglas, D.H., 1986. Experiments to locate ridges and channels to create a new type of digital
elevation model. Cartographica: The International Journal for Geographic Information and
Geovisualization, 23 (4), 29–61.

Endreny, T.A. and Wood, E.F., 2001. Representing elevation uncertainty in runoff modeling and

ﬂowpath mapping. Hydrological Processes, 15, 2223–2236.

Endreny, T.A. and Wood, E.F., 2003. Maximizing spatial congruence of observed and DEM-
delineated overland ﬂow networks. International Journal of Geographical Information Science,
17 (7), 699–713.

Erskine, R.H., et al., 2007. Digital elevation accuracy and grid cell size: effects on estimated terrain

attributes. Soil Science Society of America Journal, 71 (4), 1371–1380.

Fisher, P., 1998. Improved modeling of elevation error with geostatistics. GeoInformatica, 2 (3),

215–233.

Fisher, P. and Tate, N., 2006. Causes and consequences of error in digital elevation models. Progress

in Physical Geography, 30 (4), 467–489.

Florinsky, I., 1998. Accuracy of local topographic variables derived from digital elevation models.

International Journal of Geographical Information Science, 12 (1), 47–61.

GDAL, 2010. GDAL – Geospatial Data Abstraction Library: Version 1.7, Open Source Geospatial

Foundation. Available from: http://gdal.osgeo.org.

Garbrecht, J. and Starks, P., 1995. Note on the use of USGS Level 1 7.5-minute DEM coverages for
landscape drainage analyses. Photogrammetric Engineering & Remote Sensing, 61 (5), 519–522.
Greenlee, D., 1987. Raster and vector processing for scanned linework. Photogrammetric

Engineering and Remote Sensing, 53 (10), 1383–1387.

Holmes, K.W., Chadwick, O.A., and Kyriakidis, P.C., 2000. Error in a USGS 30-meter digital
elevation model and its impact on terrain modeling. Journal of Hydrology, 233, 154–173.
Homer, C., et al., 2007. Completion of the 2001 National Land Cover Database for the coterminous

United States. Photogrammetric Engineering and Remote Sensing, 829–840.

Januchowski, S.R., et al., 2010. Characterizing errors in digital elevation models and estimating the
ﬁnancial costs of accuracy. International Journal of Geographical Information Science, 24 (9),
1327–1347.

Jenson, S. and Domingue, J., 1988. Extracting topographic structure from digital elevation data for
geographic information system analysis. Photogrammetric Engineering and Remote Sensing,
54 (11), 1593–1600.

Jones, K.H., 1998. A comparison of algorithms used to compute hill slope as a property of the DEM.

Computers & Geosciences, 24 (4), 315–323.

Kienzle, S., 2004. The effect of DEM raster resolution on ﬁrst order, second order and compound

terrain derivatives. Transactions in GIS, 8 (1), 83–111.

Kyriakidis, P.C., Shortridge, A.M., and Goodchild, M.F., 1999. Geostatistics for conﬂation and accu-
racy assessment of digital elevation models. International Journal of Geographical Information
Science, 13 (7), 677–707.

Lin, W., et al., 2008. WinBasin: using improved algorithms and the GIS technique for auto-
mated watershed modelling analysis from digital elevation models. International Journal of
Geographical Information Science, 22 (1), 47–69.

Lindsay, J.B., 2006. Sensitivity of channel mapping techniques to uncertainty in digital elevation

data. International Journal of Geographical Information Science, 20 (6), 669–692.

Mitasova, H., et al., 1996. Modeling topographic potential for erosion and deposition using GIS.

International Journal of Geographical Information Systems, 10 (5), 629–642.

Downloaded by [University of New Mexico] at 11:10 24 November 2014 International Journal of Geographical Information Science

1307

Mouton, A., 2005. Generating stream maps using LiDAR derived digital elevation models and 10-m

USGS DEM. Thesis (MS). Washington State University.

O’Callaghan, J.F. and Mark, D.M., 1984. The extraction of drainage networks from digital elevation

data. Computer Vision, Graphics and Image Processing, 28, 328–344.

Ohio Ofﬁce of Information Technology, GIS Support Center, 2005. Ohio 10-meter digital ele-
vation model (FGDC)/oh_dem10b (ISO) [online]. Available from: http://metadataexplorer.
gis.state.oh.us/metadataexplorer/full_metadata.jsp?docId={D0820264–6E96–4E1A-860F-
F89F42C39F64}&loggedIn=false.

Qin, C., et al., 2007. An adaptive approach to selecting a ﬂow-partition exponent for a
multiple-ﬂow-direction algorithm. International Journal of Geographical Information Science,
21 (4), 443–458.

Quinn, P., et al., 1991. The prediction of hillslope ﬂowpaths for distributed hydrological modelling

using digital terrain models. Hydrological Processes, 5, 59–80.

Raaﬂaub, L.D. and Collins, M.J., 2006. The effect of error in gridded digital elevation models on the
estimation of topographic parameters. Environmental Modelling and Software, 21, 710–732.
Riggs, P.D. and Dean, D.J., 2007. An investigation into the causes of errors and inconsistencies in

predicted viewsheds. Transactions in GIS, 11 (2), 175–196.

Schmidt, F. and Persson, A., 2003. Comparison of DEM data capture and topographic wetness

indices. Precision Agriculture, 4, 179–192.

Shortridge, A., 2006. Shuttle radar topography mission elevation data error and its relationship to

land cover. Cartography and Geographic Information Science, 33 (1), 65–75.

Skidmore, A.K., 1989. A comparison of techniques for calculating gradient and aspect from a grid-
ded digital elevation model. International Journal of Geographical Information Systems, 2 (4),
323–334.

Soille, P., 2004a. Morphological carving. Pattern Recognition Letters, 25, 543–550.
Soille, P., 2004b. Optimal removal of spurious pits in grid digital elevation models. Water Resources

Research, 40, 12.

Soille, P., Vogt, J., and Colombo, R., 2003. Carving and adaptive drainage enforcement of grid digital

elevation models. Water Resources Research, 39 (12), 10-1–10-3.

Tarboton, D.G., 1997. A new method for the determination of ﬂow directions and upslope areas in

grid digital elevation models. Water Resources Research, 33 (2), 309–319.

Thompson, J.A., Bell, J.C., and Butler, C.A., 2001. Digital elevation model resolution: effects on
terrain attribute calculation and quantitative soil-landscape modeling. Geoderma, 1, 67–89.
USGS, 1998. Standards for digital elevation models [online]. Rocky Mountain Mapping Center.

Available from: http://rockyweb.cr.usgs.gov/nmpstds/demstds.html

USGS, 1999. Standards for Digital Line Graphs [online]. Rocky Mountain Mapping Center.

Available from: http://rmmcweb.cr.usgs.gov/nmpstds/acrodocs/dlg-3/2dlg0999.pdf.

Usul, N. and Pasogullari, O., 2004. Effect of map scale and grid size for hydrological modelling.
In Y. Chen, K. Takara, I. Cluckie and F. Hilaire De Smedt, eds., GIS and Remote Sensing in
Hydrology, Water Resources and Environment (Proceedings of ICGRHWE), Three Gorges Dam,
China. Wallingford, UK: IAHS Publication 289, 91–100.

Venteris, E.R. and Slater, B.K., 2005. A comparison between contour elevation data sources for DEM
creation and soil carbon prediction, Coshocton, Ohio. Transactions in GIS, 9 (2), 179–198.
Veregin, H., 1997. The effects of vertical error in digital elevation models on the determination of

ﬂow-path direction. Cartography & Geographic Information Systems, 24 (2), 67–79.

Walker, J.P. and Willgoose, G.R., 1999. On the effect of digital elevation model accuracy on

hydrology and geomorphology. Water Resources Research, 53 (7), 2259–2268.

Wechsler, S.P., 2007. Uncertainties associated with digital elevation models for hydrologic applica-

tions: a review. Hydrology and Earth Systems Sciences, (11), 1481–1500.

Wechsler, S. and Kroll, C., 2006. Quantifying DEM uncertainty and its effect on topographic

parameters. Photogrammetric Engineering & Remote Sensing, 72 (9), 1081–1090.
Wilson, J.P. and Gallant, J.C., 2000. Terrain analysis. New York: John Wiley and Sons.
Wilson, J.P., Lam, C.S., and Deng, Y., 2007. Comparison of the performance of ﬂow-routing

algorithms used in GIS-based hydrologic analysis. Hydrological Processes, 1026–1044.

Wise, S., 1998. The effect of GIS interpolation errors on the use of digital elevation models in
geomorphology. In: S.N. Lane, K.S. Richards, and J.H. Chandler, eds. Landform monitoring,
modelling and analysis. Chichester: Wiley, 139–164.

Downloaded by [University of New Mexico] at 11:10 24 November 2014 1308

G. O’Neil and A. Shortridge

Wise, S., 2000. Assessing the quality for hydrological applications of digital elevation models derived

from contours. Hydrological Processes, 14, 1909–1929.

Wise, S., 2007. Effect of differing DEM creation methods on the results from a hydrological model.

Computers & Geosciences, 33, 1351–1365.

Wolock, D.M. and McCabe, G.J., 2000. Differences in topographic characteristics computed from
100- and 1000-m resolution digital elevation model data. Hydrological Processes, 14, 987–1002.
Woolpert Inc., 2007. OSIP DEM tiles by county – GRID format (FGDC)/N1440375 (ISO) [online].
OGRIP Website. Available from: http://metadataexplorer.gis.state.oh.us/metadataexplorer/
full_metadata.jsp?docId={6FAB0C57–1A57–4142-BCF7-A38F4D11FCA3}&loggedIn=false
Wu, S., Li, J., and Huang, G., 2005. An evaluation of grid size uncertainty in empirical soil loss
modeling with digital elevation models. Environmental Modelling and Assessment, 10, 33–42.
Wu, S., Li, J., and Huang, G., 2007. Modeling the effects of elevation data resolution on the perfor-
mance of topography-based watershed runoff simulation. Environmental Modelling & Software,
22, 1250–1260.

Zhou, Q., 2000. A data-independent method for quantitative accuracy assessment of morphologi-
cal parameters extracted from grid-based DTM. International Archives of Photogrammetry and
Remote Sensing, 33, 1235–1242.

Zhou, Q. and Liu, X., 2002. Error assessment of grid-based ﬂow routing algorithms used in
hydrological models. International Journal of Geographical Information Science, 16 (8),
819–842.

Zhou, Q. and Liu, X., 2004a. Analysis of errors of derived slope and aspect related to DEM data

properties. Computers & Geosciences, 30 (4), 369–378.

Zhou, Q. and Liu, X., 2004b. Error analysis on grid-based slope and aspect algorithms.

Photogrammetric Engineering & Remote Sensing, 70 (8), 957–962.

Zhou, Q., Liu, X., and Sun., Y., 2006. Terrain complexity and uncertainties in grid-based dig-
ital terrain analysis. International Journal of Geographical Information Science, 20 (10),
1137–1147.

Ziadat, F.M., 2007. Effect of contour intervals and grid cell size on the accuracy of DEMs and slope

derivatives. Transactions in GIS, 11 (1), 67–81.

Appendix
Data pre-processing

We pre-processed the USGS DEM and lidar DEMs for hydrological analysis by re-enforcing (burn-
ing) stream locations and ﬁlling artiﬁcial sinks. Burning streams into the DEMs helps ensure the
routing of surface water ﬂow to streams and their outlets by preventing these features from being
ﬁlled ﬂat during the sink ﬁlling routine. Sink ﬁlling helps prevent surface ﬂow from becoming
trapped by potentially spurious pits in the DEMs. We obtained USGS 1:24,000 scale stream loca-
tion GIS vector data (derived from the Doylestown topographic sheet as digital line graphs (DLGs))
from OGRIP and burned them into the USGS DEM. However, we could not utilize this approach on
the lidar DEMs. The horizontal positional accuracy of the stream features was less than that of the
lidar DEMs; therefore, the features did not align with their corresponding representations in the lidar
DEMs. The USGS streams features could vary from the true locations by as much as 12 m (USGS
1999), whereas the lidar elevations that correspond to stream locations could vary by a maximum of
around 2 m (Woolpert 2007). Figure A1 illustrates this scenario. In reference to the lidar DEM, the
USGS stream feature runs through the location of the house (visible in the aerial photo).

To resolve this issue, we developed a custom Python script, based on valley recognition methods
described by Douglas (1986) and Lindsay (2006), that identiﬁed pixels of stream neighborhoods
using only lidar elevation values and burned those areas into the lidar DEMs. We deﬁned a stream
neighborhood as a diamond-shaped area centered on a low-lying cell, with higher elevations at both
ends of one axis (inferred as stream banks) and lower or similar elevations at both ends of the other,
perpendicular axis (inferred as the stream bed). Figure A2 represents the conceptual model of a
stream neighborhood. The cell labeled C is the low-lying center cell, M marks the cell with the
maximum elevation in the neighborhood, O refers to the cell opposite M at the other end of the axis,
whereas P1 and P2 refer to the ﬁrst and second elevations, respectively, along the axes perpendicular
to M and O.

Downloaded by [University of New Mexico] at 11:10 24 November 2014 International Journal of Geographical Information Science

1309

Figure A1. Vector stream data typically used to burn streams into DEMs cannot be utilized when
the DEMs positional accuracy is signiﬁcantly superior. (a) Aerial photograph of a drainage ditch. (b)
The area in (a) as represented by a lidar DEM, with a USGS DLG hydrography stream feature, is
misaligned with the stream location indicated by the lidar.
Data sources: Stream, USGS; DEM, OGRIP; aerial photo, ESRI.

Figure A2. Conceptual model of the stream neighborhood.

The script iterated through each cell in a lidar DEM and analyzed a square 121-cell neighborhood
(11 × 11) around the selected cell (C). It identiﬁed the maximum elevation value (M) within that
neighborhood and calculated the difference between that value and the elevation value of the selected
cell (M – C). If M – C was greater than a speciﬁed minimum elevation difference (MED), the script
then checked the value of the cell opposite M(O) to see whether the difference between its value and
C’s also exceeded MED. If both of these conditions were met, then the script deemed it possible that
C was a stream cell opposed by two stream banks. It then looked at opposing cells (P1 and P2) along
the axes perpendicular to M and O to see whether their elevations were below MED. If they were,
the script classiﬁed C and its entire neighborhood as stream cells and burned these into the DEM.
Essentially, if a cell had two relatively tall points opposing it, these may have been stream banks.
If the same cell had relatively ﬂat slopes in the direction perpendicular to the tall points, then these
may have been streambed cells. More formally,

Downloaded by [University of New Mexico] at 11:10 24 November 2014 1310

G. O’Neil and A. Shortridge

Figure A3. Results of the custom stream-burning approach applied to the lidar DEM. (a) Aerial
photograph indicating USGS DLG hydrography positioned well west of the stream’s actual location,
and not faithful to its geomorphology. (b) The custom approach better located the stream feature
and its shape. (c) Carving was needed to bridge gaps in the custom approach result; however, this
introduced new artifacts.
Data sources: Stream, USGS 1:24,000 DLG; aerial photo, Microsoft© Bing Maps.

IF(M − C) > MED
AND(O − C) > MED
AND(P1 − C) < MED
AND(P2 − C) < MED
THEN neighborhood = stream cell

(A1)

Based on an analysis of elevation values along stream banks and stream beds in the lidar DEMs, we
set MED equal to 1 m.

Overall, this approach to stream identiﬁcation performed adequately. Figure A3 illustrates the
outputs of the approach in a particular section of the Doylestown quadrangle. In Figure A3a, it is
clear that the USGS vector stream feature differs markedly with the actual stream, both in terms of
location and shape. Figure A3b illustrates how the custom approach described above did a better job
at locating the actual stream feature and representing its shape.

However, the approach did reveal limitations. It did not produce a contiguous stream network
in all locations. In the northern forested portion of Figure A3b, a clear gap exists in the derived
stream network. These gaps are mainly due to the nature of lidar data as a remotely sensed product.
As described in the main article, the airborne sensors that capture lidar elevations cannot capture
streambeds under bridges or culverts, and although the data used in this study are described as ‘bare
ground’ conditions (Woolpert 2007), we observed erratic elevation values in forested areas of the
quadrangle. It is possible that returns from tree canopies were erroneously included in the subsequent
DEM, making it difﬁcult for our custom approach to identify stream neighborhoods under these
canopies. Ultimately, these gaps created isolated stream features in the lidar DEM, which were treated
as sinks and ﬁlled ﬂat by the sink-ﬁlling routine. The inherent uncertainty in ﬂow direction estimates
in these perfectly ﬂat areas motivated us to exclude from the analysis any USGS DEM cell in which
its FF contained at least one ﬁlled lidar DEM cell, resulting in the removal of around 27% of USGS
DEM cells.

Downloaded by [University of New Mexico] at 11:10 24 November 2014 International Journal of Geographical Information Science

1311

In an effort to resolve some of these gaps, we implemented a modiﬁed version of carving (Soille
et al. 2003, Soille 2004a, b), whereby minimum elevations within the identiﬁed stream network seek
outward in an expanding radius (up to a speciﬁed threshold) for a lower elevation. If a lower elevation
value is found, a path is ‘carved’ from the starting elevation to the lower one, decreasing elevation
values at a constant rate along the path. Carving helped resolve some of the gaps in locations with
simple stream features, such as culverts like the one illustrated in Figure A1 and the artiﬁcial barrier
in the north-western portion of Figure A3c (note the thin single ‘carved’ line bridging the gap in the
stream network). However, it also produced artifacts of its own in areas with more complex features
such as intersecting drains and sinuous streams. In some areas, efforts to link drainage ditches created
carves that ran through road intersections, while in others carves attempted to circumvent the sinuous
curves of a stream for a straighter connection to lower elevation values (see the south-eastern portion
of Figure A3c). In other areas the distance needed to be carved was greater than the threshold of
the routine’s search radius, leaving the stream network disconnected and fated to be ﬁlled ﬂat during
sink ﬁlling. This situation is what caused the basin of the ditch running along the railroad tracks in
Figure 6 to be ﬁlled ﬂat and discarded from the analysis.

Our custom approach to burning stream locations into lidar DEMs is an unﬁnished product.
Further analysis is needed to identify optimum values for MED and to reduce the number of gaps
along the stream network. However, most of the areas where this approach introduced artifacts into
the lidar DEM were ultimately excluded from the assessment of ﬂow direction uncertainty. Where
they were included, the approach provided a much more positionally accurate and gemorphologically
honest representation of the stream network than the USGS DLG hydrography, allowing for a more
reliable re-enforcement of stream locations in the lidar DEM.

One of the challenges in implementing the conceptual model was identifying the Crast cells that
intersect each particular C, and the rast cells that make up the space between the FF and the Crast
cells. In the conceptual model, it was easy to assume that the boundaries of rast and RAST cells were
aligned; however, in application, we had to devise a way to automate a cell neighborhood intersection
routine within the Python script. As part of the data pre-processing, each RAST cell in the DEM was
assigned a unique identiﬁcation number. Next, each rast cell was assigned a non-unique identiﬁcation
number based on which RAST cell its center was located. When it was time to evaluate a particular
RAST cell, the script utilized the cell’s identiﬁcation number to select the pertinent Crast cells. FF was
then set at a speciﬁed number of rast cells (equal to a ﬂoored integer of one half the RAST resolution
divided by the rast resolution – in our example 10/0.76/2 = 6) outside of the edge cells of Crast to
yield the analysis neighborhood.

Downloaded by [University of New Mexico] at 11:10 24 November 2014 