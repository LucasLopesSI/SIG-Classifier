The Cartographic Journal
The World of Mapping

ISSN: 0008-7041 (Print) 1743-2774 (Online) Journal homepage: http://www.tandfonline.com/loi/ycaj20

Contouring by Use of a Triangular Mesh

M. H. Elfick

To cite this article: M. H. Elfick (1979) Contouring by Use of a Triangular Mesh, The
Cartographic Journal, 16:1, 24-29, DOI: 10.1179/caj.1979.16.1.24

To link to this article:  http://dx.doi.org/10.1179/caj.1979.16.1.24

Published online: 18 Jul 2013.

Submit your article to this journal 

Article views: 6

View related articles 

Citing articles: 7 View citing articles 

Full Terms & Conditions of access and use can be found at
http://www.tandfonline.com/action/journalInformation?journalCode=ycaj20

Download by: [Universite Laval]

Date: 06 May 2016, At: 17:21

Mosttechn£queswh£chderivecontoursfromspotheights,requ£reanintermed£ateprocedurewherebyasurfacere-presentedbyanarrayofdatapo£ntsspacedonaregulargridpattern,isfirstfittedtogroupsofpointsbeforethecontour.saredeterm£ned.Thisarticledescribesaprocesswherebycontoursmaybederiveddirectlyfromrandomlyd£stributedspothe£ghts,bytheuseofanirregulartr£angularlatticeofinterpolat£onlines.ContouringbyUseofaTriangularMeshM.H.ElfickUniversityofNewcastle,NewSouthWalesINTRODUCTIONThetechniqueof'gridding'scattereddataforthederivationofcontours,hasbeendevelopedmainlyforgeological,geophysicalandgeochemicalapplicationswherethedatapointsarescattered,andtheactualvaluesatthedatapointsareoftenimprecise.Therearemanywaysofevaluatingthemeshpoints,andafairlydetailedsummaryofmostofthesystemscurrentlyinusehasbeenpresentedbyLeber!.1Allrectangularmeshsystemsinvolvesurfacefittingtechniques,and,astheendproductisasimplificationoftheoriginaldatapattern,thecontourswillnothonourthedatapointsexactly.Withmanysurveyapplications,thevaluesofspotheightsareaccurate,andthepositionofthespotheighthasbeencarefullyselectedsothatlinearinterpolationbetweenthespotheightscanbeusedtointerpolatecon-tours.Thusasurveyororphotogrammetristshouldselectpointsatchangesofgrade,andalongfeaturessuchascreekbeds,thetopsandbottomsofbanksetc.,sothatthepositionofthedatapointsishighlysignificant.Ifatriangularlatticepatternisformedwiththecornersofeachtrianglebeingondatapoints,contourscanbedirectlygeneratedfromtheoriginaldatapointsusingthetriangularmeshtoindicateinterpolationlines.Theproblemthenconsistsoftwosections:firstthegenerationofatriangularmesh,andthentheuseofthismeshtogeneratecontourlines.TRIANGLEFORMATIONMETHODSThereareatleastfourbasicwaysofgeneratingatriangularmeshfromrandomdata.Onemethod(publishedbyIBMabout1966aspartofthedocumentationforacontouringsystemfortheIBM1620computer)involvestheformationofaseriesofregularpolygons,startingfromtheoutsideandworkingtowardsthemiddle.Whenallpointshavebeenincludedinthismanner,trianglesareformedbyjoining24pointsbetweenadjacentpolygons.Thesystemcanbeareasonablesolutionifthedataisfairlyregularindistribu-tion,andofanevenoverallshape.Anothermethodconsistsofbuildingtrianglesfromanadvancingfront.Hereallthedatapointsonsaytheleftsideoftheareaarefirstjoinedasacontinuousline,withbendsateachdatapoint.Thesedatapointsaretakentwoatatime,startingfromthebottomandworkingtothetopuntileachpairisconnectedtoaselecteddatapointtotherightofthefront.Thisformsanewfront,andthesystemisrecycleduntilallpointshavebeen.included.Againthesystemisreasonableforregulardata,butcanproduceunsuitableresultswherethereiswidevariationinthedensityofdatapoints.AmethoddescribedbyYoeli2generatesatriangularmeshbyconstructingtrianglesprogressivelyfromtheshortestunusedlinesegmentinaDTM,whileatthesametimeallowingfor'breaklines'ordiscontinuitiesintheterrain.Afourthmethod,tobedescribedinthispaper,buildsthetriangularmeshprogressivelyonthesidesofexistingtriangles,andhasbeendevelopedtominimisecomputercorememoryrequirementswhileatthesametimereducingtheexecutiontimeforthistypeofprocess.STRUCTUREOFCARTOGRAPHICSOFTWAREAdecisionwhetherornottoautomateanycartographicprocedureisoftenbasedonsimpleeconomics,andareasonforlimitedprogressinmanyareasisoftennotduetothecomplexityofthetask,butbecausetheacceptedexistingmanualsystemwillbepreferredunlessalternativescanbeproventobesignificantlycheaper.Manycomputerprogramssuitableforcartographicprocessesexist,butareseldomusedinaproductionenvironmentsincethecom-puterresourcestheyrequiremaketheiruseuneconomicforstandardcartographicapplications.TheCartographicJournalVol.16No.1June1979Downloaded by [Universite Laval] at 17:21 06 May 2016 StagesinoperationofCircularBufferAispointerforreadingBispointerforwritingfewpointsregardingthestructureofthebasicdatafiles.Mostdatapointshavecertainattributes,theymaybepointslyingontheedgeofabank,ortheymaybepointsabovethenaturalsurface,ortheymaybeontheouterlimitsofastockpile,etc.Thereforemosttopographicalfileswillhavebesidesthecoordinateandheightsforeachpoint,codestoindicateanyadditionalpropertiesofthepoint.Pointdataisgenerallystoredinarandomaccessfileusing(forasixteeenbitwordcomputer)12wordsperrecord,i.e.4forx,4fory,2forzand2forcodes.Whensortingthespotheightspriortothetrianglesformationphase,thesorttableneedonlycontaintheintegerxvalueandareferencetothediskfilelocationforeachpoint.Computercorerequirementsarethereforekepttoaminimum,andifmoredataisrequiredforanyparticularpoints(aswouldbenecessaryiftwopointshadidenticalxorxandycoordinates)thiscanbereadindirectlyusingthereferencestoredinthesorttable.Thefrequencyofsuchoperationsisgenerallyverysmallthereforesorttimeisnotsignificantlyincreasedbythistechnique.Followingthesort,therandomaccessfileisrewritteninthesameorderasthesortedpoints,andtheintegeryvaluewrittenintothesorttableinsteadoftherecordreferencewhichisnolongerrequired.Asimilarprocedureisusedinthetrianglesformationphase,whereifcertainpointshavecodeswhichmayneedtobeconsidered,e.g.iftheymayindicatetheedgeofanareaoutsidewhichcontoursarenottobeformed,thenthepointsconcernedareflaggedbynegatingtheintegeryvalueinthepointstable.Aspointsareselected,theintegervaluesofxandyareusedunlesstheyvalueisflagged,andonlyinthesecaseshasthefullrecordtobereadfromthediskfile.Asthediskfileisnowinthesameorderasthesortfile,thediskfilerecordisidenticaltothesortfilerecord.Thusthesearchforthemostsuitablepointforeachtriangleisdonemainlyincore,withoccasionalreferencetothediskfileofdata.Tofacilitatethetriangleformationprocess,a'CircularBuffer'isusedtoholddetailsoftriangleswhichhavebeenestablished,butareasyetincompletesincetheydonotreferencetheassociatedtrianglesoneachoftheirthreesides.Acircularbufferissimplyastorageareawhichisarrangedsothatnewrecordsarealwaysaddedtotheendofthegroupofrecords,andoldrecordsarealwaystakenfromthestartofthegroupofrecords.Twopointersareused,OUTLINEOFTRIANGLEFORMATIONPROCESSThisfourthmethodofcontouringfromatriangularmeshwasdevelopedmainlyfortheplottingandcontouringofstadiasurveysbyEngineeringComputerServicesin1967,afterafairlydetailedexaminationofalternativesystemswhichusedrectangular,squareandtriangulargridtechniques.Ithasbeendesignedtominimisecorerequire-mentsandcomputationaloverheadsandthebasicstepsareasfollows:1.Thecoordinatesarefirstconvertedtointegernumbers,intherange0to32000bysubtractingabasevaluefromeachcoordinate,andmultiplyingthenewco-ordinatesbyasuitablefactor.Thisoperationgivesaprecisionofabout1in32000.2.Thedatapointsaresortedinanx-ysort,thatis,pointsaresortedinascendingvaluesofx,andiftwoormorepointshavethesamexcoordinate,theyarethensortedinascendingvaluesofy.Atthisstagethezvaluesareonlyusedtodeterminewhetherpointswhichareveryclosetogethershouldbeconsideredasseparatepoints,orwhetherameanshouldbetakenandsubstituted.3.'Breaklines'(seeYoeli2bottomofpage104)ordis-continuitiesarecateredforpriortotheactualtrianglesformationbysimplyscanningalongeachbreaklineandaddingextradatapointsbylinearinterpolationinthosesectorswhereitwouldbelikelythatatrianglesidecouldbeformedacrossabreakline.4.Thepointnearestthecentreisusedasastartingpoint,itisjoinedtothenearestpointtoit,andthenthem?stsuitablepointtotherightlookingfromthefirstpo~nttowardsthesecondpointisselectedtoformthethirdpointofthefirsttriangle.Themostsuitablepointisthatwhichformsatrianglewithacircumscribingcircleofminimumradius.5.Thethreesidesoftrianglenumberonearelookedatinturnandtrianglesestablishedonthem.Thisprocedureisthencontinuedthroughalltriangles,i.e.workingfromthelowestnumberedtriangletothehighestnumberedtriangle,withnewtrianglesbeingestablisheduntilnomoretrianglescanbecreated.Thesixteenbitminiandmicrocomputerscurrentlyavailablecanprovidesufficientcomputingpoweratlowenoughcostformanycartographicapplications,providedthatthecomputerprogramsarestructuredforuseonthistypeofequipment.Themainpointstobeconsideredare:1.Theprogramsshouldbedesignedinamodularfashion,witheachmodulebeingassmallasconvenientlypossible.2.Theproblemshouldbebrokenintologicalphases,andeachphasecompletedbeforestartingthenextphase.3.Asanaccuracygreaterthan1:30,000attheplotscaleisseldomrequired,integernumbershouldbeusedfordatavalues,andintegerarithmeticusedforcomputa-tionswheneverpossible.4.Byusingdoublebufferingtechniquesfordiskaccess,itispossibletohandlelargeamountsofdatausingaminimumofmainmemory,whileatthesametimenotsignificantlyincreasingtheexecutiontimeforanyprocess.DATAMANIPULATIONTECHNIQUESBeforediscussingthecriteriausedfortheselectionofthebestpointforeachnewtriangle,itisworthconsideringaSoonafterst;trt,Recordswrifren8Recordswritten'RecordsreadFigure1.16Recordswritt~n10Recordsread25Downloaded by [Universite Laval] at 17:21 06 May 2016 onetoindicatewheretowriteto,andonetoindicatewheretoreadfrom.Aftereachreadorwrite,thepointerissettothenextlocationinthestoragearea,andifthepointerhasreachedtheend,itisresettothestart.Thusthebufferiscircularinconcept.Ifthereadpointercatchesthewritepointer,thebufferisempty,ifthewritepointercatchesthereadpointer,thebufferhasoverflowed.Thecircularbufferusedinthetriangleformationprocesshassixwordrecords,witheachrecordcomprisingthethreepointnumbersfortheapexpointsinthetringleandthetrianglenumbersfortheassociatedtriangles.Aseachtriangleisformedandcompleted,itsrecordiswrittenawayusingtheoriginalcoordinatesofthethreepoints(asreadfromthepointsfile)plusthethreeassociatedtrianglereferences.Thetrianglesformationphaseisonlyconcernedwiththerelativelocationofpointswithrespecttoeachother,sosixteenbitintegerarithmeticismorethanadequate.Thereforethefinalfilehasdataofthesameprecisionastheoriginaldatafileofpoints,onlyitisstructuredinaformmoresuitableforcontouringsincetherelationshipofpointsandlinesofinterpolation(thetriangles,associatedtrianglesandtrianglesides)areincorporated.Eachtrianglerecordiscompletesothereisnoneedtoreferenceanyotherfilesduringthecontouringphase.TRIANGLESELECTIONThesearchforthemostsuitablepointfortheformationofatrianglehasbeenarrangedtominimisecomputeroverheads.Amaximumsearchrangeissetforbothxandyinthepositiveandnegativedirection,andthesearchmovesbackupthefilefrompointAsequentially.Eachpointisfirstcheckedtoseeifitisoutsidethesearchboundineitherxory,andifitisnot,anewsearchboundiscomputedbyfindingthecircumscribingcirclethroughA,Bandthepoint.Thelimitsofthiscircleareusedtoreducethesearchlimit,i.e.ifthecircleislessthantheoldboundinanydirection,theboundisdecreased.Onlypointstotherightofthelineareconsideredandassoonasapointisfoundoutsidethelimitthesearchisdiscontinuedinthenegativedirection,andstartsinthepositivedirectionfrompointAagainwiththesameconditionsbeingsetuptolimitthesearcharea.Asthepointshavealreadybeensortedinorderofxandy,thesearchprocessisquiteshortsincetherequiredpointisgenerallywithinthefirst6pointsexamined.Thelastpointwhichsatisfiesthecriteriaisadopted,andthisformsatrianglewithacircumscribingcircleofmini-mumradius.EXAMPLEOFTRIANGLEFORMATIONToillustratetheprocessesofbuildingthetable,considertheestablishmentoftriangles7and8fromtriangle3.Atthecommencementofthiscyclerecords1and2willbeclear(althoughthepreviousentriesareshownindottedform)andrecords3,4,5and6containdetailsoftriangles3,4,5and6respectively.Theremainingrecordsareclear.Firstrecordsinthebufferareexaminedstartingatthelastcompletedtriangleandcontinuinguntilanincompleterecordisfound.Ifintheprocess,anycompletedrecordsarefound,theyarewrittentotheTrianglesFileandtherecordclearedforfurtheruse.ThesideBCisexaminedandifthereisnoexistingassociatedtriangle,themostsuitablepointtotherightof263Figure2.LayoutsofPointsandTriangles.thesideCBisselected(inthiscasepoint5),andanewtrianglecreated.Associatedtrianglenumbersarewrittenintheappro-priateplaces.Astriangle3isanassociatedtrianglefortriangle7,referencetotriangle3iswrittenintherecordfortriangle7,andreferencetotriangle7writtenintherecordfortriangle3.Thenewpoint(point5)ischeckedtoseeifithasbeenusedbefore.Ifnot,itisflaggedbymeansofabitarray(inthiscasebit5ofthebitarrayischecked)andasthepointhasbeenusedbeforeintheformationoftriangle6,bit5willalreadybeset,andthereforeasearchmustbemadefortheassociatedtriangle.RecordAssociatedTrianglesPointNumbersNumber·~ll:i263FirstSecond7hird1~?.~".:.!.f."'1(~:~:21&::Jo"ff,~.9..':,.317867241106852910126279573G275836249Figure3.DetailsheldinCircularBufferafterformationoftrianglenumberthree.Bysearchingupanddownthetrianglesbuffer,acheckcanbemadeifanassociatedtriangleexists,i.e.thatthelineoccursinthepointnumbersectionofanothertrianglerecord.Inthiscasetheline5-7isfoundintherecordfortriangle6,sotherelationshipofassociatedtrianglesismadebothintriangle6andtriangle7recordsintheircorrectpoisition.Theremainingside(C-A)isthencheckedandpoint4selectedtoformtrianglenumber8.Thisrecordisthensetupinthebuffer,andaspoint4hasnotbeenusedbefore,theonlyactionnecessaryistoentertheassociatedDownloaded by [Universite Laval] at 17:21 06 May 2016 trianglenumbersforpointAinrecord8,andpointCinrecord3.Astriangle3isnowcomplete,therecordisfirstwrittenawaytoadiskfile,thenclearedfromthetrianglebufferbeforethecyclestartsagainonthenexttrianglerecord.Checksaremadethatthepointselectedcannotcausethetrianglestooverlap(ascouldpossiblyoccurfromgriddeddata)aswellaslimitingtheshapeofthetrianglestopreventbadlyconditionedtrianglesbeingformedatboundarylocations.CONTOURINGFROMTRIANGULARMESHTheprocessisbrokenintothreebasicstages;theextractionofpointsoneachcontourline;thejoiningofthepointsinlogicalorder;andfittingacurvethroughthemtoformacontourline.Aseachtrianglerecordhasreferencetothethreeassoci-atedtriangles,thecontourlinecutsonthesidesofeachtrianglecanbecomputedeitherbylinearinterpolationbetweenthevaluesoftheendpointsofeachlineineachtriangle,orbytheuseofamoreelaborateprocedureentailingthefittingofasurfacetothesixpointsdefinedbytheapexpointsofeachtriangleandthethreeassociatedtriangles.Theinterpolationprocessshoulddependentirelyonthenatureoftheoriginaldata,andthetypeofresultrequired.Iftheoriginaldatasamplingwassuchthattheinformationwaschosenatpointsofchangeofgrade,e.g.stadiasurveys,etc.,linearinterpolationisprobablythebestsolution.Ifthedatasamplingpatternwaschosenforotherreasons,e.g.magneticorgravitydata,asurfacefittingtechniquemaybemoreappropriate.Anysurfacefittingtechniqueshoulduse4datapointsconsistingofthethreepointsatthecornersofthemaintriangle,andtheapexpointontheassociatedtriangleadjacenttothesideofthetriangleunderinspection.Foreachcontourlevel,theTrianglesFileisreadsequentiallyandthethreesidesofeachtriangleeachexaminedtoseeifthecontourpassesthrough,andifsothecoordinatesoftheintersectionpointarestoredinatabletogetherwithreferencestothetriangleslyingoneachsideoftheline.Topreventthesamecontourcutbeingstoredtwice,acheckismadethroughthetabletolookforasimilarpreviousentry,inwhichcasethecoordinatesarenotstored.Likethetrianglesphase,thecoordinatesstoredareinintegerformwithintherange0to32000givingampleprecisionforplottingpurposes.Ifthereadingofthetrianglesfileforeachcontourleveliscarriedoutusingadoublebufferedtechniqueextractingsay10trianglesatatimefromthecomputerdisk,littledelayiscreatedsinceeachtrianglerecordisgenerallyincorebythetimeitisneeded.Contoursareoftwobasicforms,i.e.opencontours,whichstartatoneborderofthesheetandcontinuetoanotherborder,andclosedcontourswhichformaloop.IntheformationoftheTrianglesFile,thosetrianglesontheedgeofthedataareaweregivenanassociatedtrianglenumberof0foreachsidewithoutanassociatedtriangle.Thereforetheendsofopencontourlinescanbereadilydeterminedbysimplylookingdownthetableofcontourcutslookingforazeroineitherofthetwotrianglereferenceforeachrecord.Theprocedureforextractingthepointswhichsequen-tiallyformacontourstringcommenceswithopencontourclines.Onceanendpointisfound,thenextpointinthesequenceisfoundbylookingforarecordwhichhasatrianglereferencethesameasthenon-zeroreferenceintheendpointrecord.Forthethirdpointasearchismadeforarecordwithatrianglereferencewhichmatchesthealterna-tivetrianglereferenceinthesecondrecord.Thisprocessiscontinueduntilazeroisfoundinthealternativereference,whichindicatestheendofthatcontourline.OrderofTriangleCo-ordinatesExtractionfromTableReferencesXy41·26806G413141471125921838553657167375316642252663226731134107711518698958995344G7G701158211210167817456310915659243851130420G8364213125142801631205161849911161574824021Figure4.Aseachcontourcutisextractedfromthetable,theentryiscleared.Therecanbemorethanoneopencontourpercontourlevel,sothesearchforopencontourlineshastocontinueuntilnozerotrianglereferenceexists,atwhichstageitcanbesafelyassumedthattheremainingcontourcutsrefertoclosedcontourloops.Thereareseveralotherminorpointstoconsiderintheabovevariousprocesses.Whereadatapointisexactlyequaltoacontourvalue,thecontourintheorywouldpassthroughthepointandconfusioncouldexistastotheassociatedtrianglesoneachsideofthecontourcut.Toovercome27Downloaded by [Universite Laval] at 17:21 06 May 2016 SectionofStadiaPlotbyN.S.W.DepartmentLands.PlottedonCalcomp745Plotter.Notesurv~yorhasselected~arametersforthecontourswhichgiveanangularshape-thisisprobablyatrialplot-oroneforvolumescalculation.MatchthetrIangleplotonthelineA-B.Notehowextratrianglesareformedoverthediscontinuitiesorbreaklines.this,acheckforthisconditionshouldbemade,~ndifthedatapointdoesequalthecontourvalue,theheIghtvalueofthedatapointisslightlyincreasedforthepurposeofdeterminingwhichsidesofthetrianglethecontourwillcut,butthecoordinatesofthecontourcutareleftasthecoordinatesofthedatapointitself.Thisinturncancreateanotherproblemduringthefittingofacurvetothecontourcuts,sinceitispossiblethatseveralpointscouldhaveidenticalcoordinates.Acheckthereforehastobemadebetweeneachpointanditsprecedingpoint,andiftheyaretooclose,thenewpointisnotusedinthecontourline.Thehandlingofclosedloopswilldependonthemethodofcurvefittingemployedforthedrawingofthecontourline.Ifa'fourpointfit'techniqueisused,thefirstthreepointshavetobe'saved'sothattheycanbeusedtoclosethecontour.Todothisacountercanbesettozeroatthestartofeachcontour,andincrementedwitheachpoint.Foropencontourstheentriesarezeroedregardlessofthestateofthecounter,whereaswithclosedcontours,theentriesareonlyclearedifthecounterisgreaterorequalto4forafourpointfit,6forasixpointfit,etc.28SUMMARYThedevelopmentofcomputerprogramsforcartographicapplicationsisataskrequiringsomeexpertiseinprocesscontrolandlogicalthinkingratherthanspecialisedmathe-maticalability.Manyprogramsbasedonsoundmathematicalconceptshavefailedtobeofuseinthepracticalworldbecausetheyweretoocumbersomeandinvolvedandrequiredconsider-ablecomputerresourcesfortheiroperation.Itisessentialtoselecttheappropriatecontouringtechniqueaccordingtothetypeanddistributionoftheoriginaldata,andtheprocessdescribedcanprov~deacosteffectivesolutionfordatatypesnotgenerallySUItablefor'gridding'techniques.REFERENCES1.F.Leber!,InterpolationinsquaregridDTM,TheITCJournal,1974.2.P.Yoeli,ComputerExecutedInterpolationofContoursintoArraysofRandomlyDistributedHeightPoints,TheCarto-graphicJournal,Dec.1977.Downloaded by [Universite Laval] at 17:21 06 May 2016 SectionofStadiaPlotbyN.S.W.DepartmentLands-layoutoftriangles.LandClassificationMapsAnewseriesofmaps,derivedfromtheprovisionallandclassificationmapswhichwerepublishedin1974atascaleof1:63360,hasbeenpublishedbytheMinistryofAgriculture,FisheriesandFood.Thenewmapsareatascaleof1:250000,theseriescomprisingsevensheetscoveringtheMinistryofAgricul-ture,FisheriesandFood(MAFF)regionsofEnglandandWales)andareavailablefromMAFF(Publications),TolcarneDrive,Pinner,Middlesex,HA52DT.ThesemapshavebeenpreparedbytheAgriculturalDevelopmentandAdvisoryServiceoftheMAFFwhoareconcernedwithidentifyingagriculturallanduseastoitslongtermcharacteristicswithinfivecategories,aswellasthatlandtakenupbyurbanandothernon-agriculturallanduse.InternationalCartographicAssociationTENTHINTERNATIONALCARTOGRAPHICCONFERENCE,TOKYO,1980TheSecondCircularinconnectionwiththismeetingisexpectedtobeavailableduringthesummerof1979andanymembersoftheSocietywhomaybeattendingbuthavenotyetindicatedtheirinterestshouldgetintouchwithMrD.J.H.GriffinattheRoyalSociety,6CarltonHouseTerrace,LondonSWIY5AG.TheRoyalSocietyistryingtoobtainreducedtravelconcessionsandexpecttohaveaverylimitednumberoftravelgrantsavailable.29Downloaded by [Universite Laval] at 17:21 06 May 2016 