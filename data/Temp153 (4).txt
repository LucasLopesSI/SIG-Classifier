This article was downloaded by: [New York University]
On: 29 May 2015, At: 06:25
Publisher: Taylor & Francis
Informa Ltd Registered in England and Wales Registered Number: 1072954 Registered
office: Mortimer House, 37-41 Mortimer Street, London W1T 3JH, UK

International Journal of Geographical
Information Science
Publication details, including instructions for authors and
subscription information:
http://www.tandfonline.com/loi/tgis20

Multistate supernetwork approach to
modelling multi-activity, multimodal
trip chains
T. Arentze a & H. Timmermans a
a Eindhoven University of Technology , Urban Planning Group ,
PO Box 513, NL-5600 MB Eindhoven, the Netherlands E-mail:
Published online: 06 Oct 2011.

To cite this article: T. Arentze & H. Timmermans (2004) Multistate supernetwork approach
to modelling multi-activity, multimodal trip chains , International Journal of Geographical
Information Science, 18:7, 631-651, DOI: 10.1080/13658810410001701978

To link to this article:  http://dx.doi.org/10.1080/13658810410001701978

PLEASE SCROLL DOWN FOR ARTICLE

Taylor & Francis makes every effort to ensure the accuracy of all the information (the
“Content”) contained in the publications on our platform. However, Taylor & Francis,
our agents, and our licensors make no representations or warranties whatsoever as to
the accuracy, completeness, or suitability for any purpose of the Content. Any opinions
and views expressed in this publication are the opinions and views of the authors,
and are not the views of or endorsed by Taylor & Francis. The accuracy of the Content
should not be relied upon and should be independently verified with primary sources
of information. Taylor and Francis shall not be liable for any losses, actions, claims,
proceedings, demands, costs, expenses, damages, and other liabilities whatsoever
or howsoever caused arising directly or indirectly in connection with, in relation to or
arising out of the use of the Content.

This article may be used for research, teaching, and private study purposes. Any
substantial or systematic reproduction, redistribution, reselling, loan, sub-licensing,
systematic supply, or distribution in any form to anyone is expressly forbidden. Terms
& Conditions of access and use can be found at http://www.tandfonline.com/page/
terms-and-conditions

INT. J. GEOGRAPHICAL INFORMATION SCIENCE
VOL. 18, NO. 7, OCTOBER-NOVEMBER 2004, 631–651

Research Article

Multistate supernetwork approach to modelling multi-activity,
multimodal trip chains

T. ARENTZE and H. TIMMERMANS
Eindhoven University of Technology, Urban Planning Group, PO Box 513,
NL-5600 MB Eindhoven, the Netherlands; e-mail:
H.J.P.Timmermans@bwk.tue.nl

(Received 20 November 2002; accepted 2 December 2003 )

Abstract. Least-costs path ﬁnding methods belong to the standard toolkit of
information science and allow one to assign trips with known
geographical
origin and destination to a transport network. An extension of the network
representation is proposed that allows one to model complete trip chains (tours)
that may involve multiple transport modes and multiple activities, as a least-cost
path through the network. The extension is based on the notion that link costs
may change as a consequence of activity and vehicle choices during the tour. The
extended network or supernetwork contains as many copies of the network as
there are possible activity–vehicle states and additional state transition links to
interconnect them. In this way, not only the generalized link cost function, but
also the start and end points of a path can be deﬁned state dependently. A least-
cost path through a multistate network deﬁnes an optimal sequence of travelling,
transferring, parking, conducting activities and dropping off products of
activities. An application shows how a multistate network can be constructed
and used to assess the impacts of network design variables on path choice.

1.

Introduction
Over the last 5 years, the so-called activity-based approach has become the
dominant approach in academic research to predict travel demand and it is
gradually replacing trip-based approaches (Timmermans et al. 2002). The activity-
based approach is based on the premise that transport is generated by the conduct
of activities in time and space. Activity-based models predict which activities will be
conducted where, when, for how long, with whom and the transport modes
involved.

The rapidly growing interest in activity-based models has also stimulated
innovating research in geographical
information science (Miller 1998). The
complexity of activity-based models requires new or more efﬁcient architectures
of data storage and data retrieval. The application of activity-based models to
simulate trafﬁc ﬂows may require adjusted computational algorithms. In addition,
the visualization of activity–travel diary data constitutes an important research
challenge. Consequently, the ﬁrst papers on these and related topics have appeared

International Journal of Geographical Information Science
ISSN 1365-8816 print/ISSN 1362-3087 online # 2004 Taylor & Francis Ltd
http://www.tandf.co.uk/journals
DOI: 10.1080/13658810410001701978

Downloaded by [New York University] at 06:25 29 May 2015 632

T. Arentze and H. Timmermans

in the literature. For example, Wang and Cheng (2000) proposed an interesting
data model for storing activity–travel data, Miller and co-workers (Miller 1999,
Miller and Wu 2000, Wu and Miller 2002) developed tools to measure accessibility
in a space–time context, while Kwan (2000) and Kwan and Lee (2004) suggested
various visualization tools.

The present paper is concerned with the modelling of tour choice. Traditional
trip-based transportation models have been widely applied in geographic
information systems to model trips and determine trafﬁc ﬂows on a transport
network. The choice facets of trips relevant in traditional travel demand modelling
include trip generation, destination, transport mode and route. Efﬁcient methods
exist to compute the least-cost path of a trip through a network when the origin,
destination and transport mode of the trip are known. An example of a widely used
shortest-path method is the Dijkstra algorithm (Cormen et al. 1990), which
calculates for a given origin the least-cost paths to all other nodes of the network.
Other facets of
the trip are not captured. While this does not represent a
shortcoming of traditional models of transport demand, activity-based models
attempt to represent the interdependencies and interrelationships between various
facets of travel demand, and hence a different representation scheme may be
preferred.

One such representation is the so-called supernetwork (Shefﬁ 1985, Nagurney
and Smith 2003). The aim of a supernetwork approach is to enrich the
representation of networks such that trip facets other than route can be modelled
simultaneously as a path through the network. Following this approach,
multimodal networks have been proposed that combine networks for private
modes (car and bike) and public modes (train, bus, etc.) and include special links to
interconnect them. The special links represent stations where one can board lines of
public transport. A path through the network including such a transfer link then
describes a multimodal trip, that is a trip involving one or more mode switches.
Examples of applications of
trips are
Southworth and Peterson (2000), Benjamins et al. (2002), Carlier et al. (2003)
and Lo et al. (2003).

to model multimodal

supernetworks

Nagurney and Smith (2003) explore the potential of the supernetwork approach
to model a wider
individuals or
range of decision-making behaviour of
organizations. They argue that networks in societies and economies are not limited
to physical networks, where nodes coincide with locations in space, but also
comprise more abstract networks such as economic and ﬁnancial networks, social,
and knowledge networks. The links in such more abstract networks may represent
transactions and communications. Since in many cases possible solutions of a
decision problem involve a path combining physical and non-physical links, the
supernetwork approach is proposed to model decision-making in such cases. In
several studies, Nagurney and co-workers show applications of this approach to
decision problems such as the choice between telecommuting and commuting
(Nagurney et al. 2002), the choice between teleshopping and shopping (Nagurney
et al. 2001), producer and consumer behaviour in supply chain networks (Nagurney
and Toyasaki 2003) and transactions in ﬁnancial networks (Nagurney and Ke
2002). Because multiple decision criteria can be incorporated in generalized link
cost functions, a supernetwork model can also be used in the study of multicriteria
decision-making. Xu et al. (2003) apply a supernetwork approach to model regional

Downloaded by [New York University] at 06:25 29 May 2015 Multistate supernetwork approach to modelling multi-activity, multimodal trip chains 633

freight movement integrating the ﬁnancial, informational, logistical and physical
aspects of transportation networks.

This generalization of the concept of supernetworks offers a perspective to
extend the choice facets in models of individual’s activity–travel behaviour. To date,
existing (super)network models consider travel behaviour exclusively at the trip
level, limiting their relevance for activity-based approaches. In reality, trips are part
of a tour, i.e. a circuit of trips starting at home (or some other base location) and
ending at home with the aim to conduct one or more activities involving one
or more locations. As several empirical studies have indicated, a substantial
proportion of tours involves more than one activity and sometimes more than one
location (Hanson 1980, O’Kelly 1981, Thill and Thomas 1991, Dellaert et al. 1998,
Arentze et al. 2000). Clearly, the trips involved in such tours are interrelated and,
therefore, cannot be modelled independently. At least, the mode chain and sequence
of locations should be consistent with logical and situational constraints. This is
one of the reasons, acknowledging these interdependencies, why more recent
approaches to travel demand modelling have made the transition from trip-
to activity-based models. Yet, to the best of the present authors’ knowledge,
supernetwork representations allowing one to model tours as least-cost paths
through a network do not exist.

The purpose of the present study is to ﬁll this gap. To represent multi-activity,
multimodal tours, the concept of a multistate network (MSN) is introduced. In an
MSN, the transport network is copied as many times as there are possible activity–
vehicle states during a tour. An activity state describes which activities have been
conducted and which activities still need to be performed, whereas a vehicle state
deﬁnes the current locations of available private vehicles for the tour. Activity–
vehicle state copies of the network are interconnected at locations (nodes) where an
activity can be conducted or a vehicle can be parked. When using an activity link or
a vehicle–park link, the individual stays at the same location, but transfers from one
state to another. Deﬁned in this way, an MSN resembles so-called shadow networks
or space–time expanded networks that have been used for departure time
modelling. An MSN and shadow network both use different copies of the original
network interconnected by activity–travel decisions of an individual. In shadow
networks, the copies represent the network during the peak and off-peak periods,
respectively (Van Vuren and Davies 1992, Al-Azzawi 1997, Van der Zijp and
Lindveld 2001), whereas in an MSN the copies relate to different activity–vehicle
states.

An MSN opens the possibility to specify state-dependent cost functions for the
same transport links. For example, in the state in which a shopping activity has
been completed, the costs assigned to bike and walk transport links can be
increased to account for the extra effort involved in carrying bags when using these
modes in that state. In addition, an MSN opens the possibility to deﬁne the start
and end point of a path state dependently. A complete tour can be represented as a
path from home to home between the state where none of the planned activities has
been conducted and the state where all activities have been conducted and vehicles
are returned home. In general, a path through an MSN describes a multimodal,
multi-activity tour and the associated aggregate generalized costs represent the
aggregate disutility caused by travel times, waiting times, search times and activity
times included in the path.

Downloaded by [New York University] at 06:25 29 May 2015 634

T. Arentze and H. Timmermans

To introduce and illustrate MSN models, the paper is structured as follows.
Section 2 describes a method for constructing an MSN for modelling multimodal,
multi-activity tours. Section 3 then discusses how state-dependent generalized costs
functions can be speciﬁed for the links in an MSN. In real-world problems, the
number of activity–vehicle states and hence the supernetwork representation can
become very large. Therefore, Section 4 considers the size of the network as a
function of parameters of the tour choice problem considered and discusses
implications for applications. A case study is carried out to show how an MSN can
be speciﬁed and used to assess the possible impacts of network design variables.
Section 5 describes the assumptions and results of scenario analyses. Finally, the
paper concludes with summarizing conclusions and discusses the potentials of the
model and avenues of future research.

2. Constructing a multistate network

The MSN model assumes as given an individual who has decided to make a
tour for conducting one or more out-of-home activities. The following will use the
term ‘activity programme’ to refer to the activities to be conducted on the tour. An
MSN is designed to model all relevant choice facets of a tour simultaneously. These
include the following:

. Choice of activity sequence.
. Choice of activity locations.
. Choice of parking locations.
. Choice of intermediate trips to drop off products of activities.
. Choice of mode and mode transfers.
. Choice of route.

Assuming the general case of multimodal trips, the ﬁrst step in constructing an
MSN is to transform single-mode networks into a multimodal network. This
requires the addition of extra links representing boarding and transfers between
lines of public transport, as shown for an example in ﬁgure 1. In the example, there
are two transit lines and two stations. In station 1, boarding is possible on both
lines 1 and 2, and in station 2 boarding is possible only on line 1. The bottom part

Figure 1. Representation of a transit network.

Downloaded by [New York University] at 06:25 29 May 2015 Multistate supernetwork approach to modelling multi-activity, multimodal trip chains 635

of ﬁgure 1 shows a detailed representation of the same system. Line-speciﬁc nodes
1.1, 1.2 and 2.1 are added and connected with the rest of the network through
boarding/alighting links (1 to 1.1, 1 to 1.2 and 2 to 2.1) and a transferring link (1.1
to 1.2).

The home location, activity locations and parking locations are situated at
nodes on the network. The multimodal network including these locations
constitutes the building blocks of an MSN. The remainder of this section discusses
the assumed activity and vehicle states, the corresponding state transition links, and
integration of the links in a network, respectively.

2.1. Activity and vehicle states

Each state represented in an MSN consists of a combination of an activity state

and a vehicle state. Therefore, the number of relevant states is given by:

j~ S.j

j| S?j

j,

Sj

ð1Þ
where S . and Sp are the sets of possible activity states and possible vehicle states,
respectively. For each activity, the MSN considers three possible states. The
activity: (1) has not yet been conducted, (2) has been conducted and its product is
being carried, and (3) has been conducted and the product has been dropped off
somewhere (e.g. at home). Examples of activity products include shopping goods
and being accompanied by someone else. The latter is an example of a product of
picking-up a person. Thus, a speciﬁc activity state can be speciﬁed as:

(cid:1)
s.~ :::, s.

a, :::

(cid:2) s.
a

~0, 1, 2,

ð2Þ

where a is an index of activity and the levels denote the states of not yet conducted
(s~0), conducted with product (s~1) and conducted without product (s~2). If A is
the number of activities in the programme, then |S .|~3A,
if the sequence of
activities is free to choose, and |S .|~221(Az1)(Az2) if the sequence is predeﬁned.
The product state is not necessarily relevant for every type of activity. For example,
for shopping and bringing/getting persons/goods, it generally is, and for working,
school, social, and leisure activities, it generally is not. Hence, the actual number of
activity states will be smaller in speciﬁc applications.

Similarly, the set of vehicle states consists of combinations of possible states of
the private vehicles considered as optional for the tour. Therefore, a vehicle state
can be written similarly as:

(cid:1)
s?~ :::, s?

m , :::

(cid:2)

s?
m

~0, 1, 2, . . . , Pmz1,

ð3Þ

where m is an index of a private vehicle for travelling (e.g. car or bike) and Pm is the
number of parking locations considered for vehicle m. For each vehicle, the possible
states include: the vehicle is staying at home (s~0), the vehicle is currently used for
travelling (s~1) and the vehicle is currently parked at location i (s~2, …, Pmz1).
The number of possible states on this dimension is smaller than the number of all
possible combinations. It is assumed that no more than one vehicle is in use at a
time, so that s?
m > 0 for each m. Therefore, the number of
possible mode states is given by:
S?j

j~1zMz X
where M is the number of private vehicles. The ﬁrst element on the right-hand side
corresponds to the state where all vehicles are at home, the second element

m0 ~0, Vm0=m if s?

Pm,

ð4Þ

m

Downloaded by [New York University] at 06:25 29 May 2015 636

T. Arentze and H. Timmermans

represents the number of states where one of the vehicles is on the road and the last
element represents the count of states in which one of the vehicles is parked at some
location.

2.2. Deﬁnition of an MSN

As conventional transport networks, an MSN can formally be represented as a
directed graph G~(N, L), where N is a set of nodes and L is a set of directed links.
In contrast to conventional networks, however, G includes a copy of each physical
link for each possible state in which the link is accessible, and a set of state
transition links. As a consequence, the set of nodes is deﬁned as:

N~ [

Ns,

s

ð5Þ

where Ns is the subset of physical nodes accessible in state s and S
of sets across s, and the set of links as:
L~ [

s |LS,
LT
ð6Þ
is the subset of physical links accessible in state s and LS is a set of state
where LT
s
transaction links. In states where some private vehicle m is currently used for
~1), only the nodes and links accessible for m are included, and in
travelling (i.e. s?
m
=1, Vm), only the nodes and links
states where no private vehicle is in use (s?
m
accessible for walking and transit are represented.

s Ns is the union

s

Formally, a transport or state transition link can be deﬁned as:

(cid:1)

(cid:2),

d, x

o, s.

d , s.

l~ io, id, s?

o , s?
where io and id are identiﬁers of the origin and destination node of the transport
network, so and sd deﬁne the origin and destination state of the link using the
format given by equations (2) and (3), and x is a vector of link attributes. A
transport link never results in a state change and always results in a node change, so
that a link of that type is deﬁned as the special case of (7) where so~sd and io|id.
On the other hand, a state transition link always makes a connection between the
same physical nodes and necessarily results in a state change, so that it is deﬁned as
the special case of (7) where so|sd and io~id.

ð7Þ

2.3. State transition links

vehicle states distinguished:

The following set of state transition links sufﬁces to interconnect all activity–

. Leaving/returning home by private vehicle m.
. Parking/getting vehicle m at location i.
. Conducting activity a at location i.
. Dropping off activity products.

Figure 2 illustrates each link schematically. Leaving home by m represents a
decision to use private vehicle m for travelling (while not excluding the possibility of
a mode change during the tour). This can take place when the person is at home in
any activity state. Therefore, the set of links of this type are deﬁned as:

Þ, s., s.
ð8Þ
where h is the home-location node, Le(sp) deﬁnes an operation on sp involving

~ h, h, s?, Le s?ð

Þjs?~ 0, :::, 0
ð

Þ, s. [ S.

LL
m

g,

f

ð

Downloaded by [New York University] at 06:25 29 May 2015 Multistate supernetwork approach to modelling multi-activity, multimodal trip chains 637

Figure 2. State transition links in an MSN.

setting s?
m
therefore, is deﬁned as:

~1. Returning home by m is the same link type in reversed direction and,

LR
m

~ h, h, Le s?ð

f

ð

Þ, s?, s., s.

Þjs?~ 0, :::, 0
ð

Þ, s. [ S.

g:

Parking a vehicle m at location i is deﬁned as:
Þ, s., s.

~ i, i, s?, Pa s?, m, i

(cid:3)

ð

ð

LP
m,i

Þjs? [ S?

m~1, s. [ S.

(cid:4),

ð9Þ

ð10Þ

where i is a speciﬁc parking-location node, Pa(sp, m, i) deﬁnes an operation on sp
~i, and S?
where the vehicle state is set to s?
m~1 is the set of vehicle states where
m
s?
m

~1. Getting m from i is the same link in reversed direction deﬁned as:

LG
m,i

(cid:3)

~ i, i, Pa s?, m, i

ð

ð

Þ, s?, s., s.

Þjs? [ S?

m~1, s. [ S.

(cid:4):

ð11Þ

Conducting activity a at location i is deﬁned as:

(cid:3)

(cid:4),

ð

Þ

a~0

LA
a,i

Þjs? [ S?

=1, s. [ S.

~ i, i, s?, s?, s., Ac s., a

=1, for all m, and S.

ð12Þ
ð
where i is a location node where activities of type a can be conducted, Ac(s., m, i)
deﬁnes an operation on s. whereby the activity state is set to s.
=1 is the set of
a
vehicle states where s?
a~0 is the set of activity states where
m
~0. Note that the condition for origin vehicle state implies that an activity can be
s.
a
conducted only after having parked the private vehicle or when all private vehicles
are staying at home. Note furthermore that the deﬁnition implies that an activity
always results in a state where the activity product is being carried. Finally,
dropping off activity products is deﬁned as:
LD~ h, h, s?, s?, s., Dr s.ð

Þjs? [ S?

~1, S?

(cid:4),

(cid:3)

ð

Þ

=1, s. [ S.

where Dr(s.) is an operation on s. whereby the activity state is set to s.
a
where s.
a
~1, and S.
s.
a

Aa~1 is the set of activity states where s.
a

Aa~1 is the set of activity states where s.
a

~1, and S.

~1 for at least one a.

Aa~1

ð13Þ
~2, for all a,
~2, for all a, where

Downloaded by [New York University] at 06:25 29 May 2015 638

T. Arentze and H. Timmermans

Several implications of this deﬁnition are worth noting. First, products can be
dropped off only at home. In speciﬁc applications, one may relax this assumption
and include in the location choice set other locations as well, such as, for example,
the car (i.e. place where the car is parked). Second, the products of all activities that
have been conducted are always dropped off
In speciﬁc
applications, other assumptions may be appropriate. Now, the total set of state
transition links can be deﬁned as:

simultaneously.

LS~ [

[

LL

m|

m

LR

m|

m

[

LP

m,i|

m,i

[

LG

m,i|

m,i

[

a,i|LD:
LA

a,i

ð14Þ

2.4. Representing tour choice problems

Applying the above rules results in a well-formed MSN. As an example, ﬁgure 3
schematically shows the structure of an MSN for a two-activity system in which the
with-product state is relevant only for activity A2. In addition to home, the car is
considered a possible place for dropping off products of A2 (in this case, bags). For
reasons of clarity of presentation, the car is the only private vehicle considered in
this example. Six-angle shapes with dashed borders represent the selection of the
network consisting of only walk and transit transport links, whereas six-angle
shapes with solid borders depict the part of the transport network accessible by car.
Home is located at the left most angle of each shape. States are arranged in a
matrix structure where the columns represent vehicle-by-product states and rows
depict activity states. Note that the sequence of conducting the activities is free to

Figure 3. Schematic example of an MSN.

Downloaded by [New York University] at 06:25 29 May 2015 Multistate supernetwork approach to modelling multi-activity, multimodal trip chains 639

choose in this example. Horizontal arrows represent parking and dropping-off
actions, whereas vertical arrows stand for implementations of activities.

Figure 3 also illustrates the modeller’s choice of the start and end node of the
path. To model a complete tour, the start point is deﬁned as the home location in
the state where none of the activities has been conducted and all private vehicles are
at home and the end point is deﬁned as the home location in the state where all
activities have been conducted, all products have been dropped off and all private
vehicles are at home. In general, the choice of a begin and end point can be chosen
depending on the assumptions of the application. For example, if activity A2 is not
included in the programme, then the home state where only A1 has been conducted
should be chosen as end point.

In sum, an MSN deﬁnes the solution space of the problem to ﬁnd the best
sequence of activities, modes and routes, given one or more activities to be
conducted and one or more transport modes available to the individual. Each path
represents a solution that is consistent with the constraints and opportunities
deﬁned by the physical network in terms of both transport and state transitions
links. The present model does not guarantee that solutions are also consistent with
temporal constraints that may exist when time windows for activities are limited for
example by ﬁxed start and end times or opening hours of facilities. Arguably,
in most real-world applications.
however, this does not invalidate the model
Temporal constraints may limit the possible sequences of activities, such as, for
example, when a shopping activity can be conducted after but not before a work
activity given the start and end time of the work activity and opening hours of
stores. In such cases, one can represent sequence constraints in the structure of the
MSN simply by omitting illegal sequences from the set of possible activity states.
Given the set of feasible activity states, it is unlikely that generated solutions violate
temporal constraints, as they tend to minimize travel, activity, search and waiting
times, and more so the stronger time is weighted in link cost functions (see below).

3. Specifying cost functions

In contrast to conventional networks, an MSN allows one to deﬁne link costs
state dependently and, thus, to take into account the impact of state on perceived
disutility of travelling or travel time. Furthermore, by assigning costs to state
transition links, one can also take into account the costs of other than travel
elements, such as parking and conducting an activity. This section proposes a cost
function suited for the tour choice problem.

The types of links included in an MSN represent a large variety of activities
such as biking, driving, boarding, transferring, conducting an activity, parking a
vehicle,
these activities can be
considered as passing time in some ‘mode’ and some state meaning that it is
possible to deﬁne costs as a single generic function of these two variables. The
proposed function can be written as:

leaving home, etc. Despite the diversity, all

cj~ $m,s xj

(cid:1) (cid:2)zps

(cid:1)

(cid:1) (cid:2),
(cid:2)tjzdmdjzxm,s xj

ð15Þ

where

cj
tj
dj

generalized cost (disutility) of link j,
time elapsed on the link,
distance travelled on the link,

Downloaded by [New York University] at 06:25 29 May 2015 640

T. Arentze and H. Timmermans

m

transferring, parking,

index of mode (driving, biking, boarding,
conducting an activity, etc.),
s
index of state,
xj
vector of attributes of the link,
pm,s>0 mode and state speciﬁc value of time,
ps>0
dm>0 mode-speciﬁc cost of travelling per unit distance,
xm,s>0 mode- and state-speciﬁc constant cost (disutility) of using the link.

state-speciﬁc cost of parking per time unit,

Assuming mode- and state-speciﬁc values of time and link cost constants reﬂect the
notion that individuals may have certain preferences for passing time in certain
modes (transport, transfer, activity, etc.) and states (e.g. with or without carrying
products). Furthermore, adopting both sets of parameters as a function of link
attributes allows one to differentiate between locations depending on preferences
for certain attributes. Since it should return a disutility (a cost) rather than a utility,
the function should be speciﬁed using penalties for attribute levels that are less than
ideal. Then, the ideal location would incur a cost of zero and a less ideal location
will have a positive value. The parking price variable is of special importance. This
term is state dependent and is zero in states where the car (or another vehicle) is
staying at a cost-free location (e.g. at home) or is currently used for travelling, and
is larger than zero in states where it is staying at a paid parking location. Thus, the
parking price is charged for every unit of time passed while the car is staying at a
paid parking place. In an MSN, the location where a vehicle is parked can be
identiﬁed based on the link state so that the location-speciﬁc parking tariffs can be
used to calculate the costs. Finally, the travel–distance price parameter is mode and
state dependent to take possible differences in variable costs between modes (transit
lines or car) and states (with or without product) into account.

t
travel

Apart from the marginal disutility parameters, the variables t and d also deserve
is waiting time (boarding, alighting,
attention. Depending on link type,
transferring), search time (parking),
time (transport) or activity time
(conducting an activity) and is considered a function of link attributes (frequency
of transit lines, availability of vacant parking space, availability of stores, etc.). In
particular, it is possible to increase parking time for parking locations characterized
by relatively long search times and to differentiate between alternative activity
locations depending on average waiting, search and walking times within or
between stores. Distance d is zero for all links except travel links. Finally, the state
transition links ‘leaving/returning home’ and ‘dropping off products’ deserve
attention. The costs of transport to implement these actions are already covered by
transport links. Therefore, the costs for these state transition links can be set to
zero.

The disutility parameters reﬂect preferences that may vary between individuals
or groups of individuals. It is emphasized that the problem of ﬁnding good
estimates of the parameters is not speciﬁc to an MSN, but holds for every network
model making use of generalized cost functions. The estimations of values of time
or relative weights of travel time components of multimodal trips are an active ﬁeld
of transportation research. A maximum likelihood technique is generally used to
derive estimates empirically from observed travel choices (Jong and Gunn 2001,
Graham and Glaister 2002). Having said this, an MSN allows one to differentiate
between (activity) modes and states and using this opportunity, therefore, asks for

Downloaded by [New York University] at 06:25 29 May 2015 Multistate supernetwork approach to modelling multi-activity, multimodal trip chains 641

more sophisticated data and models. The method recently introduced by Joh et al.
(2003) to estimate continuous time utility functions based on activity–travel diary
data may provide a suitable approach to the problem.

4. Size of multistate networks and application issues

Since the cost of each link in the network is independent of preceding and
proceeding links in a path, a standard shortest-path ﬁnding method can be used to
ﬁnd the least-cost path through the network for a given origin and destination pair.
However, this property comes at the cost of a considerable increase in the number
of links required to deﬁne the network. This section ﬁrst derives equations for
calculating the number of links of an MSN as a function of the size of the original
identiﬁes feasibility
physical network and behavioural parameters, and next
conditions for applications.

The number of state-speciﬁc physical links can be found by:

(cid:5)
(cid:5)
(cid:5)

(cid:5)
(cid:5)
(cid:5)

LT
s

[
s

~ S.j

s? LT

(cid:5)
j| [
(cid:5)
(cid:5)
where S . is the set of activity states and LT
s? is the set of links in vehicle state sp.
Note that vehicle states consist of the states where all vehicles are at home, one of
the vehicles is on the road and one of the vehicles is parked (cf. equation 4).
Therefore, equation (16) can be solved as:
[
s

(cid:6)
j s0 Lj

jz X

jzP Lj
j

~ S.j

sm Lj

ð16Þ

ð17Þ

LT
s

(cid:5)
(cid:5)
(cid:5),

m~1

(cid:7)

s?

,

(cid:5)
(cid:5)
(cid:5)

(cid:5)
(cid:5)
(cid:5)

which reduces to:

(cid:5)
(cid:5)
(cid:5)

[
s

LT
s

~ S.j

j

(cid:5)
(cid:5)
(cid:5)

(cid:6)

X

m~0

(cid:7)
smzP

Lj

j,

ð18Þ

where P~ P
m Pm is the total number of parking locations across M private
vehicles, L is the set of links in the original (physical) network, s0 is the proportion
of links accessible by walking or public transport, and sm is the proportion of links
accessible by private vehicle m. The number of state transition links follows from
(14) and can be written as:
(cid:5)
LS(cid:5)
LR
LL
(cid:5)
(cid:5)
m
m

(cid:5)z X
(cid:5)

(cid:5)~ X
(cid:5)

(cid:5)z X
(cid:5)

(cid:5)z X
(cid:5)

(cid:5)z X
(cid:5)

(cid:5)z LD(cid:5)
(cid:5)
(cid:5)

LG
m,i

LP
m,i

LA
a,i

ð19Þ

(cid:5)
(cid:5):

(cid:5)
(cid:5)

(cid:5)
(cid:5)

(cid:5)
(cid:5)

(cid:5)
(cid:5)

m

m

m,i

m,i

a,i

j

(cid:5)
(cid:5)

(cid:5)
(cid:5)

LL
m

LP
m,i

(cid:5)
(cid:5)~ S.j
(cid:5)
(cid:5)| S.j

The variables on the right-hand side can be derived from equations (8–13) as:
(cid:5)
(cid:5)
(cid:5)~ LR
(cid:5)
m
(cid:5)
(cid:5)
(cid:5)
(cid:5)
(cid:5)~ LG
(cid:5)~ S?
(cid:5)
(cid:5)
m,i
(cid:5)
(cid:5)
(cid:5)
(cid:5)
(cid:5)| S.
(cid:5)~ S?
(cid:5)
(cid:5)
=1
(cid:5)
(cid:5)
(cid:5)
(cid:5)
(cid:5)| S.
(cid:5)~ S?
(cid:5)
(cid:5)
=1

(cid:5)
(cid:5)
LD(cid:5)
(cid:5)
Substituting (20–23) in (19) and rewriting gives:
(cid:5)
(cid:1)
(cid:5)~2M S.j
Þ I S.j
a Ia and Ia is the number of locations considered for activity a, and A is

(cid:5)
(cid:5)~ 1zP
ð

(cid:5)
(cid:5)~ 1zP
ð

jA{1z S.j

jz 1zP
ð

jz2P S.j

j~ S.j

(cid:5)
Þ S.
(cid:5)

Þ S.j
ð

LT(cid:5)
(cid:5)

j{2

j{2

LA
a,i

ð20Þ

ð22Þ

ð21Þ

ð23Þ

ð24Þ

Aa~1

m~1

a~0

a~0

(cid:2),

Þ:

(cid:5)
(cid:5)

j

where I~ P
the number of activities.

To give an indication of the size of an MSN, consider a case where two private
vehicles are distinguished (e.g. car and bike) and link accessibility ratios of the
multimodal network are given by s0~0.9, s1~0.4 and s2~0.4. Table 1 shows the

Downloaded by [New York University] at 06:25 29 May 2015 642

T. Arentze and H. Timmermans

Table 1.

Increase in the number of links for a two-private-vehicle case where s0~0.9,

s1~0.4 and s2~0.4.

Free sequence,
three states

Given sequence,
three states

Given sequence,
two states

N activities
(A)

N parking
locations
(P)

N activity
locations
(I)

Average
number
of link
copies

Number
of state
transition
links

Average
number
of link
copies

Number
of state
transition
links

Average
number
of link
copies

Number
of state
transition
links

1
1
2
2
3
3

5
10
5
10
5
10

3
3
6
6
9
9

20.1
35.1
60.3
105.3
180.9
315.9

102
182
330
590
1014
1814

13.4
23.4
26.8
46.8
53.6
93.6

64
114
140
250
292
522

13.4
23.4
20.1
35.1
26.8
46.8

64
114
102
182
140
250

results of applying equations (18) and (24) under different assumptions of activity
choice: each activity has three states and the activity sequence is either free to
choose or given, and each activity has two states and sequence is given. The
calculations are repeated for different combinations of number of activities, the
number of parking locations and the number of activity locations. The numbers for
the three-state, free-sequence setting, which represents the most general case, are as
follows. If one activity, ﬁve parking locations and three activity locations are
considered for the tour, the MSN has approximately 20.1 |L|z102 links, where |L|
is the number of links of the original network. Each added activity increases the
network size by 300% and each doubling of parking locations ampliﬁes the network
approximately by 175%. An MSN representing three activities, 10 parking locations
and nine activity locations would count 315.9 |L|z1814 links. In case the sequence
is given or the number of states is reduced, the marginal increases in network sizes
are considerably smaller. For example, if the sequence is given and only two activity
states are distinguished, the most extensive network counts 46.8 |L|z250 links.

As the example illustrates, the number of states and with it the size of the
network increases exponentially with the number of activities and vehicle parking
locations considered for a tour. Consequently, there is a practical limitation on the
size of problems an MSN can handle. In particular, there is a practical limitation of
the number of activities. Yet, the limitation does not seem to be too restrictive, as
the number of activities that individuals may combine in a tour is seldom larger
than two or three. Even handling a larger number of activities would still be
tractable in cases where one is willing to set the sequence of the activities ﬁxed and
leave activity product states out of consideration. The limitation regarding the
number of parking places is probably more restrictive. An MSN would become too
large for reasonably sized networks in which it is assumed that all parking locations
belong to the choice set of the individual and tour considered. Therefore, one
should reduce this set for each case to a more limited number of alternatives that
presumably are considered by the individual. Obviously, larger choice sets can be
assumed if fewer activities are included and vice versa.

Clearly, the size of an MSN is also dependent on the size of the original physical
transport network. Networks considered in applications of conventional (single-
state) models may comprise as many as hundreds or thousands links. Obviously,

Downloaded by [New York University] at 06:25 29 May 2015 Multistate supernetwork approach to modelling multi-activity, multimodal trip chains 643

sizes like these are beyond the limits of what is practically feasible in terms of
transformation of an MSN. However, this does not imply a restriction on the
applicability of MSN. An MSN intends to model individual decision-making and,
therefore, the network should be constructed from the point of view of the
individual considered. This means that the network should be compiled separately
for each origin whereby a substantially reduced set of links and (activity and
parking) locations are deﬁned for that origin. From a behavioural point of view,
such a selection may not be unrealistic as individuals generally know or take into
consideration only a small subset of links/locations. For example, local roads will
be considered only in the neighbourhoods of origin and destination locations and
left out of consideration for above-local travel. From an optimization point of view,
a reduction is also feasible, as large parts of the network can be safely excluded
once the activity programme and home location of the individual is known.

To conclude, the applicability of the approach to full-scale problems depends on
the availability of a complementary model for selecting relevant parts of the
network and activity/parking locations. The selection should take the origin
location and individual characteristics of the case at hand into account. Arguably, it
is possible to deﬁne a heuristic method that can generate a sufﬁciently small
selection that still yields valid solutions to a stated problem. Section 5 gives an
example of an application given such a selection.

5. Application

A generic Czz program for two-activity tours was written that reads as input
a location ﬁle, link ﬁle, transit-line ﬁle and parameter-settings ﬁle. The program
generates an MSN according to the rules described in Section 2 and calculates a
least-cost path using the Dijkstra algorithm. This section describes an application to
illustrate how an MSN can be speciﬁed and used to assess the impacts of network
it considers the Almere–
design on least-cost activity–travel paths. As a case,
Amsterdam corridor in the Netherlands. Before discussing results, the data of the
case are ﬁrst described.

5.1. The case

Figures 4a and b schematically show the Almere and Amsterdam sides of the
corridor, respectively. Open lines, solid lines and dashed lines represent transit, car
and bike/walk connections, respectively. Grey nodes denote transit stations and
open nodes depict places for parking (P), shopping (A), work (W), residence (H)
and road intersections. The home of the hypothetical individual is in a suburb of
Almere and the work location is near Amstel station, Amsterdam. The corridor is a
multimodal transport system. The representation is a simpliﬁcation of reality, but
still maintains the properties of relevance here. An express train runs directly
(without transfers) to Amsterdam central station, but does not stop at the station
nearest to home. Furthermore, Amsterdam can be reached by using a (slower) local
train service that does stop at the nearest station, but requires at least one transfer.
The freeway offers an alternative car-based route. Parking facilities near the various
stations allow for transfers between car and train. For example, a possibility is to
use Almere centre (near the origin) or Duivendrecht (near the destination) for
parking the car and proceeding by train. All
locations are considered suitable
for parking a bike.

Downloaded by [New York University] at 06:25 29 May 2015 644

T. Arentze and H. Timmermans

Figure 4.

(a) Almere side of the Almere–Amsterdam corridor. (b) Amsterdam side of the

Almere–Amsterdam corridor.

With regard to the demand side, it is assumed that bike and car are the available
private vehicles for making trips. The activity programme consists of a work
activity and a shopping activity in a free to choose sequence. The location for work
is given and ﬁxed, whereas Almere city (less attractive) and Amsterdam centre
(more attractive) are alternative locations considered for the shopping activity. The
work activity has no consequences in terms of a product that needs to be carried.
On the other hand, shopping bags increase the amount of effort required,
particularly for transport by a slow mode. Shopping bags can be dropped off either
at home or in the car.

Table 2 shows attributes of locations assumed in the case. Although all locations
are considered suitable for parking a bike, only those in Almere were included.
Adding locations on the Amsterdam side is possible, but has no meaning since there
is no (feasible) slow mode connection between the cities. Car park locations are
described in terms of mean search time and price level using a three- and four-way
classiﬁcation, respectively. Transit stations and shopping locations are classiﬁed
using three attractiveness categories. Table 3 lists parameter settings used for
calculating costs and time variables. Car speed differs between three classes of
roads: local inside city centre, local outside city centre and freeway. Park search

Downloaded by [New York University] at 06:25 29 May 2015 Multistate supernetwork approach to modelling multi-activity, multimodal trip chains 645

Table 2. Location attributes assumed in the case study.

Type

Node

Label

Search time

Costs

Attractiveness

Bike park
Bike park
Bike park
Car park
Car park
Car park
Car park
Car park
Shops
Shops
Station
Station
Station
Station
Station
Station
Work
Home

2
4
3
2
4
11
12
9
4
12
2
3
8
9
10
13
11
1

Almere parkwijk
Almere inner city
Almere central station
Almere parkwijk
Almere inner city
Amstel work
Amsterdam inner city
Duivendrecht
Almere inner city
Amsterdam inner city
Almere parkwijk
Almere central station
Diemen Zuid
Duivendrecht
Amstel station
Amsterdam central station
Amstel work
Almere home

short
medium
medium
long
short

free
low
free
high
free

Table 3. Time- and price-related parameter values assumed in the case study.

Mode

Low value

Medium value

High value

Aspect

Speeds (km/h)

Times (min)

Park fee (J/h)

Transport cost (J/h)

Service frequency (n/h)

walk
bike
car
transit
park search
work
shop
bike
car
slow
car
transit
transit

20

5

0.7

3

4
15
40
40
8
300
60
0
1.2
0
0.074
0.08
4

time and park costs levels correspond to search time and price attributes of parking
locations (table 2). Transit service frequency varies depending on the line.

Table 4 displays base settings of time and cost constants used in the analysis.
Different levels are distinguished for values of time (VoT) as well as constants
(Pen). In case of VoT, the base level is used in states where no shopping bags are
being carried. Differences in base value across link types represent assumed mode
preferences of the individual. Car is the most preferred mode and slow is the least
preferred mode per unit travel time. Furthermore, relatively high base values are
assumed for waiting and searching for a parking place. In addition, VoT(high)
includes a penalty per time unit that is imposed in states in which shopping bags are
carried. Note that the penalty is zero for car travel and car park search times and
has a particularly high value for slow mode travel time. Intercepts (Pen) reﬂect

medium
high
low
medium
low
medium
high
high

60
60
15

2.5

7

Downloaded by [New York University] at 06:25 29 May 2015 646

T. Arentze and H. Timmermans

Table 4. Value of times assumed in the case study.

VoT (J/h)

Pen (J)

Link

Base value

High value

Base value

Medium value

High value

Car
Bike
Walk
Transit
Board
Alight
Transfer
Park
Work
Shop

5.45
6
8.175
6
8.175
8.175
8.175
10.9
0
4

5.45
8.175
10.9
6
10.9
10.9
10.9
10.9
0
6

0
0
0
0
0.45
0.45
0.9
0.9
0
0

0.9
0.9
1.8

0.9

1.8
1.8
3.6

1.8

inconvenience of transferring and the relative attractiveness of shopping locations.
Inconvenience is assumed to be larger for less attractive stations. In sum, this
implementation partly meets the level of disaggregation of the generic cost function
given by equation (15). That is to say, VoTs are state dependent but independent of
location attributes, and Pens are dependent on location attributes but state
independent.

5.2. Results of scenario analyses

transcript of

table 5 shows a full

To give an impression of the level of detail of path information generated by the
the route generated under basic
program,
parameter settings as deﬁned in tables 2–4. The last column of table 5 indicates the
time (min) for each link in the path. In this case, total time excluding activity time
equals 145 min for the complete tour, whereas total generalized costs (not shown)
equals J33.38. The least-cost path includes biking to Almere main station
(bypassing the nearest station), taking transit to Amstel station with one transfer,
walking from Amstel to the work location, returning by transit to Almere main
station, getting the bike from there, conducting the shopping activity in Almere
centre and biking back home. Hence, as key choices, the system chooses transit as
the main mode, used slow modes for access and egress, bypassed the nearest station
from home, conducted shopping after work and did not return home in between the
activities.

To show the sensitiveness of least-cost paths for some key parameter settings,
the path-ﬁnding algorithm was run for each of six illustrative scenarios. Table 6
shows summary information of the generated paths. The scenarios were deﬁned as
follows:

(1) Increase in relative attractiveness of Amsterdam centre for shopping
(penalty increase from J0.90 to J4.59 for low and medium attractiveness
locations).

(2) Increase in heaviness of shopping bags (increase in ‘carrying-bags’ penalty

for a slow mode from J8.175 to J21.00).

(3) No price reduction card for transit use (40% price increase).
(4) No price reduction card (as 3) and introduction of paid parking (from zero

to low level) at the work location.

Downloaded by [New York University] at 06:25 29 May 2015 Multistate supernetwork approach to modelling multi-activity, multimodal trip chains 647

Table 5. Example of a route transcript.

Mode

From To Line Car_at Bike_at Worked Shopped Carry Time

Bike from home
Bike
Bike
Park bike
Board
Transit
Transit
Transfer
Transit
Alight
Walk
Work
Walk
Board
Transit
Transfer
Transit
Transit
Alight
Get bike
Bike
Park bike
Shop
Get bike
Bike
Bike to home

1
1
4
3
3
3
8
9
9
10
10
11
11
10
10
9
9
8
3
3
3
4
4
4
4
1

1
4
3
3
3
8
9
9
10
10
11
11
10
10
9
9
8
3
3
3
4
4
4
4
1
1

0
0
0
0
1
1
1
3
3
0
0
0
0
3
3
1
1
1
0
0
0
0
0
0
0
0

home
home
home
home
home
home
home
home
home
home
home
home
home
home
home
home
home
home
home
home
home
home
home
home
home
home

0
0
0
3
3
3
3
3
3
3
3
3
3
3
3
3
3
3
3
0
0
4
4
0
0
home

no
no
no
no
no
no
no
no
no
no
no
yes
yes
yes
yes
yes
yes
yes
yes
yes
yes
yes
yes
yes
yes
yes

no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
yes
yes
yes
yes

no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
no
yes
yes
yes
no

0
20
2
0
8
18
3
3
5
4
8
0
8
4
5
6
3
18
8
0
2
0
0
0
20
0

(5) No shopping activity.
(6) No shopping activity and introduction of paid parking at the work location

(from zero to low level).

The ﬁrst scenario leads to a change in choice of shopping location and an
increase in total travel time of 42 min, whereas the main mode stays the same. In
the second scenario, the main mode changes from transit to car and the shopping
location changes back to Almere centre. This shows that the nature of a secondary
activity may have consequences for the choice of main mode for the work trip. The
third and fourth scenarios show the sensitivity of choice to price levels. If the price
of transit increases, transit is replaced by car and changed back to transit if, in

Table 6. Results of scenarios.

Scenario

Main
mode

Station
origin

Station
destination

Shop
location

Shop
position

Return
home

Total
time

Base
1
2
3
4
5
6

transit Almere CS
transit Almere CS

Amstel
Amstel

car
car

car
transit

transit Almere CS

Amstel

nearest

Amstel

Almere
Amsterdam
Almere
Almere
Almere

after
after
after
after
after

no
no
no
yes
yes

Total
costs

33.38
36.97
37.57
33.95
35.08
22.23
25.33

145
187
162
168
145
128
127

Downloaded by [New York University] at 06:25 29 May 2015 648

T. Arentze and H. Timmermans

addition, paid parking is introduced at the work location. It is also interesting to
note that when a car is used, the multipurpose trip is replaced by two single purpose
trips. This is the consequence of a preference for using bike for shopping in Almere
centre due to search and monetary costs associated with car parking. The purpose
of the intermediate trip home is to switch mode from car to slow. The last two
scenarios reveal a change in preference for the main mode of the tour if the
shopping activity is removed from the programme. Contrary to what one may
expect, the car becomes the preferred mode instead of transit (scenario 5). The
reason why transit is considered more favourable in tours involving shopping is that
parking a car at the shopping location or returning home to switch to a slow mode
both induce extra costs. This effect is counterbalanced if paid parking is introduced
at the work location (scenario 6).

6. Conclusions and discussion

This paper introduced a new network representation of multimodal transport
systems that allows the modelling of multi-activity, multimode tours by means of a
standard least-cost path ﬁnding method. The MSN includes a copy of the physical
transport network for each possible activity–vehicle state during a tour. The copies
are interconnected by state transition links, which represent activities such as
parking a private vehicle or conducting an activity at a speciﬁc location. In this
way, it is possible to deﬁne the link costs and start and end points of paths’ state
dependently and to use an existing algorithm to ﬁnd the least-cost path. Given the
way an MSN is constructed, the path-ﬁnding algorithm determines many choices in
interaction including the route, activity location, activity sequence, parking
location, mode and intermediate return-home trips choices. The link cost functions
can be deﬁned such that solutions are sensitive to many attributes of multimodal
transport systems including attractiveness of transfer stations, availability and price
of parking places, and travel, waiting and transfer times.

An application illustrated the use of the model to assess the sensitivity of
activity–travel choice behaviour for variables of a multimodal network. As a case,
the Almere–Amsterdam corridor was considered for implementing a two-activity
programme under various speciﬁcations of cost functions. As it appears, key
choices such as main mode, access station, activity location and making an
intermediate trip home are strongly interrelated in this case and fairly sensitive to
prices, search times, activity–location preferences and the activity programme. A
counter-intuitive ﬁnding is that a secondary activity may work in favour of transit
use. The reason is that car generates extra costs related to parking. The alternative
of making a trip back home to switch to a slow mode for the secondary activity
also invokes costs. Only if a car has sufﬁcient added value for transporting goods
will this effect be counter-balanced. Furthermore, a secondary activity may have as
an effect that a more central station rather than the nearest station is used for
access to transit. This occurs if the (preferred) activity location is close to the
central station and the costs of an extra transfer required for returning to the
nearest access station exceeds the costs of the longer distance to the central station.
Apart from this descriptive purpose, the model can also be used to generate
activity–travel plans prescriptively, given activity and mode choice sets and values
of time of a given individual/organization. Given the increasing complexity of
multimodal transport networks, time pressures on activity patterns and integration

Downloaded by [New York University] at 06:25 29 May 2015 Multistate supernetwork approach to modelling multi-activity, multimodal trip chains 649

of geographical information science in modern societies, the authors feel that there
is a great potential demand for such a decision-support tool. Another possible
application is using the model to generate choice-sets for tour-choice modelling.
The possible paths in an MSN represent the space of feasible activity–travel
patterns, and in that sense, the construct is comparable with space–time prisms in
time geography. The least-cost path is only one solution in this space. A
combinatorial algorithm could be deﬁned to select the subset of paths acceptable in
terms of relative costs and, hence, may constitute the choice set of a given
individual. Cost–function parameter settings may be varied to account
for
uncertainty or heterogeneity in preferences. The choice set thus deﬁned could be
used as input to a discrete tour choice model, in a similar way as suggested for a
multimodal trip-based model by Benjamins et al. (2002) and Carlier et al. (2003).
The choice sets generated could also be informative in their own right. The size of
the choice set can be taken as a measure of the opportunities the multimodal
network provides for implementing activity programmes. In that way, an MSN can
be used for policy analysis in a similar way as constraint-based activity-based
models are used (e.g. PESASP, Lenntorp 1976; CARLA, Jones et al. 1983). Least-
cost path-ﬁnding methods and network representations belong to the standard tools
and data formats of a geographical information science. Allowing users to deﬁne an
MSN in the way as proposed in this study would enhance the decision support and
analytical capabilities of geographical information science.

Several topics remain for future research. First, an appropriate method of
selecting the transport links, activity locations and parking locations for a given
origin, individual and tour needs to be developed, such that all relevant links and
locations are represented, and to limit the size of the network, all irrelevant links
and locations are excluded. The criteria for selection should be dependent on the
purpose of the application. If the purpose is impact analysis, the selection should
reﬂect as accurately as possible the choice sets of the individual simulated. If, on the
other hand, the purpose is decision support, the selection should exclude all those
links and locations that have a negligible chance of being part of an optimal path.
In both cases, time–geography principles and scheduling constraints might be used
to deﬁne such criteria. In descriptive analysis, the criteria may be complemented by
behavioural rules of choice-set formation.

Second, an MSN allows one to use mode and state-dependent values of time as
parameters in generalized link cost functions. Existing studies on estimating values
of time based on travel choice behaviour implicitly assume a single value of time
independent on the way time is passed and the state the individual is in. To allow
more sensitive generalized link cost functions, which can be used in an MSN, future
research could focus on empirical estimation of values of time as a function of
activity and state. An approach based on activity–travel diary data as proposed in
Joh et al. (2003) seems promising.

Acknowledgements

The study was supported by the Dutch Science Foundation (NWO).

References
AL-AZZAWI, M., 1997, An overview of three techniques designed to aid planners with over-
assignment and peak spreading in trafﬁc modeling studies. Trafﬁc Engineering and
Control, 38, 604-606.

Downloaded by [New York University] at 06:25 29 May 2015 650

T. Arentze and H. Timmermans

ARENTZE, T., HOFMAN, F., VAN MOURIK, H., TIMMERMANS, H., and WETS, G., 2000,
Using decision tree induction systems for modeling space–time behavior. Geogra-
phical Analysis, 32, 330–350.

BENJAMINS, M., LINDVELD, K., and VAN NES, R., 2002, Multimodal travel choice modelling:
a supernetwork approach. In Proceedings of the 81st Annual Meeting of the
Transportation Research Board, Washington, DC. [CD-ROM].

CARLIER, K., FIORENZO-CATALANO, S., LINDVELD, C., and BOVY, P., 2003, A supernetwork
approach towards multimodal travel modeling. In Proceedings of the 82nd Annual
Meeting of the Transportation Research Board, Washington, DC. [CD-ROM].

CORMEN, T., LEISERSON, C., and RIVEST, R., 2001, Introduction to Algorithms (Cambridge,

MA: MIT Press).

VAN VUREN, T., and DAVIES, R. F., 1992, The use of shadow networks in determination
of limits to trafﬁc growth in heavily congested networks. Trafﬁc Engineering and
Control, 33, 425-428.

DELLAERT, B., ARENTZE, T., BIERLAIRE, M., BORGERS, A., and TIMMERMANS, H., 1998,
Investigating consumers’ tendency to combine multiple shopping purposes and
destinations. Journal of Marketing Research, May, 177–188.

GRAHAM, D. J., and GLAISTER, S., 2002, The demand for automobile fuel: a survey of

elasticities. Journal of Transport Economics and Policy, 36, 1–25.

HANSON, S., 1980, Spatial diversiﬁcation and multipurpose travel: implications for choice

theory. Geographical Analysis, 12, 245–257.

JOH, C.-H., ARENTZE, T. A., and TIMMERMANS, H. J. P., 2003, Estimating non-linear utility
functions of continuous time in the context of an activity schedule adaptation model.
Proceedings of the 10th International Conference on Travel Behaviour Research,
Lucerne, Switzerland, 10–14 August 2003. [CD-ROM].

JONES, P. M., DIX, M. C., CLARKE, M. I., and HEGGIE, I. G., 1983, Understanding Travel

Behaviour (Aldershot: Gower).

JONG DE, G., and GUNN, H., 2001, Recent evidence on car cost and time elasticities of travel
demand in Europe. Journal of Transport Economics and Policy, 35, 137–160.
KWAN, M.-P., 2000, Interactive geovisualization of activity–travel patterns using three-
dimensional geographical information systems: a methodological exploration with a
large data set. Transportation Research C, 8, 185–203.

KWAN, M.-P., and LEE, J., 2004, Geovisualization of human activity patterns using 3D GIS:
a time–geographic approach. In Spatially Integrated Social Science: Examples in Best
Practice, edited by M. Goodchild and D. Janelle (Oxford: Oxford University Press).
pp. 48-66.

LENNTORP, B., 1976, Paths in Space–Time Environment: A Time Geographic Study of
Possibilities of Individuals (Lund: Royal University of Lund, Department of
Geography).

LO, H. K., YIP, C. W., and WAN, K. H., 2003, Modeling transfer and non-linear fare
structure in multi-modal network. Transportation Research B, 37, 149–170.
MILLER, H. J., 1998, Emerging themes and research frontiers in GIS and activity-based

travel demand forecasting. Geographical Systems, 5, 189–198.

MILLER, H. J., 1999, Measuring space–time accessibility beneﬁts within transportation
networks: basic theory and computational methods. Geographical Analysis, 31,
187–212.

MILLER, H. J., and WU, Y.-H., 2000, GIS software for measuring space–time accessibility in

transportation planning and analysis. GeoInformatica, 4, 141–159.

NAGURNEY, A., DONG, J., and MOKHTARIAN, P. L., 2001, Teleshopping versus shopping: a
multi-criteria equilibrium framework. Mathematical and Computer Modelling, 34,
738–798.

NAGURNEY, A., DONG, J., and MOKHTARIAN, P. L., 2002, Multicriteria network equilibrium
modeling with variable weights for decision-making in the information age with
applications to telecommuting and teleshopping. Journal of Economic Dynamics and
Control, 26, 1629–1650.

NAGURNEY, A., and KE, K., 2001, Financial networks with intermediation. Quantitative

Finance, 1, 441–451.

NAGURNEY, A., and SMITH, F., 2003, Supernetworks: paradoxes, challenges and new

Downloaded by [New York University] at 06:25 29 May 2015 Multistate supernetwork approach to modelling multi-activity, multimodal trip chains 651

opportunities. Paper presented at the 1st International Conference on the Economic
and Social Implications of Information Technology, Washington, DC, January 2003.
NAGURNEY, A., and TOYASAKI, F., 2003, Supply chain supernetworks and environmental

criteria. Transportation Research D, 8, 185–213.

O’KELLY, M., 1981, A model of the demand for retail facilities incorporating multistop,

multipurpose trips. Geographical Analysis, 13, 134–148.

SHEFFI, Y., 1985, Urban Transportation Networks: Equilibrium Analysis with Mathematical

Programming Methods (Englewood Cliffs: Prentice-Hall).

SOUTHWORTH, F., and PETERSON, B. E., 2000, Intermodal and international freight network

modeling. Transportation Research C, 8, 147–166.

THILL, J. C., and THOMAS, I., 1991, Towards conceptualizing trip-chaining behavior: a

review. Geographical Analysis, 19, 1–17.

TIMMERMANS, H., ARENTZE, T., and JOH, C.-H., 2002, Analyzing space–time behavior: new

approaches to old problems. Progress in Human Geography, 26, 175–190.

WANG, D., and CHENG, T., 2000, A spatio-temporal data model for activity-based transport
demand modeling. International Journal of Geographic Information Science, 15,
561–585.

WU, Y.-H., and MILLER, H. J., 2002, Computational tools for measuring space–time
accessibility within dynamic ﬂow transportation networks. Journal of Transportation
and Statistics, 4, 1–14.

XU, J., HANCOCK, K. L., and SOUTHWORK, F., 2003, Simulation of regional freight
movement on the TTMNet: trade & transportation multi-networks. In Proceedings
of the 82nd Annual Meeting of the Transportation Research Board, Washington,
DC. [CD-ROM].

ZIJP VAN DER, N. J., and LINDVELD, C. D. R., 2001, Estimation of O–D demand for dyna-
mic assignment with simultaneous route and departure time choice. Proceedings
of the 80th Annual Meeting of the Transport Board Meeting, Washington, DC.
[CD-ROM].

Downloaded by [New York University] at 06:25 29 May 2015 