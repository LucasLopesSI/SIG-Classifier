International Journal of Geographical Information
Science

ISSN: 1365-8816 (Print) 1362-3087 (Online) Journal homepage: http://www.tandfonline.com/loi/tgis20

Inferring spatial interaction patterns from
sequential snapshots of spatial distributions

Di Zhu, Zhou Huang, Li Shi, Lun Wu & Yu Liu

To cite this article: Di Zhu, Zhou Huang, Li Shi, Lun Wu & Yu Liu (2017): Inferring spatial
interaction patterns from sequential snapshots of spatial distributions, International Journal of
Geographical Information Science, DOI: 10.1080/13658816.2017.1413192

To link to this article:  https://doi.org/10.1080/13658816.2017.1413192

Published online: 12 Dec 2017.

Submit your article to this journal 

Article views: 108

View related articles 

View Crossmark data

Full Terms & Conditions of access and use can be found at
http://www.tandfonline.com/action/journalInformation?journalCode=tgis20

Download by: [ECU Libraries]

Date: 14 December 2017, At: 23:06

INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE, 2017
https://doi.org/10.1080/13658816.2017.1413192

RESEARCH ARTICLE

Inferring spatial interaction patterns from sequential
snapshots of spatial distributions

Di Zhu a,b, Zhou Huanga, Li Shia, Lun Wua and Yu Liu a,b

aInstitute of Remote Sensing and Geographical Information Systems, Peking University, Beijing, China;
bBeijing Key Lab of Spatial Information Integration and Its Applications, Peking University, Beijing, China

ARTICLE HISTORY
Received 5 July 2017
Accepted 30 November 2017

KEYWORDS
Spatial interaction; spatial
heterogeneity; linear
programming; migration
ﬂow; big geodata

ABSTRACT
Spatial interactions underlying consecutive sequential snapshots
of spatial distributions, such as the migration ﬂows underlying
temporal population snapshots, can reﬂect the details of spatial
evolution processes. In the era of big data, we have access to
individual-level data, but the acquisition of high-quality spatial
interaction data remains a challenging problem. Most research
has been focused on distributions of movable objects or the
modelling of spatial
interaction patterns, with few attempts to
identify hidden spatial interaction patterns from temporal transi-
In this article, we introduced an
tions of spatial distributions.
approach to infer spatial
interaction patterns from sequential
snapshots of spatial population distributions by incorporating
linear programming and the spatial constraints of human move-
ment. Experiments using synthetic data were conducted using
four simple scenarios to explore the characteristics of our method.
The proposed method was used to extract interurban ﬂows of
migrants during the Chinese Spring Festival in 2016. Our research
demonstrated the feasibility of using discrete multi-temporal
snapshots of population distributions in space to infer spatial
interaction patterns and oﬀered a general analytical framework
from snapshot data to spatial interaction patterns.

1. Introduction

Spatial heterogeneity and spatial interactions are closely intertwined in the complicated
geographical world. The former indicates that places have a tendency to be diﬀerent
from each other and exhibit heterogeneous spatial distributions of attributes (Longley
et al. 2015). A spatial interaction, however, is a second-order process that includes the
movements of people, commodities, capital or other moveable objects that occur in
space (Tobler 1970, Fotheringham 2001, Roy and Thill 2003). The heterogeneity of
spatial distributions can lead to the existence and development of spatial interaction
networks (Rodrigue et al. 2013), and in turn, spatial interactions can play an important
role in shaping the spatial structures under multiple inﬂuential factors (Batty 2013b,
Rodrigue et al. 2013) such as economic demands, natural conditions, agglomeration and
historical considerations. In recent years, we have witnessed various forms of locator
devices implemented as sensors to capture location data by automated and routine

CONTACT Yu Liu
© 2017 Informa UK Limited, trading as Taylor & Francis Group

liuyu@urban.pku.edu.cn

Downloaded by [ECU Libraries] at 23:06 14 December 2017 2

D. ZHU ET AL.

movement tracking of individuals (Hao et al. 2015, Batty 2013a, Ratti et al. 2006, Foth
et al. 2011). These collected geo-tagged data oﬀer abundant information about activ-
ities, movements and social ties (Lu and Liu 2012, Liu et al. 2015) and give us the
opportunity to revisit the dynamic relationship between the spatial distributions of
moveable objects and the corresponding spatial
interactions from a data-driven
perspective.

Previous studies about spatial distributions based on geospatial big data are conﬁned
to exploring the hidden spatial and temporal variations of human activities (Ratti et al.
2006, Kang et al. 2012, Toole et al. 2012, Deville et al. 2014, Pei et al. 2014, Yuan and
Raubal 2016, Long and Liu 2017). Spatial interactions, on the other hand, are considered
in which the modelling of aggregated interactions
a classical geographic problem,
(Wilson 1971, 2011, Fotheringham and Webber 1980, Fotheringham 2001) and individual
mobility (Barabsi 2005, Ratti et al. 2006, Han et al. 2010, Song et al. 2010a, 2010b, Yuan
and Raubal 2012) can be viewed as two sides of the same coin (Liu et al. 2014). However,
spatial interactions and distributions are related and cannot be treated independently. In
practice, the scale of an interaction may be measured by phenomena such as the
volumes of passengers, migration ﬂows, trade ﬂows and currency ﬂows among spatial
units, of which human interactions between cities and regions are governed by the
distance decay eﬀect (Miller 2004) and are inﬂuenced by the nodal attractions of
locations (Gonzalez et al. 2008). Meanwhile, the migrations among spatial units can
also lead to the reorganization of population, ﬁnances, and goods and therefore trans-
form the distributions of geographic attributes (Barthelemy 2010, Ratti et al. 2010,
interaction models, some
Hawelka et al. 2014).
researchers addressed the acquisition of unknown spatial distribution information
from observed spatial interaction ﬂows. Shen (2004) and Xiao et al. (2013) utilized data
of intercity air passenger networks to reverse-ﬁt the gravity model and reconstruct the
theoretical gravitational attractions of cities. Calabrese et al. (2011) proposed an estima-
tion method to identify origin-destination ﬂows from mobile phone traces, and by
aggregating OD points, they successfully reproduced the population density distribution
in the Boston Metropolitan area.

Inspired by various forms of spatial

Despite the above-mentioned endeavours that considered the relationship between
spatial distributions and spatial interactions, few paid attention to the important issue of
retrieving unknown spatial interaction patterns from observed multi-temporal snapshots
of spatial distributions. The acquisition of high-quality spatial interaction data for many
practical scenarios has been a challenging problem for various reasons such as the user
privacy issue facing individual spatio-temporal data sets (Montjoye et al. 2013, Blondel
et al. 2015), the cumbersome process of extracting and aggregating movement ﬂows
from raw individual trajectories (Calabrese et al. 2011) and the insuﬃciency of data for
extraction and aggregation (Zhao et al. 2016). Meanwhile, since most scientiﬁc studies
aim to understand spatial interaction patterns at only the aggregated level instead of
individual behaviours, the workﬂow of ‘ﬁrst extract individual ﬂows and then aggregate’
appears to be time consuming.

For researchers, the sequential snapshots of spatial distributions are more accessible in
practice. A temporal snapshot is a representation of the state of aﬀairs in a particular
domain at a single moment in time, and one can think of snapshots as sampling dynamic
instants (Worboys 2005). The most common
phenomena at a sequence of temporal

Downloaded by [ECU Libraries] at 23:06 14 December 2017 INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

3

approach to analysing spatio-temporal dynamics has been to view geographic space as a
succession of temporal snapshots of the spatial distribution of objects. Relevant studies can
be classiﬁed into two categories: descriptive and modelling. Descriptive research on
temporal snapshot data is commonly performed in the ﬁeld of remote sensing to monitor
the inﬂuence of natural disasters, such as ﬂoods, melting glaciers and earthquakes, on
changes in landscapes (Baszczyk et al. 2009, Ahmed 2011, Zhao 2011, Alrawas et al. 2013,
Liu and Li 2017). On the other hand, models of spatio-temporal dynamics are mainly object
based (Sinha and Mark 2005, Chee et al. 2016) and event oriented (Li et al. 2004, Worboys
2005, Hornsby and Cole 2007). They characterize the evolution of spatial distributions by
considering moving entities at the individual
instead of treating the movement
patterns as aggregated spatial interactions. To the best of our knowledge, Shoshany et al.
(2007) is one of the few exploratory works that endeavoured to discover movement
patterns from dynamic point clusters. By formalizing the problem as a spatial optimization
task, their approach successfully estimated the movements of ants based on snapshots of
ants’ clusters. However, their experiment was limited by the use of synthetic data, and their
method requires further empirical investigations with big geodata to be generalized.

level

In this article, we propose a new method to infer spatial interaction patterns from
sequential snapshots of spatial population distributions. Experiments are conducted
using synthetic data to verify the correctness of our approach. We attempt to prove
the practicability of inferring spatial interaction patterns from a temporal sequence of
spatial distributions and to note the signiﬁcance of investigating the dynamic relation-
ship between spatial heterogeneity and spatial interactions. A case study exploring the
national-scale migration ﬂows during the Chinese Spring Festival demonstrates the
feasibility of our method in scenarios concerning large-scale human movement.

2. Methodology

Assuming that the time interval between two consecutive spatial distribution snapshots is
not too long to ensure that only one spatial process exists that directly drives the observed
evolution of spatial distributions (Swihart and Slade 1985), the decision strategy for
determining the underlying spatial interactions is similar to the minimum-cost ﬂow problem
(Ahuja et al. 1993, Cook et al. 1997, Holzhauser et al. 2016) in network optimization, which
aims at ﬁnding the minimum-cost ﬂow conﬁguration of a network with the requirement of
conservation of ﬂows at all nodes. In this study, each spatial unit has a potential bidirec-
tional connection with every other unit, and thus, a fully connected network can be
constructed. To determine a global interaction pattern from the many possible patterns
that match the observed evolution of distributions, we model the problem as a spatial
optimization task that minimizes the total cost of interaction ﬂows with the constraint of
the spatial conﬁguration and the distance friction of human movement. We investigate the
relationship between spatial heterogeneity and spatial interactions and attempt to oﬀer an
analytical framework to retrieve hidden interaction patterns.

2.1. Constructing and solving the linear programs of human movement

Consider the simple concrete example illustrated in Figure 1, where Snapshot I captures
the value distribution at time t1 and Snapshot II captures that of time t2. xi ði 2 ½1; 6(cid:2)Þ is

Downloaded by [ECU Libraries] at 23:06 14 December 2017 4

D. ZHU ET AL.

Figure 1. A simple example for inferring the interaction patterns between two snapshots of spatial
distributions. x1 and x2 are the ﬂows between spatial units ① and ②, respectively; x3 and x4 are the
ﬂows between units ② and ③, respectively; and x5 and x6 are the ﬂows between units ① and ③,
respectively. The value of unit ① decreases from 10 to 7, that of unit ② increases from 5 to 9 and
that of unit ③ decreases from 7 to 6.

the number of inﬂows or outﬂows from one unit to another during the given time
period. Assuming that t2 (cid:3) t1 can ensure that no extra independent spatial interaction
pattern exists other than the one that results in the evolution from Snapshot I to
Snapshot II, the fully connected network among the three spatial units can be repre-
sented by a single vector x ¼ ½x1; x2; x3; x4; x5; x6(cid:2), where "xi 2 x we require xi (cid:4) 0. Since
the requirements for the conservation of ﬂows at all spatial units and the objective
function of the total cost are all linear functions, we have the following linear program:

x1 þ x2 þ x3 þ x4 þ x5 þ x6
minimize
subject to (cid:3) x1 þ x2 (cid:3) x5 þ x6 ¼ (cid:3)3

x1 (cid:3) x2 (cid:3) x3 þ x4 ¼ 4
þ x3 (cid:3) x4 þ x5 (cid:3) x6 ¼ (cid:3)1
xi (cid:4) 0 for i ¼ 1; 2; :::; 6;

where a minus sign denotes outﬂow and a plus sign indicates inﬂow for a certain spatial
1
0 (cid:3)1
0
1
0
1 (cid:3)1
1 (cid:3)1

A represents the coeﬃcients of

0
1
(cid:3)1
1 (cid:3)1 (cid:3)1
0
0

unit. The matrix A ¼

0

1

@

the conservation of ﬂows and the vector bT = [−3,4,1] represents the observed evolution
of spatial distributions.

Then, we transform the linear program (1)

form
(Matousek and Gärtner 2007), which can be directly solved by the simplex method
(Nelder and Mead 1965, Dantzig and Thapa 1997). The equational form is as follows:

into an equational

(standard)

cT x

minimize
subject to Arex ¼ bre

x (cid:4) 0

(1)

(2)

Downloaded by [ECU Libraries] at 23:06 14 December 2017 INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

5

where x is a vector of n variables and Are is an m (cid:5) n reduced row echelon form matrix
with m rows and n columns (n (cid:4) m) of rank m (Meyer 2000). c 2 Rn, bre 2 Rm and 0 is
the zero vector with n components.

For a subset B (cid:6) 1; 2; :::; n

f

g, we let AB denote the matrix consisting of the columns of

(cid:2)

A whose indices belong to B. For instance, for Are ¼
(cid:2)

(cid:3)

B ¼ 1; 6f

g, we have Are

1 (cid:3)1
0 (cid:3)1
x 2 R n for which there exists an m -element set B (cid:6) 1; 2; :::; n

B ¼

f

g such that

. A basic feasible solution of linear program (2) is an

(cid:129) the (square) matrix Are

B is nonsingular, i.e. the columns indexed by B are linearly

1 (cid:3)1 0
0
0

1 (cid:3)1
1 (cid:3)1 1 (cid:3)1

0

(cid:3)

and

independent, and

(cid:2)

(cid:129) xj ¼ 0 for all j‚B.
We convert A in linear program (1)
1 (cid:3)1
1 (cid:3)1 0
1 (cid:3)1 1 (cid:3)1
0
0

(cid:3)

0

into its reduced row echelon form Are ¼

after Gauss–Jordan elimination (Leon 1980). Are is a matrix of

rank 2 with 2 rows and 6 columns, and the corresponding bre of b is ½3; (cid:3)1(cid:2). Supposing that
c ¼ ð1; 1; 1; 1; 1; 1Þ, the equation form of linear program (1) is rewritten as

minimize
subject to

x1 þ x2 þ x3 þ x4 þ x5 þ x6
x1 (cid:3) x2 þ x5 (cid:3) x6 ¼ 3
þ x3 (cid:3) x4 þ x5 (cid:3) x6 ¼ (cid:3)1
xi (cid:4) 0 for i ¼ 1; 2; :::; 6:

In the simplex method, we ﬁrst express the linear program in the form of a simplex
tableau. In the case of Equation (3), we begin with B ¼ 1; 6f

g, and the tableau is

The ﬁrst two rows consist of equations of the linear program, in which the non-zero
variables are on the left-hand side and the remaining terms are on the right-hand side.
The last row separated by a line contains a new variable z, which represents the
objective function. From this tableau, we obtain a feasible solution x ¼ ½4; 0; 0; 0; 0; 1(cid:2)
and z ¼ 5, which is basic with B ¼ 1; 6f

g.

Starting from the initial simplex tableau, we continue constructing a sequence of
tableaus of similar form by gradually rewriting them according to certain rules until
the optimal z is obtained. Due to the non-negativity constraint of x, possible subsets
g; 5; 6f
B (cid:6) 1; 2; :::; 6
g. Finally, we can obtain the optimal
feasible solution with z = 4, B = {1,4} and x = [3,0,0,1,0,0] when the simplex tableau is

g; 1; 6f

g; 4; 5f

g are

1; 4f

f

x1 ¼ 3 þ x6
x6 ¼ 1
z ¼ x1 þ x6:

x1 ¼ 3
x4 ¼ 1
z ¼ x1 þ x4:

(3)

(4)

(5)

The previous example brieﬂy shows how to construct and solve a linear program of the
evolution between two snapshots of spatial distributions with the assumption that all
spatial interactions are of identical unit cost. Derived from Newton’s law of gravity, a

Downloaded by [ECU Libraries] at 23:06 14 December 2017 6

D. ZHU ET AL.

simple gravity model to describe the relationship between spatial
spatial distributions can be written as

interactions and

Fi;j ¼ kAiAj=f ðdi;jÞ;

(6)

where Fi;j is the interaction intensity from place i to j, Ai and Aj are their attractions (usually
measured by the population size), and f ðdi;jÞ is the spatial friction function related to the
distance di;j between them. The distance friction function f ðdi;jÞ may have several forms
according to the given application, among which the power function dβ is most widely
used (Wang 2012). The decay parameter β reveals the eﬀect of distance on spatial
interactions: a greater β indicates a faster distance decay eﬀect such that movements
are more likely to be impeded due to the spatial segregation. Suppose that the unit cost
of the interaction from place i to place j is ci;j, and the total cost of all the ﬂows in the
P
system is required to be a constant C ¼
ci;jFi;j when the evolutionary aim of the

P

i
regional system is an entropy optimization of the ﬂow distribution (Chen 2015). In real
scenarios of human movement inference, we can change the identical cost matrix into a
gravity-based cost matrix, where the unit cost of an interaction between place i and place
j is ci;j / dβ
ci;jFi;j remains
AiAj

. Thus, the total cost of migrations among all spatial units

P

P

j

i

j

ﬁxed when we adopt a gravity-based form of Fi;j. This deﬁnition of the unit cost leads to a
more reasonable curve for the distance decay that is convex and non-linear,

@d ¼ βd β(cid:3)1;
@c

indicating that the unit cost of spatial interactions increases, although at a sublinear rate,
with distance (Haggett 2001).

Now, we are ready to propose a formal method to infer spatial interaction patterns
from sequential snapshots of spatial distributions. Given two consecutive snapshots of
population distributions, S1 at time t1 and S2 at time t2, we formalize S1 and S2 as
S1 ¼ ½s1; s2; :::; si; :::; sn(cid:3)1; sn(cid:2)
n(cid:2);
; s(cid:7)
; :::; s(cid:7)
S2 ¼ ½s(cid:7)
i
1

; :::; s(cid:7)

; s(cid:7)
2

(8)

n(cid:3)1

where the study area consists of n spatial units, for instance, the set N. si and s(cid:7)
i are the
observed population in unit i 2 N at S1 and S2. The fully connected spatial interaction
patterns among all units can be represented by an n (cid:5) n matrix F.

(7)

(9)

0

B
B
B
B
B
B
B
B
B
B
@

0
f2;1
.
..
(cid:8) (cid:8) (cid:8)
.
..
fn(cid:3)1;1
fn;1

f1;2
0
.
..
(cid:8) (cid:8) (cid:8)
.
..
(cid:8) (cid:8) (cid:8)
(cid:8) (cid:8) (cid:8)

(cid:8) (cid:8) (cid:8)
(cid:8) (cid:8) (cid:8)
.
..
fi;j
.
..
(cid:8) (cid:8) (cid:8)
(cid:8) (cid:8) (cid:8)

f1;n(cid:3)1
(cid:8) (cid:8) (cid:8)
.
..
(cid:8) (cid:8) (cid:8)
.
..
(cid:8) (cid:8) (cid:8)
(cid:8) (cid:8) (cid:8)

1

C
C
C
C
C
C
C
C
C
C
A

f1;n
(cid:8) (cid:8) (cid:8)
.
..
(cid:8) (cid:8) (cid:8)
.
..
(cid:8) (cid:8) (cid:8)
0

F ¼

fi;j is the interaction ﬂow from unit i to unit j (i; j 2 N) during the evolution from S1 to S2,
and we do not consider intra-unit interactions. Meanwhile, an n (cid:5) n cost matrix C can be
used to describe the movement costs among the spatial units.

Downloaded by [ECU Libraries] at 23:06 14 December 2017 (10)

(11)

INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

7

0

B
B
B
B
B
B
B
B
B
B
@

0
c2;1
.
..
(cid:8) (cid:8) (cid:8)
.
..
cn(cid:3)1;1
cn;1

c1;2
0
.
..
(cid:8) (cid:8) (cid:8)
.
..
(cid:8) (cid:8) (cid:8)
(cid:8) (cid:8) (cid:8)

(cid:8) (cid:8) (cid:8)
(cid:8) (cid:8) (cid:8)
.
..
ci;j
.
..
(cid:8) (cid:8) (cid:8)
(cid:8) (cid:8) (cid:8)

c1;n(cid:3)1
(cid:8) (cid:8) (cid:8)
.
..
(cid:8) (cid:8) (cid:8)
.
..
(cid:8) (cid:8) (cid:8)
(cid:8) (cid:8) (cid:8)

1

C
C
C
C
C
C
C
C
C
C
A

c1;n
(cid:8) (cid:8) (cid:8)
.
..
(cid:8) (cid:8) (cid:8)
.
..
(cid:8) (cid:8) (cid:8)
0

C ¼

We assume the cost matrix to be symmetric, and the entries of the main diagonal are all
zero, that is "i; j 2 N, ci;j ¼ cj;i and ci;i ¼ 0. Then, we can construct the linear program as
follows:

minimize
subject to

CT (cid:5) F
P
si (cid:3)

j2N

P

j2N

fi;j 2 Zn; "i; j 2 N:

fi;j þ

fj;i ¼ s(cid:7)
i

; "i 2 N

Since a linear program in form (11) can always be transformed into the equational form
(2), we can ﬁnd the solution for F using the simplex method, as demonstrated before, if
the optimal basic solution does exist.

2.2. Experiments using synthetic data

The workﬂow diagram of Inferring Interactions from Distribution Snapshots (IIDS) is
illustrated in Figure 2. First, we calculate the geographic modiﬁed cost matrix for the
spatial units in our study area, where the deﬁnition of the cost matrix may vary
according to the characteristics of diﬀerent concerned spatial processes. Based on the
input temporal consecutive snapshots of spatial distributions, we construct the linear
program that minimizes the linear objective function of the total cost of spatial interac-
tions subject to some linear constraints such as the conservation of ﬂows and the non-
negativity of ﬂows during the evolution between snapshots. Then, we convert the initial
linear program into an equational form that is solvable by the simplex method and
ultimately obtain the feasible optimal spatial interaction pattern.

Experiments were conducted to infer the spatial interaction patterns in four simple
scenarios to test the IIDS method. In Figure 3, the four initial spatial distributions are
displayed in the column of Snapshot I, and they all end with the uniform distributions
shown in the column of Snapshot II. The initial spatial distributions of Snapshot I are all
discrete two-dimensional distributions represented in grid cells, and the distance matrix
is calculated using the Euclidean distances among the centres of the cells (we assume
the edge length of each cell to be one). Each distribution in Snapshot II is a uniform
distribution, of which the value in each cell
is the average of their corresponding
Snapshot I. As the optimal interaction patterns of our simulated scenarios are relatively
easy to infer by human perception, some characteristics of IIDS may be discovered
simply by comparing the calculated interaction patterns to the intuitional guesses on
these simulated evolutions.

In case 1, Snapshot I is a zebra-stripe-like distribution (Figure 3(a)) with non-zero
values set to 100, and Snapshot II is a uniform distribution with cell values set to 50

Downloaded by [ECU Libraries] at 23:06 14 December 2017 8

D. ZHU ET AL.

Figure 2. Diagram of Inferring Interactions from Distribution Snapshots (IIDS). The deﬁnition of the
geographical cost matrix can be modiﬁed according to the characteristics of diﬀerent concerned
spatial processes.

(Figure 3(b)). Assuming that all grid cells have equal gravitational attractions, which
means that the cost matrix is calculated based on only distance, the inferred interaction
pattern in Figure 3(c) is obviously an optimal and feasible solution with 50 ﬂows with the
same length of 1 and weight of 50, and the total cost is 2500. In case 2, Snapshot I is a
bisected distribution (Figure 3(d)) with non-zero values set to 100, and Snapshot II is a
uniform distribution with cell values set to 50 (Figure 3(e)). We used the same uniform
gravity conﬁguration as in case 1 and inferred 72 ﬂows in total: each ﬂow has a weight of
50, and the total cost is 12,500. The optimal local solution is not unique in this case
because the cost is simply a function of distance. For each row, we only need to ensure
that the horizontal ﬂows result in the observed evolution and that the total length of the
ﬂows is 25. The ﬂows illustrated in the 10 rows of Figure 3(f) are just some of the
possible solutions. Case 3 and case 4 are contrast experiments that help to investigate
the inﬂuence of gravitational attractions on the inferred result. In both cases, we built
the same ring-like distribution as the initial snapshot with non-zero values set to 100,
and the corresponding Snapshot II is a uniform distribution in which each grid cell has a
value of 20. Compared to the uniform gravity conﬁguration in case 3, we design a non-
uniform attraction distribution in case 4, where the black non-zero cells are 100 times
more attractive than the other cells (see Figure 3(m)). Thus, the ﬂows originating or
terminating at these four black cells may cost much less than the other ﬂows. In Figure 3
(i), the interaction pattern on the upper-left quarter (the evolution can be regarded as
four isologous local quarters) is diﬀerent from that of the other three quarters, which is
similar to the situation of case 2, where the optimal local solution is not unique and

Downloaded by [ECU Libraries] at 23:06 14 December 2017 INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

9

Snapshot I

Snapshot II

Inferred Interactions

case1

case2

case3

case4

(a)

(b)

(c)

(d)

(e)

(f)

(g)

(h)

(i)

(m)

(n)

(o)

Figure 3. Experiments under simulated scenarios.

leads to an unstable calculated pattern. However, in Figure 3(o), the interaction pattern
is reorganized due to the constraint of the four more attractive cells. Flows occur among
non-zero cells, and the calculated pattern is locally stable in all four quarters.

From these simulation experiments, we ﬁnd that IIDS can return an optimal solution
of the constructed linear program, which means that the inferred interaction pattern is a
net ﬂow pattern with no two-way interaction. If the optimal solution is not unique, IIDS
only chooses one of the optimal solutions to show a possible interaction pattern. For
real scenarios about inferring human interaction patterns, since the gravity conﬁgura-
tions are always complex distributions (e.g. population), IIDS is very likely to achieve a
single optimal solution. Therefore, if the time interval between given consecutive snap-
shots of spatial distributions is able to ensure that no extra spatial process exists other
than the one that directly drives the observed evolution of distributions, IIDS is able to

Downloaded by [ECU Libraries] at 23:06 14 December 2017 10

D. ZHU ET AL.

compute the net ﬂows of human movements correctly and provides information about
the hidden spatial interaction pattern.

3. Case study: the national-scale migration ﬂows during the Chinese spring
festival

The Spring Festival travel rush is a well-known event in China, during which interurban
human movements intensively surge in a short period of time around the Spring
Festival. This social phenomenon mainly results from the separation of the working
cities and home cities for a large portion of the Chinese population who have strong
demands to return home before New Year’s Eve (Li et al. 2016, Xu et al. 2017). On the
one hand, the number of job opportunities in a city can be considered proportional to
the population, which means that larger cities are more likely to attract job seekers. On
the other hand, people have the tendency to select closer cities as their work places to
reduce commuting costs. Therefore, a spatial interaction from the working city to the
home city can be regarded as a trade-oﬀ between the attractiveness and closeness of
candidate city pairs and can be modelled using a standard gravity model. Considering
the signiﬁcant impact of the Spring Festival travel rush, it is reasonable to assume that
no extra spatial process exists other than the migrations that result in the national-scale
evolution of population distributions, which is consistent with the prerequisite of IIDS
demonstrated in Section 2. Thus, we believe that the Chinese Spring Festival is a suitable
scenario for IIDS to infer the hidden spatial interactions.

3.1. Data descriptions

We utilized a positioning data set from Tencent, a major Chinese Internet company, to
apply our method to the real scenario of inferring human migrations around the Chinese
Spring Festival. The raw data set contains the daily number of active users in each
0:01(cid:9) (cid:5) 0:01(cid:9) geographic cell collected from related Tencent Mobile Apps for 28 con-
secutive days (16 January to 12 February of 2016). We obtained more than 38.4 billion
user records in total, representing an average of 1.37 billion records per day, which is
roughly equal to China’s population.1 We extracted two sub-data sets from the original
data set and generated two snapshots (Figure 4) of population as the input data for the
IIDS method. The ﬁrst snapshot is the distribution of the average number of daily active
users from 18 January to 22 January, which can be considered as a reﬂection of the
population distribution during a normal working week (Figure 4). The second snapshot
is the distribution of the average number of daily active users from 7 February to 11
February (7 February 2016 is New Years Eve), which reﬂects the population distribution
when people are enjoying the Spring Festival (Figure 4(b)). We used the 361 prefecture-
level cities of mainland China as our study units and relocated the number of active
users in each geographic cell onto the geometric centre of its corresponding city area, a
process usually called reverse geocoding (Ratcliﬀe 2001, Kounadi et al. 2013). Thus, the
reverse-geocoded snapshot I includes the population of each city before the Spring
Festival, and the reverse-geocoded snapshot II contains the population of each city
during the Spring Festival.

Downloaded by [ECU Libraries] at 23:06 14 December 2017 INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

11

(a)

(b)

Figure 4. (a) Snapshot I, the spatial distribution of daily average active users before the Spring
Festival (18 January 2016–22 January 2016). (b) Snapshot II, the spatial distribution of daily average
active users during the Spring Festival (7 February 2016–11 February 2016). Note that our study area
does not include Hong Kong, Macao or cities in Taiwan due to the bias of the data set, and all the
maps that we present in this paper do not delineate the islands in the South China Sea for
cartographic convenience.

In Figure 5(a), we illustrate the variation in the user number distribution between
snapshot I and snapshot II. Green indicates a decrease, with people leaving the city,
while red indicates an increase, with people arriving in the city. It is interesting to note
that almost all provincial capital cities show a decreasing pattern, whereas many lower
class cities in south-eastern China increase in population. Meanwhile, we selected the
original data of some typical prefecture-level cities and reproduced their normalized
daily temporal signatures (TSn) of active user numbers for all 28 consecutive days
(Figure 5). Beijing and Shenzhen are two of the megacities in China, and their TSn of
active user numbers show a decreasing tendency, with people gradually leaving before
the Spring Festival. The number of active users reaches the lowest point around New
Year’s Eve (Figure 5(b,c)). By contrast, Zhoukou (Henan Province) and Huanggang (Hubei
Province) are two lower level cities that show an increasing tendency, with people
continuously ﬂowing in before the Spring Festival. The number of active users reaches
the highest point around New Year’s Eve (Figure 5(f,g)). In addition, we chose Fushun

(b)

(c)

(d)

(a)

(e)

(f)

(g)

Figure 5. (a) The variation of user numbers from snapshot I to snapshot II at the city level. (b)–(g)
The normalized temporal variation signature of active users in some typical cities.

Downloaded by [ECU Libraries] at 23:06 14 December 2017 12

D. ZHU ET AL.

(Liaoning Province) and Mianyang (Sichuan Province) as examples to show that there are
also some small- and medium-sized cities that do not exhibit obvious variation patterns
of population despite the Spring Festival travel rush (Figure 5(d,e)).

In Figure 6, we plot the overall relation between city ranks and city sizes (active user
numbers), or the rank-size distribution, of Snapshots I and II. The relationship can be well
ﬁtted by a power law formulated as y ¼ kx(cid:3)α. The power law exponent α in the rank-size
ﬁtting curve denotes the degree of imbalance for the population distribution in China
(Jiang and Jia 2011). Since S1 has a steeper slope (α ¼ 0:553) than that of S2 (α ¼ 0:456),
which means that the users are less spatially clustered during the Spring Festival (S2) than
during normal workdays (S1), we conclude that there is a substantial human movement
pattern that leads to this reconﬁguration of spatial population distributions.

Despite the former analysis, this is the most information that we can obtain about the
spatial process. The detailed migration ﬂows between origins and destinations remain
unknown. Figures 5 and 6 have demonstrated the quantity variance across the country,
but no information about the hidden spatial interactions has been identiﬁed.

3.2. Results

Based on the two consecutive city-level snapshots of active user numbers in Figure 4(a,b), the
gravitational attraction Ai of city i can be approximated as the average number of its active
users in the two snapshots. The snapshots of spatial distributions are formulated as

SBefore ¼ ½s1; s2; :::; si; :::; sn(cid:3)1; sn(cid:2)
n(cid:2):
; s(cid:7)
; :::; s(cid:7)
SAfter ¼ ½s(cid:7)
i
1

; :::; s(cid:7)

; s(cid:7)
2

n(cid:3)1

(12)

Figure 6. The distributions of cities’ active user numbers in Snapshot I and Snapshot II. The rank-size
plots in the log–log scale appear to be straight lines, indicating power law distributions for both S1
and S2. S1 has a steeper slope (α ¼ 0:553) than does S2 (α ¼ 0:456), which means that the users are
more spatially clustered (imbalanced) in S1 than in S2.

Downloaded by [ECU Libraries] at 23:06 14 December 2017 INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

13

In our collected data, the total user number of SAfter is slightly smaller than that of SBefore,
which means that the system is not self-contained, with some people leaving the
Chinese mainland around the Spring Festival. To ensure that our inferred results repre-
sent the interaction patterns of the national-scale migration ﬂows, we normalized s(cid:7)
i to
s(cid:7)
be ðs(cid:7)
i ; thus, the total user number remains unchanged between the two
i (cid:8)
i Þ=2,

is approximated as Ai ¼ ðsi þ s(cid:7)

snapshots. Then, the gravitational attraction Ai
where s(cid:7)

i represents the normalized user number of city i in SAfter.

siÞ=

P

P

i

i

The inferred spatial interaction pattern using a gravity-model-based cost matrix
with the power law distance friction parameter β =1.0 is illustrated in Figure 7(a),
and the parameters are explained in Figure 7(b) separately. Flows are rendered as
arrows from one city to another, with diﬀerent colours and line widths denoting
the interaction strength (weight of the ﬂow). By deﬁning the gravity-model-based

(a)

(b)

α
β
Iteration times
Number of ﬂows
Number of migrants
Optimal cost

109
1.0
1,922
364
.353 × 108
3
1.281 × 109

Figure 7. The inferred spatial
β ¼ 1:0. (a) Illustration of the inferred pattern. (b) Related parameters in IIDS.

interactions using IIDS with the gravity cost matrix C /

β
d
i;j
Ai(cid:8)Aj

and

Downloaded by [ECU Libraries] at 23:06 14 December 2017 14

D. ZHU ET AL.

cost matrix with β ¼ 1:0, our IIDS method iterates 1922 times using the simplex
method and obtains the optimal total ﬂow cost. α is a parameter used to optimize
the precision of computing and is set to be 109 in this case. The inferred number of
aggregated ﬂows is 364, with more than 335 million individual migrations in total.
As expected, four urban agglomerations in China can be easily found (Figure 7(a)),
that is the Yangtze River Delta urban agglomeration in East China (Shanghai,
Suzhou and Hangzhou as core cities), the Beijing–Tianjin–Hebei area in North
China, the Pearl River Delta urban agglomeration in South China (Guangzhou and
Shenzhen as core cities) and the Chengdu–Chongqing urban agglomeration in
Southwest China. Meanwhile, most provincial capital cities act as the sources of
migrations to lower level cities within the province. With the geographic constraint
of the gravity-model-based cost matrix, the inferred long-distance movements are
than the short-distance movements, while some long-distance ﬂows
smaller
between large cities, such as the most prominent ﬂow from Shenzhen to
Chongqing, can also be identiﬁed.

Detailed illustrations of some local patterns are given in Figure 8 by zooming into
four subareas A, B, C and D. Subarea A shows the inferred ﬂows among Chongqing and
the Pearl River Delta urban agglomeration, where a huge inﬂux of people from
Shenzhen, Dongguan to Chongqing is observed, which is consistent with the fact that
a large number of people from the Chongqing area are working in the Pearl River Delta,
and they return home during the Spring Festival. Subareas B and C show the typical
local patterns of Chengdu and Zhengzhou, two of the major provincial capital cities in
China, where the spatial interactions present radial patterns from the capital city to
aﬃliated cities. Subarea D is the Beijing–Tianjin–Hebei area in North China. We can see
that even though Beijing and Tianjin are connected and both serve as ﬂow sources, the
strongest interaction in this area is from Beijing to Handan, Hebei.

Figure 8. Detailed illustrations of some inferred local patterns in Figure 7(a). Yellow polygons are the
cities selected for further explanations. In subarea A, the upper left yellow polygon is Chongqing,
and the lower right polygons are Guangzhou and Shenzhen.
In subarea B, the yellow polygon
delineates the city of Chengdu, and in subarea C, the yellow polygon represents Zhengzhou. In
subarea D, Beijing and Tianjin are selected and illustrated in yellow.

Downloaded by [ECU Libraries] at 23:06 14 December 2017 INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

15

4. Discussion

4.1. Evaluation of the inferred patterns

Since we do not have access to the actual national-scale human migration data during
the 2016 Chinese Spring Festival, a data set collected by Baidu (a major Chinese web
services company) was adopted as a substitute for the real migrant ﬂows to evaluate our
inferred interaction patterns by IIDS. This data set includes the city-level population
migration numbers (quarterly) from the fourth quarter of 2015 (2015Q4) to the ﬁrst
quarter of 2016 (2016Q1)2. The real numbers of migrations, which represent the inter-
action strength, are scaled down to another dimension for data conﬁdentiality. The scale
of Baidu’s migration data is thus diﬀerent from that of our inferred ﬂows. We selected
the spatial interactions related to Beijing, Chengdu and Shanghai that are inferred by
IIDS (Figure 7(a)) and searched their corresponding migration numbers in the Baidu data
set. We then investigated the correlation between our inferred interactions and the real
interactions. The chosen cities in this evaluation experiment are relatively large, and
their migration patterns are considered more stable compared to lower level cities.

Figure 9 depicts the OLS regression lines and the correlation coeﬃcients for six sets of
samples. For Beijing, the Pearson correlation coeﬃcient r is 0.758 when ﬁtting the

(a)

(c)

(e)

(b)

(d)

(f)

Figure 9. The correlation analysis between the inferred interaction patterns (during the 2016
Chinese Spring Festival) and Baidu’s quarterly migration data set (from 2015Q4 to 2016Q1) for
three major cities: Beijing, Chengdu and Shanghai. The ﬁgure parts (a), (c), (e) show the results of the
ordinary least squares (OLS) regression on the interaction strength, where a negative value means
inﬂow and a positive value means outﬂow. The ﬁgure parts (b), (d), (f) show the results of the OLS
regression on the rank of the interaction strength. Note that the ranking of cities is sorted in a
descending order from positive interaction strength to negative interaction strength.

Downloaded by [ECU Libraries] at 23:06 14 December 2017 16

D. ZHU ET AL.

migration numbers (Figure 9(a)), and the Spearman’s correlation coeﬃcient for ranked
data ρ is 0.923 when ﬁtting the city ranks of migration numbers (Figure 9(b)). Shanghai
exhibits a similar result to Beijing, with a lower r ¼ 0:773 in Figure 6 and a higher ρ ¼
0:844 in Figure 9(f). For Chengdu, the correlation coeﬃcients are approximately 0.9 in
both situations (Figure 9(c,d)). The correlation analysis indicates that, for the represen-
tative cities, our inferred interaction patterns by IIDS are positively associated with real
patterns from the numerical perspective (r > 0:75 in Figure 9(a,c,e); the correlation is
even stronger from the rank perspective (ρ (cid:10) 0:9 in Figure 9(b,d,f)) when reducing the
impacts of extreme values on the calculation. Although the studied time intervals are
not exactly the same between our case study and the Baidu data set, the correlation
analysis results are satisfying enough to demonstrate the practicability of IIDS under real
scenarios of inferring large-scale human movements.

4.2. Deﬁnition of the cost matrix

Then, we used the result in Figure 7(a) as the baseline and designed several other cost
matrices for comparison. By changing the distance–decay parameter β in the gravity-
model-based cost matrix, we slightly modiﬁed the preference of our calculation, that is
we changed the inﬂuence of the spatial displacement on the occurrence of interactions.
A higher β represents a stronger blocking eﬀect, while a lower β denotes less rejection
for long-distance interactions. Figure 10(a,c) illustrates the inferred interaction patterns
with β =0.8 and 0.4, respectively. The related IIDS parameters are listed in Figure 10(b,d).
long-distance ﬂows are more likely to be inferred when
Compared to Figure 7(a),
decreasing the value of β, even though most long-distance ﬂows have relatively low
weights. When setting β to 1.0, there is no obvious interaction between the Beijing–
Tianjin–Hebei area and the Yangtze River Delta urban agglomeration. However, when β
is changed to 0.8, one of the most signiﬁcant changes in the inferred pattern is a direct
spatial interaction from the Yangtze River Delta urban agglomeration to Beijing, or more
speciﬁcally, from Suzhou to Beijing. Additionally, β =0.4 generates a greater diﬀusional
pattern in which more long-distance ﬂows are inferred, and provincial capital cities tend
to have larger aﬃliated hinterland areas. The most signiﬁcant ﬂow between the Yangtze
River Delta urban agglomeration and Beijing is from Hangzhou to Beijing. In addition,
when β changes from 1.0 to 0.4, the originally strongest interaction between Shenzhen
and Chongqing decomposes into several outﬂows from Shenzhen to lower level cities
and inﬂows from other lower level cities to Chongqing.

Furthermore, the results of three other cost matrices are presented to test the
performance of IIDS. Figure 11(a,b) shows the results of a cost matrix that considers
only the inverse proportional relationship between the ﬂow cost and the attraction of
cities. For this result,
interactions occur among big cities and form a diamond-like
pattern with Beijing, Shanghai, Shenzhen, Chengdu and Chongqing as the vertexes. It
is diﬃcult to identify the central role of the provincial capital cities since the ﬂows from
lower level cities are rearranged to achieve the optimal total cost. Figure 11(c,d) shows
the result of a cost matrix that considers only the distance decay eﬀect of spatial
interactions. In contrast to Figure 11(a), considering only the inﬂuence of the distance
makes the inferred result unreasonable. Cross-nation migrations from Southwest China
to Xinjiang and Tibet no longer exist, the average distance of the inferred ﬂows is

Downloaded by [ECU Libraries] at 23:06 14 December 2017 INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

17

(a)

(b)

Cost matrix

Ci,j =

(cid:2)

α · dβ
i,j
Ai·Aj
0

(i (cid:2)= j)
(i = j)

α
β
Iteration times
Number of ﬂows
Number of migrants
Optimal cost

109
0.8
1,925
364
.276 × 108
3
.957 × 107
9

Cost matrix

Ci,j =

(cid:2)

α · dβ
i,j
Ai·Aj
0

(i (cid:2)= j)
(i = j)

α
β
Iteration times
Number of ﬂows
Number of migrants
Optimal cost

109
0.4
1,956
365
.130 × 108
3
5.721 × 105

(c)

(d)

and β =0.8
Figure 10. The inferred spatial interactions using IIDS with a gravity cost matrix C /
and 0.4. (a) Illustration of the inferred pattern with β =0.8. (b) Related parameters in IIDS with a
gravity cost matrix and β =0.8. (c) Illustration of the inferred pattern with β =0.4. (d) Related
parameters in IIDS with a gravity cost matrix and β =0.4.

β
d
i;j
Ai(cid:8)Aj

signiﬁcantly reduced and the ﬂows are concentrated on closer city pairs. Figure 11(e,f)
shows the results of an identical cost matrix, where the cost between any two cities is
ﬁxed as one. Similar to case 2 in Figure 3, where IIDS has more than one optimal
solution, the result in Figure 11(e) is simply one of the optimal solutions and exhibits
no apparent regular pattern.

4.3. Shortcomings and future directions

Admittedly, inferring spatial interaction patterns from sequential snapshots of spatial
distributions, as proposed in this research, has some deﬁciencies. First, the basic require-
ment of our method that we have to ensure that there is only one spatial process and
that it is the one that directly drives the observed evolution during snapshots may be
too strong. Unfortunately, for many real situations, such as intra-urban daily commuting,
the migration pattern of people is far from optimal due to the existence of the excess
commuting (Horner and Murray 2002, Ma and Banister 2006) and geometric restrictions
of the traﬃc network, which may lead to inaccurate inferences when applying our
method. The potential of our workﬂow for understanding intra-urban human migrations
must be the subject of future work exploring at ﬁner spatio-temporal scales. Second, the

Downloaded by [ECU Libraries] at 23:06 14 December 2017 18

D. ZHU ET AL.

(a)

(b)

(c)

(d)

Cost matrix

Ci,j =

(cid:3)

α ·

1
Ai·Aj
0

(i (cid:2)= j)
(i = j)

α
Iteration times
Number of ﬂows
Number of migrants
Optimal cost

1015
2,073
365
3.202 × 108
3.026 × 109

Cost matrix

Ci,j =

(cid:3)

α · dβ
0

i,j (i (cid:2)= j)
(i = j)

α
β
Iteration times
Number of ﬂows
Number of migrants
Optimal cost

10−3
1
2,267
360
2.185 × 108
8.204 × 1010

Cost matrix

Ci,j =

(cid:3)

1 (i (cid:2)= j)
0 (i = j)

Iteration times
Number of ﬂows
Number of migrants
Optimal cost

1,398
360
2.185 × 108
2.185 × 108

(e)

(f)

Figure 11. The inferred spatial interactions using IIDS with diﬀerent deﬁnitions of the cost matrix. (a)
Illustration of the inferred pattern with an inverse-attraction-based cost matrix. (b) Related para-
meters in IIDS with an inverse-attraction-based cost matrix. (c) Illustration of the inferred pattern
with a distance-decay-based cost matrix. (d) Related parameters in IIDS with a distance-decay-based
cost matrix. (e) Illustration of the inferred pattern with identical costs. (f) Related parameters in IIDS
with identical costs.

interactions is one of net ﬂux instead of the two-way
inferred strength of spatial
connections that exist between cities, which means that we can only infer the spatial
interaction pattern that directly causes the spatial reconﬁguration. The inference may
help us to understand the dynamic relationship between spatial heterogeneity and
spatial interactions but cannot be used to calculate the exact ﬂows. For example, if
there are three million people traveling from Beijing to Shanghai and three million
people simultaneously migrating from Shanghai to Beijing, the inferred interaction
strength between Beijing and Shanghai will be zero.

Downloaded by [ECU Libraries] at 23:06 14 December 2017 INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

19

5. Conclusions

interactions separately or adopted the observed spatial

The rapid development of big geodata and spatio-temporal analysis methods enables us
to investigate the relationship between spatial heterogeneity and spatial interactions, the
two essential issues in geographic studies. Most research has addressed spatial distribu-
interaction
tions and spatial
patterns to retrieve unknown information about spatial distributions.
In contrast, few
studies have focused on inferring spatial interaction patterns from observed multi-tem-
poral snapshot data, even though the acquisition of high-quality spatial interaction data is
actually signiﬁcantly more diﬃcult than that of distributions in many practical situations.
Given the basic assumption that the time interval between two consecutive snap-
shots of spatial distributions is not too long to ensure that no independent spatial
process exists other than the one that directly drives the observed evolution, we
proposed a framework to infer spatial interaction patterns from temporal spatial dis-
tribution snapshots, named IIDS. The inference can be modelled as a spatial optimization
task, the decision strategy of which is to ﬁnd a possible interaction pattern that mini-
mizes the total ﬂow cost of the network. Aimed at the retrieval of human behaviours, we
introduced a method to construct and compute linear programs of human movements
considering both the conservation of ﬂows at each spatial unit and the geographic
inﬂuence on the objective functions. We conducted four experiments under simulated
scenarios in which the interaction patterns can be easily inferred by human perception.
The results generated by IIDS show that our method can correctly obtain an optimal
IIDS only
solution of the constructed linear program.
chooses one of the optimal solutions.

If the solution is not unique,

The understanding and modelling of human movements under speciﬁc circum-
stances may determine the similarity between the inferred pattern and the real pattern.
In the case study of inferring national-scale migration ﬂows during the Chinese Spring
Festival, we adopted the classic gravity model to characterize the trade-oﬀ between the
attractiveness and closeness of candidate working cities for job seekers. The inferred
migration ﬂows using IIDS with a gravity-model-based cost matrix provided detailed
information about how the population distribution became less spatially clustered
around the Spring Festival. The inferred interaction pattern agrees well with a migration
data set from another independent source and forms an interesting network that is
consistent with our understanding of the organization of Chinese cities.

Tobler’s ﬁrst law implies spatial heterogeneity and spatial interactions in the geogra-
phical space (Tobler 1970); these two closely tangled concepts have long been studied
by geographers. The development of GIScience and big data provides an unprece-
dented opportunity to revisit the relationship between spatial heterogeneity and spatial
interactions. In this research, for the ﬁrst time, we propose a method to infer spatial
interaction patterns from sequential snapshots of spatial distributions; the method is
shown to be correct and eﬀective but can also be improved. The proposed method is a
positive attempt to investigate the dynamic relationship between spatial heterogeneity
and spatial interactions and oﬀers a general analytical framework for other studies to
retrieve spatial interaction patterns from snapshot distributions. Our research shows that
the inference of spatial interaction patterns from sequential snapshots of spatial dis-
tributions is feasible and is of great value in related ﬁelds.

Downloaded by [ECU Libraries] at 23:06 14 December 2017 20

D. ZHU ET AL.

Notes

1. Although the daily active users and population are close in quantity, we are not saying
that the data set is a near perfect sampling of China’s population or that everyone in China
is using Tencent apps. However, we do treat the number of users as a proxy for
population.

2. This data set is aggregated from individual locations collected by Baidu Mobile Apps, where a
migration is recorded if there is a change in residential city for a person from 2015Q4 to
2016Q1.

Acknowledgements

The authors thank X. Chen, Y. Wang and D. Tong for their advice; L. Dong for providing the Baidu
migration data and professor May Yuan, professor Shawn Laﬀan and the anonymous referees for
their insightful comments.

Disclosure statement

No potential conﬂict of interest was reported by the authors.

This research was supported by the National Key Research and Development Program of China
[Grant Number: 2017YFB0503602] and the National Natural Science Foundation of China [Grant
Number: 41625003].

Funding

ORCID

References

Di Zhu
Yu Liu

http://orcid.org/0000-0002-3237-6032
http://orcid.org/0000-0002-0016-2902

Ahmed, B., 2011. Urban land cover change detection analysis and modeling spatio-temporal
Growth dynamics using Remote Sensing and GIS Techniques: A case study of Dhaka,
Bangladesh. Thesis (PhD).

Ahuja, R.K., Magnanti, T.L., and Orlin, J.B., 1993. Network ﬂows: theory, algorithms, and applications.

New Jersey, NJ: Prentice Hall.

Alrawas, G.A., et al. 2013. Eﬀects of urban form on wadi ﬂow frequency analysis in the Wadi Aday

watershed in Muscat, Oman. Urban Water Journal, 12 (4), 1–12.

Barabsi, A.L., 2005. The origin of bursts and heavy tails in human dynamics. Nature, 435 (7039),

Barthelemy, M., 2010. Spatial networks. Physics Reports, 499 (1), 1–101. doi:10.1016/j.

207–211. doi:10.1038/nature03459

physrep.2010.11.002

Baszczyk, M., Jania, J.A., and Hagen, J.O., 2009. Tidewater glaciers of svalbard: recent changes and

estimates of calving ﬂuxes. Polish Polar Research, 30 (2), 85–142.

Batty, M., 2013. Big data, smart cities and city planning. Dialogues in Human Geography, 3 (3), 274–

279. doi:10.1177/2043820613513390

Batty, M., 2013b. The new science of cities. Cambridge, MA: MIT Press.

Downloaded by [ECU Libraries] at 23:06 14 December 2017 INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

21

Blondel, V.D., Decuyper, A., and Krings, G., 2015. A survey of results on mobile phone datasets

analysis. EPJ Data Science, 4 (1), 1–55. doi:10.1140/epjds/s13688-015-0046-0

Calabrese, F., et al. 2011. Estimating origin-destination ﬂows using mobile phone location data.

IEEE Pervasive Computing, 10 (4), 36–44. doi:10.1109/MPRV.2011.41

Chee, Y.E., et al. 2016. Modelling spatial and temporal changes with GIS and Spatial and Dynamic
Bayesian Networks. Environmental Modelling and Software, 82, 108–120. doi:10.1016/j.
envsoft.2016.04.012

Chen, Y., 2015. The distance-decay function of geographical gravity model: power law or expo-
nential law? Chaos Solitons and Fractals the Interdisciplinary Journal of Nonlinear Science and
Nonequilibrium and Complex Phenomena, 77 (11), 174–189.

Cook, W.J., et al. 1997. Minimum-cost ﬂow problems. Combinatorial Optimization. 1st ed. Hoboken,

NJ: John Wiley & Sons, 91–126.

Dantzig, G.B. and Thapa, M.N., 1997. The simplex method. Berlin: Springer.
Deville, P., et al. 2014. Dynamic population mapping using mobile phone data. Proceedings of the
the United States of America, 111 (45), 15888–15893.

National Academy of Sciences of
doi:10.1073/pnas.1408439111

Foth, M., Choi, H.J., and Satchell, C., 2011. Urban informatics. In: Proceedings of the ACM 2011

Conference on Computer Supported Cooperative Work, 1–8.

Fotheringham, A.S., 2001. Spatial interaction models. International Encyclopedia of the Social and

Behavioral Sciences. Oxford: Elsevier Science, 14794–14800.

Fotheringham, A.S. and Webber, M.J., 1980. Spatial structure and the parameters of spatial
interaction models. Geographical Analysis, 12 (1), 33–46. doi:10.1111/j.1538-4632.1980.tb00016.x
Gonzalez, M.C., Hidalgo, C.A., and Barabasi, A.L., 2008. Understanding individual human mobility

patterns. Nature, 453 (7196), 779–782. doi:10.1038/nature06958

Haggett, P., 2001. Geography: a global synthesis. New York, NY: Pearson Education.
Han, X.P., Wang, B.H., and Zhou, T., 2010. Researches of human dynamics. Complex Systems and

Hao, J., Zhu, J., and Zhong, R., 2015. The rise of big data on urban studies and planning practices in
review and open research issues. Journal of Urban Management, 4 (2), 92–124.

Complexity Science, 7, 132–144.

China:
doi:10.1016/j.jum.2015.11.002

Hawelka, B., et al. 2014. Geo-located Twitter as proxy for global mobility patterns. Cartography and

Geographic Information Science, 41 (3), 260–271. doi:10.1080/15230406.2014.890072

Holzhauser, M., Krumke, S.O., and Thielen, C., 2016. Budget-constrained minimum cost ﬂows.

Journal of Combinatorial Optimization, 31 (4), 1720–1745. doi:10.1007/s10878-015-9865-y

Horner, M. and Murray, A., 2002. Excess commuting and the modiﬁable areal unit problem. Urban

Studies, 39 (1), 131–139. doi:10.1080/00420980220099113

Hornsby, K.S. and Cole, S., 2007. Modeling moving geospatial objects from an event-based

perspective. Transactions in GIS, 11 (4), 555–573. doi:10.1111/tgis.2007.11.issue-4

Jiang, B. and Jia, T., 2011. Zipf’s law for all the natural cities in the United States: a geospatial
Information Science, 25 (8), 1269–1281.

International Journal of Geographical

perspective.
doi:10.1080/13658816.2010.510801

Kang, C., et al. 2012. Towards estimating urban population distributions from mobile call data.

Journal of Urban Technology, 19 (4), 3–21. doi:10.1080/10630732.2012.715479

Kounadi, O., et al. 2013. Accuracy and privacy aspects in free online reverse geocoding services.
doi:10.1080/

and Geographic

Information

140–153.

Science,

(2),

40

Cartography
15230406.2013.777138

Leon, S.J., 1980. Linear algebra with applications. New York, NY: Macmillan.
Li, J., et al. 2016. Spatial-temporal analysis on spring festival travel rush in china based on multi-

source big data. Sustainability, 8 (11), 1184. doi:10.3390/su8111184

Li, Y., Han, J., and Yang, J., 2004. Clustering moving objects. In: Proceedings of the tenth ACM

SIGKDD international conference on Knowledge discovery and data mining, 617–622.

Liu, C. and Li, Y., 2017. GIS-based dynamic modelling and analysis of ﬂash ﬂoods considering land-
Information Science, 31 (3), 481–498.

International Journal of Geographical

use planning.
doi:10.1080/13658816.2016.1207774

Downloaded by [ECU Libraries] at 23:06 14 December 2017 22

D. ZHU ET AL.

Liu, Y., et al. 2014. Uncovering patterns of inter-urban trip and spatial interaction from social media

check-in data. PLoS ONE, 9 (1), e86026. doi:10.1371/journal.pone.0086026

Liu, Y., et al. 2015. Social sensing: a new approach to understanding our socioeconomic environ-
ments. Annals of the Association of American Geographers, 105 (3), 512–530. doi:10.1080/
00045608.2015.1018773

Long, Y. and Liu, L., 2017. How green are the streets? An analysis for central areas of Chinese cities

using tencent street view. PLoS ONE, 12, e0171110. doi:10.1371/journal.pone.0171110

Longley, P.A., et al. 2015. Geographic information science and systems. 4th ed. Hoboken: NJ: John

Wiley & Sons.

Lu, Y. and Liu, Y., 2012. Pervasive location acquisition technologies: opportunities and challenges
for geospatial studies. Computers Environment and Urban Systems, 36 (2), 105–108. doi:10.1016/j.
compenvurbsys.2012.02.002

Ma, K. and Banister, D., 2006. Excess commuting: a critical review. Transport Reviews, 26 (6), 749–

767. doi:10.1080/01441640600782609

Matousek, J. and Gärtner, B., 2007. Understanding and using linear programming. Berlin: Springer.
Meyer, C.D., 2000. Matrix analysis and applied linear algebra. Philadelphia, PA: SIAM.
Miller, H.J., 2004. Tobler’s ﬁrst law and spatial analysis. Annals of the Association of American

Geographers, 94 (2), 284–289. doi:10.1111/j.1467-8306.2004.09402005.x

Montjoye, Y.A.D., et al. 2013. Unique in the Crowd: the privacy bounds of human mobility. Scientiﬁc

Reports, 3 (6), 1376. doi:10.1038/srep01376

Nelder, J.A. and Mead, R., 1965. A simplex method for function minimization. The Computer

Journal, 7 (4), 308–313. doi:10.1093/comjnl/7.4.308

Pei, T., et al. 2014. A new insight into land use classiﬁcation based on aggregated mobile phone
data. International Journal of Geographical Information Science, 28 (9), 1988–2007. doi:10.1080/
13658816.2014.913794

Ratcliﬀe, J.H., 2001. On the accuracy of TIGER-type geocoded address data in relation to cadastral
and census areal units. International Journal of Geographical Information Science, 15 (5), 473–485.
doi:10.1080/13658810110047221

Ratti, C., et al. 2006. Mobile landscapes: using location data from cell phones for urban analysis.

Environment and Planning B: Planning and Design, 33 (5), 727–748. doi:10.1068/b32047

Ratti, C., et al. 2010. Redrawing the map of Great Britain from a network of human interactions.

PLoS ONE, 5 (12), e14248. doi:10.1371/journal.pone.0014248

Rodrigue, J.P., Comtois, C., and Slack, B., 2013. The Geography of Transport Systems. New York,

NY: Routledge.

Roy, J.R. and Thill, J.C., 2003. Spatial interaction modelling. Papers in Regional Science, 83 (1), 339–

361. doi:10.1007/s10110-003-0189-4

Shen, G., 2004. Reverse-ﬁtting the gravity model to inter-city airline passenger ﬂows by an
Journal of Transport Geography, 12 (3), 219–234. doi:10.1016/j.

algebraic simpliﬁcation.
jtrangeo.2003.12.006

Shoshany, M., EvenPaz, A., and Bekhor, S., 2007. Evolution of clusters in dynamic point patterns:
with a case study of Ants’ simulation. International Journal of Geographical Information Science,
21 (7), 777–797. doi:10.1080/13658810601169881

Sinha, G. and Mark, D.M., 2005. Measuring similarity between geospatial lifelines in studies of
environmental health. Journal of Geographical Systems, 7 (1), 115–136. doi:10.1007/s10109-005-
0153-8

Song, C., et al. 2010a. Modelling the scaling properties of human mobility. Nature Physics, 6 (10),

Song, C., et al. 2010b. Limits of predictability in human mobility. Science, 327 (5968), 1018–1021.

818–823. doi:10.1038/nphys1760

doi:10.1126/science.1177170

Swihart, R.K. and Slade, N.A., 1985. Testing for independence of observations in animal move-

ments. Ecology, 66 (4), 1176–1184. doi:10.2307/1939170

Tobler, W.R., 1970. A computer movie simulating urban growth in the Detroit region. Economic

Geography, 46, 234–240. doi:10.2307/143141

Downloaded by [ECU Libraries] at 23:06 14 December 2017 INTERNATIONAL JOURNAL OF GEOGRAPHICAL INFORMATION SCIENCE

23

Toole, J.L., et al., 2012. Inferring land use from mobile phone activity. In: Proceedings of the ACM

SIGKDD International Workshop on Urban Computing, 1–8.

Wang, F., 2012. Measurement, optimization, and impact of health care accessibility: a methodolo-
gical review. Annals of the Association of American Geographers, 102 (5), 1104–1112. doi:10.1080/
00045608.2012.657146

Wilson, A.G., 1971. A family of spatial

interaction models, and associated developments.

Environment and Planning A, 3 (1), 1–32. doi:10.1068/a030001

Wilson, A.G., 2011. Entropy in urban and regional modelling. Vol. 1, New York, NY: Routledge.
Worboys, M., 2005. Event-oriented approaches to geographic phenomena. International Journal of

Geographical Information Science, 19 (1), 1–28. doi:10.1080/13658810412331280167

Xiao, Y., et al. 2013. Reconstructing gravitational attractions of major cities in China from air
passenger ﬂow data, 2001–2008: a particle swarm optimization approach. The Professional
Geographer, 65 (2), 265–282. doi:10.1080/00330124.2012.679445

Xu, J., et al. 2017. Diﬀerence of urban development in China from the perspective of passenger
doi:10.1016/j.
Applied

Geography,

85–96.

festival.

spring

87,

transport
around
apgeog.2017.07.014

Yuan, Y. and Raubal, M., 2012. Extracting dynamic urban mobility patterns from mobile phone
data. Lecture Notes in Computer Science, 7478, 354–367. doi:10.1007/978-3-642-33024-7_26
Yuan, Y. and Raubal, M., 2016. Analyzing the distribution of human activity space from mobile
International Journal of Geographical

phone usage: an individual and urban-oriented study.
Information Science, 30 (8), 1594–1621. doi:10.1080/13658816.2016.1143555

Zhao, X., 2011. Monitoring the dynamics of wetland inundation by random sets on multi-temporal

images. Remote Sensing of Environment, 115 (9), 2390–2401. doi:10.1016/j.rse.2011.05.002

Zhao, Z., et al. 2016. Understanding the bias of call detail records in human mobility research.
Information Science, 30 (9), 1738–1762. doi:10.1080/

International Journal of Geographical
13658816.2015.1137298

Downloaded by [ECU Libraries] at 23:06 14 December 2017 