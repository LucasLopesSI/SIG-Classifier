27

ARTICLE

The rHEALPix Discrete Global Grid System: considerations
for Canada
David Bowater and Emmanuel Stefanakis

Abstract: Geospatial data is ubiquitous. However, the geographic grid is not designed to manage, store, or inte-
grate huge volumes of heterogeneous geospatial data. One possible solution to these challenges is a Discrete
Global Grid System (DGGS), which was recently announced as a new standard by the Open Geospatial
Consortium (OGC). If Canada plans to utilize a DGGS in the future to reference geospatial data, research is needed
to explore characteristics and suitability of different DGGSs. Although hexagonal- and triangular-based DGGSs are
popular, the square-based rHEALPix DGGS mirrors the geographic grid more closely and has many advantages.
This paper reviews key features of the rHEALPix DGGS, outlines recent work, and qualitatively considers cell
shape and cell orientation with respect to Canada, including how variations can be avoided or exploited by rotat-
ing the grid.

Key words: Discrete Global Grid System, rHEALPix DGGS, Canada, spatial data structure.

Résumé : Les données géospatiales sont omniprésentes. Toutefois, la grille géographique n’est pas conçue pour
gérer, stocker ou intégrer d’énormes quantités de données géospatiales hétérogènes. Une solution possible à ces
problèmes est un Discrete Global Grid System (DGGS) qui a été annoncé récemment comme nouvelle norme par
le Open Geospatial Consortium (OGC). Si le Canada prévoit utiliser le DGGS dans le futur pour référencer les
données géospatiales, une recherche est requise pour examiner les caractéristiques et la pertinence des
différents DGGS. Même si les DGGS hexagonaux et triangulaires sont populaires, le rHEALPix DGGS à base
carrée reflète davantage la grille géographique et possède de nombreux avantages. La présente communication
examine les principales caractéristiques du rHEALPix DGGS, décrit les travaux récents et examine qualitativement
la forme de la cellule et l’orientation de la cellule en ce qui a trait au Canada, y compris la façon dont les écarts peu-
vent être évités ou exploités en faisant pivoter la grille. [Traduit par la Rédaction]

Mots-clés : Discrete Global Grid System, rHEALPix DGGS, Canada, structure des données spatiales.

1. Introduction

In recent years, the growth in the number of ground,
airborne, and satellite sensors has led to a significant
increase in the amount, variety, and rate of collection
of geospatial data. However, combining huge volumes
of heterogeneous geospatial data on the geographic grid
is computationally expensive and time consuming (OGC
2016; OGC 2017a). One solution is a Discrete Global Grid
System (DGGS). A DGGS is capable of efficient manage-
ment, storage, integration, exploration, mining, and vis-
ualisation of geospatial big data. Over the years, many
DGGSs have been devised, and although a single DGGS
cannot currently meet all global geospatial needs
(Amiri et al. 2015; OGC 2017a), the potential of a DGGS
was confirmed in October 2017 when the Open

Geospatial Consortium (OGC) officially adopted the
DGGS as a new standard (OGC 2017c).

If Canada plans to adopt a DGGS framework in the
future to reference geospatial data, important research
is needed to explore characteristics and suitability of
different DGGSs. Although hexagonal and triangular
DGGSs based on the Icosahedral Snyder Equal Area
(ISEA) projection are popular, they are not optimal for
all applications (Amiri et al. 2015). The rHEALPix DGGS
(Gibb et al. 2016), which is based on the Hierarchical
Equal Area isoLatitude Pixelization (HEALPix) projec-
tion, adopts a square cell approach that mirrors the geo-
graphic grid more closely and has several advantages
over DGGSs based on hexagonal or triangular cells.
This paper reviews key features of the rHEALPix DGGS,

Received 20 April 2018. Accepted 26 June 2018.

D. Bowater and E. Stefanakis. Department of Geodesy and Geomatics Engineering, University of New Brunswick, Fredericton, NB E3B
5A3, Canada.

Corresponding author: David Bowater (email: david.bowater@unb.ca).

Copyright remains with the author(s) or their institution(s). Permission for reuse (free in most cases) can be obtained from RightsLink.

Geomat. 72: 27–37 (2018) dx.doi.org/10.1139/geomat-2018-0008

Published at www.nrcresearchpress.com/geomat on 30 July 2018.

Geomatica 2018.72:27-37.Downloaded from www.nrcresearchpress.com by GLASGOW UNIVERSITY LIBRARY on 09/18/18. For personal use only.28

Geomat. Vol. 72, 2018

highlights advantages and disadvantages, outlines
recent work and implementation, and qualitatively
considers two fundamental characteristics with respect
to Canada, namely cell shape and cell orientation,
including how variations can be avoided or exploited
by rotating the grid.

The content of this paper is organised as follows.
Section 2 provides some background information relat-
ing to geographic grid issues, the OGC, and key terms
in DGGS literature. Section 3 reviews the rHEALPix
DGGS, including recent work and implementation.
Section 4 considers the rHEALPix DGGS with respect to
Canada. Section 5 concludes the discussion by highlight-
ing areas for future research.

2. Background

Discrete Global Grid System — four words that often
bring blank or confused looks from inquiring minds in
both academia and the public. A common definition says
that a discrete global grid partitions the earth’s surface
into a series of cells, and a Discrete Global Grid System
(DGGS) consists of many discrete global grids, that
together provide a progressively finer resolution of cells
(Sahr et al. 2003; Stefanakis 2016). If the meaning of a
DGGS is still unclear, describing each word may help:
“discrete” refers to a finite number of cells, “global”
refers to a grid that completely covers the earth’s sur-
face, “grid” refers to a tessellation of space into a uni-
form arrangement of cells, and “system” refers to a grid
that can be subdivided into smaller cells. That being said,
what is wrong with the traditional geographic grid and
why is a DGGS preferred?

2.1. Why use a DGGS?

The geographic grid is a latitude–longitude parametri-
zation of the sphere or ellipsoid (Amiri et al. 2015) that
was originally designed for repeatable navigation and
naturally suited to vector data, because the coordinate
system references a continuous point field (Sahr et al.
2003; OGC 2017b). To create the quadrilateral cells that
make up the geographic grid, equal angle steps are taken
along the latitude and longitude axes.

Although the geographic grid has many advantages,
it contains inadequacies that make it impractical for
many applications. For example, cell centroids are not
equal distances apart, cells do not have uniform adja-
cency, and cells surrounding the poles are actually tri-
angles not quadrilaterals. These issues have been
highlighted in several applications, including climate
modelling (Randall et al. 2002), numerical weather pre-
diction (Carfora 2007), and oceanography (Hoggarth
and Taylor n.d.). Furthermore, grid cells do not have
equal area (they gradually decrease in size from the
equator to the pole), which complicates analyses such
as sampling because cells do not have equal probabil-
ities of being selected (White et al. 1992; OGC 2017b).
Finally and perhaps most importantly, with the advent

of big data, global datasets are now heterogeneous and
high in volume. As a result, combining datasets from
different sources (such as those having different sen-
sors or coordinate reference systems) on the geographic
grid is computationally expensive and time consuming
(OGC 2016).

On the other hand, a DGGS has many advantages that
helps solve some of the problems faced by the geo-
graphic grid. Firstly, with regards to big data, a DGGS
can easily manage, store, and rapidly assemble large
volumes of heterogeneous geospatial data, which ena-
bles efficient exploration, mining, and visualisation.
Secondly, a DGGS can easily combine vector and raster
data in the same framework, thereby overcoming some
of the difficulties faced by GIS approaches such as
the “vector–raster divide” and use of map projections
(OGC 2017c). Finally, by adopting a grid of equal area
cells, spatial analysis can be replicated regardless of loca-
tion or resolution, and information collected at a given
location can be (i) referenced to the explicit area of its
associated cell, (ii) integrated with other cell values, and
(iii) provide statistically valid summaries from a sample
of cells (OGC 2017b).

There have been many DGGSs devised since the
1980s, and new interesting examples are still being
created such as the PlanetRisk DGGS (Sahr et al. 2015).
A good summary of DGGSs up to 2003 can be found in
(Sahr et al. 2003). Although there are a great variety of
DGGSs, it should be noted that a single DGGS cannot
currently provide the solution to all modern day geo-
spatial applications. Having said that, they have been
used separately for line simplification, optimal path
determination, statistically valid sampling, and index-
ing geospatial databases (Sahr et al. 2003). Further-
more, they can be optimized to meet many global
geospatial needs including processing, analysis, visuali-
zation, and modelling (Stefanakis 2016; OGC 2017a).

2.2. The OGC

In January 2016, the OGC — an international organiza-
tion that provides standards to the global community —
issued a press release seeking comments on a DGGS
standard that may replace those based on geographic
coordinate systems (OGC 2016). In October 2017, the
OGC officially adopted the DGGS as a new standard
(OGC 2017c). This was an important announcement that
could revolutionise the way geospatial information is
used in the future. In addition, the OGC has set up a
DGGS Standards Working Group (OGC 2017a) with the
aim of increasing awareness of DGGS advantages and to
explore a standard that enables interoperability between
DGGSs. This has already prompted research on methods
to aid index conversion between different DGGSs
(Amiri et al. 2015) with more research likely to follow.

The new OGC DGGS standard entitled “Topic 21:
Discrete Global Grid Systems Abstract Specifica-
tion” includes important information on definitions,

Published by NRC Research Press

Geomatica 2018.72:27-37.Downloaded from www.nrcresearchpress.com by GLASGOW UNIVERSITY LIBRARY on 09/18/18. For personal use only.Bowater and Stefanakis

29

Fig. 1. Examples of DGGSs and their corresponding cell shape. (a) Quadrilateral cells of the rHEALPix projection on the rHEALPix
DGGS, (b) hexagonal cells of the Snyder projection on the ISEA3H DGGS, and (c) triangular cells of the QTM. (Copyright (c) 2017
Open Geospatial Consortium; OGC 2017b). [Colour online.]

conventions, functional algorithms, the core data
model, and more (OGC 2017b). One section in parti-
cular, namely Global Grid Taxonomy, highlights the
possible ways to create a global grid, only a few of
which are classified as suitable under the abstract
specification. Currently, three prominent options are
the Snyder projection, rHEALPix projection, and
Quaternary Triangular Mesh (QTM). Notably, each is
based on a different cell shape. Figure 1 shows examples
of DGGSs that use these methods. Interestingly, PYXIS
Innovation (PYXIS Innovation 2017) — a Canadian com-
pany that has gained widespread attention for creating
a new DGGS platform to analyse geospatial data — uses
the ISEA3H (Icosahedral Snyder Equal Area Aperture 3
Hexagonal) DGGS (Sahr et al. 2003), whereas people at
Landcare Research New Zealand created the rHEALPix
DGGS (Gibb et al. 2016). This reiterates the fact that no
single DGGS is optimal for all situations or preferred
by all users.

With regards to current software on the market for
geospatial applications, PYXIS is leading the way. Its
Digital Earth web based application makes it is easy to
explore, combine, and analyse different datasets by
adopting DGGS technology (PYXIS Innovation 2017).
However, like any DGGS, the ISEA3H DGGS consists of
specific design choices that mean it is not suited to every
application. For example, it uses a hexagonal grid which
is less familiar to users and less adaptable to Cartesian
coordinate systems and hardware devices than tradi-
tional square grids (Amiri et al. 2015). In comparison to
the hexagonal grid, quadrilateral grids mirror the
geographic grid more closely. An emerging DGGS
that adopts the quadrilateral grid approach is the
rHEALPix DGGS.

2.3. Useful terminology

Before delving more into the rHEALPix DGGS, a few
key terms should be clarified, with the first being base
polyhedron. This refers to one of the five platonic solids
that can tessellate a sphere or ellipsoid into equal area
cells (Fig. 2).

The second term is refinement (sometimes called
aperture). This refers to the process of subdividing a cell
into a certain number of smaller cells. For example, if a
planar square cell is subdivided into four square cells of
equal area, the refinement is called one-to-four, nine
square cells is called one-to-nine, and so on (Fig. 3).

The third term is resolution. This refers to the number
of times the cell subdivision process has occurred. For
example, assuming one-to-nine refinement, resolution
one for a square has nine cells and resolution two has
81 cells (Fig. 4).

With regards to cells, key terms include parent cell,
child cell, aligned, congruent, and adjacency. A parent
cell is a cell at resolution, k, and a child cell is a cell at res-
olution, k+1. Aligned means the centroid of the parent
cell is also the centroid of a child cell. For example, this
is true of a 3×3 (one-to-nine refinement) square cell but
not for a 2×2 (one-to-four refinement) square cell (Fig. 5).
Congruent means the parent cell can be subdivided in
such a way that child cells are enclosed by the parent
cell. For example, squares and triangles are congruent
but hexagons are not (Fig. 6).

Adjacency refers to how a cell is connected to its
neighbours. For example, hexagons exhibit uniform
adjacency because they have six equal edge neighbours.
Conversely, squares and triangles exhibit non-uniform
adjacency because they have both edge and vertex
neighbours (Sahr et al. 2003; Fig. 7).

Published by NRC Research Press

Geomatica 2018.72:27-37.Downloaded from www.nrcresearchpress.com by GLASGOW UNIVERSITY LIBRARY on 09/18/18. For personal use only.30

Geomat. Vol. 72, 2018

Fig. 2. The five platonic solids and their spherical representation. (a) tetrahedron, (b) hexahedron (cube), (c) octahedron,
(d) icosahedron, and (e) dodecahedron. (Copyright (c) 2017 Open Geospatial Consortium; OGC 2017b). [Colour online.]

Fig. 3. A square cell (a) with one-to-four refinement (b) and one-to-nine refinement (c).

Fig. 4. A square cell with one-to-nine refinement at resolution (a) 0, (b) 1, and (c) 2.

Fig. 5. The centroid in the square parent cell (a) is not aligned with a child cell centroid in one-to-four refinement (b) but is aligned
in one-to-nine refinement (c).

Published by NRC Research Press

Geomatica 2018.72:27-37.Downloaded from www.nrcresearchpress.com by GLASGOW UNIVERSITY LIBRARY on 09/18/18. For personal use only.Bowater and Stefanakis

31

Fig. 6. A (a) square and (b) triangle can be subdivided into child cells that are enclosed by the parent, whereas a (c) hexagon cannot
be subdivided into hexagons that are enclosed by the parent.

Fig. 7. Edge and vertex neighbours of a (a) square, (b) triangle, and (c) hexagon.

(a)

(b)

(c)

reference cell

vertex neighbour

edge neighbour

3. The rHEALPix DGGS

In general, DGGSs that have a planar square grid have
many favourable characteristics including familiarity of
square grids for users and compatibility with (i) existing
hardware and display devices, (ii) quad-tree based algo-
rithms, (iii) hierarchical data structures, and (iv) coordi-
nate systems (Sahr et al. 2003; Gregory et al. 2008;
Amiri et al. 2015). Although many innovative square
based DGGSs have been designed, e.g., Ma et al. 2009
and Amiri et al. 2013, the rHEALPix DGGS appears most
often in DGGS related articles and literature. To under-
stand the rHEALPix DGGS, it is important to mention
the HEALPix DGGS.

The HEALPix DGGS (Gorski et al. 2005) was devel-
oped out of necessity for use in the astronomical com-
munity. The motivation for HEALPix was linked to
measurement and interpretation of cosmic back-
ground radiation. At the time, datasets covered the
entire sky and were increasing at a rapid rate. As a
result, a new DGGS was needed to process and analyse
huge volumes of spherically distributed astronomical
data in a timely and efficient manner. Consequently, a
DGGS unique from any other alternative was created
that had three essential features: (i) hierarchical tessel-
lation, (ii) equal area cells at every resolution, and
(iii) isolatitude distribution of cells (isolatitude means
cell nuclei are distributed only along lines of latitude).
For example, the geographic grid does not satisfy fea-
ture ii and grids based on hexagonal and triangular tes-
sellations do not satisfy feature iii. Inquisitive readers
can get more information about the background,

purpose, history, and links to software at NASA’s JPL
website (JPL 2017).

In 2016, people working at Landcare Research in New
Zealand realized the potential of the HEALPix DGGS
and extended it to be more suitable for geospatial needs,
renaming it the rHEALPix DGGS (Gibb et al. 2016).

3.1. Key features

In order for the rHEALPix DGGS to be more aligned
with geospatial applications, the team made a few
important amendments, including

1.
2.

3.

compatibility with ellipsoids of revolution,
rearrangement of the planar projection into an
alignment of square grids (Fig. 8), and
using a hexahedron as the base polyhedron.

Because reference ellipsoids (such as GRS80 and
WGS84) are used in geodesy rather than spheres, the
rHEALPix DGGS is more aligned with geospatial require-
ments and terrestrial use than its predecessor (Gibb
2016). Furthermore, by adopting a platonic solid as the
base polyhedron, it is aligned with the criteria and
design choices outlined in previous work on DGGS
requirements for a digital earth framework (Sahr et al.
2003). Finally, by altering the planar projection to an
alignment of square grids, it is easier to understand and
link to similar grids used in remote sensing and environ-
mental modelling (Gibb 2016). For detailed information
on the rHEALPix DGGS, including the definition, cell
IDs, cell shapes, projection equations, distortions, and
mathematical underpinnings (see also Calabretta and
Roukema 2007), readers are referred to Gibb et al. 2016.

Published by NRC Research Press

Geomatica 2018.72:27-37.Downloaded from www.nrcresearchpress.com by GLASGOW UNIVERSITY LIBRARY on 09/18/18. For personal use only.32

Geomat. Vol. 72, 2018

Fig. 8. Combining the north and south polar triangles of the (a) HEALPix projection into two squares on the (b) rHEALPix
projection. Grid lines represent parallels and meridians. Gibb et al. 2016. [Colour online.]

The fundamental features of the rHEALPix DGGS that
set it apart from other DGGSs include (Gibb 2016) the
following:

1.

2.

3.
4.

5.

Hierarchical and congruent cell structure that is
compatible with efficient data structures and easy
to implement cell addressing schemes.
Aligned for odd factors of refinement such as
one-to-nine.
Equal area cells at every resolution.
Isolatitude distribution of cells, which ensures fast
computation of spherical harmonics.
Planar projection that has low average angular and
linear distortion.

Two features that distinguish the rHEALPix DGGS
from the popular the ISEA3H DGGS are congruent cell
structure and isolatitude distribution of cells. Firstly,
congruency is an important property because it makes
hierarchy-based cell indexing a trivial process, which
enables efficient handling of large volumes of data
(Amiri et al. 2013; Amiri et al. 2015). Secondly, isolatiti-
tude distribution of cells is a rare quality in DGGSs. As
this feature is essential for fast computation of spherical
harmonics, the rHEALPix DGGS is a good choice for
applications that require harmonic analysis (Gibb et al.
2016). Therefore, geospatial applications involving tidal
analysis or image processing, for example, may find the
rHEALPix DGGS well suited. Overall, the rHEALPix
DGGS contains advantages both from its fundamental
design and as a by-product of being a quadrilateral cell
based grid. Furthermore, it contains features that other
DGGSs simply do not have. As a result, the rHEALPix
DGGS may be the ideal choice for new geospatial applica-
tions in the future.

It should be mentioned that the rHEALPix DGGS is not
perfect for all applications and has limitations of use just
like any other DGGS. The main disadvantages are lack of
uniform adjacency and varying cell shape. The former,
which is common in both quadrilateral and triangle cell
based DGGSs, means distances to neighbouring cell

centroids are not equal. This causes problems for
dynamical systems where functions are related to inter-
cell distances, as well as in applications involving dis-
crete simulations (Sahr et al. 2003; Gregory et al. 2008).
The latter is a result of combining four triangular
Collignon projections into a single square (Fig. 8).
Although all cells are quadrilaterals in the plane, some
change shape when projected to the ellipsoid and four
different cell shapes occur: the quad cell (quadrilateral),
the dart cell (triangular), skew-quad cell (quadrilateral),
and cap cell (circular) (Gibb et al. 2016). This is reminis-
cent of the geographic grid (triangular cells at the pole)
and may lead to issues involving conversion algorithms
between DGGSs or representation of geometries.
Interestingly, however, the rHEALPix DGGS can be
rotated, which means some cell shapes can be avoided
in a given target area.

3.2. Recent work and implementation

In 2016, the rHEALPix DGGS was updated in response to
the proposed OGC standard. The work included two main
features. Firstly, it showed that cell geometries and cell
IDs agree with the OGC standard. Secondly, it defined a
process to determine cell adjacency and DE-9IM topologi-
cal relationships using unique cell IDs rather than geo-
detic coordinates (Gibb 2016). This update was important
work that promoted the usability and benefits of the
rHEALPix DGGS, as well as its ability to be compliant with
the proposed OGC standard.

In addition, the rHEALPix DGGS has been imple-
mented in Python, and both the rHEALPix and HEALPix
projections have been implemented in the Proj.4
Cartographic Library (Gibb et al. 2016). The Proj.4 library
allows users to convert geodetic coordinates into and out
of both projections using a command line window such
as the OSGeo shell. Furthermore, it establishes the
ground work for meeting the OGC requirement of
having operations that allow data to be assigned to and
retrieved from cells (Gibb 2016).

Research yielded one more example of implementation.
A document prepared by the Spatial Data on the Web

Published by NRC Research Press

Geomatica 2018.72:27-37.Downloaded from www.nrcresearchpress.com by GLASGOW UNIVERSITY LIBRARY on 09/18/18. For personal use only.Bowater and Stefanakis

33

Fig. 9. (a) Quad cells on the ellipsoid have letter prefixes O, P, Q, and R (not visible) (Gibb 2016). (b) A grid of quad cells
(at resolution 3) over Madagascar (latitude: 12° S–25.5° S, longitude: 43° E–50.5° E approximately). [Colour online.]

Working Group (a joint World Wide Web Consortium
(W3C) – OGC project) described how earth observation
data can be represented using the W3C Resource
Description Framework (RDF) Data Cube and the
rHEALPix DGGS. In particular, there is proof of concept
that shows how satellite imagery can be retrieved from
the Data Cube using a SPARQL query system (W3C 2017).

Currently, no further work or application utilising the
rHEALPix DGGS can be found. With regards to model-
ling, visualisation, and analysis of geographic entities,
PYXIS have shown that DGGSs are a powerful tool.
Could the rHEALPix DGGS provide new insights or appli-
cations in this field? As of yet, no research has been car-
ried out. Future work should aim to determine how
well the rHEALPix DGGS is suited to handling geo-
graphic entities such as points, lines, and polygons.
Furthermore, due to the lack of open source algorithms
that model geospatial entities on DGGSs, algorithms
should be made available to the public to promote
DGGS usability and reproducible science.

4. Canadian use

The rHEALPix DGGS is classified as quadrilateral
because its planar projection consists of a square grid.
Although the majority of planar squares are projected
to quadrilateral cells, some are projected to circular or
triangular cells. Although cell shapes vary, all cells have
the same area regardless of shape, so processes such as
statistically valid sampling are not affected. In addition,
cells shapes do not vary randomly on the ellipsoid; their
positions can be calculated, accounted for, and some-
what avoided. To understand how this impacts Canada,
the rHEALPix projection must be explained.

The rHEALPix DGGS uses the equal area rHEALPix pro-
jection to convert planar squares to ellipsoidal cells using
the associated projection equations (Gibb et al. 2016). The
rHEALPix projection is basically a rearrangement of the

Fig. 10. Cell shapes in the north polar region. N4 is the cap
cell; N0, N2, N6, and N8 are dart cells; and N1, N3, N5, and
N7 are skew quad cells. Cell IDs correspond to Fig. 9a.
[Colour online.]

HEALPix projection, the mathematics for which can be
found in Calabretta and Roukema 2007. The details of
the rearrangement and all projection equations can be
found in Gibb et al. 2016. This discussion will be based
on the rHEALPix DGGS as described in Gibb et al. 2016,
in particular having a refinement of one-to-nine. The
rHEALPix projection is comprised of two projections
which form two regions: the Lambert cylindrical equal
area projection in the equatorial region and the
Collignon equal area projection in the polar region.

Somewhat unfortunately for Canada, the more user
friendly and mathematically simpler equatorial region
is defined by ∼ −41.9° ≤ φ ≤ ∼41.9°, where φ is the
geodetic latitude. This region adopts the Lambert

Published by NRC Research Press

Geomatica 2018.72:27-37.Downloaded from www.nrcresearchpress.com by GLASGOW UNIVERSITY LIBRARY on 09/18/18. For personal use only.34

Geomat. Vol. 72, 2018

Fig. 11. (a) The cap cell denoted N at resolution zero, and (b) the much smaller cap cell denoted N4 at resolution one (Gibb 2016).
[Colour online.]

cylindrical equal area projection, which has the conven-
ient property of projecting parallels to horizontal lines
and meridians to vertical lines. As a result, a square in
the plane becomes a quadrangle on the earth, known as
a quad cell (Gibb et al. 2016;a quadrangle is an area
bounded by two parallels and two meridians). This
means all cells in the equatorial region are quad cells.
Figure 9a shows quad cells on the ellipsoid, and Fig. 9b
shows Madagascar covered by a uniform quad cell grid.

4.1. The polar region — implications for Canada

The polar region consists of the north polar region
(φ > ∼41.9°) and south polar region (φ < ∼−41.9°).
Because they are isomorphic (Gibb et al. 2016) and
Canada (almost entirely) lies in the north polar region,
the discussion will be based there almost entirely,
because Canada’s most southerly location is in Ontario
just below the equatorial and polar region border
(e.g., Pelee Island falls in the equatorial region). This is
an important consideration if the area of interest is
southern Ontario. Essentially though, all of Canada falls
within the north polar region, so equatorial region char-
acteristics are not applicable.

The north polar region is created by rotating four tri-
angular Collignon projections from the HEALPix projec-
tion into a single square. As a result, parallels project to
straight lines (and appear as concentric squares), and
meridians project to straight lines heading poleward
(Fig. 8b). This representation is quite difficult to under-
stand, and visually determining projection coordinates
from geodetic coordinates is not an easy task. Although
the mathematical formulas have been implemented in
the Proj.4 library to carry out the conversion, this tool
should be used with caution. Results can sometimes be
unexpected and unfathomable without knowledge of
the projection. Conversely, a square grid in the plane is
projected to an ellipsoidal grid containing a variety of
cell shapes. For refinement one-to-nine, there are three
different cell shapes: the cap cell (circular), dart cell

Fig. 12. A grid (at resolution 2) of skew quad cells (cyan) and
dart cells (red) over Canada. Dart cells can be positioned
along the east and west edges of Canada. Orientation of
skew quad cells is north-west in western Canada, north in
central Canada and north–east in eastern Canada. (© 2018
Google) [Colour online.]

(triangular), and skew quad cell (quadrilateral) (Fig. 10).
Note, if refinement is even, then there are no cap cells
(Gibb et al. 2016).

The cap cell covers the pole and is the only circular
cell. Its edge is a line of constant latitude with the cell
centroid located at the pole. This cell is not a major con-
cern for Canada, because as resolution increases, the par-
allel defining the cell boundary converges towards the
pole (as the cell area decreases and the centroid remains
at the pole). Although Canada’s northern boundary
reaches high into the arctic, the likelihood of encounter-
ing the cap cell decreases with every increase in resolu-
tion, as shown in Fig. 11.

Triangular dart cells are formed where the edges of
each of the four Collignon projections meet. The

Published by NRC Research Press

Geomatica 2018.72:27-37.Downloaded from www.nrcresearchpress.com by GLASGOW UNIVERSITY LIBRARY on 09/18/18. For personal use only.Bowater and Stefanakis

35

Fig. 13. The rHEALPix projection in (a) (n,s) = (0,0) position and (b) (n,s) = (1,3) position.

(a)

(b)

equatorial square 
north polar square
south polar square

southern edge of a dart cell is a line of constant latitude
and north–east and north–west edges converge pole-
ward to a point (Gibb et al. 2016). Furthermore, dart cells
are aligned along four meridians and bounded by two
parallels: the parallel that defines the cap cell and the
parallel that defines the equatorial and polar region
border. This divides the north polar region into four
quadrants spanning 90°. Because Canada has a large
east–west extent that approaches 90° in longitude, dart
cells are unavoidable when considering the whole coun-
try (although they can be positioned at the east and west
edges of Canada, see Fig. 12). However, if smaller features
are of interest such as the province of New Brunswick,
dart cells can be avoided entirely.

The remaining cells in the north polar region are
skew-quad cells. Skew-quad cells have four edges with
the north and south edges aligned with parallels. In addi-
tion and only for skew quad cells, cell orientation
changes with longitude through a quadrant (Fig. 12).
Consequently, cells initially having a north–west slant
gradually rotate clockwise to a north–east slant. Similar
to dart cells, this effect is unavoidable if considering
the whole country but can be reduced over smaller areas.
It has been established that a country the size of
Canada in the polar region will have issues with varying
cell shape and cell orientation. However, smaller areas
can escape some of these issues, but how is this
achieved? The answer lies in the versatility of the
rHEALPix projection.

4.2. Versatility of the rHEALPix projection

An important advantage of the rHEALPix projection is
its versatility, which means it can be rotated and altered
to meet user needs. To tailor the rHEALPix projection to
Canada, or any country in fact, it is possible to alter the
rHEALPix projection in two ways. Firstly, the north polar
square and south polar square can each be positioned in
four different locations. Secondly, the projection image
of the ellipsoid can be rotated by shifting the position
of the prime meridian (0° longitude), see Gibb 2016.

By rearranging the north polar square, n, and south
polar square, s, into four different locations, it is possible
to create 16 different views of the projection. For exam-
ple, Fig. 13 shows the (n,s) = (0,0) and (n,s) = (1,3) positions.
Choosing a view is not a difficult task because the math-
ematics behind the projection enables the positions to

Fig. 14. A rotated grid (at resolution 3) over Canada
consisting of skew quad cells (cyan). Dart cells (red) can be
seen along the Alaskan border. The prime meridian has
been shifted to 50° W. (© 2018 Google) [Colour online.]

be easily defined. The main advantage of this is that it
allows the projection to be rearranged to enable a better
view of a chosen area (Gibb 2016).

The process of shifting the prime meridian simply
involves adding the desired offset to all longitudinal val-
ues. This results in rotating the grid cells longitudinally
around the ellipsoid. With regards to the polar region,
this has two key benefits. Firstly, dart cells can be
avoided because the four meridians on which they lie
can be selected arbitrarily. Although the four meridians
will always have a 90° separation, the positions of the
meridians can be rotated to any location. Consequently,
dart cells can be avoided for any area with a longitudinal
extent less than approximately 90°. Because Canada has
a longitudinal extent of approximately 90°, dart cells
can almost be avoided by shifting the prime meridian
to 50° W. This aligns the dart cells with the 50° W and
140° W meridians, as shown in Fig. 14.

Secondly, skew quad cells with angled orientations
can be avoided or even exploited. This is an interesting
feature because it provides some flexibility to choose cell
orientation over a given area. For example, if an area is
north–south aligned such as New Brunswick, skew quad

Published by NRC Research Press

Geomatica 2018.72:27-37.Downloaded from www.nrcresearchpress.com by GLASGOW UNIVERSITY LIBRARY on 09/18/18. For personal use only.36

Geomat. Vol. 72, 2018

Fig. 15. A grid of skew quad cells orientated to suit New Brunswick at resolution (a) 4 and (b) 5. The prime meridian has been
shifted to 21° W. (© 2018 Google) [Colour online.]

Fig. 16. A grid of skew quad cells orientated to suit Cape
Breton at resolution 5. The prime meridian has been
shifted to 50° W. (© 2018 Google) [Colour online.]

cells having the same orientation can be used and a grid
resembling the quad cell grid of the equatorial region
can be achieved. Figure 15 shows a skew quad cell grid
over New Brunswick at various resolutions where the
prime meridian has been shifted to 21° W. However, if
an area has an angled orientation such as Cape Breton,
Nova Scotia, the grid can be rotated so that angled skew
quad cells with similar orientation are used instead, see
Fig. 16 where the prime meridian has been shifted to
50° W. Notably, this characteristic only applies for a spe-
cific range of orientations. The most angled skew quad
cells are adjacent to dart cells and have orientations of
approximately N 30° E and N 30° W. Therefore, using

angled skew quad cells is most suited to areas having
an orientation in this 60° range.

With regards to the equatorial region, shifting the
prime meridian rotates the grid so that quad cells can
be more aligned with a given area. However, because
quad cells are always aligned with parallels and meri-
dians, shifting the prime meridian does not affect cell
orientation.

5. Conclusion

This paper reviews key features of the rHEALPix
DGGS, highlights recent work and implementation, and
gives qualitative consideration to the rHEALPix DGGS
over Canada. Although the rHEALPix DGGS is well
defined, no significant research has been carried out to
determine its ability to handle geospatial entities. For
Canada, varying cell shape and cell orientation are key
considerations due to the size and location of the coun-
try. However, for smaller features such as provinces,
these variations can be avoided or even exploited by
rotating the grid.

Future work should explore how geospatial entities
such as points, lines, and polygons can be modelled,
visualized, and analysed on the rHEALPix DGGS. This
will enable quantitative comparisons to be made against
other DGGSs and help to determine the most suitable
DGGS for Canada. Finally, due to the lack of open source
algorithms that model geospatial entities on DGGSs,
algorithms should be made available to the public to
promote DGGS usability and reproducible science.

Acknowledgements

We thank the editor and anonymous reviewers for
their valuable comments. This work was funded by the
Natural Sciences and Engineering Research Council of
Canada (NSERC-DG).

Published by NRC Research Press

Geomatica 2018.72:27-37.Downloaded from www.nrcresearchpress.com by GLASGOW UNIVERSITY LIBRARY on 09/18/18. For personal use only.Bowater and Stefanakis

References

Amiri, A.M., Bhojani, F., and Samavati, F. 2013. One-to-two digital
earth. In: Bebis G. et al. (eds) Advances in visual computing.
ISVC 2013. Lecture notes in computer science, vol 8034.
Springer, Berlin, Heidelberg. doi:10.1007/978-3-642-41939-3_67.
Amiri, A.M., Samavati, F., and Peterson, P. 2015. Categorization
and conversions for indexing methods of discrete global
grid systems. ISPRS Int. J. Geo-Inf. 4: 320–336. doi:10.3390/
ijgi4010320.

Calabretta, M.R., and Roukema, B.F. 2007. Mapping on the
HEALPix grid. Mon. Not. R. Astron. Soc. 381: 865–872.
doi:10.1111/j.1365-2966.2007.12297.x.

Carfora. 2007. Interpolation on spherical geodesic grids: a com-
parative study. J. Comput. Appl. Math. 210(1–2): 99–105.
doi:10.1016/j.cam.2006.10.068.

Gibb, R.G. 2016. The rHEALPix Discrete Global Grid System. Inst.

Phys. Conf. Ser.: Earth Environ. Sci. 34: 012012.

Gibb, R., Raichev, A., and Speth, M. 2016. The rHEALPix Discrete
Global Grid System. doi:10.7931/J2D21VHM.
[Online].
Available from https://datastore.landcareresearch.co.nz/
dataset/rhealpix-discrete-global-grid-system [16 May 2017].
Gorski, K.M., Hivon, E., Banday, A.J., Wandelt, B.D., Hansen, F.K.,
Reinecke, M., and Bartelmann, M. 2005. HEALPix: a frame-
work for high-resolution discretization and fast analysis of
data distributed on the sphere. Astrophys. J. 622: 759–771.
doi:10.1086/427976.

Gregory, M.J., Kimerling, A.J., White, D., and Sahr, K. 2008.
A comparison of intercell metrics on discrete global grid
systems. Comput. Environ. Urban Syst. 32(3): 188–203.
doi:10.1016/j.compenvurbsys.2007.11.003.

Hoggarth, A., and Taylor, T. n.d. The OGC Discrete Global Grid
Systems core standard and its relevance to the hydrographic
community. [Online]. Available from https://www.iho.int/
mtg_docs/com_wg/IRCC/IRCC8/IRCC8-07E-MSDIWG-AnnexH-
GGS-for-Hydrography.pdf [12 Oct. 2017].

JPL. 2017. Healpix. [Online]. Available from http://healpix.jpl.

nasa.gov/ [6 Oct. 2017].

Ma, T., Zhou, C., Xie, Y., Qin, B., and Ou, Y. 2009. A discrete
square global grid system based on the parallels plane

37

projection. Int. J. Geogr. Inf. Sci. 23(10): 1297–1313. doi:10.1080/
13658810802344150.

OGC. 2016. OGC® seeks public comment on a candidate
standard that may replace legacy coordinate systems.
http://www.opengeospatial.org/pressroom/pressreleases/
2349/ [29 May 2017].

OGC. 2017a. Discrete Global Grid Systems SWG. http://www.
opengeospatial.org/projects/groups/dggsswg/ [29 May 2017].
OGC. 2017b. Topic 21: Discrete Global Grid Systems
Abstract Specification. [Online]. Available from http://docs.
opengeospatial.org/as/15-104r5/15-104r5.html [3 Jan. 2018].
OGC. 2017c. OGC announces a new standard that improves
the way information is referenced to the earth. [Online].
Available from http://www.opengeospatial.org/pressroom/
pressreleases/2656 [3 Jan. 2018].

PYXIS Innovation. 2017. [Online]. Available from https://www.

pyxisinnovation.com/ [6 Oct. 2017].

Randall, D.A., Ringler, T.D., Heikes, R.P., Jones, P., and
Baumgardner, J. 2002. Climate modeling with spherical geo-
desic grids. Comput. Sci. Eng. 4(5): 32–41. doi:10.1109/MCISE.
2002.1032427.

Sahr, K., White, D., and Kimerling, A.J. 2003. Geodesic discrete
global grid systems. Cartogr. Geogr. Inf. Sci. 30(2): 121–134.
doi:10.1559/152304003100011090.

Sahr, K., Dumas, M., and Choudhuri, N. 2015. The PlanetRisk
Discrete Global Grid System. [Online]. Available from http://
www.discreteglobalgrids.org/wp-content/uploads/sites/33/
2016/10/PlanetRiskDGGS.pdf [5 Jan. 2018].

Stefanakis, E. 2016. Discrete Global Grid Systems — A new OGC
standard emerges. GoGeomatics. Magazine of GoGeomatics
Canada. January 2016.

White, D., Kimerling, J.A., and Overton, S.W. 1992. Cartographic
and geometric components of a global sampling design
for environmental monitoring. [Online]. Available from
http://capblanc.org/attachments/White_etal_CAGIS_1992.pdf
[10 Jan. 2018].

W3C. 2017. Publishing and Using Earth Observation Data with
the RDF Data Cube and the Discrete Global Grid System.
[Online]. Available from https://w3c.github.io/sdw/eo-qb/
#DGGS [6 Oct. 2017].

Published by NRC Research Press

Geomatica 2018.72:27-37.Downloaded from www.nrcresearchpress.com by GLASGOW UNIVERSITY LIBRARY on 09/18/18. For personal use only.