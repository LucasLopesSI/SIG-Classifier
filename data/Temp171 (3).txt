This article was downloaded by: [Southern Illinois University]
On: 02 January 2015, At: 19:24
Publisher: Taylor & Francis
Informa Ltd Registered in England and Wales Registered Number: 1072954 Registered
office: Mortimer House, 37-41 Mortimer Street, London W1T 3JH, UK

International Journal of Geographical
Information Science
Publication details, including instructions for authors and
subscription information:
http://www.tandfonline.com/loi/tgis20

Prediction and visualization of GPS
multipath signals in urban areas using
LiDAR Digital Surface Models and
building footprints
Jing Li a , George Taylor b , David Kidner b & Mark Ware b
a Department of Geography , University of Leicester , London
Road, Leicester LE1 7RU, UK
b GIS Research Unit , Faculty of Advanced Technology , University
of Glamorgan , Pontypridd CF37 1DL, UK
Published online: 04 Dec 2010.

To cite this article: Jing Li , George Taylor , David Kidner & Mark Ware (2008) Prediction and
visualization of GPS multipath signals in urban areas using LiDAR Digital Surface Models and building
footprints, International Journal of Geographical Information Science, 22:11-12, 1197-1218, DOI:
10.1080/13658810701851396

To link to this article:  http://dx.doi.org/10.1080/13658810701851396

PLEASE SCROLL DOWN FOR ARTICLE

Taylor & Francis makes every effort to ensure the accuracy of all the information (the
“Content”) contained in the publications on our platform. However, Taylor & Francis,
our agents, and our licensors make no representations or warranties whatsoever as to
the accuracy, completeness, or suitability for any purpose of the Content. Any opinions
and views expressed in this publication are the opinions and views of the authors,
and are not the views of or endorsed by Taylor & Francis. The accuracy of the Content
should not be relied upon and should be independently verified with primary sources
of information. Taylor and Francis shall not be liable for any losses, actions, claims,
proceedings, demands, costs, expenses, damages, and other liabilities whatsoever or
howsoever caused arising directly or indirectly in connection with, in relation to or arising
out of the use of the Content.

This article may be used for research, teaching, and private study purposes. Any
substantial or systematic reproduction, redistribution, reselling, loan, sub-licensing,
systematic supply, or distribution in any form to anyone is expressly forbidden. Terms &

Conditions of access and use can be found at http://www.tandfonline.com/page/terms-
and-conditions

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 International Journal of Geographical Information Science
Vol. 22, Nos. 11–12, November–December 2008, 1197–1218

Research Article

Prediction and visualization of GPS multipath signals in urban areas
using LiDAR Digital Surface Models and building footprints

JING LI*{, GEORGE TAYLOR{, DAVID KIDNER{ and MARK WARE{
{Department of Geography, University of Leicester, London Road, Leicester LE1 7RU,
UK
{GIS Research Unit, Faculty of Advanced Technology, University of Glamorgan,
Pontypridd CF37 1DL, UK

(Received 17 June 2007; in final form 7 December 2007 )

This paper explains a ray tracing method which is applied to prediction and
visualization of diffracted and reflected GPS signals in dense urban areas.
Reflected and diffracted signals can have a detrimental effect on GPS positioning
accuracy especially in highly built-up areas. The ray tracing technique
implemented in this paper is specially geared to LiDAR height pole data at 1-
m spatial resolution and 2D building footprints in raster and vector format,
respectively. Such a simple data format allows for rapid implementation of 3D
ray tracing in a GIS without further processing so that detailed 3D urban models
in vector format are not required. Issues of spatial uncertainty in the data used
are also addressed in relation to the identification of multipath signals. Some
preliminary results obtained from fieldwork are presented and analysed in detail.

Keywords: GPS multipath; LiDAR; 3D visualization

1.

Introduction

It is well known that Light Detection And Ranging (LiDAR) Digital Surface
Models (DSMs) have a much higher quality than the traditional Digital Terrain
Models (DTMs), in terms of accuracy and resolution. Since man-made features in
urban areas such as buildings are usually adequately modelled in LiDAR data, it is
possible to predict GPS multipath effect using LiDAR derived DSMs.

In practice, both GPS code and phase observations are affected by multipath. The
multipath effect is highly dependent on the surrounding geographic features (e.g.
buildings) near a GPS receiver, and therefore cannot be removed by differential
GPS, which removes most of the common errors between base and moving receiver.
The term multipath is derived from the fact that a GPS signal might follow several
paths to a receiver’s antenna. The signal can be reflected and/or diffracted from
buildings or the ground and create a range error of several metres or more in C/A
code measurements (Strang and Borre 1997).

Taylor et al. (2007) have shown that the line of sight (LOS) between GPS satellites
and a GPS receiver antenna can be modelled at a very high accuracy using 1-m
LiDAR data. Lower-resolution DSMs such as IFSAR (Interferometric Synthetic
Aperture Radar) elevation data is insufficient for a reliable prediction of GPS

*Corresponding author. Email: jl185@le.ac.uk

International Journal of Geographical Information Science
ISSN 1365-8816 print/ISSN 1362-3087 online # 2008 Taylor & Francis
http://www.tandf.co.uk/journals
DOI: 10.1080/13658810701851396

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 1198

J. Li et al.

satellites availability (Taylor et al. 2007). Since a reliable LOS result is a prerequisite
for visualizing GPS multipath effect, it is anticipated that 1-m spacing LiDAR
DSMs can be used to predict the GPS multipath effect in order to assess the
positioning accuracy of conventional and high sensitivity GPS receivers for location-
based services, as there is a growing demand for the use of GPS and/or the future
Galileo system for transport applications such as positioning-based road user
charging or bus positioning and scheduling (Vrhovski 2003, Taylor and Blewitt
2006). High-sensitivity GPS receivers often operate in the lower signal-to-noise
regimes found in personal, hand-held, mobile, and asset-tracking applications,
which are consequently more prone to multipath errors (Pratt 2004).

2. Methodology and data

The methodology used in this study is known as ray tracing and is an approach to
3D deterministic radio wave propagation modelling; it is also commonly used for
surface-rendering in computer graphics. The prime motivation for this study is that
the accuracy, resolution, and availability of LiDAR DSMs have significantly
improved over the last 5 years owing to the advances in surveying techniques.
Therefore, it is worthwhile exploring how ray tracing can be implemented using
newly acquired LiDAR data and 2D building footprints. Figure 1 shows an overlay
of building footprints with a 1-m spacing LiDAR raster DSM covering part of the
vehicle route. The image on the left is the same LiDAR model without the building
footprints.

As shown in figure 1, the image on the right shows that the Ordnance Survey (OS)
2D building footprints closely align with the 1-m LiDAR raster DSM. Moreover,
urban features can be clearly recognized from the 1-m LiDAR DSM even without
the 2D building footprints (i.e. the image on the left). The scale bar in the upper left
corner indicates height values in metres. The building footprints were supplied by
Ordnance Survey. Their absolute accuracy is within half a metre at 1:1250 scale
(Ordnance Survey 2007). The 1-m LiDAR data of London and the University
campus were supplied by UK Environmental Agency (EA) in ASCII grid format.
The irregularly spaced raw LiDAR points of the campus at 1-m resolution were also
provided by InfoTerra, and then interpolated into a 1-m raster grid using IDW
interpolation. It should be noted that these two LiDAR data sets of the same area
(i.e. the campus) were flown at different times and processed by two different
organizations. It is interesting to know what effects the two data sets have on the
identification of multipath signals. This issue is addressed in section 7.3.

In the following sections, 2D building footprints and 1-m spacing LiDAR data in

raster format are combined to predict GPS multipath.

GPS signal operates at UHF band (i.e. L1 1575.42 MHz, L2 1227.6 MHz). It is
generally accepted that the wavelengths (L1: 19 cm and L2: 24 cm) are small in
comparison with the dimensions of the obstacles, and the building walls are treated
as specular reflectors. It is well known that ray tracing techniques are based on the
same assumptions. In addition, the UHF band above about 1.5 GHz must have line
of sight (LOS) between the transmitting and receiving antennas; otherwise losses are
extremely high (Parsons 2000). The research topic on the accuracy of LOS analysis
has been thoroughly investigated using 1-m spacing LiDAR (Taylor et al., 2007).
This is because a correct LOS prediction is a prerequisite for ray tracing.
Furthermore, because the GPS satellite elevation angles are normally higher than
conventional terrestrial radio links, only geographic features (e.g. buildings), which

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 GPS multipath

1199

Figure 1. One-metre LiDAR DSM and building footprints covering the vehicle route.

are close to the receiver, may contribute significantly to the propagation process. In
this study, only one single reflected ray is traced from each satellite. Multiple
reflections are not considered. This is because the strongest rays are usually those
involving the fewest interactions on their journey from source to field points, and
the building closest to the receiver is usually significant (Saunders 1999).

In the following sections, two predominant multipath effects (i.e. diffraction and

reflection) are dealt with respectively.

3. Diffraction

is partially masked or
Signal diffraction may refer to the fact that the signal
unmasked and can still be tracked by the receiver. For example, it is possible that
GPS signals bend around the edges of a wall, although, from a geometrical point of
view, the satellites are obstructed (Brunner et al. 1999).

As a result, the diffracted signals are weakened and travel a longer distance
compared with the direct signals which consequently introduce a range error into

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 1200

J. Li et al.

positioning. Often, the signal-to-noise ratio (SNR) is highly correlated with signals
contaminated by diffraction (Richter and Euler 2001). A low SNR may indicate the
occurrence of diffraction, especially when the receiver is placed close to a building. A
good example of this is where a vehicle travels along a narrow street with tall
buildings on each side. For high-precision GPS applications such as the detection of
the abnormal movements of the world’s largest span suspension bridge in Hong
Kong (Wong et al. 2001), diffraction can have a non-negligible effect on the
positioning accuracy.

In this study, a simple single knife-edge diffraction model is first implemented
according to the International Telecommunication Union Radio Communication
(ITU-R 1999) standard. Such a model is illustrated in figures 2 and 3, which account
for both LOS and Non Line-Of-Sight (NLOS) cases, where: h is the effective height
of the obstruct (i.e. perpendicular distance to the LOS); d1 is the distance of the
obstruct from the satellite; d2 is the distance of the obstruct from the receiver; and v
is the Fresnel parameter.

For v greater than 20.7, the diffraction gain G(v) can be approximated using

equation (1):

G vð Þ~6:9z20 log

(cid:2)

q

ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
Þ2z1
v(cid:1)0:1
ð

(cid:3)

zv{0:1

dB

ð1Þ

Figure 2.

(a) Non LOS; (b) LOS.

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 GPS multipath

1201

Figure 3. Knife-edge diffraction gain as a function of the Fresnel diffraction parameter v.

where the Fresnel parameter

v~h

s

(cid:2)

ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
(cid:3)
2
l

z 1
d2

1
d1

ð2Þ

l50.19 m for GPS L1

Note that v is negative, when there is clear LOS between the satellite and receiver
(i.e. h is negative). In that situation, the attenuation is less severe compared with the
NLOS signal with a positive v value (figure 3).

For the NLOS signal (i.e. v.0), the diffracted signal gets increasingly weaker as
the value of v increases. This trend is clearly depicted in figure 3, which is computed
using equation (1). It is quite clear from figure 3 that the diffracted signal
is
weakened and may not be tracked by the receiver if the loss is too high.

The single knife-edge diffraction model is implemented in ArcGIS9 3D analyst.
The reason for choosing ArcGIS is twofold. First, the commonly used GIS functions
(e.g. LOS analysis) are already implemented in ArcGIS and can be accessed through
ArcObjects. The use of ArcObjects significantly shortened development time and
increased productivity. The second advantage is that ArcGIS has the ability to handle
a large amount of spatial data in various formats (e.g. raster and vector), and hence
facilitates analysis and visualization of the research findings.

For the LOS signals, the shortest perpendicular distance from the LOS vector to
the terrain profile (i.e. h,0 in figure 2(b)) is computed so that the 3D coordinates of

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 1202

J. Li et al.

the terrain point closest to the LOS vector are chosen as the obstruction point and
then used to calculate the Fresnel parameter v. In this case, the LOS vector is above
the terrain profile.

In terms of the NLOS signals, the LOS vector is below certain portions of the
terrain profile, so the coordinates of the obstruction point can be found by
interpolation along the terrain profile. This approach may be considered as finding
the nearest edge point to the receiver provided that the building features are
adequately modelled in the 1-m raster LiDAR DSM. As stated earlier, it is generally
accepted that, for GPS signals, the buildings closest to the receiver are more likely to
contribute to the propagation process.

4. Multipath data collection and results

In order to examine the effect of the single knife-edge model on the positioning
accuracy, a pair of Leica Geodetic-grade GPS receivers with AT502 dual-frequency
antennas were used to collect data that are expected to be affected by the diffracted
signals. It should be noted that multipath mitigation techniques have been
implemented within the Leica receivers (Be´taille 2003), which are designed to reject
long-delay multipath signals. However, multipath mitigation schemes are often
manufacturer-specific and assumed to operate in conditions with high SNRs (Pratt
2004). In this study, the GPS data were collected at the relatively lower SNRs (i.e.
33–42 dB) than the expected ones (40–48 dB) at a range of satellite elevation angles,
which often imply that the direct LOS signal is not present, and the resultant
positional error is large.

The simulation is carried out in a 3D GIS environment. Data were collected over
a period of 30 min in front of a building on the university campus. In this period,
SV10 was found to be affected by diffraction, which is evident in figure 4. As shown
in figure 4, the solid green lines indicate the visible portions of the LOS between the
receiver and the satellite, and the invisible part of the LOS is indicated by the solid
red lines.

It is very clear from studying figure 4 that SV10 was moving from invisible to
visible to the receiver over a period of 30 min, as the elevation angle of the satellite
increases. The satellite positions are computed with the broadcast orbits which can

Figure 4. Screenshot showing SV10 moves invisible to visible to the receiver over a period of
30 min.

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 GPS multipath

1203

be extracted from the RINEX (Receiver
navigation file.

Independent Exchange Format)

Figure 5 is a plot of the computed elevation angles of SV10 against the single
knife-edge diffraction gain expressed in decibel over a period of 30 min. The gain is
computed on 1-m LiDAR DSM using equation (1) for both LOS and NLOS signals.
As expected, the signal gets stronger as the elevation angle increases. It is quite
evident from figures 4 and 5 that 1-m spacing LiDAR data successfully identified
this transition period in which the direct signal is partially masked and unmasked.
Note that the fractional parts of the elevation angles on the x axis are omitted in
figure 5.

Having identified the affected satellite and the transition period, the next task is to
investigate how much multipath errors are likely to be caused by such a propagation
effect. There are many techniques that can quantify the magnitude of the possible
multipath errors by post-processing such as carrier minus code statistics as described
in Braasch (1996). However, such an approach often requires a period of
observations in which no cycle slips occurred, and thus often becomes impractical
in low signal-to-noise conditions, as the loss of lock on weak signals happens
frequently.

Instead of using the above-mentioned approach, the Double Differencing (DD)
residuals are used to give an indication of the magnitude of the possible pseudorange
multipath error. This is because the base and rover stations are placed so close
together (about 100 m apart) on campus that almost all orbit errors, receiver clock
errors, and atmospheric delays are eliminated. Therefore, the DD residuals mainly
comprise multipath error and a small amount of measurement noise.

During the data collection, one station, whose coordinates were known to be
accurate to a few millimetres, was set up as the base station on the roof of the School
of Computing, and so estimating the baseline vector between the rover and base
station is equivalent to estimating the coordinates of the rover station that is

Figure 5. Single knife-edge diffraction gain for point 1.

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 1204

J. Li et al.

expected to be contaminated by multipath. The DD residuals are the differences
between the actual observed double difference measurements and those computed
by the least-squares solution for the baseline vector.

Figure 6 shows the code double-differenced residuals of SV10. It is very clear from
figures 6 and 7 that very large residuals with the maximum up to 231 m can be
observed on SV10, which means that the effect of diffraction on SV 10 is more
significant compared with those satellites unaffected (figure 7). This agrees with the
prediction result shown in figures 4 and 5 in which the effect of diffraction is clearly
visualized in 3D.

In addition to the large DD residuals on SV10, the effect of multipath caused by
SV10 on the overall accuracy of single point positioning is also of interest, because
one such contaminated satellite could deteriorate the accuracy of the final position
computed by all the satellites available irrespective of the satellite geometry (e.g.
PDOP) and the number of satellites in view. As shown in figure 8, the light green
point (i.e. RTK point) is known to be accurate to a few centimetres, and can be
considered as the true position of the receiver (i.e. ground data). The red points are
calculated using all the satellites in view including that contaminated by diffraction
as shown in figure 4. The black points are calculated without using the data from

Figure 6. Large double differencing residuals on SV10 for a period of 30 min.

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 GPS multipath

1205

Figure 7. Large double differencing residuals on Satellite No. 10 (m).

SV10. It is evident from studying figure 8 that the positions computed without SV10
(i.e. black points) are closer to the truth (about 3–4 m away from the true position),
while the red points are much further away from the truth (about 10–16 m) due to
the errors introduced by SV10. Under normal conditions, the more satellites there
are, the more accurate the position would be. However, in a severe multipath
environment like that displayed in figures 4 and 8, the overall positioning accuracy
would benefit from successful detection of the satellites affected by multipath.

Figure 8. Map of positional errors caused by signal diffraction in which black points being
closer to the truth (i.e. the green point) are calculated without using the affected satellite, and
red points being further way from the truth are calculated with all the satellites including that
affected by diffraction. # Crown Copyright/database right 2007. An Ordnance Survey/
EDINA supplied service.

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 1206

J. Li et al.

Since the data collected on one location do not provide sufficient evidence to
prove how good LiDAR data can predict multipath, two more locations closer to
the buildings on campus were chosen; the results are presented in figures 9–12. Note
that the magnitude of the DD residuals is much smaller compared with those
displayed in figure 6. This is because Point 2 and Point 3 were placed around 5 m
away from the buildings, but point 1 is about 20 m away from the obstruction point.
In summary, by applying the single knife-edge model to 1-m LiDAR data, the
effect of single diffraction can be predicted successfully, the signals weakened by the
obstructions are tracked by the receiver, and this is the major cause of the large DD
residuals.

5. Rigorous determination of diffraction point

The single knife-edge diffraction model has its limitations in that it does not
consider the three dimensions of the problem. The diffraction point is determined
only along the LOS profile by interpolation. Signals diffracted by the side of the
buildings (e.g. vertical edges) are not dealt with. However, in an urban canyon

Figure 9. Large double differencing residuals on SV20 for Point 2.

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 GPS multipath

1207

Figure 10. diffraction gain G(v) for Point 2.

scenario, it is likely that the signals emitted from the satellites at very low elevation
angles (15u and below) are diffracted by the vertical edges of the buildings especially
in the transition zone where the satellites are partially masked and unmasked.
Studying such an effect requires the implementation of the Unified Theory of
Diffraction (UTD). It is not the intention of this research to produce such an
implementation but to use a geometrical representation of the diffracted rays, using
a real 3D urban environment within Central London.

The first step to the rigorous determination of diffraction points is to remove the
shared building segments shown in figure 13(b) to create the building outlines in
figure 13(a). As such, the building corners can be identified. The second step is to
assign two different height values to each building corner in the scene. The heights
can be estimated from 1-m spacing LiDAR data.

The height of the building foundation can be derived from a 1-m bare-earth
LiDAR Digital Terrain Model (DTM) by taking the average of the points which fall
into the building outlines. The building height can be estimated from the 1-m
LiDAR DSM in the similar way.

The last step is to implement Keller’s cone (figure 14) in order to determine the
coordinates of the diffraction point which are located on the vertical edges of the
buildings. The calculation of the diffraction point in an arbitrarily oriented straight
edge is described in detail in Catedra and Arriaga (1999). In this study, such a
method is adapted and applied to the 1-m LiDAR data and the building footprints.
As shown in figure 14, p1 is the top of the building edge, and p2 is the bottom of the
building edge. S is a particular GPS satellite in space, O is a GPS receiver, and Q is
the diffraction point located on the edge of the building. 3D vectors, whose origins
are the origin of the British National Grid, can then be constructed using the 3D
coordinates of each point (i.e. easting, northing, and height). The plane coordinates

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 1208

J. Li et al.

Figure 11. Large double differencing residuals on SV 24 for Point 3.

of the points can be extracted from the building footprints. Heights are estimated
from LiDAR data using the method described earlier.

Figure 14 Diffraction at a straight edge

!
Q

tð Þ~p1

!zt p2

!(cid:4)
!{p1

(cid:5) for 0ƒtƒ1

ð3Þ

where:

t~

(cid:5)
!(cid:4)
!{p1
p2
!(cid:6)
(cid:6)
!{p1
p2
(cid:6)
(cid:6)

2

(cid:7)

2

!
S

4

(cid:8)

ds

!
d0zO
d0zds

Þ

ð

3

!
{p1

5

If the value of t is between 0 and 1, a diffraction point exists, and can be calculated
using equation (3). However, a diffracted ray should only be traced if the diffraction
point is visible to both the satellite and the receiver. Therefore, two LOS checks have
to be made in order to successfully identify a diffracted ray. Furthermore, it is
important to know that the diffraction point is located exactly on the vertical edge
of the buildings, which may cause errors in LOS analysis due to the edge effects in
the 1-m LiDAR data (e.g. sloping walls). This problem can be solved by checking
whether the obstruction point along LOS is extremely close to the diffraction point

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 GPS multipath

1209

Figure 12. Diffraction gain G(v) for Point 3.

(e.g. the obstruction point could be only a few centimetres away from the diffraction
point.) If so, the LOS is deemed visible rather than invisible. This method has been
verified by visual inspections on a large number of receiver points in several 3D scenes.
As shown in figure 15, pink lines are the edge-diffracted rays, green lines are the
visible portion of the LOS signal, and red are not. Note that there is a transition
zone in figure 15 where the satellite becomes invisible to visible to the receiver due to
the movement of the vehicle along its route.

Figure 13.

(a) Without shared boundaries. (b) With shared boundaries.

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 1210

J. Li et al.

Figure 14. Diffraction at a straight edge.

In this situation, it is likely that the receiver suffers from diffracted rays emitted
from the satellites at low elevation angles. With the help of the 3D visualization in a
GIS environment, it is possible to study and analyse the signal degradation in more
detail, given a location and a time, which can facilitate the testing on the
performance of a high sensitivity GNSS receiver and the development of new
multipath mitigation algorithms. As shown in figure 16, given a set of observation
points, all the building footprints are searched for potential diffraction points, and
both direct and diffracted rays are visualized on a 1-m LiDAR DSM. However, it is

Figure 15. Pink lines indicating the edge diffracted rays . # Crown Copyright/database
right 2007. An Ordnance Survey/EDINA supplied service.

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 GPS multipath

1211

important to know that the 3D building blocks, as shown in figure 15, are an inexact
representation of
the true building heights, and therefore introduce spatial
uncertainty into the identification of diffracted rays. As mentioned earlier, the
building heights were estimated from the mean of the points within each building
footprint, because an overestimate of the building height (e.g. the highest point)
would result in an increase in the number of identified diffracted rays. An example is
given in figure 16.

In figure 16(b), increasing the height of all the building edges by 3 m would
generate a larger number of diffracted rays compared with the height estimated by
the mean height approach in Figure 16(a) according to equation (3).

On the contrary, underestimated building heights would result in a decrease in the
number of identified diffracted rays. Since most of the buildings in the study area
have flat building roofs, the mean height approach provides a more realistic
estimation of the true building height than using the highest point. A super-
imposition of the block building models on the LiDAR DSM would also reveal
whether the mean height approach is acceptable or not, as higher LiDAR points
would stand out in this case. Furthermore, the height of the building foundations
was obtained from the bare earth terrain model which was created using a
supervised classification/filtering technique that strips out vegetation and building
from the LIDAR derived surface model. This bare earth DTM was processed and
provided by the Environment Agency.

In summary, a combination of 2D building footprints and LiDAR DSMs can
help visualize diffracted rays without using detailed 3D vector building models
which is often unavailable or at substantial cost. However, the issues of spatial
uncertainty and the implications of using different derived heights should be taken
into consideration.

6. Central London data

The experiment was carried out using data collected from a vehicle on route through
the urban canyons of Central London, over a 5-min period. A low-cost single GPS

Figure 16.
mean height plus 3 m.

(a) Rays identified using the mean height. (b) More rays identified using the

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 1212

J. Li et al.

receiver was used, with an antenna height of 4.4 m. In figure 17, the vehicle is
travelling from north to south. It is quite evident that removing SV15 from the
single-epoch least-square solution brings an improvement of around 40 m. The GPS
points are brought back on to the road centreline at the beginning and end of the
road without using SV15. The elevation angle of SV15 is just above 15u and
introduced large positional errors. Note that other error
such as
atmospheric effects and satellite clock cannot cause such severe positional errors.
Similar improvements as such are observed on other parts of the route as well at
different times.

sources

In order to produce a visibility map for SV15, the antenna height of 4.4 m is added
to the height of each pixel cell centre on the 1-m raster LiDAR DSM, and the LOS
analysis is subsequently performed at each cell centre. Therefore, the resultant
visibility map has a very high resolution of 1 m, and is displayed as a backdrop in
figure 17. It can be seen from figure 17 that SV15 is frequently masked and
unmasked by the buildings especially in the two transition zones at the beginning
and end of the road where SV15 becomes invisible to visible. Also, SV15 is not
visible most of the time when travelling along the middle part of the road due to the
urban canyon effects. However, there is no sufficient evidence to say that this large

Figure 17.
Ordnance Survey/EDINA supplied service.

Improvements without SV15. # Crown Copyright/database right 2007. An

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 GPS multipath

1213

positional error is caused by multipath. Figures 15 and 16 also visualize the potential
diffracted rays being tracked by the receiver

7. Reflection

7.1 Ray tracing for reflected rays

In general, ray tracing techniques can be classified into two main groups: techniques
based on the shooting and bouncing rays method, and techniques based on the
image method (Catedra and Arriaga 1999). The image method is used in this study.
As shown in figure 18, it appears that the signal is emitted directly from the image
source (I) given an original signal source (S) and a building segment. The image
point (I) is symmetrical to the signal source (S) with respect to the building segment.
Note that two additional tests have to be made before a reflected ray is successfully
identified. First, the reflection point (R) must be located onto the building segment
in order to create a reflected ray. The second test is to check if there are any
obstructions between the signal source (S) and the reflection point (R) which could
block the LOS. Therefore, an accurate LOS result is a prerequisite for successful
identification of reflected rays. The details of the implementation of image-based ray
tracing algorithm are presented as follows:

1. Calculate the 2D coordinates of the image point with respect to the current

building segment in the scene.

2. Calculate the 2D coordinates of the intersection point (R) between the current
building segment and the line connecting the image point and the receiver
point (O). The calculation of the intersection point is completed in 2D, which
requires the 2D building footprints. The heights of both image and receiver
point are set to zero in this step.

3. Perform the 3D LOS analysis between the current image point and the
receiver point using 1-m spacing LiDAR raster DSM. The reflection point
exists only if the obstruction point closest to the receiver is identical to the
intersection point computed in Step 2. The height of the obstruction point is
interpolated along the LOS, which is also the height of the reflection point.
4. Perform the LOS analysis between the reflection point and the satellite. If

unobstructed, a reflected ray is detected.

Figure 18. Application of the image method to the ray reflections.

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 1214

J. Li et al.

Steps 1–4 are performed iteratively for each of the building segments in the scene
and the satellites in the sky above a particular elevation mask angle (e.g. 15u).

As illustrated in figure 19, dotted lines represent reflected rays. It should be noted
that the edge effects of the 1-m LiDAR DSM must be taken into account when
performing the LOS between the reflection point and the satellite. This is because
the LOS may be blocked by an obstruction point on the building wall that is very
close to the reflection point (e.g. only a few centimetres away). In such a
circumstance,
than invisible.
the satellite should be deemed visible rather
Furthermore, the execution speed of the ray-tracing algorithm depends on the
number of buildings stored in the scene, and ray-acceleration techniques should be
considered when a large number of buildings are present in the scene.

7.2 Spatial pattern of multipath error due to one single reflection

The magnitude of multipath error mainly depends on the amplitude, time delay, and
phase of the multipath signal relative to the LOS signal. The theoretical multipath
envelopes are given by Van Dierendonck et al. (1992). However, reasonable
assumptions have to be made in order to assess the possible magnitude of
pseudorange multipath error. An example is given in figure 20.

The steps taken to calculate the map of pseudorange multipath error displayed in

figure 20 are as follows:

1. Given a particular satellite with an elevation angle, in this study, SV15 was
chosen at an elevation angle of 15u. Note that the visibility of this particular
satellite is also shown in figure 20.
In this study, the power of the reflected signal is set to 0.5 relative to the direct
signal, as the reflection coefficient for concrete at the propagation angel of 15u
is about 0.5. A detailed discussion and derivation of the reflection coefficients
for various materials can be found in Hannah (2001).

2.

3. Only one single reflected ray is considered when the direct signal is present.

The reflected-only signals are not displayed in figure 20.

The additional length the reflected signal travels compared with the direct signal is
divided by the speed of light, and the resultant quantity is the time delay. The phase

Figure 19. Reflected (dotted lines) and direct rays (solid lines).

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 GPS multipath

1215

Figure 20. 0.1 chip pseudorange multipath error in metres.

delay is simply the additional length divided by 19 cm, which is the wavelength of
GPS L1. Alternatively, the phase delay can be set to either 180 or 0u in order to
assess the absolute maximum multipath error. This method is more appropriate,
owing to the fact that it is not possible to calculate the exact number of carrier cycles
at centimetre level given the spatial accuracy of LiDAR and building footprints. It
should be noted that the objective of this research is to indicate the possible
occurrence of multipath error for planning and testing purposes rather than
precisely compute the amount of pseudorange multipath error.

As shown in figure 20, every cell centre in the 1-m LiDAR data is used as a
potential observation point (i.e. receiver position) at which ray tracing is performed
in order to detect the reflected rays. As a result, the resultant prediction map has a
very high resolution of 1 m.

As illustrated in figure 20,

the reflections are more likely to occur when
the receiver is placed close to a building. The pseudorange multipath map
gives clear location information of the possible occurrences of multipath owing
the predicted magnitude of multipath
to one single reflection. Furthermore,
error (in metres) agrees with the theoretical multipath envelopes such as the one
for 0.1 chip narrow correlator fully described in Van Dierendonck et al.
(1992). Moreover, the developed software can be extended to assess and identify
reflected only signals in urban areas, which introduces unbounded errors into
positioning.

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 1216

J. Li et al.

Table 1. Number of reflection points identified by both data sets.

Supplier

Resolution

EA
InfoTerra

1 m
1 m

No. of receiver
positions processed

No. of reflection
points

No. of reflection points
identified in both data sets

12917
12917

1068
972

683 (64%)
683 (70%)

7.3 Spatial uncertainty on the identification of reflected rays

As mentioned in section 2 of this paper, the two LiDAR data sets of the University
campus were flown at different times and processed by two different organizations.
Although a thorough investigation on the effect of multipath identification caused
by different interpolation and data-processing techniques is beyond the scope of this
research, it is interesting to compare the results produced by each of these two data
sets. Having performed ray tracing on a total of 12 917 points on campus, the
agreement between two data sets is 683 reflection points out of around 1000 points,
as shown in table 1. This means that reflected rays are identified at these 683
locations in both DSMs, the 683 points account for 64 percent of the total number
of reflection points identified by EA data, and 70 percent for the data from
InfoTerra.The discrepancies in the number of reflection points between the two data
sets are mainly due to the different outcomes of LOS tests performed on each of the
two surface models. Although both LiDAR data sets are at 1-m spatial resolution,
the inconsistencies in point density, accuracy, and interpolation errors may all have
an impact on the identification of
such
discrepancies between the two LiDAR DSMs. Black points indicate the points

reflected rays. Figure 21 displays

Figure 21. Map of occurrence of reflection in which white points indicate the occurrence of
reflection in both DSMs, and black points indicate the occurrence of reflection in either EA
data or infoTerra data.

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 GPS multipath

1217

where reflected rays were identified either in EA data or in InfoTerra data, but not
in both. White points indicate the locations where reflection occurs in both data sets.

8. Conclusions

In conclusion, the use of LiDAR data and 2D building footprints can visualize and
predict GPS multipath effect in urban areas. The transition period during which a
satellite was moving from invisible to visible to the receiver was successfully
identified on 1-m LiDAR DSMs. The positional errors introduced by the affected
satellite were also identified and visualized in figure 8. Ray tracing was performed in
a 3D GIS, and diffracted and reflected rays were visualized and used to predict the
magnitude of multipath error. For the rays diffracted by the side of the building, a
Keller’s cone was implemented based on 3D block buildings generated from 2D
building footprints and LiDAR data. The limited accuracy of 3D building blocks
also had an effect on the identification of diffracted rays. This effect has been
visualized in figure 16. For the reflected rays, two different LiDAR data sets gave
different results on the number of identified reflection points, as shown in figure 20
and table 1. Such inconsistencies between both LiDAR surface models are mainly
caused by the different outcomes of the LOS tests performed on two different
surface models. Furthermore, the terrain data in raster format used in this work is
compatible with common GIS applications. Either a triangulated irregular network
or a regular grid can be used in conjunction with the building footprints. Therefore,
the developed ray tracing method does not require full three-dimensional city
models which are often unavailable or at substantial cost.

Finally, the preliminary results presented in this paper have demonstrated that the
developed approach is effective and feasible. Future research will focus on the
verification and validation on the multipath effect caused by reflection and diffraction.

Acknowledgements
Thanks are given to UK Environment Agency (EA) and InfoTerra for providing
LiDAR data, The copyright of the LiDAR data used belongs to EA and InfoTerra.

References
BE´ TAILLE, D., 2003, Testing methodology for GPS Phase multipath mitigation techniques. In
Proceedings of the 16th International Technical Meeting of the Satellite Division of the
Institute of Navigation ION GPS/GNSS 2003, Portland, Oregon, USA, pp. 2151–2162.
BRAASCH, M.S., 1996, Multipath effects. In Global Positioning System: Theory and Applica-

tions, 1, (Washington, DC: American Institute of Aeronautics and Astronautics).

BRUNNER, F.K., HARTINGER, H. and TROYER, L., 1999, GPS signal diffraction modelling: the

stochastic SIGMA-D model. Journal of Geodesy, 73, pp. 259–267.

CATEDRA, M.F. and ARRIAGA, J.P., 1999, Cell Planning for Wireless Communications

HANNAH, B.M., 2001, Modelling and simulation of GPS multipath propagation. PhD thesis,

(London: Artech House).

Queensland University of Technology.

ITU-R P.526-7, 1999, Propagation by diffraction, Radio Communication Bureau,

International Telecommunication Union (ITU), Geneva.

ORDNANCE SURVEY, 2007, OS Landline technical

information leaflet. Available on line
http://www.ordnancesurvey.co.uk/oswebsite/products/landline/pdf/ds20865.pdf

at:
(accessed 20 October 2007).

PARSONS, J.D., 2000, The Mobile Radio Propagation Channel, pp. 36–37 (Chichester, UK:

Wiley).

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 1218

GPS multipath

PRATT, A.R., 2004, Performance of multi-path mitigation techniques at low signal to noise

ratios. In Proceedings of ION GPS/GNSS 2004, Long Beach, CA.

RICHTER, B. and EULER, H.J., 2001, Study of improved observation modelling for surveying
type applications in multipath environment. In Proceedings of ION-GPS 2001, Salt
Lake City, UT.

SAUNDERS, S.R., 1999, Antennas and Propagation for Wireless Communication Systems

STRANG, G. and BORRE, K., 1997, Linear Algebra, Geodesy, and GPS (Wellesley, MA:

TAYLOR, G. and BLEWITT, G., 2006, Intelligent Positioning: GPS-GIS Unification (Chichester,

(Chichester, UK: Wiley).

Wellesley-Cambridge Press).

UK: Wiley).

TAYLOR, G., LI, J., KIDNER, D.B., BRUNSDON, C. and WARE, J.M., 2007, Modelling and
prediction of GPS availability with digital photogrammetry and LiDAR. International
Journal of Geographical Information Science, 1, pp. 1–20.

VAN DIERENDONCK, A.J., FENTON, P. and FORD, T., 1992, Theory and Performance of
Narrow Correlator Spacing in a GPS Receiver. Navigation: Journal of the Institute of
Navigation, USA, 39, pp. 265–284.

VRHOVSKI, D., 2003, Satellite visibility in simulating urban satellite positioning-based road
user charging. In Proceedings of ION GPS/GNSS 2003, Portland, OR, pp. 199–205.
WONG, K., MAN, K. and CHAN, W., 2001, Monitoring Hong Kong’s bridges—real-time

kinematic spans the gap. GPSWorld, 12, pp. 10–18.

Downloaded by [Southern Illinois University] at 19:24 02 January 2015 